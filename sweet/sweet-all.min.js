/*! sweet 2015-08-12 
 *  SweetUI JS Library 2.0 
 *  Copyright © Huawei Technologies Co., Ltd. 2013. All rights reserved. 
*/(function(){var e="zh_CN",t="en_US";global=this,"undefined"==typeof I18N&&(global.I18N={}),I18N.core={},I18N.core[e]={month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],week:["一","二","三","四","五","六","日"],date:{time:"时间",okButton:"确定",formatCheckTip:"请输入正确的时间格式："},dialog:{prompt:"提示",alert:"注意",success:"成功",error:"错误",confirm:"确认",warn:"警告",ok:"确定",cancel:"取消"},container:{save:"保存",prev:"上一步",next:"下一步",done:"完成"},tree:{info:"提示告警",warn:"紧急告警",search:"搜索",clickLoad:"点击加载更多",clickLoadOver:"数据全部加载完成",nodeName:"节点",add:"增加","delete":"删除",edit:"编辑"},chart:{unit:"单位: ",meter:{name:"名称",value:"当前值",major:"紧急阀值",minor:"提示阀值",min:"最小值",max:"最大值"},view:"视图",legend:"隐藏图例",balloon:"只显示一个提示",zoom:"缩放",noDataTips:"无数据"},calculator:{title:"公式:",button:"清除公式",tip:"不合法的输入！",emptyText:"请输入！……"},grid:{pageRow:"每页{0}行",text:"共计:{0}条记录",prev:"上一页",next:"下一页",go:"跳转",hideCol:"隐藏该列",filter:"过滤",exactMatch:"精确匹配",fuzzyMatch:"模糊匹配",notEqual:"不等于",eqNull:"为空",notNull:"非空",from:"从",to:"至",okBtn:"确认",resetBtn:"重置",clearSingleFilter:"清除过滤",selectCol:"列选择",multiSort:"多列组合排序",secondStat:"二次统计",clearFilter:"清除所有过滤",qClearFilter:"确定要清除所有过滤吗？","export":"导出","delete":"删除",edit:"编辑",modify:"修改",close:"关闭",pause:"暂停",start:"启动",reset:"复位",detail:"详情",confirm:"确认",SN:"序号",validate:{beginDate:"请输入开始时间！",endDate:"请输入结束时间！",compare:"开始时间必须早于结束时间！"},multiSortWin:{winWidth:450,comboLabelWidth:"30%",comboWidth:280,radioWidth:120,title:"列排序设置",asc:"升序",desc:"降序",firstSort:"第一排序列",secondSort:"第二排序列",thirdSort:"第三排序列",firstNoSelectTip:"请选择第一排序列，排序方式。",secondNoSelectTip:"请选择第二排序列，排序方式。",thirdNoSelectTip:"请选择第三排序列，排序方式。"}},mask:{loading:"加载中...",second:"秒"},combobox:{pleaseCheck:"请选择...",pleaseSelect:"请选择",checkAll:"全选"},tab:{menu:{closeCurrent:"关闭标签",closeOthers:"关闭其它标签",closeAll:"关闭所有标签"}},tip:{EMPTY_TITLE:"不能为空。",HEX_TIP_TITLE:"请输入合法的十六进制数！",IP_TIP_TITLE:"请输入合法的IP地址！",NUMBERFEILD_MAX_TIP:"允许输入的最大数值：",NUMBERFEILD_MIN_TIP:"允许输入的最小数值：",LENGTH_RANGE_1:"字符长度范围应该在",LENGTH_RANGE_2:"~",LENGTH_RANGE_3:"之间！"},listbox:{clearAll:"清空",close:"关闭"},labelImage:{setting:"设置",plus:"添加",add:"添加",minus:"删除","delete":"删除",save:"保存","import":"导入","export":"导出",print:"打印",lock:"锁定",unlock:"未锁定",reset:"重置"},exportType:{csv:"CSV",pdf:"PDF",xls:"Excel"},fileUpload:{browse:"浏览",importType:"导入方式",appendImport:"追加式导入",overWriteImport:"覆盖式导入"},fileUploadWin:{title:"文件上传",fileName:"文件名"},list:{total:"总数",selected:"已选",minRemains:"最少选择{0}个。",maxRemains:"最多选择{0}个。"},map:{layer:"层级：",areaName:"区域："},widgetPanel:{refresh:"刷新",setting:"设置",close:"删除"},stateItem:{plus:"新增","delete":"删除",check:"设置默认",headerText:"状态",stateText:"状态"}},I18N.core[t]={month:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],week:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],date:{time:"Time",okButton:"OK",formatCheckTip:"Please specify the time in correct format: "},dialog:{prompt:"Prompt",alert:"Alert",success:"Success",error:"Error",confirm:"Confirm",warn:"Warning",ok:"OK",cancel:"Cancel"},container:{save:"Save",prev:"Previous",next:"Next",done:"Finish"},tree:{info:"Warning",warn:"Major",search:"Search",clickLoad:"Click here to load more data",clickLoadOver:"Data loading is complete.",nodeName:"Node",add:"Add","delete":"Delete",edit:"Edit"},chart:{unit:"Unit: ",meter:{name:"Name",value:"Value",major:"Major",minor:"Minor",min:"Min",max:"Max"},view:"View",zoom:"Zoom",legend:"Hide Legend",balloon:"Only One Balloon",noDataTips:"No data"},calculator:{title:"Formula: ",button:"Clear",tip:"Invalid value!",emptyText:"entry text……"},grid:{pageRow:"{0} rows/page",text:"Total:{0} records",prev:"Previous",next:"Next",go:"Go",hideCol:"Hide Column",filter:"Filter",exactMatch:"Exact match",fuzzyMatch:"Fuzzy match",notEqual:"Not equal",eqNull:"Is null",notNull:"Not null",from:"From",to:"To",okBtn:"OK",resetBtn:"Reset",clearSingleFilter:"Clear",selectCol:"Select Column",multiSort:"Multi-column Sorting",secondStat:"Secondary Statistics",clearFilter:"Clear All Filters",qClearFilter:"Are you sure to clear all filters?","export":"Export","delete":"Delete",edit:"Edit",modify:"Modify",close:"Close",pause:"Pause",start:"Start",reset:"Reset",detail:"Details",confirm:"Confirm",SN:"SN",validate:{beginDate:"Please input the start time.",endDate:"Please input the end time.",compare:"The start time should be earlier than the end time."},multiSortWin:{winWidth:650,comboLabelWidth:"45%",comboWidth:350,radioWidth:250,title:"Column Sorting Setup",asc:"Ascending Order",desc:"Descending Order",firstSort:"First Sorting Column",secondSort:"Second Sorting Column",thirdSort:"Third Sorting Column",firstNoSelectTip:"Please select the first sorting column and sorting mode.",secondNoSelectTip:"Please select the second sorting column and sorting mode.",thirdNoSelectTip:"Please select the third sorting column and sorting mode."}},mask:{loading:"Loading...",second:"s"},combobox:{pleaseCheck:"Please select…",pleaseSelect:"Please select",checkAll:"All"},tab:{menu:{closeCurrent:"Close Current Tab",closeOthers:"Close Other Tabs",closeAll:"Close All Tabs"}},tip:{EMPTY_TITLE:"This value cannot be empty.",HEX_TIP_TITLE:"Please enter a valid hexadecimal number.",IP_TIP_TITLE:"Please enter a valid IP address.",NUMBERFEILD_MAX_TIP:"Maximum value allowed: ",NUMBERFEILD_MIN_TIP:"Minimum value allowed: ",LENGTH_RANGE_1:"The length must be ",LENGTH_RANGE_2:" to ",LENGTH_RANGE_3:" characters."},listbox:{clearAll:"Clear",close:"Close"},labelImage:{setting:"Setting",plus:"Add",add:"Add",minus:"Delete","delete":"Delete",save:"Save","import":"Import","export":"Export",print:"Print",lock:"Lock",unlock:"Unlock",reset:"ReSet"},exportType:{csv:"CSV",pdf:"PDF",xls:"Excel"},fileUpload:{browse:"Browse",importType:"Import Mode",appendImport:"Appended",overWriteImport:"Overwritten"},fileUploadWin:{title:"Upload File",fileName:"File Name"},list:{total:"Total",selected:"Selected",minRemains:"At least {0} of them must be selected.",maxRemains:"A maximum of {0} of them can be selected."},map:{layer:"Level:",areaName:"Area:"},widgetPanel:{refresh:"Refresh",setting:"Setting",close:"Remove"},stateItem:{plus:"Add","delete":"Delete",check:"Set as default",headerText:"State",stateText:"state"}}})(),function(){var e="zh_CN",t="en_US";I18N.cmp={},I18N.cmp[e]={holiday:"节假日",timeSchedule:{buttonText:"忙时"},stat:{calculation_msg:"统计",confirm_msg:"确定",cancel_msg:"取消",total_msg:"计数",delete_msg:"删除",max_msg:"最大值",min_msg:"最小值",sum_msg:"求和",average_msg:"平均",secondary_statistics_msg:"二次统计",indicators_msg:"指标",statistics_item_msg:"统计项",analysis_dimensions_msg:"待选分析维度",selected_analysis_dimensions_msg:"已选分析维度",statistics_msg:"统计",select_indicators_msg:"请选择指标！",analysis_dimension_msg:"请选择分析维度！",prompt_msg:"提示"},officeDirection:{sourceCombLabel:"源",destinationCombLabel:"目的",optionsMsg:"选择项",selectedMsg:"已选择"},listWindow:{fromTitle:"选择项",toTitle:"已选择"}},I18N.cmp[t]={holiday:"节假日",timeSchedule:{buttonText:"Time Schedules"},stat:{calculation_msg:"Calculate",confirm_msg:"Confirm",cancel_msg:"Cancel",total_msg:"Count",delete_msg:"Delete",max_msg:"Maximum",min_msg:"Minimum",sum_msg:"Sum",average_msg:"Average",secondary_statistics_msg:"Secondary statistics",indicators_msg:"Indicator",statistics_item_msg:"Statistic",analysis_dimensions_msg:"Analysis dimensions",selected_analysis_dimensions_msg:"Selected analysis dimensions",statistics_msg:"Statistics",select_indicators_msg:"Please select indicator!",analysis_dimension_msg:"Select the analysis dimension!",prompt_msg:"Reminder"},officeDirection:{sourceCombLabel:"Source",destinationCombLabel:"Destination",optionsMsg:"Options",selectedMsg:"Selected"},listWindow:{fromTitle:"Options",toTitle:"Selected"}}}(),function(){var e="zh_CN",t="en_US";I18N.business={},BusinessI18NZH=I18N.business[e]={},BusinessI18NEN=I18N.business[t]={}}(),function(e){var t="sweetMask",i="sweetMaskLoading",a="sweetMaskRecordTime",n="options",o="sweet-mask",r="sweet-mask-all",l="sweet-mask-masked",s="sweet-mask-relative",d="sweet-mask-loading",c="sweet-mask-loading-msg",h="sweet-mask-loading-pic";e.fn.sweetMask=function(u){var p,f,g,m,v,w,_={propagation:!1,maskAll:!1,loading:!1,msg:Sweet.core.i18n.mask.loading},C=.5,b=e.extend({},_,u),E=e(this);if(!e(this).hasClass(l)){if(p=e.getMaxZIndex(),f=p+1,g=e("<div>").addClass(o).css({"z-index":p}).attr("tabindex","-1"),E.addClass(l).data(t,g).data(n,b),b.duration&&(g.css("opacity",0),g.animate({opacity:C},b.duration)),b.maskAll){v=e(document),w=document.body,g.addClass(r).appendTo(document.body);var y=e(document).width(),x=e(document).height();g.width(y).height(x)}else w=v=E,"static"===E.css("position")&&E.addClass(s),g.appendTo(E);if(b.propagation&&g.bind("click",function(e){e.stopImmediatePropagation()}),b.loading&&(m=e("<div>").css({"z-index":f}).addClass(d).appendTo(w),e("<div>").addClass(c+" "+h).html(b.msg).appendTo(m),E.data(i,m),sweetDebug)){var T=function(){var t=m.children(),i=t.html(),a=i.indexOf("("),n=i.indexOf(")");-1!==a?i=i.substr(0,a+1)+(e.string.toNumber(i.substring(a+1,n-1))+1)+Sweet.core.i18n.mask.second+i.substr(n):i+="&nbsp;&nbsp;(1"+Sweet.core.i18n.mask.second+")",t.html(i)},D=setInterval(T,1e3);E.data(a,D)}g.focus()}},e.fn.unSweetMask=function(){var d,c,h,u=e(this),p=u.data(n);if(p){d=p.maskAll?u.data(t):u.find("."+o).first();var f=p.duration||0;d.animate({opacity:0},{duration:f,complete:function(){d.remove();var o=e("."+r).length;p.maskAll&&1>o&&e(document.body).css("overflow","auto"),p.loading&&(sweetDebug&&(h=u.data(a),clearInterval(h)),c=u.data(i),c.remove()),u.removeClass(l+" "+s).removeData(n+" "+t+" "+i+" "+a)}})}},e.fn.getSweetMaskZIndex=function(){return e(this).data(t).css("z-index")}}(jQuery),function(e){function t(e,t){var i=t.options.getAttrTipType.call(e,",")||t.options.tipType;"error"===i&&(e.hasClass("sweet-form-input-text")||e.hasClass("sweet-form-combobox-element")||e.hasClass("sweet-form-comboboxv1-input")?(e.addClass("sweet-tips-input"),e.parent().addClass("sweet-tips-inputParent")):e.hasClass("sweet-form-textarea-errorRedBorder")&&e.parent().addClass("sweet-tips-input sweet-tips-inputParent"))}function i(e,t){var i=t.options.getAttrTipType.call(e,",")||t.options.tipType;"error"===i&&(e.hasClass("sweet-form-input-text")||e.hasClass("sweet-form-combobox-element")||e.hasClass("sweet-form-comboboxv1-input")?(e.removeClass("sweet-tips-input"),e.parent().removeClass("sweet-tips-inputParent")):e.hasClass("sweet-form-textarea-errorRedBorder")&&e.parent().removeClass("sweet-tips-input sweet-tips-inputParent"))}function a(t,i){var a=(t.attr("aria-describedby")||"").split(/\s+/);a.push(i),t.data("ui-sweettip-id",i).attr("aria-describedby",e.trim(a.join(" ")))}function n(t,a){var n=t.data("ui-sweettip-id"),o=(t.attr("aria-describedby")||"").split(/\s+/),r=e.inArray(n,o);-1!==r&&o.splice(r,1),t.removeData("ui-sweettip-id"),o=e.trim(o.join(" ")),o?t.attr("aria-describedby",o):t.removeAttr("aria-describedby");var l=a.options.getAttrTipType.call(t,",")||a.options.tipType,s=a.options.getAttrErrorModel.call(t,",")||"none";"error"===l&&"side"===s&&i(t,a)}var o=0,r="side";e.widget("ui.sweettip",{version:"1.0",options:{getAttrTipType:function(){var t=e(this).attr("tiptype")||"";return e("<a>").text(t).html()},getAttrErrorModel:function(){var t=e(this).attr("errormodel")||"";return e("<a>").text(t).html()},content:function(){var t=e(this).attr("title")||"";return t.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/&lt;br&gt;/g,"<br>")},hide:!0,items:"[title]:not([disabled])",position:{my:"left+20 top-40",at:"right top",collision:"flipfit flip"},show:!0,sweettipClass:null,track:!0,close:null,open:null,tipType:"normal",tipFloat:!0},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.sweettips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(t,i){var a=this;return"disabled"===t?(this[i?"_disable":"_enable"](),this.options[t]=i,void 0):(this._super(t,i),"content"===t&&e.each(this.sweettips,function(e,t){a._updateContent(t)}),void 0)},_disable:function(){var t=this;e.each(this.sweettips,function(i,a){var n=e.Event("blur");n.target=n.currentTarget=a[0],t.close(n,!0)}),this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.is("[title]")&&t.data("ui-sweettip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=e(this);t.data("ui-sweettip-title")&&t.attr("title",t.data("ui-sweettip-title"))})},showErrorBorder:function(i){var a=e(i?i.currentTarget:this.element);t(a,this)},open:function(t){var i=this,a=e(t?t.target:this.element).closest(this.options.items);if(a.length&&!a.data("ui-sweettip-id")){for(var n=a,o=n.prop("tagName").toUpperCase();"BODY"!==o;){if("SVG"===o)return;if(n=n.parent(),!n||0>=n.length)break;o=n.prop("tagName").toUpperCase()}if(a.attr("title")){var r=a.data("ui-sweettip-title");r&&"none"===a.attr("title")?(a.attr("title",""),this._destroy(),a.data("ui-sweettip-title",""),this.tipChange=!0):(a.data("ui-sweettip-title",a.attr("title")),this.tipChange=!1)}a.data("ui-sweettip-open",!0),t&&"mouseover"===t.type&&a.parents().each(function(){var t,a=e(this);a.data("ui-sweettip-open")&&(t=e.Event("blur"),t.target=t.currentTarget=this,i.close(t,!0)),a.attr("title")&&(a.uniqueId(),i.parents[this.id]={element:this,title:a.attr("title")},a.attr("title",""))}),this._updateContent(a,t)}},_updateContent:function(e,t){var i,a=this.options.content,n=this,o=t?t.type:null;return"string"==typeof a?this._open(t,e,a):(i=a.call(e[0],function(i){e.data("ui-sweettip-open")&&n._delay(function(){t&&(t.type=o),this._open(t,e,i)})}),i&&this._open(t,e,i),void 0)},_open:function(t,i,n){function o(e){d.of=e,r.is(":hidden")||r.position(d)}var r,l,s,d=e.extend({},this.options.position);if(n){if(r=this._find(i),r.length)return r.find(".ui-sweettip-content").html(n),void 0;i.is("[title]")&&(t&&"mouseover"===t.type?i.attr("title",""):i.removeAttr("title")),r=this._sweettip(i),a(i,r.attr("id")),r.find(".sweet-tip-content").html(n),r.css({left:0,top:0});var c=r.get(0),h=getComputedStyle(c,"").width;r.width(h),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:o}),o(t)):r.position(e.extend({of:i},this.options.position)),r.hide(),this._show(r,this.options.show),this.options.show&&this.options.show.delay&&(s=this.delayedShow=setInterval(function(){r.is(":visible")&&(o(d.of),clearInterval(s))},e.fx.interval)),this._trigger("open",t,{sweettip:r}),l={keydown:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var a=e.Event(t);a.currentTarget=i[0],this.close(a,!0)}},remove:function(){this._removesweettip(r)}},t&&"mouseover"!==t.type||(l.mouseleave="close",l.focusout="close"),t&&"focusin"!==t.type||(l.focusout="close"),this._on(!0,i,l)}},close:function(i){var a=this,o=e(i?i.currentTarget:this.element),r=this._find(o),l=this.options.getAttrTipType.call(o,",")||this.options.tipType,s=this.options.getAttrErrorModel.call(o,",")||"none";return"normal"===l||"error"===l&&"none"===s?this.options.tipFloat=!0:"error"===l&&"side"===s&&(this.options.tipFloat=!1),this.options.tipFloat?(this.closing||(clearInterval(this.delayedShow),o.data("ui-sweettip-title")&&e.isNull(o.attr("title"))&&o.attr("title",o.data("ui-sweettip-title")),n(o,this),r.stop(!0),this._hide(r,this.options.hide,function(){a._removesweettip(e(this))}),o.removeData("ui-sweettip-open"),this._off(o,"mouseleave focusout keyup"),o[0]!==this.element[0]&&this._off(o,"remove"),this._off(this.document,"mousemove"),i&&"mouseleave"===i.type&&e.each(this.parents,function(t,i){e(i.element).attr("title",i.title),delete a.parents[t]}),this.closing=!0,this._trigger("close",i,{sweettip:r}),this.closing=!1),void 0):(n(o,this),this.tipChange||t(o,a),void 0)},_sweettip:function(i){var a="ui-sweettip-"+o++,n=e("<div>").attr({id:a,role:"sweettip"}),l=this.options.getAttrErrorModel.call(i,",")||"none",s=this.options.getAttrTipType.call(i,",")||this.options.tipType;if("error"===s&&r===l?n.insertAfter(this.element.parent().parent().parent()):n.appendTo(this.document[0].body),"normal"===s)n.addClass("sweet-tips-tipBox"+(this.options.sweettipClass||"")),e("<div>").addClass("sweet-tip-content sweet-tip-content-normal").appendTo(n);else if("error"===s)if("none"===l){n.addClass("sweet-tips-errorBox"+(this.options.sweettipClass||""));var d=e("<div>").appendTo(n);e("<div>").addClass("sweet-tips-errorImage").appendTo(d),e("<div>").addClass("sweet-tip-content sweet-tip-content-error").appendTo(d),t(i,this)}else if("side"===l){n.addClass("sweet-tips-errorBox-side"+(this.options.sweettipClass||""));var c=e("<div>").appendTo(n);e("<div>").addClass("sweet-tips-errorImage-side").appendTo(c),e("<div>").addClass("sweet-tip-content sweet-tip-content-error").appendTo(c),t(i,this),this.options.tipFloat=!1,this.options.position=i.hasClass("sweet-form-combobox-element")||i.hasClass("sweet-form-comboboxv1-input")||i.hasClass("sweet-form-input-text")&&i.parent().attr("class").indexOf("sweet-form-input-date")>=0?{my:"left+43 top+15",at:"right+10 top-17",collision:"flipfit flip"}:{my:"left+10 top+15",at:"right+10 top-17",collision:"flipfit flip"}}return this.sweettips[a]=i,n},_find:function(t){var i=t.data("ui-sweettip-id");return i?e("#"+i):e()},_removesweettip:function(e){e.remove(),delete this.sweettips[e.attr("id")]},_destroy:function(){var t=this;i(t.element,t),e.each(this.sweettips,function(a,n){var o=e.Event("blur");o.target=o.currentTarget=n[0],t.close(o,!0),e("#"+a).remove(),i(n,t),n.data("ui-sweettip-title")&&n.removeData("ui-sweettip-title"),n.removeAttr("title")})}})}(jQuery),jQuery.fn.sweetDrag=function(e,t,i){"use strict";function a(i){r=!1,l.css("cursor","default"),$.isFunction(e)&&t(i)}var n,o,r=!1,l=$(this),s=0,d=0;l.mousedown(function(t){var i=!0;$.isFunction(e)&&(i=e(t)),i!==!1&&(n=t.pageX-(parseInt(l.css("left"),10)||0),o=t.pageY-(parseInt(l.css("top"),10)||0),r=!0,null!==i&&l.css("position","absolute"))}),l.mouseup(a),$(document).mouseup(a),$(document).mousemove(function(e){return r?(e.preventDefault(),s=e.pageX-n,d=e.pageY-o,$.isFunction(i)&&i(e,s,d)===!1?!1:(l.css("cursor","move"),l.css({top:d,left:s}),!1)):void 0})},function(e){"use strict";function t(){o=!0,Sweet.Task.Delay.start({id:r,run:function(){o=!1},delay:5e3})}function i(t){var i,a,n,o,r=0;if(t||(t=window.event),t.wheelDelta?r=t.wheelDelta/120:t.detail&&(r=-t.detail/3),r)for(var s=0;l.length>s;s++)a=l[s].obj,n=l[s].callback,o=t.originalTarget||t.srcElement,(!o||o.id===a.attr("id")||e.contains(a.get(0),o))&&e.isFunction(n)&&(i={ui:a,delta:r},n(t,i)===!1&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1))}function a(){window.addEventListener?window.addEventListener("DOMMouseScroll",i,!1):window.onmousewheel=i}jQuery.fn.externalWidth=function(t){var i=this;if(e.isNull(t))return i.outerWidth(!0);if("number"==typeof t)return i.outerWidth(t,!0),i;if("auto"===t)return i.width(t),i;if("string"==typeof t&&/\d+%/.test(t)){if(0===i.outerWidth(!0)-i.width())i.width(t);else try{var a=parseInt(t,10);i.outerWidth(i.parent().width()*a/100,!0)}catch(n){e.log(n)}return i}return i},jQuery.fn.externalHeight=function(t){var i=this;if(e.isNull(t))return i.outerHeight(!0);if("number"==typeof t)return i.outerHeight(t,!0),i;if("auto"===t)return i.height(t),i;if("string"==typeof t&&/\d+%/.test(t)){if(0===i.outerHeight()-i.height())i.height(t);else try{var a=parseInt(t,10);i.outerHeight(i.parent().height()*a/100,!0)}catch(n){e.log(n)}return i}return i};var n=[],o=!1,r="jquery.sweetutil.obj_size_monitor";e(function(){e("body").bind("mousedown mouseup keydown",function(){t()}),e(window).resize(function(){t()}),t()}),e.fn.onResize=function(i){t();for(var a,o,r,l=0;n.length>l;l++)if(a=n[l].obj,o=a[0],r=this[0],o&&r&&o.id===r.id)return e.isNull(i)?(n.splice(l,1),l--):n[l].handler=i,void 0;var s={width:this.width(),height:this.height()};n.push({obj:this,handler:i,size:s})},window.setInterval(function(){if(o){var i=[];e.each(n,function(a,n){n.obj.is(":hidden")||(n.obj.width()!==n.size.width||n.obj.height()!==n.size.height)&&(t(),n.size.width=n.obj.width(),n.size.height=n.obj.height(),e.isFunction(n.handler)&&i.push(n))});for(var a,r=0;i.length>r;r++)a=i[r],a.handler(a.obj)}},100);var l=[];a(),jQuery.fn.onMouseWheel=function(t,a){for(var n=0;l.length>n;n++)if(e(t).attr("id")===l[n].obj.attr("id"))return a===void 0?l.splice(n,1):l[n].callback=a,this;return l.push({obj:e(t),callback:a}),t.onmousewheel=i,this},jQuery.fn.scrollPanel=function(t,i){function a(){var e=p.find(">."+E.contentClass);return e.length>0?e.first():p.children().first()}function n(e){e===_?p.__verticalScrollBar.css("opacity",1):e===C&&p.__horizonScrollBar.css("opacity",1),w=!0}function o(e){e===_?p.__verticalScrollBar.css("opacity",E.opacity):e===C&&p.__horizonScrollBar.css("opacity",E.opacity),w=!1}function r(t,i){var n=!1;if(d=a().externalWidth(),c=a().externalHeight(),m=p.width(),v=p.height(),e.isNumeric(i)&&p.__verticalScrollBar&&c>v){f>i&&(i=f);var o=p.height()-f-p.__verticalScrollBar.outerHeight(!0);i>o&&(i=o);var r=parseInt(p.__verticalScrollBar.css("top"),10)||0;i!==r&&(p.__verticalScrollBar.css("top",i),i=Math.ceil((i-f)/(o-f)*(c-v)),a().css("top",0-i),n=!0)}if(e.isNumeric(t)&&p.__horizonScrollBar){f>t&&(t=f);var l=p.width()-f-p.__horizonScrollBar.outerWidth(!0);t>l&&(t=l);var s=parseInt(p.__horizonScrollBar.css("top"),10)||0;t!==s&&(p.__horizonScrollBar.css("left",t),t=Math.ceil((t-f)/(l-f)*(d-m)),a().css("left",0-t),n=!0)}return n}function l(t){var i,a,l,s=null,d=null,c=null,h=null;if(t!==_||p.__verticalScrollBar){if(t!==C||p.__horizonScrollBar)return;i=0,a=E.thick,d=3,h=f,l=p.__horizonScrollBar=e("<div>")}else i=E.thick,a=0,s=3,c=f,l=p.__verticalScrollBar=e("<div>");l.css("width",i).css("border-radius",E.radius).css("background-color",E.color).css("opacity",E.opacity).css("z-index",10).css("position","absolute").css("top",c).css("right",s).css("bottom",d).css("left",h).appendTo(p),l.sweetDrag(function(){n(t)},function(){o(t)},function(e,i,a){return t===_?r(null,a):r(i,null),!1}),l.hover(function(){l.css("opacity",1)},function(){l.css("opacity",E.opacity)})}function s(e){var t,i,n,o;e===_?(o=a().outerHeight(!0),i=p.height(),o>i?(h=Math.floor((i-2*f)*i/o),g>h&&i>g&&(h=g),p.__verticalScrollBar.outerHeight(h,!0).show()):(p.__verticalScrollBar.hide(),a().css("top",0))):e===C&&(n=a().outerWidth(!0),t=p.width(),n>t?(h=Math.floor((t-2*f)*t/n),g>h&&t>g&&(h=g),p.__horizonScrollBar.outerWidth(h,!0).show()):(p.__horizonScrollBar.hide(),a().css("left",0)))}var d,c,h,u,p=this,f=5,g=10,m=this.width(),v=this.height(),w=!1,_="vertical",C="horizon",b="both",E={thick:6,radius:3,color:"#7E838B",opacity:.5,contentClass:"sweet-scroll-content"};e.extend(E,i);var y=this.css("position");return"absolute"!==y&&"relative"!==y&&this.css("position","relative"),this.css("overflow","hidden"),"undefined"===e.type(t)||null===t?(this.__verticalScrollBar instanceof e&&(this.__verticalScrollBar.hide(),r(null,-2e3)),this.__horizonScrollBar instanceof e&&(this.__horizonScrollBar.hide(),r(-2e3,null)),this):(a().css("position","absolute"),(t===_||t===b)&&("undefined"===e.type(this.__verticalScrollBar)&&(l(_),u=this.get(0),this.onMouseWheel(u,function(e,t){var i=(parseInt(p.__verticalScrollBar.css("top"),10)||0)-10*t.delta;return r(null,i)===!0?!1:void 0})),s(_)),(t===C||t===b)&&("undefined"===e.type(this.__horizonScrollBar)&&l(C),s(C)),this)}}(jQuery),jQuery.extend({log:function(e){sweetDebug&&window.console&&window.console.log&&window.console.log(e)},error:function(e){sweetDebug&&window.console&&window.console.error&&(window.console.log("%c "+e+" ","background:#222;color:#bada55"),window.console.error(e))},objClone:function(e){if($.isNull(e)||$.isArray(e)&&0===e.length)return e;var t;t=Object===e.constructor?new e.constructor:new e.constructor(e.valueOf());for(var i in e)t[i]!==e[i]&&(t[i]="object"==typeof e[i]?$.objClone(e[i]):e[i]);return t},objCopy:function(e){if(!$.isNull(e)){var t={};for(var i in e)e.hasOwnProperty(i)&&("object"==typeof e[i]||$.isFunction(e[i])||(t[i]=e[i]));return t}},objMultiSort:function(e){return function(t,i){for(var a,n,o,r=0,l=0;e.length>l;l++)if(o=e[l],a=t[o.name],n=i[o.name],"number"===o.dataType&&(a=$.string.toNegativeInfinity(a),n=$.string.toNegativeInfinity(n)),r=$._getCompareValue(a,n,o.order),0!==r)return r;return 0}},objSort:function(e,t){return function(i,a){var n=i[e],o=a[e];return $._getCompareValue(n,o,t)}},objNumberSort:function(e,t){return function(i,a){var n=$.string.toNegativeInfinity(i[e]),o=$.string.toNegativeInfinity(a[e]);return $._getCompareValue(n,o,t)}},_getCompareValue:function(e,t,i){var a=0;if(a=t>e?1:e>t?-1:0,Sweet.constants.sortType.ASC===i)return-a;if(Sweet.constants.sortType.DESC===i)return a;throw Error("Do not support the type of sort!")},isVisiable:function(e){return!e.is(":hidden")},isNull:function(e){return void 0===e||null===e||""===e},isNotNull:function(e){return $.isNull(e)?!1:!0},isString:function(e){return"string"===$.type(e)},isBoolean:function(e){return"boolean"===$.type(e)},isDate:function(e){return"date"===$.type(e)},isRegExp:function(e){return"regexp"===$.type(e)},isNumber:function(e){return"number"===$.type(e)},isUndefined:function(e){return void 0===e},isEmptyArray:function(e){return $.isArray(e)&&0===e.length},nullToString:function(e){return e&&"function"==typeof e?"":$.isNull(e)?"":e},equals:function(e,t){if(e===t)return!0;if(e===void 0||null===e||"object"!=typeof e)return!1;if(t===void 0||null===t||"object"!=typeof t)return!1;var i=0,a=0;for(var n in e)i++;for(var o in t)a++;if(i!==a)return!1;if(e.constructor===t.constructor){for(var r in e)if("object"==typeof e[r]){if(!$.equals(e[r],t[r]))return!1}else if("function"==typeof e[r]){if(!$.equals(""+e[r],""+t[r]))return!1}else if(e[r]!==t[r])return!1;return!0}return!1},string:{lpad:function(e,t,i){if($.isNull(e))return $.error("lpad() The input parameter is null."),void 0;if("string"===$.type(e)||"number"===$.type(e)){var a,n=""+e,o=n.length;if(o>=t)return e;a=t-o;for(var r=0;a>r;r++)n=i+n;return n}},toNegativeInfinity:function(e){if($.isNumber(e))return e;var t=parseFloat(e);return 0!==t&&isNaN(t)&&(t=Number.NEGATIVE_INFINITY),t},toNumber:function(e){if($.isNull(e))return $.error("toNumber() The input parameter is null."),void 0;var t=10;if("string"===$.type(e)){if(!$.isNumeric(e))return $.error("toNumber() The input parameter 'value' is not a number. value="+e),e;if(-1!==e.indexOf("0")){var i;for(i=0;e.length>i&&"0"===e.charAt(i);i++);if(i!==e.length)return parseInt(e.substr(i),t)}return parseInt(e,t)}return e},urlParamToJson:function(e){if($.isNull(e))return $.error("Function urlParamToJson(): The input arg is null."),void 0;var t,i,a={};t=e.split("&");for(var n=0;t.length>n;n++)i=t[n].split("="),a[i[0]]=i[1];return a},reviseNumber:function(e){var t="";if($.isNull(e))return $.error("Function reviseNumber(): the input arg is null."),t;if(!$.isNumeric(e))return $.error("Function reviseNumber(): the input parameter 'value' is not a number. value="+e),e;var i=e,a=!1;"-"===e[0]&&(i=e.slice(1),a=!0);for(var n=".",o=i.indexOf(n),r=-1,l=-1,s=0;i.length>s;s++)"0"!==i[s]&&0>r&&(r=s),"0"!==i[i.length-1-s]&&0>l&&(l=i.length-1-s);if(r>l)return $.error("A no-specific error!"),t;if(o>-1){if(r>o||o>l)return $.error("A no-specific error!"),t;t=r===o&&l===o?"0":r===o&&l!==o?i.slice(r-1,l+1):r!==o&&l===o?i.slice(r,l):i.slice(r,l+1)}else t=i.slice(r);return a?"-"+t:t}},date:{getMilliseconds:function(){var e=new Date;return e.getTime()},format:function(e,t){var i=t;return i=i.replace(/yyyy|YYYY/,e.getFullYear()),i=i.replace(/yy|YY/,e.getYear()%100>9?""+e.getYear()%100:"0"+e.getYear()%100),i=i.replace(/MM/,e.getMonth()>=9?""+(e.getMonth()+1):"0"+(e.getMonth()+1)),i=i.replace(/M/g,e.getMonth()+1),i=i.replace(/w|W/g,Sweet.core.i18n.week[e.getDay()]),i=i.replace(/dd|DD/,e.getDate()>9?""+e.getDate():"0"+e.getDate()),i=i.replace(/d|D/g,e.getDate()),i=i.replace(/hh|HH/,e.getHours()>9?""+e.getHours():"0"+e.getHours()),i=i.replace(/h|H/g,e.getHours()),i=i.replace(/mm/,e.getMinutes()>9?""+e.getMinutes():"0"+e.getMinutes()),i=i.replace(/m/g,e.getMinutes()),i=i.replace(/ss|SS/,e.getSeconds()>9?""+e.getSeconds():"0"+e.getSeconds()),i=i.replace(/s|S/g,e.getSeconds())},getLocalOffset:function(){var e=new Date;return 60*e.getTimezoneOffset()},millisecondsToDate:function(e,t){return"number"!=typeof e?($.log("millisecondsToDate(): The input parameter 'milliseconds' is not a number! milliseconds="+e),void 0):($.isNull(t)&&(t="YYYY-MM-dd HH:mm:ss"),this.format(new Date(e),t))},dateToUTC:function(e,t){if($.isNull(t)&&(t=-(new Date).getTimezoneOffset()/60),"string"!=typeof e)return $.log("Function dateToUTC(): The input parameter 'date' is not a string! date="+e),void 0;if("number"!=typeof t)return $.log("Function dateToUTC(): The input parameter 'timeZone' is not a number! timeZone="+t),void 0;var i,a=-(new Date).getTimezoneOffset()/60,n=e.split(" "),o=n[0].split("/"),r=o[0],l=o[1]-1,s=o[2],d=n[1]?n[1].split(":"):["00","00","00"],c=d[0]?d[0]:"00",h=d[1]?d[1]:"00",u=d[2]?d[2]:"00",p=new Date(r,l,s,c,h,u,0);return isNaN(p)?0:(a=-p.getTimezoneOffset()/60,i=p.getTime()-36e5*(t-a),i/=1e3,i=Math.floor(i),$.isNull(i)?0:i)},UTCToDate:function(e){if($.isNull(e))return $.error("Function UTCToDate(): The input args is null."),void 0;var t=new Date;t.setTime(1e3*e);var i=t.getFullYear(),a=t.getMonth()+1;2>(a+"").length&&(a="0"+a);var n=t.getDate();2>(n+"").length&&(n="0"+n);var o=t.getHours();2>(o+"").length&&(o="0"+o);var r=t.getMinutes();2>(r+"").length&&(r="0"+r);var l=t.getSeconds();return 2>(l+"").length&&(l="0"+l),i+"-"+a+"-"+n+" "+o+":"+r+":"+l},isLeapYear:function(e){return $.isNumeric(e)?("number"!=typeof e&&(e=parseInt(e,10)),0===e%4&&0!==e%100||0===e%400?!0:!1):($.error("Function isLeapYear(): The input parameter 'year' is not a number! year="+e),!1)},setDateAfterOrder:function(e,t,i,a){var n,o,r=t,l=parseInt(e,10),s=(new Date).getTime()/1e3,d=-new Date(1e3*i).getTimezoneOffset()/60,c=$.isNotNull(i)?i:s;if(a?a:a=d,n=3600*a,r>=i?r=i:"",$.isNotNull(l)&&(o=(r+n)%l,o>0))for(r=((r-o)/l+1)*l;r>c;)r-=l;return r},setTimeAlignment:function(e,t,i,a,n){var o=$.date.setDateAfterOrder(e,t,a,n),r=$.date.setDateAfterOrder(e,i,a,n);return o===r&&(o-=e),{start:o,end:r}},fixTime:function(e,t){if($.isNull(t)||$.isNull(e)||0===parseInt(e,10))return $.log("Granularity Error value:"+e),t;var i=new Date,a=60*i.getTimezoneOffset(),n=parseInt(t,10)-a,o=n%parseInt(e,10),r=n-o+parseInt(e,10);return r+=a},UTCToDateTime:function(e,t,i){if($.isNull(e))return $.error("Function UTCToDateTime(): The input args is null."),void 0;var a=new Date;a.setTime(1e3*e);var n=a.getMonth()+1;n=10>n?"0"+n:n;var o=a.getDate();o=10>o?"0"+o:o;var r=a.getHours();r=10>r?"0"+r:r;var l=a.getMinutes();return l=10>l?"0"+l:l,$.isNull(t)||$.isNull(i)?r+":"+l:parseInt(t,10)>=86400?n+"/"+o:parseInt(t,10)>=3600?n+"/"+o+" "+r+":"+l:parseInt(t,10)>=900?r+":"+l:void 0},compare:function(e,t,i){var a,n,o,r,l;return $.isNotNull(i)?(o=RegExp(i,"g"),a=new Date(e.replace(o,"/")),n=new Date(t.replace(o,"/"))):(a=new Date(e),n=new Date(t)),r=a.getTime(),l=n.getTime(),r>l?1:r===l?0:-1},getSDstSwitchDate:function(e){var t,i,a=this,n=null,o=0,r=99;if(e=parseInt(e),isNaN(e))return n;1e3>e&&(e+=1900);for(var l=0;12>l;l++)t=new Date(Date.UTC(e,l,0,0,0,0,0)),i=-1*t.getTimezoneOffset()/60,i>r&&(o=l-1),r=i;return n=a._findDstSwitchDate(e,o)},_findDstSwitchDate:function(e,t){for(var i,a,n,o,r,l,s,d,c,h=this,u=new Date(Date.UTC(e,t,0,0,0,0,0)),p=-1,f=-1*u.getTimezoneOffset()/60,g=0,m=0;50>m;m++)if(n=new Date(Date.UTC(e,t,m,0,0,0,0)),s=-1*n.getTimezoneOffset()/60,s!=f){for(g=0,n=new Date(Date.UTC(e,t,m-1,0,0,0,0)),s=-1*n.getTimezoneOffset()/60;-1==p;){if(n=new Date(Date.UTC(e,t,m-1,0,g,0,0)),s=-1*n.getTimezoneOffset()/60,s!=f){s=new Date(Date.UTC(e,t,m-1,0,g-1,0,0)),p=g;break}g++}return i=s.getMonth()+1,a=s.getDate(),n=new Date(Date.UTC(e,t,m-1,0,g-1,0,0)),d=n.toTimeString().split(" ")[0].split(":"),o=parseInt(d[0]),r=parseInt(d[1]),l=parseInt(d[2]),c=1==t?h.isLeapYear(e)?29:28:0==t||2==t||4==t||6==t||7==t||9==t||11==t?31:30,r+1>=60&&(r=0,o+=1),o>23&&(o=0,a+=1),a>c&&(a=1,t+=1),t>11&&(t=0,e+=1),[e,t,a,o,r,l]}return null}},number:{fixPrecision:function(e,t){return $.isNumeric(e)?parseFloat(parseFloat(e).toFixed(t)):($.log("Function fixPrecision(): The input parameter 'value' is not a number! value="+e),void 0)
},isFloat:function(e){return $.isNumeric(e)?"string"==typeof e?-1!==e.indexOf("."):e!==Math.round(e):($.log("Function isFloat(): The input parameter 'value' is not a number! value="+e),void 0)},toHex:function(e){return $.isNull(e)?"00":(e=parseInt(e,10),0===e||isNaN(e)?"00":(e=Math.max(0,e),e=Math.min(e,255),e=Math.round(e),"0123456789abcdef".charAt((e-e%16)/16)+"0123456789abcdef".charAt(e%16)))}},e:{getCharCode:function(e){var t=e.browserEvent||e;return t.charCode||t.keyCode||0},getMousePosition:function(e){var t=e||window.event,i=document.documentElement.scrollLeft||document.body.scrollLeft,a=document.documentElement.scrollTop||document.body.scrollTop,n=t.pageX||t.clientX+i,o=t.pageY||t.clientY+a;return{x:n,y:o}},onlyNumber:function(e){if(Sweet.constants.keyCode.BACKSPACE!==e.keyCode&&Sweet.constants.keyCode.ENTER!==e.keyCode&&Sweet.constants.keyCode.DELETE!==e.keyCode&&Sweet.constants.keyCode.LEFT!==e.keyCode&&Sweet.constants.keyCode.RIGHT!==e.keyCode&&Sweet.constants.keyCode.DOWN!==e.keyCode&&Sweet.constants.keyCode.UP!==e.keyCode&&Sweet.constants.keyCode.TAB!==e.keyCode){var t=RegExp("[0123456789]"),i=String.fromCharCode($.e.getCharCode(e));t.test(i)||e.preventDefault()}}},cursor:{getSelection:function(e){if(e.createTextRange){var t=document.selection.createRange().duplicate();t.moveStart("character",-e.value.length);var i=t.text.length,a=document.selection.createRange().duplicate();a.moveEnd("character",e.value.length);var n=e.value.lastIndexOf(a.text);return""===a.text&&(n=e.value.length),{start:n,end:i}}return{start:e.selectionStart,end:e.selectionEnd}}},cookie:{set:function(e,t,i){var a=new Date;a.setDate(a.getDate()+i),document.cookie=e+"="+escape(t)+(null===i?"":";expires="+a.toGMTString())+";path=/"},get:function(e){if(document.cookie.length>0){var t,i=document.cookie.indexOf(e+"=");if(-1!==i)return i=i+e.length+1,t=document.cookie.indexOf(";",i),-1===t&&(t=document.cookie.length),unescape(document.cookie.substring(i,t))}}},regExp:{escape:function(e){return $.isNull(e)?void 0:e.replace(/\\/g,"\\\\").replace(/\$/g,"\\$").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\[/g,"\\[").replace(/\?/g,"\\?").replace(/\^/g,"\\^")}},externalSize:function(e){var t={width:0,height:0},i=$(e);return 0===i.length?t:(t.width=i.externalWidth(),t.height=i.externalHeight(),t)},operColumn:function(e){function t(e,t,i,a){return'<a href="javascript:void(0);" class="'+e+' space" '+'row="'+t+'" '+'column="'+i+'" '+'title="'+a+'"'+"></a>"}var i='<div class="sweet-common-opercolumn">',a=$.extend({},{row:0,column:0,data:0,rowData:{},columnDesc:{}},e);for(var n in a.columnDesc.rendererArr)a.columnDesc.rendererArr.hasOwnProperty(n)&&(Sweet.constants.operType.EDIT===n?i+=t("sweet-common-opercolumn-edit",a.row,a.column,Sweet.core.i18n.grid.edit):Sweet.constants.operType.MODIFY===n?i+=t("sweet-common-opercolumn-modify",a.row,a.column,Sweet.core.i18n.grid.modify):Sweet.constants.operType.DELETE===n?i+=t("sweet-common-opercolumn-delete",a.row,a.column,Sweet.core.i18n.grid["delete"]):Sweet.constants.operType.CLOSE===n?i+=t("sweet-common-opercolumn-close",a.row,a.column,Sweet.core.i18n.grid.close):Sweet.constants.operType.PAUSE===n?i+=t("sweet-common-opercolumn-pause",a.row,a.column,Sweet.core.i18n.grid.pause):Sweet.constants.operType.START===n?i+=t("sweet-common-opercolumn-start",a.row,a.column,Sweet.core.i18n.grid.start):Sweet.constants.operType.RESET===n?i+=t("sweet-common-opercolumn-reset",a.row,a.column,Sweet.core.i18n.grid.reset):Sweet.constants.operType.DETAIL===n?i+=t("sweet-common-opercolumn-detail",a.row,a.column,Sweet.core.i18n.grid.detail):Sweet.constants.operType.CONFIRM===n&&(i+=t("sweet-common-opercolumn-confirm",a.row,a.column,Sweet.core.i18n.grid.confirm)));return i+="<div>"},htmlEscape:function(e){return $.isNull(e)||!$.isString(e)?e:e.replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/ /g,"&nbsp;")},htmlInversEscape:function(e){return $.isNull(e)?void 0:e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&nbsp;/g," ")},isIE:function(){"use strict";var e=/MSIE\s\d+\.\d/,t=navigator.userAgent;return e.test(t)},isFirefox:function(){"use strict";var e=/Firefox\/\d+\.\d/,t=navigator.userAgent;return e.test(t)},isChrome:function(){"use strict";var e=/Chrome\/\d+/,t=navigator.userAgent;return e.test(t)},recursiveAssign:function(e,t,i){if(!$.isNull(e))for(var a,n=0;e.length>n;n++)a=e[n],a.children&&a.children.length>0?(a.data?a.data[t]=i:(a.data={},a.data[t]=i),$.recursiveAssign(a.children,t,i)):a.data?a.data[t]=i:(a.data={},a.data[t]=i)},getMaxZIndex:function(e,t){var i=[Sweet.constants.className.MASK,Sweet.constants.className.FLOAT_WINDOW,Sweet.constants.className.DIALOG],a=0,n=Sweet.constants.Z_INDEX;if(!$.isNull(t)){var o=$.type(t);if("string"!==o&&"array"!==o)return $.log("Illegal parameter! Not string or array."),void 0;"string"===o?i.push(t):i.concat(t)}return $.each(i,function(e,t){$("."+t).each(function(){a=$(this).css("z-index"),isNaN(a)||(n=Math.max(n,a))})}),n+=Sweet.constants.Z_INDEX_STEP},getFloatOffset:function(e,t,i){var a=$(window),n=$(document),o=a.height()+n.scrollTop(),r=a.width()+n.scrollLeft(),l=e.offset(),s=e.outerWidth(!0),d=e.outerHeight(!0),c=t.outerWidth(!0),h=t.outerHeight(!0);return i?c>=r-l.left&&l.left+s>c?{top:l.top+d,left:l.left-c+s}:{top:l.top+d,left:l.left}:h>=o-l.top-d&&l.top>=h?{top:l.top-h,left:l.left}:{top:l.top+d,left:l.left}},getPadding:function(e){return[$.getPaddingTop(e),$.getPaddingRight(e),$.getPaddingBottom(e),$.getPaddingLeft(e)]},getPaddingTop:function(e){return parseInt(e.css("padding-top").slice(0,-2),10)},getPaddingRight:function(e){return parseInt(e.css("padding-right").slice(0,-2),10)},getPaddingBottom:function(e){return parseInt(e.css("padding-bottom").slice(0,-2),10)},getPaddingLeft:function(e){return parseInt(e.css("padding-left").slice(0,-2),10)},matrix:{reversal:function(e){if(!$.isArray(e))return $.error("Function reversal(): The input arg is not array."),void 0;for(var t=[],i=e.length,a=0,n=0;i>n;n++){a=e[n].length;for(var o=0;a>o;o++)t[o]||(t[o]=[]),t[o][n]=e[n][o]}return t}},windowToCanvas:function(e,t,i){var a=e.getBoundingClientRect();return{x:t-a.left*(e.width/a.width),y:i-a.top*(e.height/a.height)}},color2rgb:function(e){var t=parseInt(e.substr(1,2),16),i=parseInt(e.substr(3,2),16),a=parseInt(e.substr(5,2),16);return[t,i,a]},rgb2color:function(e){for(var t="",i=0;e.length>i;i++){var a=Math.round(e[i]).toString(16);1===a.length&&(a="0"+a),t+=a}return"0x"+t.toUpperCase()},lineGradient:function(e,t,i){for(var a=[],n=$.color2rgb(e),o=$.color2rgb(t),r=0;i>r;r++){for(var l=[],s=0;3>s;s++)l.push(n[s]+(o[s]-n[s])/i*r);a.push($.rgb2color(l))}return a},colorStepByStep:function(e,t,i){var a,n,o,r,l,s,d,c,h,u=100,p=0,f=i?i.length:0,g=[];if(!(f>0))return g;if(1===f)return[e];if(2===f)return[e,t];a=(16711680&e)>>>16,n=(65280&e)>>>8,o=255&e,r=(16711680&t)>>>16,l=(65280&t)>>>8,s=255&t,p=Math.floor(u/(f-1));for(var m=0;f>m;m++){var v=m*p;d=255&a+v*(r-a)/u,c=255&n+v*(l-n)/u,h=255&o+v*(s-o)/u,g.push($.rgb2color([d,c,h]))}return g},dealAttrSVG:function(e){function t(e,t){for(var i=e.getElementsByTagName(t),a=i.length;a--;)i[a].parentNode.removeChild(i[a])}return t(e,"pattern"),t(e,"image"),e},fuzzyFilter:function(e,t,i,a,n){if($.isNull(e))return e;t=$.isNull(t)?"":t,a=a||!1,n=n||!1;var o,r="value",l=this,s=RegExp($.regExp.escape(t),"i");o=n?e:$.objClone(e),i||(r="text");var d,c,h;return $.each(o,function(e,n){if(!$.isNull(n))if(n.children&&n.children.length>0){if(a){if(d=!1,c=n[r],d=s.test(c))return;l.fuzzyFilter(n.children,t,i,a,!0)}else l.fuzzyFilter(n.children,t,i,a,!0);h=!1,$.each(n.children,function(e,t){$.isNull(t)||(h=!0)}),h||delete o[e]}else d=!1,c=n[r],d=s.test(c),d||delete o[e]}),l.deleteUndefinedData(o)},deleteUndefinedData:function(e){var t=this,i=[];for(var a in e){var n=e[a];if(!$.isNull(n)&&!$.isFunction(n)&&!$.isNull(n.value)){var o={text:n.text,value:n.value,data:n.data,editable:n.editable};t._createChildNode(e[a].children,o),i.push(o)}}return i},_createChildNode:function(e,t){var i,a,n=this,o=!0;if($.isNull(e)||$.isNull(t))return[];for(var r in e)if(i=e[r],!$.isNull(i)&&!$.isNull(i.text)){o=!1;break}if(o&&$.isArray(e)&&0===e.length)return[];for(var r in e)$.isNull(t.children)&&(t.children=[]),i=e[r],$.isNull(i)||$.isFunction(i)||(a={text:i.text,value:i.value,data:i.data,editable:i.editable},i.children?(a.children=[],t.children.push(a),n._createChildNode(i.children,a)):t.children.push(a))}}),function(){var e=this;"undefined"==typeof Sweet&&(e.Sweet={});var t="en_US",i="locale",a={zh_CN:"zh_CN",en_US:"en_US"};Sweet.core={},Sweet.constants={Z_INDEX:1e3,KEY:"key",VALUE:"value",FUNC:"func",HREFSCRIPT:"javascript:void(0);",logLevel:{ERROR:"error",INFO:"info"},sortType:{ASC:"ASC",DESC:"DESC"},colors:["#369cd8","#60b2df","#63ccd3","#b7e042","#90cc19","#f2a14e","#cf7a37","#cf4737","#d07dd0","#9a53e4","#a5a5a5"],layout:{HLayout:"HLayout",VLayout:"VLayout",GridLayout:"gridLayout",BorderLayout:"borderLayout",AccordionLayout:"accordionLayout",CardLayout:"cardLayout"},imgType:{INDEX:"index",DIM:"dim",CUSTOM_INDEX:"customizedIndex"},align:{LEFT:"left",RIGHT:"right",CENTER:"center",TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},MONTHS:[31,28,31,30,31,30,31,31,30,31,30,31],keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},symbol:{COLON:":",EQUAL:"=",LIKE:"LIKE",NOTEQUAL:"<>",EQNULL:"NULL",NOTNULL:"NOTNULL",LT:"<",GT:">"},fontSize:12,language:{KEY:"locale",ZH_CN:"zh_CN",EN_US:"en_US"},dataType:{STRING:"string",NUMBER:"number",DATE:"date",BOOL:"bool",LIST:"list"},graphType:{LINE:"line",AREA:"area",COLUMN:"column",BAR:"bar",PIE:"pie",MIX_COLUMN_LINE:"columnline"},chart:{fontFamily:"Tahoma",textColor:"#696d7d",fontSize:{min:10,normal:12,larger:14},titleCfg:{labelColor:"#3c3c3c",labelAlpha:1}},axisType:{VALUE:"value",CATEGORY:"category"},operType:{SETTING_STYLE1:"setting_style_1",ADD:"add",MODIFY:"modify",DELETE:"delete",MOVE:"move",ACTIVE:"active",TERMINATE:"terminate",SAVEAS:"save",CONFIRM:"confirm",PLUS:"plus",MINUS:"minus",EDIT:"edit",CLOSE:"close",PAUSE:"pause",START:"start",RESET:"reset",DETAIL:"detail",SETTING:"setting",CRITICAL:"critical",MAJOR:"major",MINOR:"minor",WARNING:"warning",WARNING_R:"warning_r",CRITICAL_R:"critical_r",CUSTOM_1:"custom_1",CUSTOM_2:"custom_2",CUSTOM_3:"custom_3",CUSTOM_4:"custom_4",CUSTOM_5:"custom_5",CUSTOM_6:"custom_6",CUSTOM_7:"custom_7",IMPORT:"import",EXPORT:"export",PRINT:"print",REFRESH:"refresh",FOLDER:"folder",CATEGORY:"category",VIEW:"view",FAVORITE_ADD:"favorite_add",FAVORITE_REMOVE:"favorite_remove",LAYOUT:"layout",DASHBOARD:"dashboard",DASHBOARD_SETTING:"dashboard_setting",ENTER_FULLSCREEN:"enter_fullscreen",EXIT_FULLSCREEN:"exit_fullscreen",LOCK:"lock",UNLOCK:"unlock",ADDNODE:"addNode",ADDCHILDREN:"addChildren"},tipAttr:{TYPE_NORMAL:"normal",TYPE_ERROR:"error",MODEL_NORMAL:"none",MODEL_SIDE:"side"},ipType:{VERSION4:"v4",VERSION6:"v6",VERSION:"v"},scoreCard:{ROW:2,NUM:5,TYPE:"line",LINE_COLOR:"#99a5af",FILL_COLOR:"#d1dfec",WIDTH:"50px",HEIGHT:"18px",SPOT_COLOR:"#99a5af",MAX_SPOT_COLOR:"",MIN_SPOT_COLOR:"",LINE_WIDTH:2,SPOT_RADIUS:2,NO_VALUE:"--",CHAR_NUM:2},numColor:{GREEN:"green",RED:"red",YELLOW:"yellow"},differType:{EQUAL:"equal",INCREASE:"increase",DECREASE:"decrease"},errorType:{UNCONNECTED:"server_unconnected",UNKNOWN:"server_unknown",COMMON:"common_error"},gap:{IMG_TEXT:40},elWidth:{MIN_WIDTH:400,DIV_WIDTH:620},btnImageType:{INDEX:"index",DIM:"dim",ADD:"add",MODIFY:"modify",DELETE:"delete",MOVE_TO:"moveto",ACTIVE:"active",TERMINATE:"terminate"},listWindowButton:{RIGHT:">",LEFT:"<",ALL_RIGHT:">>",ALL_LEFT:"<<"},className:{MASK:"sweet-mask",DIALOG:"sweet-dialog-bg",FLOAT_WINDOW:"sweet-float-bg"},exportType:{CSV:"csv",XLS:"xls",PDF:"pdf"},overflow:{AUTO:"auto",HIDDEN:"hidden"},Z_INDEX_STEP:10},Sweet.libPath=SweetLoad&&SweetLoad.basePath?SweetLoad.basePath:"../",Sweet.amchartsImagePath=Sweet.libPath+"lib/amcharts/amcharts/images/",Sweet.supermapThirdJsPath=Sweet.libPath+"lib/supermap/layer",Sweet.supermapImagePath={defaultCell:Sweet.libPath+"themes/default/core/images/map/cellDef.png",overCell:Sweet.libPath+"themes/default/core/images/map/cellIn.png"},Sweet.logLevel=Sweet.constants.logLevel.INFO,Sweet._widgets={},Sweet.chart={},Sweet.form={},Sweet.Dialog={},Sweet.Msg={},Sweet.list={},Sweet.container={},Sweet.panel={},Sweet.portal={},Sweet.grid={},Sweet.menu={},Sweet.tree={},Sweet.core.i18n={},Sweet.Calculator={},Sweet.Reader={},Sweet.Store={},Sweet.Task={},Sweet.MapCfg={},Sweet.getWidget=function(e){return $.isNull(e)?($.error("Input parameter id is empty!"),null):Sweet._widgets[e]},Sweet.setLocale=function(e){return $.isNull(e)?($.error("Input parameter language is empty!"),null):(I18N&&I18N.core&&I18N.core[e]&&(Sweet.core.i18n=I18N.core[e]),I18N&&I18N.cmp&&I18N.cmp[e]&&(Sweet.cmp.i18n=I18N.cmp[e]),I18N&&I18N.business&&I18N.business[e]&&(BusinessI18N=I18N.business[e]),void 0)},Sweet.getLocale=function(){var e=$.cookie.get(i),n=a[e];return n?n:t},Sweet.resize=function(){var e={};$.each(Sweet._widgets,function(t,i){"gridPanel"===i.type||"HPanel"===i.type||"VPanel"===i.type?i.doLayout():e[t]=i}),$.each(e,function(e,t){t.doLayout()})},Sweet._closeFloatPanel=function(){$.each(Sweet._widgets,function(e,t){t._closeFloatPanel()})},$(window).resize(function(){var e=$(".sweet-mask-all");e&&e.length>0&&e.width($(document).width()).height($(document).height())}),Sweet._changeLoadTime=function(e){Sweet.Task.Delay.start({id:e,run:function(){var e=new Date;$.cookie.set("timeNum",e.getTime(),null)},delay:350})},Sweet._closeECMMenu=function(){top.clickHideMenu&&top.clickHideMenu()},Sweet._gc=function(){Sweet.Task.Timeout.start({id:"sweet-gc",run:function(){var e,t="[Sweet-gc]: ",i=$.date.getMilliseconds();$.log(t+"Begin GC!!!!!!!!!!!!!!!!"),$.each(Sweet._widgets,function(e,t){(t.rendered||t.getWidgetElFlag)&&0===$("#"+t.options.id).length&&t.destroy()}),e=$.date.getMilliseconds(),$.log(t+"End GC!!! Time-consuming = "+(e-i)+"ms")},interval:6e5})},$(document).ready(function(){$("body").bind("click",function(){setTimeout(Sweet._closeFloatPanel,20),Sweet._changeLoadTime("delayClickChangeLoadTime"),Sweet._closeECMMenu()}),$("body").bind("contextmenu",function(){$.isIE()?Sweet._closeFloatPanel():setTimeout(Sweet._closeFloatPanel,20),Sweet._changeLoadTime("delayContextmenuChangeLoadTime"),Sweet._closeECMMenu()}),$("body").bind("keydown",function(){Sweet._changeLoadTime("delayKeydownChangeLoadTime")}),$("body").bind("mouseup",function(){Sweet._changeLoadTime("delayMouseupChangeLoadTime")}),Sweet._gc(),Sweet.ToolTip.enable()}),Sweet.cmp={},Sweet.cmp.i18n={},Sweet.setLocale($.cookie.get(i)?$.cookie.get(i):t),Sweet.Ajax={_ajaxCount:0,timeout:6e4,request:function(e){var t=e&&$.isFunction(e.success)?e.success:$.noop,i=e&&$.isFunction(e.error)?e.error:$.noop,a={async:!0,type:"post",dataType:"json",loadMask:!0,timeout:6e4,beforeRequest:$.noop,afterRequest:$.noop},n=$.extend({},a,e);return n.success=function(e,i,a){Sweet.Ajax._end(n.loadMask),t(e,i,a),delete t},n.error=function(e,t,a){Sweet.Ajax._end(n.loadMask),i(e,t,a),delete i},n.beforeSend=function(e){Sweet.Ajax._start(n.loadMask,e);var t=$("meta[name='_csrf']"),i=$("meta[name='_csrf_header']"),a=i?i.attr("content"):"",o=t?t.attr("content"):"";a&&o&&e.setRequestHeader(a,o),n.beforeRequest(this,e)},n.complete=function(e){n.afterRequest(this,e)},$.ajax(n)},_start:function(e){return e?(0===Sweet.Ajax._ajaxCount&&$(document).sweetMask({maskAll:!0,loading:!0}),Sweet.Ajax._ajaxCount++,$.log("start ajaxCount:"+Sweet.Ajax._ajaxCount),void 0):!1},_end:function(e){return e?(Sweet.Ajax._ajaxCount--,0===Sweet.Ajax._ajaxCount&&$(document).unSweetMask(),$.log("stop ajaxCount:"+Sweet.Ajax._ajaxCount),void 0):!1}},Sweet.ToolTip={enable:function(){$(document).sweettip({show:{delay:500}})},reset:function(){$(document).sweettip("disable"),$(document).sweettip("enable")}}}(),function(e){if(e.isIE()){var t=window.setTimeout,i=window.setInterval;window.setTimeout=function(e,i){var a=(new Date).getTime();if("function"==typeof e){var n=Array.prototype.slice.call(arguments,2),o=function(){n.push((new Date).getTime()-a-i),e.apply(null,n)};return t(o,i)}return t(e,i)},window.setInterval=function(e,t){var a=(new Date).getTime();if("function"==typeof e){var n=Array.prototype.slice.call(arguments,2),o=function(){n.push((new Date).getTime()-a-t),e.apply(null,n)};return i(o,t)}return i(e,t)}}var a=function(){var t="[Sweet.Task.Timeout]: ",i={},a=function(n){return n&&i[n.id]?i[n.id].stop?(o(n.id),void 0):(i[n.id].pause||(n.run.call(n.scope||n,n.args),i[n.id].timeout=window.setTimeout(a,n.interval,n),e.log(t+"Timer task start. ID = "+n.id)),void 0):void 0},n=function(t){i[t.id]={},e.extend(i[t.id],t),i[t.id].stop=!1,i[t.id].pause=!1,i[t.id].timeout=window.setTimeout(a,t.interval,t)},o=function(e,t){var a=i[e];if(a){var n=a.timeout;n&&clearTimeout(n);var o=a.callBack;o&&!t&&o.call(a.scope||a),delete i[e]}};this.start=function(a){var r=a.id;return e.isNull(r)?(e.error(t+"Task id can not be empty!"),void 0):(i[r]&&(o(r,!0),e.log(t+"The task has already exist!")),n(a),void 0)},this.active=function(e){var t=i[e];t&&n(t)},this.activeAll=function(){e.each(i,function(e,t){t&&n(t)})},this.pause=function(t,a){var n=i[t];n&&(n.pause=!0,e.isFunction(a)?n.callBack=a:"")},this.pauseAll=function(){e.each(i,function(e,t){t&&(t.pause=!0)})},this.stop=function(t,a){var n=i[t];n&&(n.stop=!0,e.isFunction(a)?n.callBack=a:"")},this.stopAll=function(){e.each(i,function(e,t){t&&(t.stop=!0)})}},n=function(){},o=function(){function t(e){var i=n[e.id];if(e&&i){var a=new Date;a.getTime()>=i.time+e.delay&&!i.execute&&(i.execute=!0,o(e.id),e.run.call(e.scope||e,e.args)),i.timeout=window.setTimeout(t,50,e)}}function i(e){var i=new Date;n[e.id]={},n[e.id].time=i.getTime(),n[e.id].timeout=window.setTimeout(t,50,e),n[e.id].execute=!1}var a="[Sweet.Task.Delay]: ",n={},o=function(e){var t=n[e];if(t){var i=t.timeout;i&&clearTimeout(i),delete n[e]}};this.start=function(t){var r=t.id,l=n[r];return e.isNull(r)?(e.error(a+"Task id can not be empty!"),void 0):(l&&o(r),i(t),void 0)},this.stop=function(e){o(e)}};Sweet.Task.Timeout=new a,Sweet.Task.Interval=new n,Sweet.Task.Delay=new o}(jQuery),function(e){e.widget.addExtendListener=function(t,i){var a=t.split("."),n=e[a[0]][a[1]].prototype;n?n._extendHandlers.push(i):(n=[],n._extendHandlers.push(i))};var t=1e3;e.widget("sweet.widget",{version:"1.0",sweetWidgetName:"[widget]:",eventNames:{rendered:"渲染完毕事件"},floatBgClass:"sweet-float-bg",winBgClass:"sweet-win-bg",options:{id:null,vID:null,name:null,width:"100%",height:"100%",visible:!0,widgetClass:"",renderTo:null,listenerEvents:null},hide:function(){this.renderEl.hide(),this.visible=!1},show:function(){this.renderEl.show(),this.visible=!0,this.doLayout()},isVisible:function(){return this.visible},render:function(t){var i=this;if(!i.rendered){var a,n=e.date.getMilliseconds(),o=i.options;i._render(t)&&(i.setWH(o.width,o.height),a=e.date.getMilliseconds(),i._info("Render. Time-consuming = "+(a-n)+"ms"),i.rendered&&i._triggerHandler(i,"rendered"))}},getCanvasObject:function(){var e=this;return e._getCanvasObject()},_getCanvasObject:function(){return null},doLayout:function(t){if(!this.rendered||!this.renderEl.is(":visible"))return this.lastLayoutWidth=0,this.lastLayoutHeight=0,undefined;var i=this.getWidth(),a=this.getHeight();if(0!==i&&(0!==a||"auto"===this.options.height)){if(this.lastLayoutWidth===i&&this.lastLayoutHeight===a){if(t!==!0)return}else this.lastLayoutWidth=i,this.lastLayoutHeight=a;e("body").onResize();var n,o=e.date.getMilliseconds();this.options,this._doLayout(),n=e.date.getMilliseconds(),this._info("Do Layout. Time-consuming = "+(n-o)+"ms")}},setValue:function(t){if(!e.isUndefined(t)){this._hideEmptyText(t);var i,a=e.date.getMilliseconds();this.options.value=e.objClone(t),this._setValue(t),i=e.date.getMilliseconds(),this._info("Set value. Time-consuming = "+(i-a)+"ms")}},setWidth:function(t){var i=this;"string"===e.type(t)&&i.renderEl&&i.renderEl.onResize(function(){i.doLayout()}),i.options.width=t,("string"===e.type(t)||"number"===e.type(t)&&"number"===e.type(i._initConfig.width))&&(i._initConfig.width=t),i._setWidth(t),i.doLayout()},setHeight:function(t){var i=this;"string"===e.type(t)&&i.renderEl&&i.renderEl.onResize(function(){i.doLayout()}),i.options.height=t,("string"===e.type(t)||"number"===e.type(t)&&"number"===e.type(i._initConfig.height))&&(i._initConfig.height=t),i._setHeight(t),i.doLayout()},setWH:function(t,i){var a=this;"string"!==e.type(t)&&"string"!==e.type(i)||!a.renderEl||a.renderEl.onResize(function(){a.doLayout()}),a.options.width=t,a.options.height=i,("string"===e.type(t)||"number"===e.type(t)&&a._initConfig&&"number"===e.type(a._initConfig.width))&&(a._initConfig.width=t),("string"===e.type(i)||"number"===e.type(i)&&a._initConfig&&"number"===e.type(a._initConfig.height))&&(a._initConfig.height=i),a._setWH(t,i),a.doLayout()},setOffset:function(t,i,a){function n(){var n,l,s=Sweet.constants.align;if(s.LEFT===t)if(l=a.left,s.TOP===i)n=a.top;else{if(s.BOTTOM!==i)return o._error(r+"Unsupported parameter. v = "+t),undefined;n=e(document).height()-o.getHeight()-a.top}else{if(s.RIGHT!==t)return o._error(r+"Unsupported parameter. h = "+t),undefined;if(l=e(document).width()-o.getWidth()-a.left,s.TOP===i)n=a.top;else{if(s.BOTTOM!==i)return o._error(r+"Unsupported parameter. v = "+t),undefined;n=e(document).height()-o.getHeight()-a.top}}o.renderEl.css({position:"absolute",top:n,left:l})}var o=this,r="Function setOffset(): ";return e.isNull(a)?(o._error(r+"The parameter is null!"),undefined):(n(),e(document).onResize(function(){Sweet.Task.Delay.start({id:"sweet-setoffset-delay",run:function(){n()},delay:350})}),undefined)},getWidth:function(){var e,t=this;return e=t._getWidth(),"number"!=typeof e?0:e},getHeight:function(){var e,t=this;return e=t._getHeight(),"number"!=typeof e?0:e},getValue:function(){var t,i,a=e.date.getMilliseconds();return i=this._getValue(),t=e.date.getMilliseconds(),this._info("Get value. Time-consuming = "+(t-a)+"ms"),i},addListener:function(t,i){var a=this,n={};e.isNull(t)||(n[t]=i),a.handlers=e.extend({},n,a.handlers),e.each(n,function(t){if(e.isNull(a.eventNames[t]))throw Error("Unsupport event! Event name: "+t)}),a._addListener(t,i)},removeListener:function(t){var i=this;i.handlers=i.handlers||{},i._removeListener(t),e.isNull(t)?delete i.handlers:delete i.handlers[t]},getWidgetEl:function(e){var t,i=this;return t=i.renderEl?e?i.renderEl[0]:i.renderEl:i._getWidgetEl(e),i.getWidgetElFlag=!0,t},_hideEmptyText:e.noop,_getWidgetEl:e.noop,_addListener:e.noop,_removeListener:e.noop,_optionsValidate:e.noop,_render:function(e){var t=this;return!e||t.rendered?!1:t.renderEl||t._createRenderEl(e)?!0:!1},_doLayout:e.noop,_closeFloatPanel:e.noop,_setValue:e.noop,_getValue:e.noop,_setWidth:e.noop,_setHeight:e.noop,_setWH:e.noop,_getWidth:e.noop,_getHeight:e.noop,_beforeCreateSweetWidget:e.noop,_afterCreateSweetWidget:e.noop,_create:function(){if(!this.rendered){var i,a,n=this,o=e.date.getMilliseconds(),r=n.options;if(n._frozen=!1,n.__frozenDoLayout=e.noop,n.__frozenDoLayout2=e.noop,n.visible=n.options.visible,n.handlers||(n.handlers={}),e.isNull(r.id)&&(r.id="sweet-"+t++),!e.isNull(Sweet._widgets[r.id]))return n._error("Duplicate ID! id="+r.id),undefined;a=r.listenerEvents,e.isEmptyObject(a)||e.each(a,function(e,t){n.addListener(""+e,t)}),n._initConfig=e.objCopy(n.options),n._beforeCreateSweetWidget(),n._createSweetWidget(),n._afterCreateSweetWidget(),n._extendHandlers&&e(n._extendHandlers).each(function(){this.call(n)}),n._render(r.renderTo),n.setWH(r.width,r.height),Sweet._widgets[r.id]=n,i=e.date.getMilliseconds(),n._info("Create widget. Time-consuming = "+(i-o)+"ms"),n.rendered&&n._triggerHandler(n,"rendered")}},_createRenderEl:function(t){var i=this,a=i.options;if(t&&!i.renderEl){if(i.renderEl=e("#"+t),0===i.renderEl.length)return!1;i.options.renderTo=t}return a.visible||i.renderEl.hide(),!0},_createSweetWidget:e.noop,destroy:function(){var t=this;Sweet.Task.Delay.start({id:"sweet-widgets-destroy-reset-tooltip",run:function(){Sweet.ToolTip.reset()},delay:100}),t.removeListener(),t._destroyWidget(),t._destroyDom(),e.isNull(t.options)||delete Sweet._widgets[t.options.id];for(var i in t)t.hasOwnProperty(i)&&delete t[i]},_destroyDom:function(){var e=this;e.renderEl&&(e.renderEl.empty(),e.renderEl=null,e.rendered=!1)},_destroyWidget:e.noop,_freeze:function(t){"use strict";var i=this;i._frozen!==t&&(i._frozen=t,t?(i.__frozenDoLayout=i.doLayout,i.__frozenDoLayout2=i._doLayout,i.doLayout=e.noop,i._doLayout=e.noop):(i.doLayout=i.__frozenDoLayout,i._doLayout=i.__frozenDoLayout2,i.__frozenDoLayout=e.noop,i.__frozenDoLayout2=e.noop))},_triggerBodyClick:function(){e(document.body).click()},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},_unselectable:function(){return!1},_error:function(t){sweetDebug&&e.error("[ERROR]"+this.sweetWidgetName+t)},_info:function(t){sweetDebug&&Sweet.constants.logLevel.INFO===Sweet.logLevel&&e.log("[INFO]"+this.sweetWidgetName+t)}}),Sweet.widget=e.sweet.widget}(jQuery),function(e,t){var i,a="sweet-dialog-title",n="sweet-dialog-title-close",o="sweet-dialog-content",r="sweet-dialog-content-success",l="sweet-dialog-content-error",s="sweet-dialog-content-warning",d="sweet-dialog-content-confirm",c="sweet-dialog-content-prompt",h="sweet-dialog-content-prompt-text",u="sweet-dialog-content-prompt-input",p="sweet-dialog-bottom",f="sweet-form-button",g="sweet-dialog-text",m="sweet-dialog-text-pic",v="sweet-dialog-content-input";e.widget("sweet.widgetDialog",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-dialog]",defaultElement:"<div>",defaultDialogBg:"sweet-dialog-bg",options:{width:330,height:130,modal:!0,propagation:!1},alert:function(t){var a=e.extend({},i.options,t),n=a.listeners||{};return i.params=a||{},i._showDialog({dialogClass:"",propagation:a.propagation,prompt:t.prompt?t.prompt:Sweet.core.i18n.dialog.alert,modal:a.modal,message:a.message,okFun:n.ok}),i.textEl.removeClass().addClass(g),i.cancelButtonEl.hide(),i.inputEl.hide(),i},success:function(t){var a=e.extend({},i.options,t),n=a.listeners||{};return i.params=a||{},i._showDialog({dialogClass:r,propagation:a.propagation,prompt:Sweet.core.i18n.dialog.success,modal:a.modal,message:a.message,okFun:n.ok}),i.textEl.addClass(m),i.cancelButtonEl.hide(),i.inputEl.hide(),i},error:function(t){var a=e.extend({},i.options,t),n=a.listeners||{};return i.params=a||{},i._showDialog({dialogClass:l,propagation:a.propagation,prompt:Sweet.core.i18n.dialog.error,modal:a.modal,message:a.message,okFun:n.ok}),i.textEl.addClass(m),i.cancelButtonEl.hide(),i.inputEl.hide(),i},warn:function(t){var a=e.extend({},i.options,t),n=a.listeners||{};return i.params=a||{},i._showDialog({dialogClass:s,propagation:a.propagation,prompt:Sweet.core.i18n.dialog.warn,modal:a.modal,message:a.message,okFun:n.ok,cancelFun:n.cancel}),i.textEl.addClass(m),i.cancelButtonEl.hide(),i.inputEl.hide(),i},confirm:function(t){var a=e.extend({},i.options,t),n=a.listeners||{};return i.params=a||{},i._showDialog({dialogClass:d,propagation:a.propagation,prompt:Sweet.core.i18n.dialog.confirm,modal:a.modal,message:a.message,okFun:n.ok,cancelFun:n.cancel}),i.textEl.addClass(m),i.cancelButtonEl.show(),i.inputEl.hide(),i},prompt:function(a){function n(a){return e.isFunction(r.ok)?r.ok(a,i.inputTextEl.getValue()):t}var o=e.extend({},i.options,a),r=o.listeners||{};if(i.params=o||{},i._showDialog({dialogClass:c,propagation:o.propagation,prompt:Sweet.core.i18n.dialog.prompt,modal:o.modal,message:o.message,okFun:n,cancelFun:r.cancel}),i.textEl.removeClass().addClass(h+" "+g),i.cancelButtonEl.show(),i.inputEl.show(),i.inputTextEl)i.inputTextEl.setValue({text:"",value:""});else{var l=(o.vID?o.vID:o.id)+"_prompt_text";i.inputTextEl=new Sweet.form.TextField({width:i.contentEl.width(),required:o.required||!1,minLength:o.minLength||0,maxLength:o.maxLength||Number.MAX_VALUE,errorModel:Sweet.constants.tipAttr.MODEL_NORMAL,validateFun:o.validateFun,emptyText:o.emptyText,vID:l,renderTo:v})}return i},show:function(){i.dialogEl.show()},hide:function(){i.dialogEl.hide()},_getWidgetEl:function(e){return e?this.dialogEl[0]:this.dialogEl},_doLayout:function(){var t,i,a,n,o=this,r=o.params||{},l=o.options,s=r.width||l.width,d=r.height||l.height,h=e(document);try{t=h.width(),i=h.height()}catch(u){return}if(a=Math.floor((i-d)/3),n=Math.floor((t-s)/2),o.dialogEl.css({top:0>a?0:a,left:n}).width(s).height(d),o.dialogClass===c){var p=parseInt(o.textEl.css("height"));o.textDiv.css({width:"100%",height:p})}else{var f=o.textEl.offset().top,g=o.bottomEl.offset().top,m=g-f-7,p=parseInt(o.textEl.css("height"));o.textDiv.css({width:"100%",height:m}),p>m?"auto"!==o.textDiv.css("overflow-y")&&o.textDiv.css("overflow-y","auto"):o.textDiv.css("overflow-y","hidden")}},_showDialog:function(a){function n(a){l===i.dialogClass&&("boolean"===e.type(a)&&a||t===a)&&i._closeDialog()}function o(t,i,a){var o=!0;e.isFunction(i)&&(o=i.call(null,t)),n(o,a)}function r(t,i,a){var o=!0;e.isFunction(i)&&(o=i.call(null,t)),n(o,a)}var l=a.dialogClass,s=a.prompt,d=a.modal,c=a.message,h=a.okFun,u=a.cancelFun,p=a.propagation;i.dialogClass=l,i.hasAppend||(i.dialogEl.appendTo("body"),i.hasAppend=!0);var f=i.dialogEl,g=0;d?(f.sweetMask({maskAll:!0,propagation:p}),g=e.string.toNumber(f.getSweetMaskZIndex())+1):g=e.getMaxZIndex(),f.css("z-index",g),p&&f.bind("click",function(e){e.stopImmediatePropagation()}),i.titleTextEl.html(s),i.picDivEL.removeClass().addClass(l),i.textEl.html(c),i.show(),i._doLayout(),i.okButtonEl.unbind().bind("click",{dialogClass:l},function(e){o(e,h,e.data.dialogClass)}),i.cancelButtonEl.unbind().bind("click",{dialogClass:l},function(e){r(e,u,e.data.dialogClass)}),i.dialogEl.draggable({handle:"#"+i.titleId,containment:"document",scroll:!1})},_closeDialog:function(e){var t=e||{},i=t.data||{},a=i.me||this,n=a.params||{},o=n.modal;o&&a.dialogEl.unSweetMask(),a.hide()},_createSweetWidget:function(){if(!i){var t=this,a=t.options,n=t.dialogEl=e("<div>").hide();i=t,n.addClass(t.defaultDialogBg+a.widgetClass).attr("id",a.id).height(a.height).width(a.width),t._createTitle(),t._createContent(),t._createButtons()}},_createTitle:function(){var t=this,i=(t.options,t.params||{},t.titleEl=e("<div>")),o=t.closeSapn=e("<span>").addClass(n),r=t.titleTextEl=e("<em>"),l=t.titleId=t.id+"-dialog-title";o.bind("click",function(){t._closeDialog()}).appendTo(i),r.appendTo(i),i.attr("id",l).addClass(a).appendTo(this.dialogEl)},_createContent:function(){var t=this,i=(t.options,t.contentEl=e("<div>")),a=t.picDivEL=e("<div>").appendTo(i),n=t.textDiv=e("<div>").appendTo(a);t.textEl=e("<p>").appendTo(n),t.inputEl=e("<div>").attr("id",v).addClass(u).appendTo(i),i.addClass(o).appendTo(t.dialogEl)},_createButtons:function(){var t=this,i=t.options,a=i.vID?i.vID:i.id,n={width:"65px","margin-left":"5px"},o=t.bottomEl=e("<div>").addClass(p),r=t.okButtonEl=e("<button>").attr("id",a+"_ok").addClass(f),l=t.cancelButtonEl=e("<button>").attr("id",a+"_cancel").addClass(f);r.css(n).text(Sweet.core.i18n.dialog.ok).appendTo(o),l.css(n).text(Sweet.core.i18n.dialog.cancel).appendTo(o),o.appendTo(t.dialogEl)}}),Sweet.Dialog=new e.sweet.widgetDialog({message:""}),Sweet.Msg={alert:function(t,i,a,n){e.isNull(t)||Sweet.Dialog.alert({width:i?i:330,height:a?a:130,message:t,listeners:{ok:function(t){e.isFunction(n)&&n.call(null,t)}}})},success:function(t,i,a,n){e.isNull(t)||Sweet.Dialog.success({width:i?i:330,height:a?a:130,message:t,listeners:{ok:function(t){e.isFunction(n)&&n.call(null,t)}}})},warn:function(t,i,a,n){e.isNull(t)||Sweet.Dialog.warn({width:i?i:330,height:a?a:130,message:t,listeners:{ok:function(t){e.isFunction(n)&&n.call(null,t)}}})},error:function(t,i,a,n){e.isNull(t)||Sweet.Dialog.error({width:i?i:330,height:a?a:130,message:t,listeners:{ok:function(t){e.isFunction(n)&&n.call(null,t)
}}})},confirm:function(t,i,a,n,o){e.isNull(t)||Sweet.Dialog.confirm({width:i?i:330,height:a?a:130,message:t,listeners:{ok:function(t){e.isFunction(n)&&n.call(null,t)},cancel:function(t){e.isFunction(o)&&o.call(null,t)}}})},prompt:function(t,i,a,n,o){e.isNull(t)||Sweet.Dialog.prompt({width:i?i:330,height:a?a:130,message:t,listeners:{ok:function(t){e.isFunction(n)&&n.call(null,t)},cancel:function(t){e.isFunction(o)&&o.call(null,t)}}})}}}(jQuery),function(e){var t="sweet-form-widget",i="sweet-form-combobox-textGray";e.widget("sweet.widgetForm",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-form]",defaultElement:"<input>",type:"text",widgetClass:"sweet.widgetForm",options:{disabled:!1,value:""},widget:function(){return this.formEl},setDisabled:function(e){var t=this,a=t.formElement;return"boolean"!=typeof e?(t._error("setDisabled() Input parameter is not a Boolean type!"),undefined):(a.removeAttr("readonly").removeAttr("disabled"),a.attr("readonly",e),e?a.addClass(i):a.removeClass(i),t.options.disabled=e,t._setDisabled(e),t.disabled=e,e||!1===t.editable&&t.setEditable(!1),undefined)},getDisabled:function(){return this.options.disabled},_getWidgetEl:function(e){return e?this.formEl[0]:this.formEl},_setWidth:function(e){var t=this;t.formEl&&t.formEl.externalWidth(e)},_setHeight:function(e){var t=this;t.formEl&&t.formEl.externalHeight(e)},_getWidth:function(){var e=this;return e.formEl.externalWidth()},_getHeight:function(){var e=this;return e.formEl.externalHeight()},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)},_doLayout:function(){},_setValue:function(t){var i,a=this;e.isNull(t)||(i=a._textCmpSetValue(t),a.formElement.val(i))},_textCmpSetValue:function(t){var i,a=this,n=a.options;return t?(i=0===t.text?t.text:e.isNull(t.text)?"":t.text,""===i&&(i=0===t.value?0:e.isNull(t.value)?"":t.value),n.value=0===t.value||t.value?0===t.text||t.text?t:{value:t.value,text:t.value,data:t.data}:{value:t.text,text:t.text,data:t.data},i):""},_getValue:function(){var t=this,i=null,a=t.options,n=this.formElement.val();return a.value&&(i=a.value.data),(!a.value||a.value&&n!==a.value.text)&&(a.value={text:n,value:n,data:i}),e.objClone(a.value)},_createSweetWidget:function(){if(!this.renderEl){var i=this,a=i.formEl=e("<div>"),n=i.options;a.width(n.width).height(n.height).attr("id",n.id).addClass(t).addClass(n.widgetClass),i._beforeCreateFormWidget(),i._createFormWidget(),i._afterCreateFormWidget(),i.disabled=!1,i.setDisabled(n.disabled)}},_beforeCreateFormWidget:e.noop,_createFormWidget:e.noop,_afterCreateFormWidget:e.noop,_setDisabled:e.noop,_render:function(e){var t=this;return t._super(e)?(t.formEl.appendTo(t.renderEl),t.rendered=!0,t._afterRenderFormWidget(),!0):!1},_afterRenderFormWidget:e.noop,_destroyWidget:function(){this.renderEl&&(this.renderEl.find("*").unbind(),this.renderEl.empty())}})}(jQuery),function(e){var t="sweet-form-content";e.widget("sweet.widgetFormInput",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-input]",defaultElement:"<input>",type:"text",eventNames:{change:"改变值事件",focus:"获得焦点事件"},defaultPaddingDivClass:"sweet-form-input",defaultPaddingDivDisabledClass:"sweet-form-input-disabled",defaultInputClass:"sweet-form-input-text",defaultInputPaddingClass:"sweet-form-input-text-padding",defaultInputEmptyDivClass:"sweet-form-input-emptyDiv",defaultInputEmptyDivDisabledClass:"sweet-form-empty-disabled",options:{emptyText:null,height:25,editable:!0,label:!1,labelText:null,labelWidth:.3,required:!1,errorModel:Sweet.constants.tipAttr.MODEL_SIDE,tooltip:"",minLength:0,maxLength:Number.MAX_VALUE,symbol:!0,blank:!0,validateFun:function(){return{success:!0}}},setLabelText:function(e){var t=this,i=t.options;i.symbol&&(e+=Sweet.constants.symbol.COLON),i.required?t.label.children("label")[0].lastChild.textContent=e:t.label.text(e)},getLabelText:function(){var e=this;return e.options.required?e.label.children("label")[0].lastChild.textContent:e.label.text()},validate:function(){var e=this;return e.check()},check:function(){var e=this,t=e.options,i=t.validateFun,a=i.eventName||"blur";if(!e.getDisabled())return e._checkFun()?"object"!=typeof i||"blur"!==a?(e.tipType=null,e._showNormalTip(),!0):e._checkOuterFun():!1},showTip:function(e){var t=this,i=t.formElement,a=this.options,n=t.tipTitle,o=t.tipType,r=a.errorModel;o||(o=t.tipType=Sweet.constants.tipAttr.TYPE_NORMAL),e&&(o=Sweet.constants.tipAttr.TYPE_ERROR,n=Sweet.core.i18n.tip.EMPTY_TITLE),o&&n&&(t.oldTipTitle&&t.oldTipTitle===n||(t.oldTipTitle&&t.oldTipTitle!==n&&(i.sweettip(),i.sweettip("destroy")),i.sweettip(),i.attr({tiptype:o,errormodel:r,title:n}),t.oldTipTitle=n,"error"===o&&"none"===r&&i.sweettip("showErrorBorder"),"error"===o&&"side"===r&&i.sweettip("open")))},closeTip:function(){if(this.formElement){var e=this;e.formElement.attr("title",""),e.formElement.sweettip(),e.formElement.sweettip("destroy"),e.oldTipTitle=null}},setEditable:function(e){this.disabled||(this.formElement.removeAttr("readonly").removeAttr("disabled"),this.formElement.attr("readOnly",!e),this.editable=e,this._setEditable(e))},_addListener:function(){var t=this;e.each(t.handlers,function(i,a){"change"===i?e(t.formElement).blur(function(e){if(t.oldValue!==t.formElement.val()&&a){var i=t.getValue();a.call(this,e,i)}}):"focus"===i&&e(t.formElement).focus(function(e){a.call(this,e,t.getValue())})})},_removeListener:function(t){var i=this;i.handlers=i.handlers||{},t&&""!==t?e.each(i.handlers,function(e){t===e&&i.formElement.unbind(e)}):i.formElement&&i.formElement.unbind()},_setValue:function(t,i){var a,n=this;e.isEmptyObject(t)&&(t={value:""}),a=n._textCmpSetValue(t),n.formElement.val(a),n.closeTip(),(!0===i||"true"===i)&&n.check()},setValue:function(t,i){var a,n,o=this;e.isEmptyObject(t)&&(t={value:""}),a=e.date.getMilliseconds(),o.options.value=e.objClone(t),o._setValue(t,i),n=e.date.getMilliseconds(),o._info("Set value. Time-consuming = "+(n-a)+"ms")},_createFormWidget:function(){var t=this,i=this.options;t._createLabel(),t._createInputContainer(),t._createInputField(),t._check(),t._focus(),i.tooltip&&(t.tipTitle=i.tooltip,t.showTip()),e.isEmptyObject(i.value)||t._setValue(i.value),t.setEditable(i.editable),t._setEmptyText()},_createInputContainer:function(){"use strict";this.formDiv1El=e("<div>"),this.formDiv1El.addClass(t).appendTo(this.formEl)},_createLabel:function(){if(this.options.label){var t=this,i=t.options,a="sweet-form-label",n=t.label=e("<label>").addClass(a),o="";if(!e.isNull(i.labelText)){o+=e.htmlEscape(i.labelText),i.symbol&&(o+=Sweet.constants.symbol.COLON);var r='<label><font class="sweet-form-label-required" color="red"';i.required?o=r+">&nbsp;*&nbsp;</font>"+o:i.blank&&(o=r+' style="visibility:hidden">&nbsp;*&nbsp;</font>'+o),n.html(o).appendTo(t.formEl)}}},_doLayout:function(){"use strict";var t=this.formEl.width()-e.getPaddingRight(this.formEl)-e.getPaddingLeft(this.formEl),i=this.labelWidth=this._doLabelLayout(t);this.formDiv1El&&this.formDiv1El.css("left",i)},_doLabelLayout:function(e){var t,i=this,a=i.options;return t=i.label?1>a.labelWidth?Math.floor(e*a.labelWidth):a.labelWidth:0},_setDisabled:function(t){var i=this,a=i.defaultInputEmptyDivClass,n=i.defaultInputEmptyDivDisabledClass,o=i.defaultPaddingDivClass,r=i.defaultPaddingDivDisabledClass;if(i.emptyDiv&&e.isVisiable(i.emptyDiv))if(t){if(!i.emptyDiv.hasClass(a))return;i.emptyDiv.removeClass(a).addClass(n)}else{if(!i.emptyDiv.hasClass(n))return;i.emptyDiv.removeClass(n).addClass(a)}t?(i.formElement.attr("disabled",!0),i.formDiv2El.removeClass(o).addClass(r)):(i.formElement.attr("disabled",!1),i.formDiv2El.removeClass(r).addClass(o)),i.__setDisabled(t)},__setDisabled:e.noop,_focus:function(){var e=this;e.formElement.focus(function(){e.oldValue=e.formElement.val()})},_check:function(){var e=this;e.formElement.blur({me:e},e._onBlur)},_onBlur:function(e){function t(){i.validate()}var i=e.data.me;"[widget-form-date]"===i.sweetWidgetName&&i._setRightTimeValue(i),i.getDisabled()||(i.delayCheckTimerInput=setTimeout(t,500))},_checkFun:function(e){var t=this;return e=!1,!1===t._checkAllFun(e)?!1:(e||t.closeTip(),!0)},_checkAllFun:function(e){if(this.formElement){var t=this,i=t.options,a=t.formElement.val(),n=a.length;return i.required&&!a?(e||(t._error("Can not be empty!"),t.showTip(!0)),!1):n>i.maxLength||i.minLength>n?(e||(t.tipType=Sweet.constants.tipAttr.TYPE_ERROR,t.tipTitle=Sweet.core.i18n.tip.LENGTH_RANGE_1+i.minLength+Sweet.core.i18n.tip.LENGTH_RANGE_2+i.maxLength+Sweet.core.i18n.tip.LENGTH_RANGE_3,t.showTip()),!1):undefined}},setEmptyText:function(t){var i=this,a=i.formElement;a&&(e.isNull(t)?(i.options.emptyText=null,a.removeAttr("placeholder")):(i.options.emptyText=t,a.attr("placeholder",t)))},_setEmptyText:function(e){var t=this,i=t.options.emptyText,a=t.formElement;a&&t.options.emptyText&&(e?a.removeAttr("placeholder"):i&&a.attr("placeholder",i))},_afterCreateSweetWidget:function(){var e,t=this,i=t.options,a=i.validateFun;"object"==typeof a&&(e=a.eventName||"blur",("keypress"===e||"keyup"===e||"keydown"===e||"blur"===e||"focus"===e)&&t.formElement.bind(e,{me:t},t._filterCharacter))},_filterCharacter:function(e){function t(){return r&&!r.success?(i.tipType=Sweet.constants.tipAttr.TYPE_ERROR,i.tipTitle=r.message,i.showTip(),!1):(i.closeTip(),!0)}var i=e.data.me,a=i.options,n=a.validateFun,o=e.type;if("blur"!==o){var r=n.fun.call(this,e,i.getValue(),n.params);setTimeout(t,800)}},_checkOuterFun:function(){var e=this,t=e.options,i=t.validateFun,a=i.fun.call(this,null,e.getValue(),i.params);return a&&!a.success?(e.tipType=Sweet.constants.tipAttr.TYPE_ERROR,e.tipTitle=a.message,e.showTip(),!1):(e.closeTip(),e.tipType=null,e._showNormalTip(),!0)},_showNormalTip:function(){var e=this,t=e.options;e.showTipTimerInput=setTimeout(function(){t.tooltip&&!e.tiptype&&(e.tipTitle=t.tooltip,e.showTip())},600)},_destroyWidget:function(){var e=this;e._super(),e.delayCheckTimerInput&&clearTimeout(e.delayCheckTimerInput),e.showTipTimerInput&&clearTimeout(e.showTipTimerInput)},_createInputField:e.noop,_setEditable:e.noop})}(jQuery),function(e){var t="sweet-form-label",i=Sweet.constants.align,a={};a[i.CENTER]="sweet-form-label-center",a[i.RIGHT]="sweet-form-label-right",e.widget("sweet.widgetFormLabel",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-label]",defaultElement:"<label>",options:{align:i.LEFT,symbol:!1,value:{text:"",value:"",data:null},height:25,tip:!1,required:!1,blank:!1},_setValue:function(t){if(!e.isNull(t)){var i=this,a=i.options,n=a.value,o=e.isNull(n.text)?"":n.text;i._setText(o)}},_createFormWidget:function(){var e=this;e._createLabel()},_createLabel:function(){var i=this,n=i.options,o=a[n.align]||"",r=i.formParentEl=e("<div class='"+t+" "+o+"'"+">").appendTo(i.formEl);i.formElement=e("<label>").appendTo(r),e.isNotNull(n.vID)&&i.formElement.attr("id",n.vID),i._addBeforeLabel(),i._createLabelText(),i._addAfterLabel()},_createLabelText:function(){var t=this,i=t.options,a=i.value,n=e.isNotNull(a)&&e.isNotNull(a.text)?a.text:"";t._setText=t._config(),t._setText(n)},_config:function(){var t=this,i=t.options,a=i.blank?'<font class="sweet-form-label-required"\n         color="red" style="visibility:hidden">&nbsp;*&nbsp;</font>':"",n=i.symbol?Sweet.constants.symbol.COLON:"";return a=i.required&&!i.blank?'<font class="sweet-form-label-required"\n         color="red">&nbsp;*&nbsp;</font>':a,function(o){var r=o;o=a+e.htmlEscape(r)+n,t.formElement.html(o).val(r).attr("title",i.tip?e.nullToString(r):"")}},_doLayout:function(){this.rendered&&this._super()},_destroyWidget:function(){var e=this;e.formElement.trigger("mouseout"),e._super()},_setText:e.noop,_addBeforeLabel:e.noop,_addAfterLabel:e.noop}),Sweet.form.Label=e.sweet.widgetFormLabel}(jQuery),function(e){var t="sweet-form-password";e.widget("sweet.widgetFormPassword",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-password]",type:"text",replacement:"%u25CF",options:{duration:0},_doLayout:function(){this._super()},_createInputField:function(){var i=this,a=i.options,n=i.formElement=e("<input>"),o=i.formDiv1El,r=i.formDiv2El=e("<div>").addClass(i.defaultPaddingDivClass).addClass(t).appendTo(o),l=e.nullToString(a.value.value),s=0===i.options.duration?"password":"text";n.attr("type",s).addClass(i.defaultInputClass).val(l),n.appendTo(r),i.value=[]},_afterCreateFormWidget:function(){var e=this;e.__afterCreateFormWidget()},__afterCreateFormWidget:function(){var e=this;e.options.duration>0&&e.formElement.keyup({me:e},e._onKeyDown),e.formElement.bind("paste",{me:e,obj:e.formElement},e._onPaste)},_onKeyDown:function(t){var i=t.data.me,a=i.options,n=i.formElement.val(),o=n.length,r=i.value.length,l=e.cursor.getSelection(i.formElement[0]),s=n[l.start-1]||"",d=t.charCode||t.keyCode,c=l.start,h=0;if(46===d||8===d)return r-o>=1&&(h=r-o),i.value[c]&&(i.value.splice(c,h),i.value.length=r-h),undefined;if(s&&s!==unescape(i.replacement)){r+1>o&&(h=r-o+1),i.value.splice(l.start-1,h,s),i.value.length=r-h+1,o>=2&&unescape(i.replacement)!==n[o-2]&&(clearTimeout(i.timer),i._convertLastChar(i,l.start-1,s,!1));var u=function(){i._convertLastChar(i,l.start-1,s,!0)};return i.timer=setTimeout(u,a.duration),undefined}},_onPaste:function(e){e.preventDefault()},_convertLastChar:function(e,t,i,a){if(""!==e.formElement.val()){var n="",o=e.formElement.val().length;if(1===o)return e.formElement.val(unescape(e.replacement)),undefined;for(var r=0;o-1>r;r++)n+=unescape(e.replacement);i=a?unescape(e.replacement):i,n=n.slice(0,t)+i+n.slice(t),e.formElement.val(n)}},_getValue:function(){var t=this,i=t.options,a="";if(0===i.duration)return a=t.formElement.val(),{text:a,value:a};for(var n=0;t.value.length>n;n++)a+=t.value[n];return i.value&&a===i.value.text||(i.value={text:a,value:a}),e.objClone(i.value)},_setValue:function(t){var i,a=this,n=a.options,o="";if(i=a._textCmpSetValue(t),0===n.duration)return a.formElement.val(i),undefined;if(e.isNull(i))return a.formElement.val(o),n.value={value:"",text:""},undefined;a.value=[];for(var r=0;i.length>r;r++)a.value[r]=i[r],o+=unescape(a.replacement);a.formElement.val(o)}}),Sweet.form.Password=e.sweet.widgetFormPassword}(jQuery),function(e){var t="sweet-form-textfield",i="sweet-tips-inputParent",a="sweet-tips-input";e.widget("sweet.widgetFormTextfield",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-textfield]",type:"text",options:{IPVersion:null,tip:!1},_doLayout:function(){this._super()},_createInputField:function(){var n=this,o=n.options,r=n.formElement=e("<input>"),l=n.formDiv1El,s=n.formDiv2El=e("<div>");if(e.nullToString(o.value),s.addClass(n.defaultPaddingDivClass).addClass(t).appendTo(l),r.attr("type",n.type).addClass(n.defaultInputClass),e.isNotNull(o.vID)&&r.attr("id",o.vID),r.appendTo(s),o.maxLength<Number.MAX_VALUE&&r.attr("maxLength",o.maxLength),o.tip){var d=n.formElement,c=n.formDiv2El;d.mouseover(function(){if(e.isNull(o.tooltip)&&!o.disabled){if(c&&c.hasClass(i)||d.hasClass(a))return;var t="";t=d.val(),e.isNull(t)&&(t=""),d.attr("title",t),n.tipTitle=t,n.showTip()}})}},_checkAllFun:function(e){var t=!0,i=this,a=i.options,n=i.formElement.val();return i._super(e)===!1?t=!1:a.IPVersion===Sweet.constants.ipType.VERSION4?i._isIPv4Fun(n)||(i._checkHandler(e),t=!1):a.IPVersion===Sweet.constants.ipType.VERSION6?i._isIPv6Fun(n)||(i._checkHandler(e),t=!1):a.IPVersion===Sweet.constants.ipType.VERSION&&(i._isIPv6Fun(n)||i._isIPv4Fun(n)||(i._checkHandler(e),t=!1)),t},_isIPv6Fun:function(e){var t=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|[0-1]?\d\d?)(\.(25[0-5]|2[0-4]\d|[0-1]?\d\d?)){3}))|:)))(%.+)?\s*$/;return t.test(e)},_isIPv4Fun:function(e){var t=/^\s*((25[0-5]|2[0-4]\d|[0-1]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[0-1]?\d\d?)\s*$/;return t.test(e)},_checkHandler:function(e){var t=this;e||(t.tipType=Sweet.constants.tipAttr.TYPE_ERROR,t.tipTitle=Sweet.core.i18n.tip.IP_TIP_TITLE,t.showTip())}}),Sweet.form.TextField=e.sweet.widgetFormTextfield}(jQuery),function(e){"use strict";function t(e){return RegExp("^(?:"+e.join("|")+")$","i")}var i=t(["abs","acos","adddate","aes_encrypt","aes_decrypt","ascii","asin","atan","atan2","avg","benchmark","bin","bit_and","bit_count","bit_length","bit_or","cast","ceil","ceiling","char_length","character_length","coalesce","concat","concat_ws","connection_id","conv","convert","cos","cot","count","curdate","current_date","current_time","current_timestamp","current_user","curtime","database","date_add","date_format","date_sub","dayname","dayofmonth","dayofweek","dayofyear","decode","degrees","des_encrypt","des_decrypt","elt","encode","encrypt","exp","export_set","extract","field","find_in_set","floor","format","found_rows","from_days","from_unixtime","get_lock","greatest","group_unique_users","hex","ifnull","inet_aton","inet_ntoa","instr","interval","is_free_lock","isnull","last_insert_id","lcase","least","left","length","ln","load_file","locate","log","log2","log10","lower","lpad","ltrim","make_set","master_pos_wait","max","md5","mid","min","mod","monthname","now","nullif","oct","octet_length","ord","password","period_add","period_diff","pi","position","pow","power","quarter","quote","radians","rand","release_lock","repeat","reverse","right","round","rpad","rtrim","sec_to_time","session_user","sha","sha1","sign","sin","soundex","space","sqrt","std","stddev","strcmp","subdate","substring","substring_index","sum","sysdate","system_user","tan","time_format","time_to_sec","to_days","trim","ucase","unique_users","unix_timestamp","upper","user","version","week","weekday","yearweek"]),a=t(["alter","grant","revoke","primary","key","table","start","top","transaction","select","update","insert","delete","create","describe","from","into","values","where","join","inner","left","natural","and","or","in","not","xor","like","using","on","order","group","by","asc","desc","limit","offset","union","all","as","distinct","set","commit","rollback","replace","view","database","separator","if","exists","null","truncate","status","show","lock","unique","having","drop","procedure","begin","end","delimiter","call","else","leave","declare","temporary","then"]),n=t(["bigint","binary","bit","blob","bool","char","character","date","datetime","dec","decimal","double","enum","float","float4","float8","int","int1","int2","int3","int4","int8","integer","long","longblob","longtext","mediumblob","mediumint","mediumtext","middleint","nchar","numeric","real","set","smallint","text","time","timestamp","tinyblob","tinyint","tinytext","varbinary","varchar","year"]),o=t([":=","<","<=","==","<>",">",">=","like","rlike","in","xor","between"]);e.widget("sweet.widgetFormSyntax",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-syntax]",type:"syntax",options:{},_doLayout:function(){var e=this;e.rendered&&e._super()},_createFormWidget:function(){var t=this,i=t.options,a="sweet-form-syntax",n=t.formElement=e("<textarea>").appendTo(t.formEl),o=e.nullToString(i.value);n.css("position","absolute").css("left","-10000px"),t.formEl.addClass(a),t.syntaxEl=e("<div>").appendTo(t.formEl),t.setValue(o)},setValue:function(e){this.value=e,this.formElement.val(e);var t=this.parseSql(e),i=this.buildDom(t);this.syntaxEl.empty().append(i.children())},__setDisabled:e.noop,_check:e.noop,parseSql:function(t){function r(e){return"\n"===e||"\r"===e?!0:!1}function l(){return y>x-1&&x-1>=0?t[x-1]:null}function s(){return y>x?t[x]:null}function d(){return y>x+1?t[x+1]:null}function c(){return y>x?t[x++]:null}function h(e){for(var t=null,i=[];null!==(t=s())&&e.test(t);)i.push(c());return i.join("")}function u(e,t){for(var i=null,a=[];;){if(null===s()){E.err="Absent of end flag";break}if(t===!0&&r(i)&&(E.err="Token should be in a single line"),r(i)&&T++,i=c(),a.push(i),e.test(i))break}return a.join("")}function p(){for(var e=[],t=s();" "===t||"	"===t;)e.push(c()),t=s();return e.join("")}function f(){for(var e=[];!r(s())&&null!==s();)e.push(c());return e.join("")}function g(){var e=c(),t="",i=[];for(i.push(e);;){if(null===s()){E.err="Literal is not closed";break}if(t=c(),i.push(t),t===e&&"\\"!==l())break;r(t)&&(T++,E.err="Unexpected return in literal")}return i.join("")}function m(){for(var e="",t=[];;){if(null===s()){E.err="Block comment is not closed";break}if(e=c(),t.push(e),"*"===e&&"/"===s()){t.push(c());break}r(e)&&T++}return t.join("")}function v(){if(x>=y)return b;E=e.extend({},k),E.index=S++,E.pos=x;var t=s();return r(t)?(E.type="sql-enter",E.content=c()):" "===t||"	"===t?(E.type="sql-blank",E.content=p()):"@"===t||"$"===t?(E.type="sql-ver",E.content=c()+h(/[\w\d]/)):"#"===t?(E.type="sql-comment",E.content=f()):","===t||";"===t||"."===t?(E.type="sql-separator",E.content=c()):'"'===t||"'"===t||"`"===t?(E.type="sql-literal",E.content=g()):"["===t||"{"===t?(E.type="sql-word",E.content=u(/[\]\}]/)):/\d/.test(t)?(E.type="sql-number",E.content=h(/\d/),"."===s()&&(E.content+=c(),E.content+=h(/\d/))):"-"===t?"-"===d()?(E.type="sql-comment",E.content=f()):/\d/.test(d())?(E.type="sql-number",E.content=c(),E.content+=h(/\d/),"."===s()&&(E.content+=c(),E.content+=h(/\d/))):(E.type="sql-operator",E.content=c()):w.test(t)?"/"===t&&"*"===d()?(E.type="sql-comment",E.content=m()):(E.type="sql-operator",E.content=h(w)):/[()]/.test(t)?(E.type="sql-punctuation",E.content=c()):(E.content=h(/[_\w\d\u4E00-\u9FA5\uf900-\ufa2d]/),E.type=o.test(E.content)?"sql-operator":a.test(E.content)?"sql-keyword":i.test(E.content)?"sql-function":n.test(E.content)?"sql-type":"sql-word"),"sql-enter"===E.type?(T+=1,D=0):D+=E.content.length,""!==E.err?C:_}for(var w=/[*+\-<>=&|:\/]/,_=1,C=-1,b=0,E=null,y=t.length,x=0,T=0,D=0,S=0,k={index:0,pos:x,row:T,col:D,type:"",content:"",err:""},L=0,N=[];v()!==b;)if(N.push(E),L++>1e4){e.log("too many tokens");for(var I=N.length-10;N.length>I;I++)e.log(N[I]);break}return N},buildDom:function(t){for(var i=null,a=e("<div></div>"),n=null,o=[],r=null,l="",s=0;t.length>s;s++)if(i=t[s],null===r&&(r=e("<pre></pre>")),"sql-enter"===i.type)a.append(r),r=null;else{o=i.content.split("\n");for(var d=0;o.length>d;d++)l=o[d],l=l.replace(/\t/gi,"  "),n=e("<span></span>"),n.addClass(i.type),""!==i.err&&(n.addClass("sql-error"),n.attr("title",i.err)),n.text(l),r.append(n),o.length-1>d&&(a.append(r),r=e("<pre></pre>"))}return null!==r&&a.append(r),a}}),Sweet.form.Syntax=e.sweet.widgetFormSyntax}(jQuery),function(e){var t="sweet-form-input-method-disabled",i="sweet-form-numberfield";e.widget("sweet.widgetFormNumberfield",e.sweet.widgetFormTextfield,{version:"1.0",sweetWidgetName:"[widget-form-numberfield]",type:"text",baseChars:"0123456789",options:{allowDecimals:!1,decimalSeparator:".",decimalPrecision:2,allowNegative:!0,maxValue:Number.POSITIVE_INFINITY,minValue:Number.NEGATIVE_INFINITY},hide:function(){this.renderEl.hide(),this.formElement.trigger("mouseout")},_setValue:function(t){if(!e.isNull(t)){var i,a=this;i=a._textCmpSetValue(t),a.decimalHasExsited=-1!==(i+"").indexOf(a.options.decimalSeparator)?!0:!1,a._checkRange(a,i)?a.formElement.val(e.number.fixPrecision(i,a.options.decimalPrecision)):a.formElement.val(""),a._checkAllFun(!1)}},_getValue:function(){var t=this,i=t.options,a=t.formElement.val();return i.value&&a===""+i.value.text?e.objClone(i.value):(i.value={text:a,value:a},e.objClone(i.value))},_beforeCreateFormWidget:function(){var e=this,t=e.options;e.allowdChars=e.baseChars,t.allowDecimals&&(e.allowdChars+=t.decimalSeparator)},_afterCreateFormWidget:function(){var e=this;e.formDiv2El.addClass(i),e.formElement.addClass(t),e.formElement.on("paste",function(){return!1}),e.__afterCreateFormWidget()},_check:function(){var e=this;e.formElement.keypress({me:e},e._onKeyPress).blur({me:e},e._onBlur),e.formElement.keydown({me:e},e._onKeyDown)},_onKeyPress:function(t){if(Sweet.constants.keyCode.BACKSPACE!==t.which&&Sweet.constants.keyCode.ENTER!==t.which&&0!==t.which){var i,a=t.data.me,n=a.options,o=a.allowdChars,r=String.fromCharCode(e.e.getCharCode(t)),l=a.formElement.val(),s=l.length,d=e.cursor.getSelection(a.formElement[0]);if(-1===l.indexOf(n.decimalSeparator)&&(a.decimalHasExsited=!1),(""===l||1===s&&"-"===l||0===d.start||1===d.start&&"-"===l.charAt(0)||s-d.start>n.decimalPrecision||a.decimalHasExsited)&&n.decimalSeparator===r)return t.preventDefault(),undefined;if(n.allowDecimals&&a.decimalHasExsited){var c=(""+l).indexOf(n.decimalSeparator);if(s-c>n.decimalPrecision&&d.start>c)return t.preventDefault(),undefined}if(""===l&&a.options.allowNegative&&(o+="-"),""!==l){var h=e(a.formElement)[0];!h.selectionStart&&n.allowNegative&&(o+="-")}return i=RegExp("["+o+"]"),i.test(r)?(n.decimalSeparator===r&&(a.decimalHasExsited=!0),undefined):(t.preventDefault(),undefined)}},_onKeyDown:function(e){var t=e.charCode||e.keyCode,i=Sweet.constants.keyCode,a=e.keyCode;i.BACKSPACE!==a&&i.ENTER!==a&&i.DELETE!==a&&i.LEFT!==a&&i.RIGHT!==a&&i.DOWN!==a&&i.UP!==a&&i.TAB!==a&&(t>47&&58>t||t>95&&106>t||190===t||110===t||189===t||109===t||173===t||e.preventDefault())},_onBlur:function(t){function i(){a.validate(),a.validate()&&a._checkRange(a)}var a=t.data.me,n=e.string.reviseNumber(a.formElement.val());a.formElement.val(n),setTimeout(i,500)},_checkRange:function(t,i){var a=t.options,n=t.formElement,o=i;return e.isNull(o)?(t._info("Can not be empty!"),!1):e.isNumeric(o)?(o=-1!==(""+o).indexOf(a.decimalSeparator)?parseFloat(o):parseInt(o,10),!0):(t._error("The input value is not a number!"),t.rendered&&n.focus(),!1)},_checkAllFun:function(e){if(this.formElement){var t=this,i=t.options,a=t.formElement.val();return a.length,t.closeTip(),t._super(e)===!1?!1:i.maxValue<parseFloat(a)?(t.tipType=Sweet.constants.tipAttr.TYPE_ERROR,t.tipTitle=Sweet.core.i18n.tip.NUMBERFEILD_MAX_TIP+i.maxValue,i.errorModel=Sweet.constants.tipAttr.MODEL_NORMAL,t.showTip(),!1):i.minValue>parseFloat(a)?(t.tipType=Sweet.constants.tipAttr.TYPE_ERROR,t.tipTitle=Sweet.core.i18n.tip.NUMBERFEILD_MIN_TIP+i.minValue,i.errorModel=Sweet.constants.tipAttr.MODEL_NORMAL,t.showTip(),!1):undefined}},setMaxValue:function(e){var t=this;t.options.maxValue=parseFloat(e),isNaN(t.options.maxValue)&&(t.options.maxValue=Number.POSITIVE_INFINITY),t._checkAllFun(!1)},setMinValue:function(e){var t=this;t.options.minValue=parseFloat(e),isNaN(t.options.minValue)&&(t.options.maxValue=Number.NEGATIVE_INFINITY),t._checkAllFun(!1)},__afterCreateFormWidget:e.noop}),Sweet.form.NumberField=e.sweet.widgetFormNumberfield}(jQuery),function(e){var t="sweet-form-ipfield";e.widget("sweet.widgetFormIpfield",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-ipfield]",type:"text",eventNames:{change:"改变值事件"},baseChars:/^((?:25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d))))$/,options:{tooltip:Sweet.core.i18n.tip.IP_TIP_TITLE},_doLayout:function(){this._super()},_addListener:function(){var t=this;t.options,e.each(t.handlers,function(i,a){"change"===i&&e(document).bind("click",function(){var e=t.inputElement1.val()+"."+t.inputElement2.val()+"."+t.inputElement3.val()+"."+t.inputElement4.val();t.oldValue!==e&&a&&a.call(this,t.getValue())})})},_createInputField:function(){var i=this,a=i.inputArr=[],n=(i.formElement=e("<input>"),i.formDiv1El),o=i.formDiv2El=e("<div>"),r=i.inputElement1=e("<input>").attr("type",i.type).keydown({me:i,inputIndex:0},i._onKeyDown),l=i.inputElement2=e("<input>").attr("type",i.type).keydown({me:i,inputIndex:1},i._onKeyDown),s=i.inputElement3=e("<input>").attr("type",i.type).keydown({me:i,inputIndex:2},i._onKeyDown),d=i.inputElement4=e("<input>").attr("type",i.type).keydown({me:i,inputIndex:3},i._onKeyDown);o.addClass(i.defaultPaddingDivClass).addClass(t).appendTo(n),r.appendTo(o),o.append("."),l.appendTo(o),o.append("."),s.appendTo(o),o.append("."),d.appendTo(o),a[0]=r,a[1]=l,a[2]=s,a[3]=d},_focus:function(){var e=this;e.inputElement1.focus(function(){var t=e.inputElement1.val()+"."+e.inputElement2.val()+"."+e.inputElement3.val()+"."+e.inputElement4.val();e.oldValue=t}),e.inputElement2.focus(function(){var t=e.inputElement1.val()+"."+e.inputElement2.val()+"."+e.inputElement3.val()+"."+e.inputElement4.val();e.oldValue=t}),e.inputElement3.focus(function(){var t=e.inputElement1.val()+"."+e.inputElement2.val()+"."+e.inputElement3.val()+"."+e.inputElement4.val();e.oldValue=t}),e.inputElement4.focus(function(){var t=e.inputElement1.val()+"."+e.inputElement2.val()+"."+e.inputElement3.val()+"."+e.inputElement4.val();e.oldValue=t})},showTip:function(){},closeTip:function(){},setEditable:function(e){this.inputElement1.attr("readOnly",!e),this.inputElement2.attr("readOnly",!e),this.inputElement3.attr("readOnly",!e),this.inputElement4.attr("readOnly",!e)},setDisabled:function(e){var t=this;if("boolean"!=typeof e)return t._error("setDisabled() Input parameter is not a Boolean type!"),undefined;if(t.inputElement1.attr("disabled",e),t.inputElement2.attr("disabled",e),t.inputElement3.attr("disabled",e),t.inputElement4.attr("disabled",e),t.options.disabled=e,e){if(!t.formDiv2El.hasClass(t.defaultPaddingDivClass))return;t.formDiv2El.removeClass(t.defaultPaddingDivClass).addClass(t.defaultPaddingDivDisabledClass)}else{if(!t.formDiv2El.hasClass(t.defaultPaddingDivDisabledClass))return;t.formDiv2El.removeClass(t.defaultPaddingDivDisabledClass).addClass(t.defaultPaddingDivClass)}},_setValue:function(t){var i=this,a=i.options,n=i._textCmpSetValue(t),o=n.split(".");return e.isNull(n)?(a.value={value:"",text:""},undefined):(4===o.length&&i._checkFormat(o[0])&&i._checkFormat(o[1])&&i._checkFormat(o[2])&&i._checkFormat(o[3])?(i.inputElement1.val(o[0]),i.inputElement2.val(o[1]),i.inputElement3.val(o[2]),i.inputElement4.val(o[3])):(this._error("Invalid IP address："+n+"."),i.inputElement1.val(""),i.inputElement2.val(""),i.inputElement3.val(""),i.inputElement4.val(""),a.value={value:"",text:""}),undefined)},_getValue:function(){var t=this,i=t.options,a="";return t.inputElement1.val()&&t._checkFormat(t.inputElement1.val())&&t.inputElement2.val()&&t._checkFormat(t.inputElement2.val())&&t.inputElement3.val()&&t._checkFormat(t.inputElement3.val())&&t.inputElement4.val()&&t._checkFormat(t.inputElement4.val())?(a=t.inputElement1.val()+"."+t.inputElement2.val()+"."+t.inputElement3.val()+"."+t.inputElement4.val(),i.value&&a===i.value.text||(i.value={text:a,value:a}),e.objClone(i.value)):(this._error("Invalid IP address："+a+"."),{value:"",text:""})},_beforeCreateFormWidget:function(){var e=this;e.allowdChars=e.baseChars},_afterCreateFormWidget:function(){var e=this;e.__afterCreateFormWidget()},_check:function(){},_onKeyDown:function(t){function i(){c>2||d.inputArr[h].focus()}function a(){return c>2?undefined:v.start===f.length?(d.inputArr[h].focus(),d.inputArr[h][0].selectionStart=0,undefined):undefined}function n(){return 1>c?undefined:0===v.end?(d.inputArr[u].focus(),d.inputArr[u][0].selectionStart=g.length,undefined):undefined}function o(){return c>2?undefined:d.inputArr[c].val()?undefined:(d.inputArr[h].val(""),d.inputArr[h].focus(),undefined)}function r(){return 1>c?undefined:d.inputArr[c].val()?undefined:(d.inputArr[u].val(""),d.inputArr[u].focus(),undefined)}function l(){return c>2?(t.preventDefault(),undefined):(t.preventDefault(),d.inputArr[h].focus(),undefined)}function s(t){return f||(f=0),f=e.number.isFloat(f)?parseFloat(f):parseInt(f,10),d._checkFormat(f+t)?(d.inputArr[c].val(f+t),undefined):256===f+t?(d.inputArr[c].val(0),undefined):-1===f+t?(d.inputArr[c].val(255),undefined):undefined
}var d=t.data.me,c=t.data.inputIndex,h=c+1,u=c-1,p=String.fromCharCode(e.e.getCharCode(t)),f=t.target.value,g=f+p,m=t.charCode||t.keyCode,v=e.cursor.getSelection(d.inputArr[c][0]);if(m>=48&&57>=m||m>=96&&105>=m)return m>=96&&105>=m&&(p=m-96,g=f+p),d._checkFormat(g)?(3===g.length&&3>c&&setTimeout(function(){d.inputArr[h].focus()},200),undefined):(t.preventDefault(),3>c&&setTimeout(function(){d.inputArr[h].focus()},200),undefined);if(13===m)i();else if(39===m)a();else if(37===m)n();else if(8===m)r();else if(46===m)o();else if(110===m||190===m)l();else if(38===m)s(1);else if(40===m)s(-1);else{if(8!==m)return t.preventDefault(),undefined;t.preventDefault()}},_checkFormat:function(e){var t=this,i=RegExp(t.allowdChars);return i.test(e)?(t.closeTip(),!0):(t.showTip(),!1)},__afterCreateFormWidget:function(){var e=this;e.inputElement1.bind("paste",{me:e,obj:e.inputElement1},e._onPaste),e.inputElement2.bind("paste",{me:e,obj:e.inputElement2},e._onPaste),e.inputElement3.bind("paste",{me:e,obj:e.inputElement3},e._onPaste),e.inputElement4.bind("paste",{me:e,obj:e.inputElement4},e._onPaste)},_onPaste:function(t){function i(){var t=n.val();e.isNull(t)||a._checkFormat(t)||(a._error("Invalid IP address："+t+"."),n.val(o))}var a=t.data.me,n=t.data.obj,o=n.val();setTimeout(i,10)}}),Sweet.form.IPField=e.sweet.widgetFormIpfield}(jQuery),function(e){var t="sweet-form-input-method-disabled",i="sweet-form-hexfield",a="0x";e.widget("sweet.widgetFormHexfield",e.sweet.widgetFormTextfield,{version:"1.0",sweetWidgetName:"[widget-form-hexfield]",type:"text",baseChars:/[^0123456789ABCDEFabcdef]/,options:{},_doLayout:function(){this._super()},_setValue:function(t){var i=this,n=i.options,o=RegExp(i.allowdChars),r=i._textCmpSetValue(t);return e.isNull(t)?(this.options.value={value:"",text:""},i.formElement.val(""),undefined):a!==r.slice(0,2)?(i._error("Invalid hexadecimal number:"+r+"."),n.value={value:"",text:""},undefined):(r=r.slice(2),i._checkFormat(r,o)?i.formElement.val(r):(i._error("Invalid hexadecimal number: "+r+"."),i.formElement.val(""),n.value={value:"",text:""}),undefined)},_getValue:function(){var e=this,t=e.options,i=RegExp(e.allowdChars),n=this.formElement.val();return n&&e._checkFormat(n,i)?(n=a+n,t.value&&n===t.value.text||(t.value={text:n,value:n}),t.value):(e._error("Invalid hexadecimal number: "+n+"."),{value:"",text:""})},_beforeCreateFormWidget:function(){var e=this;e.allowdChars=e.baseChars},_afterCreateFormWidget:function(){var e=this;e.formElement.addClass(t),e.formElement.on("paste",function(){return!1}),e.__afterCreateFormWidget()},_check:function(){var e=this;e._super(),e.formElement.keypress({me:e},e._onKeyPress)},_onKeyPress:function(t){var i=Sweet.constants.keyCode,a=t.keyCode,n=t.data.me,o=RegExp(n.allowdChars),r=String.fromCharCode(e.e.getCharCode(t));if(i.BACKSPACE!==a&&i.ENTER!==a&&i.DELETE!==a&&i.LEFT!==a&&i.RIGHT!==a&&i.DOWN!==a&&i.UP!==a&&i.TAB!==a)return n._checkFormat(r,o)?undefined:(t.preventDefault(),undefined)},_checkFormat:function(e,t){var i=this;return t.test(e)?(i.showTip(),!1):(i.closeTip(),!0)},__afterCreateFormWidget:function(){var e=this;e.formDiv2El.prepend(a).addClass(i)}}),Sweet.form.HEXField=e.sweet.widgetFormHexfield}(jQuery),function(e){var t="sweet-form-spinner-changeValue",i="sweet-form-spinner-changeValSpan",a="sweet-form-spinner-changeValTop",n="sweet-form-spinner-changeValDown",o="sweet-form-spinner-changeValue-disabled",r="sweet-form-spinner-changeValTop-disabled",l="sweet-form-spinner-changeValDown-disabled",s="sweet-form-spinner",d="javascript:void(0);",c=[1,2];e.widget("sweet.widgetFormSpinner",e.sweet.widgetFormNumberfield,{version:"1.0",sweetWidgetName:"[widget-form-spinner]",type:"text",eventNames:{change:"改变值事件"},options:{step:1,start:0},_doLayout:function(){this._super()},__afterCreateFormWidget:function(){var o=this,r=o.spanEl=e("<span>").addClass(t).insertBefore(o.formElement);o.upEl=e("<span>").attr("href",d).addClass(a+" "+i).appendTo(r),o.downEl=e("<span>").attr("href",d).addClass(n+" "+i).appendTo(r),o.formDiv2El.addClass(s),o._setRange()},_onFilp:function(t){var i,a=t.data.me,n=a.options,o=t.data.type,r=t.data.obj,l=r.val();n.disabled||a.editable&&(a.oldValue1=r.val(),l=e.number.isFloat(l)?parseFloat(l):parseInt(l,10),c[0]===o?(i=l+n.step,e.isNotNull(n.maxValue)?n.maxValue>=i&&(r.val(i),a._triggerHandler(t,"change",a.getValue())):(r.val(i),a._triggerHandler(t,"change",a.getValue())),a._setRange()):c[1]===o?(i=l-n.step,e.isNotNull(n.minValue)?i>=n.minValue&&(r.val(i),a._triggerHandler(t,"change",a.getValue())):(r.val(i),a._triggerHandler(t,"change",a.getValue())),a._setRange()):a._error("_onFilp(): Unsupported type. Type equals 1 or 2. type="+o),t.stopImmediatePropagation())},_setRange:function(){var t,i=this,o=i.options,s=i.formElement,d=o.maxValue,c=o.minValue;t=i.formElement.val(),t=e.number.isFloat(t)?parseFloat(t):parseInt(t,10),o.disabled||(e.isNotNull(d)&&e.isNull(c)?t===d||t+o.step>d?(i.upEl.removeClass(a).addClass(r),i.downEl.removeClass(l).addClass(n),i.upEl.unbind("click"),i.downEl.bind("click",{me:i,type:2,obj:s},i._onFilp)):(i.upEl.removeClass(r).addClass(a),i.upEl.bind("click",{me:i,type:1,obj:s},i._onFilp),i.downEl.removeClass(l).addClass(n),i.downEl.bind("click",{me:i,type:2,obj:s},i._onFilp)):e.isNull(d)&&e.isNotNull(c)?t===c||c>t-o.step?(i.downEl.removeClass(n).addClass(l),i.upEl.removeClass(r).addClass(a),i.downEl.unbind("click"),i.upEl.bind("click",{me:i,type:1,obj:s},i._onFilp)):(i.downEl.removeClass(l).addClass(n),i.upEl.removeClass(r).addClass(a),i.upEl.bind("click",{me:i,type:1,obj:s},i._onFilp),i.downEl.bind("click",{me:i,type:2,obj:s},i._onFilp)):e.isNotNull(d)&&e.isNotNull(c)?t===d||t+o.step>d?(i.upEl.removeClass(a).addClass(r),i.downEl.removeClass(l).addClass(n),i.upEl.unbind("click"),i.downEl.bind("click",{me:i,type:2,obj:s},i._onFilp)):t===c||c>t-o.step?(i.downEl.removeClass(n).addClass(l),i.upEl.removeClass(r).addClass(a),i.downEl.unbind("click"),i.upEl.bind("click",{me:i,type:1,obj:s},i._onFilp)):(i.upEl.removeClass(r).addClass(a),i.downEl.removeClass(l).addClass(n),i.upEl.bind("click",{me:i,type:1,obj:s},i._onFilp),i.downEl.bind("click",{me:i,type:2,obj:s},i._onFilp)):(i.upEl.bind("click",{me:i,type:1,obj:i.formElement},i._onFilp),i.downEl.bind("click",{me:i,type:2,obj:i.formElement},i._onFilp)))},__setDisabled:function(e){var i=this;e?(i.spanEl.removeClass(t).addClass(o),i.upEl.removeClass(a).addClass(r),i.downEl.removeClass(n).addClass(l)):(i.spanEl.removeClass(o).addClass(t),i.upEl.removeClass(r).addClass(a),i.downEl.removeClass(l).addClass(n)),i.spanEl.attr("disabled",e),i.upEl.attr("disabled",e),i.downEl.attr("disabled",e)}}),Sweet.form.Spinner=e.sweet.widgetFormSpinner}(jQuery),function(e,t){var i="sweet-form-date-float-panel-spinner-month",a="sweet-form-date-float-panel-spinner-year",n="sweet-form-date-float-south-panel",o="sweet-form-date-float-panel-up",r="sweet-form-date-float-panel-down",l="sweet-form-date-float-panel-up-gray",s="sweet-form-date-float-panel-down-gray",d="current",c="invalid",h="currentMonthInvalid",u="rest",p="sweet-form-date-text",f="sweet-form-date-pic-field",g="sweet-form-date-pic-field-gray",m="sweet-form-date-input-field-gray",v="sweet-form-date-input-field",w="sweet-form-date-input-pic-disabled",_=-1*((new Date).getTimezoneOffset()/60),C=[1,2,3],b=[1,2],E=[1,2,3],y=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],x=[0,5,10,15,20,25,30,35,40,45,50,55],T=[0,10,20,30,40,50],D=[1,2],S=42,k=[1,2,3];e.widget("sweet.widgetFormDate",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-date]",type:"text",baseChars:"0123456789:-",months:e.objClone(Sweet.constants.MONTHS),eventNames:{change:"改变值事件",click:"图片点击事件"},options:{format:"yyyy-MM-dd hh:mm:ss",editable:!0,timeZone:"",maxDate:"",minDate:"",showDays:!1,beforePopDatePanel:e.noop},setTimeZone:function(t){var i=this;e.isNotNull(t)&&e.isNumber(t)?(i.options.timeZone=t,i._isTimeZoneNull=null):(i.options.timeZone=-1*((new Date).getTimezoneOffset()/60),i._isTimeZoneNull=!0)},setDisableTimePart:function(t){var i=this;e.isNotNull(t)&&"yyyy-MM-dd hh:mm"===i.options.format&&i._setTimeElStyle(i,t)},setFiledType:function(t){var i=this;i.options;var a=i.formElement.val();e.isNull(t)||("HMS"===t&&(i.options.format="yyyy-MM-dd"),"MS"===t&&(i.options.format="yyyy-MM-dd hh"),"S"===t&&(i.options.format="yyyy-MM-dd hh:mm")),e.isNotNull(a)&&("yyyy-MM-dd hh"===i.options.format?i.formElement.val(e.date.format(new Date(a.replace(/-/g,"/")),i.options.format)+":00"):i.formElement.val(e.date.format(new Date(a.replace(/-/g,"/")),i.options.format)))},setMaxDate:function(t){var i=this,a=i.options,n=i.formElement.val();if(e.isNotNull(t)){a.maxDate=i._findError(t);var o=a.timeZone;i._isTimeZoneNull&&(o=i._getTempZone(n.replace(/-/g,"/")+""));var r=e.date.dateToUTC(n.replace(/-/g,"/")+"",o);i._setUtcTimefield(r)}},setMinDate:function(t){var i=this,a=i.options,n=i.formElement.val();if(e.isNotNull(t)){a.minDate=i._findError(t);var o=a.timeZone;i._isTimeZoneNull&&(o=i._getTempZone(n.replace(/-/g,"/")+""));var r=e.date.dateToUTC(n.replace(/-/g,"/")+"",o);i._setUtcTimefield(r)}},setRegularization:function(t,i){var a=this,n=a.options;if(!e.isNull(t)){var o=i||parseInt(e.date.getMilliseconds()/1e3,10),r=a.formElement.val(),l=n.timeZone,s=0,d=0;return a._isTimeZoneNull?(l=a._getTempZone(r.replace(/-/g,"/")+""),d=e.date.dateToUTC(r.replace(/-/g,"/")+"",l),s=e.date.setDateAfterOrder(t,d,o),s+=3600*(l- -new Date(1e3*s).getTimezoneOffset()/60)):(d=e.date.dateToUTC(r.replace(/-/g,"/")+"",l),s=e.date.setDateAfterOrder(t,d,o,l)),s=a._checkMaxMin(s),a._setUtcTimefield(s),s}},setInterval:function(t,i){var a=this,n=a.options;if(!e.isNull(t)){switch(n.intervalSeconds=t,t){case 300:case 900:a.options.format="yyyy-MM-dd hh:mm",a.setFiledType("S");break;case 3600:a.options.format="yyyy-MM-dd hh",a.setFiledType("MS");break;case 86400:a.options.format="yyyy-MM-dd",a.setFiledType("HMS");break;default:}var o=i||parseInt(e.date.getMilliseconds()/1e3,10),r=a.formElement.val(),l=n.timeZone,s=0,d=0;return a._isTimeZoneNull?(l=a._getTempZone(r.replace(/-/g,"/")+""),d=e.date.dateToUTC(r.replace(/-/g,"/")+"",l),s=e.date.setDateAfterOrder(t,d,o),s+=3600*(l- -new Date(1e3*s).getTimezoneOffset()/60)):(d=e.date.dateToUTC(r.replace(/-/g,"/")+"",l),s=e.date.setDateAfterOrder(t,d,o,l)),s=a._checkMaxMin(s),a._setUtcTimefield(s),s}},_findError:function(i){var a,n=this,o=(n.options,/^(\d{4})-(\d{2})-(\d{2}) (\d{2})$/);if("string"==typeof i){var r=i,l=r.split(" "),s=l[0].split("-"),d=s[0],c=s[1]-1,h=s[2],u=l[1]===t?["00","00","00"]:l[1].split(":"),p=u[0]===t?"00":u[0],f=u[1]===t?"00":u[1],g=u[2]===t?"00":u[2];a=n._initFormElVal(d,c,h,p,f,g)}else e.isNumeric(i)&&(a=n._getTimeStrByUtc(i));return a=null===a.match(RegExp(o))?a:a+":00"},_destroyWidget:function(){var e=this;e._super(),e.floatEl?e.floatEl.empty().remove():"",e.datePicEl?e.datePicEl.unbind():"",delete e.regMap},_setUtcTimefield:function(t){var i,a=this,n=parseInt(t,10);e.isNumeric(n)&&(n=a._checkMaxMin(n),i=a._getTimeStrByUtc(n),a.formElement.val(i))},_getTimeStrByUtc:function(t){e.isString(t)&&(t=e.string.toNumber(t));var i,a,n,o=this,r=o.options.format,l=o.options.timeZone,s=-new Date(1e3*t).getTimezoneOffset()/60;return o._isTimeZoneNull&&(l=s),a=s-l,n=t-3600*a,i="yyyy-MM-dd hh"===o.options.format?e.date.millisecondsToDate(1e3*n,r)+":00":e.date.millisecondsToDate(1e3*n,r)},_setValue:function(i){var a,n=this,o=n.options;if(e.isNotNull(i.data))n._setUtcTimefield(i.data);else if(e.isNotNull(i.value)){var r=i.value;if(e.isNumeric(r))n._setUtcTimefield(r);else{var l,s;if("string"==typeof i.value){l=i.value;var d=/\//g,c=l.match(d);e.isNotNull(c)&&(l=l.replace(d,"-"));var h=l.split(" "),u=h[0].split("-"),p=u[0],f=u[1]-1,g=u[2],m=h[1]===t?["00","00","00"]:h[1].split(":"),v=m[0]===t?"00":m[0],w=m[1]===t?"00":m[1],_=m[2]===t?"00":m[2];n.formElement.val(n._initFormElVal(p,f,g,v,w,_))}else"object"==typeof i.value&&(l=e.date.format(new Date(i.value),n.options.format),s=e.date.dateToUTC(l.replace(/-/g,"/")+"",o.timeZone),n._setUtcTimefield(s))}e.data(n.formElement[0],"value",i)}else n.formElement.val("");n._checkFun(),a=n.formElement.val(),n.oldValue===a||o.disabled||(n._triggerHandler(null,"change",n._getValue()),n.oldValue=a)},_setDisabled:function(e){var t=this,i=t.formDiv2El,a=t.datePicEl,n=t.defaultPaddingDivDisabledClass,o=t.defaultPaddingDivClass;if(e){if(i.removeClass(v).addClass(m),a.removeClass().addClass(g),t.emptyDiv?t.emptyDiv.hide():"",!i.hasClass(o))return;i.removeClass(o).addClass(n)}else{if(i.removeClass(m).addClass(v),a.removeClass().addClass(f),!i.hasClass(n))return;i.removeClass(n).addClass(o)}},_getMaxUtc:function(t){var i,a=this,n=a.options,o=n.timeZone,r=(n.format,""),l=n.maxDate,s="";return e.isNotNull(l)&&(t?("number"==typeof l&&(r=a._getTimeStrByUtc(l)),"string"==typeof l&&(r=e.date.format(new Date(l.replace(/-/g,"/")),a.options.format)),"yyyy-MM-dd hh"===a.options.format&&(r+=":00")):("number"==typeof l&&(r=l),"string"==typeof l&&(i=new Date(l.replace(/-/g,"/")),s=e.date.format(i,a.options.format),a._isTimeZoneNull&&(o=-i.getTimezoneOffset()/60),r=e.date.dateToUTC(s.replace(/-/g,"/")+"",o)))),r},_getMinUtc:function(t){var i,a=this,n=a.options,o=n.timeZone,r="",l="",s=n.minDate;return n.format,e.isNotNull(s)&&(t?("number"==typeof s&&(l=a._getTimeStrByUtc(s)),"string"==typeof s&&(l=e.date.format(new Date(s.replace(/-/g,"/")),a.options.format)),"yyyy-MM-dd hh"===a.options.format&&(l+=":00")):("number"==typeof s&&(l=s),"string"==typeof s&&(i=new Date(s.replace(/-/g,"/")),r=e.date.format(i,a.options.format),a._isTimeZoneNull&&(o=-i.getTimezoneOffset()/60),l=e.date.dateToUTC(r.replace(/-/g,"/")+"",o)))),l},_checkMaxMin:function(t){var i,a=this,n=a.options,o=(n.timeZone,n.maxDate),r=n.minDate;if(e.isNotNull(o)&&e.isNotNull(r)){var l=a._getMaxUtc(),s=a._getMinUtc();l>=t&&t>=s?i=t:t>l?i=l:s>t&&(i=s)}else if(e.isNotNull(o)&&e.isNull(r)){var d=a._getMaxUtc();i=d>=t?t:d}else if(!e.isNotNull(o)&&e.isNotNull(r)){var c=a._getMinUtc();i=t>=c?t:c}else i=t;return i},_getValue:function(){var t=this,i=t.options,a=t.formElement.val(),n="yyyy-MM-dd hh"===t.options.format?t.regMap["yyyy-MM-dd hh:mm"]:t.regMap[i.format],o=RegExp(n),r=i.timeZone;if(e.isNull(a))return null;if(null===a.match(o))return t._error("The format of the time is wrong!"),null;t._isTimeZoneNull&&(r=t._getTempZone(a.replace(/-/g,"/")+""));var l=e.date.dateToUTC(a.replace(/-/g,"/")+"",r);return e.isNotNull(i.value)?{value:a,text:i.value.text,data:l}:{value:a,text:"time",data:l}},_doLayout:function(){var e=this;e._super(),e._closeFloatPanel()},_closeFloatPanel:function(){var t=this;t.floatEl&&(!t.openDropDownFlag&&e.isVisiable(t.floatEl)&&(t.floatEl.fadeOut(150),t._closeDateFloatPanel()),t.openDropDownFlag=!1)},_closeDateFloatPanel:function(){var e=this;e.northMonthSpinnerEl.find("."+i).hide(),e.northYearSpinnerEl.find("."+a).hide(),e.southSpinnerEl.find("."+n).hide()},_createInputField:function(){var t=this,i=t.options,a=e.isNotNull(i.vID)?i.vID:i.id+"_date_input",n="sweet-form-input-date",o=t.formElement=e("<input>").addClass(t.defaultInputClass),r=t.formDiv1El.appendTo(t.formEl),l=t.formDiv2El=e("<div>").addClass(t.defaultPaddingDivClass+" "+n).appendTo(r),s=t.datePicEl=e("<span>").addClass(f);o.attr("id",a),t.formEl.css({position:"relative"}),e.isNull(i.timeZone)&&(t._isTimeZoneNull=!0,i.timeZone=_),s.appendTo(l),o.attr("type",t.type).bind("click",{me:t},t._onDatePicClick).appendTo(l),e.isNull(i.maxDate)||(i.maxDate=t._findError(i.maxDate)),e.isNull(i.minDate)||(i.minDate=t._findError(i.minDate));for(var d={},c=[/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})$/,/^(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2})$/,/^(\d{4})-(\d{2})-(\d{2}) (\d{2})$/,/^(\d{4})-(\d{2})-(\d{2})$/],h=["yyyy-MM-dd hh:mm:ss","yyyy-MM-dd hh:mm","yyyy-MM-dd hh","yyyy-MM-dd"],u=0;c.length>u;u++)d[h[u]]=c[u];t.regMap=d,t.datePicEl.bind("click",{me:t},t._onDatePicClick)},_onDatePicClick:function(i){var a,n,o,r=i.data.me,l=r.options,s=l.disabled;return s?(r.floatEl?r.floatEl.hide():"",t):(e.isFunction(l.beforePopDatePanel)&&l.beforePopDatePanel(),r.floatEl||r._createDateFloatPanel(),e.isNull(r.oldValue)&&(r.oldValue=r.formElement.val()),a=e.getMaxZIndex(r.floatEl.css("z-index")),r.floatEl.css("z-index",a),r._closeDateFloatPanel(),"block"===r.floatEl.css("display")?(i.stopImmediatePropagation(),t):(r._getCurrentDate(r),r._changeDateMidContent(r),r._setFloatPanelDateVal(r),r._setTimeElStyle(r,l.format),r._triggerHandler(i,"click",r.formElement.val()),n=e.getFloatOffset(r.formDiv2El,r.floatEl,!0).left,o=e.getFloatOffset(r.formDiv2El,r.floatEl).top,r.floatEl.css("left",n).css("top",o-1),s||r.floatEl.fadeIn(150),r.openDropDownFlag=!0,t))},_setFloatPanelDateVal:function(t){t.northMonthSpinnerEl.find("input").val(e.string.lpad(t.month,2,"0")),t.northYearSpinnerEl.find("input").val(e.string.lpad(t.year,4,"0")),t._setDayEl(null,t,t.day)},_setTimeElStyle:function(t,i){var a,n="00";"yyyy-MM-dd"===i?(a=t.southSpinnerEl.find("input"),e(a[0]).val(e.string.lpad(n,2,"0")),e(a[1]).val(e.string.lpad(n,2,"0")),e(a[2]).val(e.string.lpad(n,2,"0")),t.inputHourEl.attr("disabled",!0),t.inputMinuteEl.attr("disabled",!0),t.inputSecondEl.attr("disabled",!0),t.timeUpEl.removeClass(o),t.timeDownEl.removeClass(r),t.timeUpEl.addClass(l),t.timeDownEl.addClass(s)):(t.timeUpEl.removeClass(l),t.timeDownEl.removeClass(s),t.timeUpEl.addClass(o),t.timeDownEl.addClass(r)),"yyyy-MM-dd hh"===i&&(a=t.southSpinnerEl.find("input"),e(a[0]).val(e.string.lpad(t.hour,2,"0")),e(a[1]).val(e.string.lpad(n,2,"0")),e(a[2]).val(e.string.lpad(n,2,"0")),t.inputHourEl.attr("disabled",!1),t.inputMinuteEl.attr("disabled",!0),t.inputSecondEl.attr("disabled",!0)),"yyyy-MM-dd hh:mm"===i&&(a=t.southSpinnerEl.find("input"),e(a[0]).val(e.string.lpad(t.hour,2,"0")),e(a[1]).val(e.string.lpad(t.minute,2,"0")),e(a[2]).val(e.string.lpad(n,2,"0")),t.inputHourEl.attr("disabled",!1),t.inputMinuteEl.attr("disabled",!1),t.inputSecondEl.attr("disabled",!0)),"yyyy-MM-dd hh:mm:ss"===i&&(a=t.southSpinnerEl.find("input"),e(a[0]).val(e.string.lpad(t.hour,2,"0")),e(a[1]).val(e.string.lpad(t.minute,2,"0")),e(a[2]).val(e.string.lpad(t.second,2,"0")),t.inputHourEl.attr("disabled",!1),t.inputMinuteEl.attr("disabled",!1),t.inputSecondEl.attr("disabled",!1))},_getCurrentDate:function(t){var i,a,n,o=t.options,r=t.formElement.val(),l="yyyy-MM-dd hh"===t.options.format?t.regMap["yyyy-MM-dd hh:mm"]:t.regMap[t.options.format],s=RegExp(l),d=o.timeZone;return r=e.isNull(r.match(s))?new Date:e.isNull(r)?new Date:new Date(r.replace(/-/g,"/")),a=e.date.format(new Date(r),t.options.format),t._isTimeZoneNull&&(d=t._getTempZone(a.replace(/-/g,"/")+"")),n=e.date.dateToUTC((a+"").replace(/-/g,"/"),d),n=t._checkMaxMin(n),i=t._getTimeStrByUtc(n),r=new Date(i.replace(/-/g,"/")),t.year=r.getFullYear(),t.month=r.getMonth()+1,t.day=r.getDate(),t.hour=r.getHours(),t.minute=r.getMinutes(),t.second=r.getSeconds(),r},_createDateFloatPanel:function(){var t=this,i="sweet-form-date-float-panel",a=t.floatEl=e("<div>").addClass(i+" "+t.floatBgClass).hide();t._createDateNorthItem(),t._createDateMiddlleItem(),t._createDateSouthItem(),a.bind("click",function(e){t._closeDateFloatPanel(),e.stopImmediatePropagation()}).appendTo("body")},_createDateNorthItem:function(){var t=this,i="sweet-form-date-float-panel-north",a="sweet-form-date-float-panel-preyear",n="sweet-form-date-float-panel-nextyear",o="sweet-form-date-float-panel-premonth",r="sweet-form-date-float-panel-nextmonth",l=t.northItemEl=e("<div>").addClass(i),s=t.northPreYearEl=e("<span>").addClass(a),d=t.northNextYearEl=e("<span>").addClass(n),c=t.northPreMonthEl=e("<span>").addClass(o),h=t.northNextMonthEl=e("<span>").addClass(r),u=t.northMonthSpinnerEl=t._createDateSpinner(C[0]),p=t.northYearSpinnerEl=t._createDateSpinner(C[1]);s.bind("click",{me:t},t._onPreYearClick).appendTo(l),c.bind("click",{me:t},function(e){var i=t.northMonthSpinnerEl.find("input"),a=i[0].value;1===parseInt(a,10)&&(t.month=12),t._onPreMonthClick(e)}).appendTo(l),u.appendTo(l),p.appendTo(l),h.bind("click",{me:t},function(e){var i=t.northMonthSpinnerEl.find("input"),a=i[0].value;12===parseInt(a,10)&&(t.month="01"),t._onNextMonthClick(e)}).appendTo(l),d.bind("click",{me:t},t._onNextYearClick).appendTo(l),l.appendTo(t.floatEl)},_onPreYearClick:function(e){var t=e.data.me;t.northYearSpinnerEl.find("."+r).click()},_onNextYearClick:function(e){var t=e.data.me;t.northYearSpinnerEl.find("."+o).click()},_onPreMonthClick:function(e){var t=e.data.me,i=t.northMonthSpinnerEl.find("input"),a=i[0].value;if(1===parseInt(a,10)){var n=13;i.val(n),t._onPreYearClick(e)}t.northMonthSpinnerEl.find("."+r).click()},_onNextMonthClick:function(e){var t=e.data.me,i=t.northMonthSpinnerEl.find("input"),a=i[0].value;if(12===parseInt(a,10)){var n=0;i.val(n),t._onNextYearClick(e)}t.northMonthSpinnerEl.find("."+o).click()},_createDateSpinner:function(i){var a=this,n="sweet-form-date-float-panel-span",l="sweet-form-date-float-panel-input",s="sweet-form-date-float-panel-input-north",d="sweet-form-date-float-panel-input-south",c="sweet-form-date-float-panel-spinner",h="sweet-form-date-float-panel-spinner-north",u="sweet-form-date-float-panel-spinner-south",p=e("<span>").addClass(n),f=e("<a>").addClass(o),g=e("<a>").addClass(r),m=e("<div>").addClass(c);if(f.appendTo(p),g.appendTo(p),p.appendTo(m),C[0]===i||C[1]===i){var v,w,_=a.inputEl=e("<input>").attr("type","text").keydown(function(){return!1}).addClass(l).addClass(s).appendTo(m);C[0]===i?(_.attr({maxlength:2,max:12,min:1}),w=k[1],v=a._createMonthPanel(a),a.floatMonthPanelEl=v):(_.attr({maxlength:4,max:9999,min:1900}),w=k[0],v=a._createYearPanel(_),a.floatYearPanelEl=v),v.appendTo(m),m.addClass(h),_.bind("click",{me:a,inputObj:_,panelObjs:[v],type:w},a._onInputClick),_.blur(function(){a.year=e.string.toNumber(a.northYearSpinnerEl.find("input").val()),a.month=e.string.toNumber(a.northMonthSpinnerEl.find("input").val()),a._changeDateMidContent(a)}),f.bind("click",{me:a,type:b[0],objs:_,spinnerType:i},a._onSpinnerFlipClick),g.bind("click",{me:a,type:b[1],objs:_,spinnerType:i},a._onSpinnerFlipClick)}else{if(C[2]!==i)return a._error("Unsupported type. type="+i),t;var D,S,L,N="sweet-form-date-float-south-time-em",I={type:"text",maxlength:2},A=a.inputHourEl=e("<input>").attr(I).keydown(function(){return!1}).addClass(l).addClass(d),P=a.inputMinuteEl=e("<input>").attr(I).keydown(function(){return!1}).addClass(l).addClass(d),M=a.inputSecondEl=e("<input>").attr(I).keydown(function(){return!1}).addClass(l).addClass(d),F=e("<em>").addClass(N).text(Sweet.constants.symbol.COLON),W=e("<em>").addClass(N).text(Sweet.constants.symbol.COLON),B=[];D=a._createTimePanel(a,y,A),a.floatHourPanelEl=D,D.appendTo(m),S=a._createTimePanel(a,x,P),a.floatMinutePanelEl=S,S.appendTo(m),L=a._createTimePanel(a,T,M),a.floatSecondEl=L,L.appendTo(m),B=[D,S,L],m.addClass(u),A.attr({max:23,min:0,timeType:E[0]}).bind("click",{me:a,inputObj:A,hourObj:A,panelObjs:B},a._onInputClick).appendTo(m),a.inputHourEl=A,F.appendTo(m),P.attr({max:59,min:0,timeType:E[1]}).bind("click",{me:a,inputObj:P,hourObj:A,panelObjs:B},a._onInputClick).appendTo(m),a.inputMinuteEl=P,W.appendTo(m),M.attr({max:59,min:0,timeType:E[2]}).bind("click",{me:a,inputObj:M,hourObj:A,panelObjs:B},a._onInputClick).appendTo(m),a.inputSecondEl=M,f.bind("click",{me:a,type:b[0],objs:[A,P,M],spinnerType:i},a._onSpinnerFlipClick),a.timeUpEl=f,g.bind("click",{me:a,type:b[1],objs:[A,P,M],spinnerType:i},a._onSpinnerFlipClick),a.timeDownEl=g}return m},_onInputClick:function(e){var t,i,a=e.data,n=a.me,o=a.panelObjs,r=a.inputObj,l=a.type,s=0,d=0,c=0,h=0,u=r.val();if(1===o.length)n.floatHourPanelEl.hide(),n.floatMinutePanelEl.hide(),n.floatSecondEl.hide(),k[0]===l&&(n.floatMonthPanelEl.hide(),r.select(),n._changeYearPanel(n,u,r)),k[1]===l&&(n.floatYearPanelEl.hide(),r.select(),n._changeMonthPanel(n,u,r)),t=o[0],i=r.position(),h=r.height()-1;else{var p=n._onInputTimeElClick(e);t=p.floatPanelEl,h=p.height,c=p.weight,i=p.position}s=i.top+h+3,d=i.left+c,t.css({top:s,left:d}).show(),e.stopImmediatePropagation()},_onInputTimeElClick:function(e){var i,a,n,d=e.data,c=d.me,h=d.panelObjs,u=d.inputObj,p=-3,f=0,g=d.hourObj;if(c.floatYearPanelEl.hide(),c.floatMonthPanelEl.hide(),c.spinnerTimeType=u.attr("timeType")?parseInt(u.attr("timeType"),10):null,u.select(),c._changeTimePanel(c,u.val(),u,c.spinnerTimeType),E[0]===c.spinnerTimeType)n=84,i=h[0].height(n),h[1].hide(),h[2].hide();else if(E[1]===c.spinnerTimeType)n=42,i=h[1].height(n),h[0].hide(),h[2].hide();else{if(E[2]!==c.spinnerTimeType)return c._error("_onInputClick() Unsupport time type. not 1/2/3. type="+c.spinnerTimeType),t;n=20,i=h[2].height(n),h[0].hide(),h[1].hide()}return i[0].disabled&&(c.timeUpEl.removeClass(o).addClass(l),c.timeDownEl.removeClass(r).addClass(s)),f=-n-11,a=g.position(),{floatPanelEl:i,height:f,weight:p,position:a}},_clickMYInputSpinner:function(t,i,a){var n=(t.options,t._getMaxUtc(!0)),o=t._getMinUtc(!0),r=e.string.toNumber(t.northYearSpinnerEl.find("input").val()),l=(e.string.toNumber(t.northMonthSpinnerEl.find("input").val()),new Date(n.replace(/-/g,"/")).getMonth()+1),s=new Date(o.replace(/-/g,"/")).getMonth()+1,d=new Date(n.replace(/-/g,"/")).getFullYear(),c=new Date(o.replace(/-/g,"/")).getFullYear();C[0]===i&&(e.isNotNull(n)&&e.isNotNull(o)?d===c?a.attr({maxlength:2,max:l,min:s}):d===r?a.attr({maxlength:2,max:l,min:1}):c===r?a.attr({maxlength:2,max:12,min:s}):a.attr({maxlength:2,max:12,min:1}):e.isNotNull(n)&&!e.isNotNull(o)?r===d?a.attr({maxlength:2,max:l,min:1}):a.attr({maxlength:2,max:12,min:1}):!e.isNotNull(n)&&e.isNotNull(o)?r===c?a.attr({maxlength:2,max:12,min:s}):a.attr({maxlength:2,max:12,min:1}):a.attr({maxlength:2,max:12,min:1})),C[1]===i&&a.attr({maxlength:4,max:e.isNotNull(n)?new Date(n.replace(/-/g,"/")).getFullYear():9999,min:e.isNotNull(o)?new Date(o.replace(/-/g,"/")).getFullYear():1900})},_clickTimeInputSpinner:function(t,i,a){if(C[2]===i){var n,o,r,l,s,d=1,c=t.options,h=c.timeZone,u=c.maxDate,p=c.minDate,f=t._getMaxUtc(),g=t._getMinUtc(),m=t.northYearSpinnerEl.find("input").val(),v=e.string.toNumber(t.northMonthSpinnerEl.find("input").val())-d,w=t.dayEl.val(),_=t.southSpinnerEl.find("input");return E[0]===t.spinnerTimeType?(b[0]===a&&(r=e.string.toNumber(e(_[0]).val())+d),b[1]===a&&(r=e.string.toNumber(e(_[0]).val())-d),l="00",s="00"):E[1]===t.spinnerTimeType?(b[0]===a&&(l=e.string.toNumber(e(_[1]).val())+d),b[1]===a&&(l=e.string.toNumber(e(_[1]).val())-d),r=e(_[0]).val(),s="00"):E[2]===t.spinnerTimeType&&(b[0]===a&&(s=e.string.toNumber(e(_[2]).val())+d),b[1]===a&&(s=e.string.toNumber(e(_[2]).val())-d),r=e(_[0]).val(),l=e(_[1]).val()),n=t._initFormElVal(m,v,w,r,l,s),t._isTimeZoneNull&&(h=t._getTempZone(n.replace(/-/g,"/")+"")),o=e.date.dateToUTC((n+"").replace(/-/g,"/"),h),e.isNotNull(u)&&e.isNotNull(p)?o>f||g>o?!1:!0:e.isNotNull(u)&&!e.isNotNull(p)?o>f?!1:!0:!e.isNotNull(u)&&e.isNotNull(p)?g>o?!1:!0:(t.inputSecondEl.attr({max:59,min:0,timeType:E[2]}),t.inputHourEl.attr({max:23,min:0,timeType:E[0]}),t.inputMinuteEl.attr({max:59,min:0,timeType:E[1]}),!0)}return!0},_onSpinnerFlipClick:function(i){var a,n,o,r,l,s=i.data,d=i.data.me,c=s.type,h=d.spinnerTimeType,u=s.objs,p=u.length>1?E[0]===h?u[0]:E[1]===h?u[1]:E[2]===h?u[2]:null:u,f=null===p?u[2]:p,g=s.spinnerType;if(f=null===p?u[0]:p,d.spinnerTimeType=null===p?E[0]:h,o=f.val(),d._clickMYInputSpinner(d,g,u),d._clickTimeInputSpinner(d,g,c)){if(e.isNull(o))return d._error("_onSpinnerFlipClick(): Can't get value."),t;if(a=parseInt(f.attr("max"),10),n=parseInt(f.attr("min"),10),o=e.string.toNumber(o),r=o-1,l=o+1,b[0]===c){if(l>a)return;if(f[0].disabled)return;var m=d.options,v=m.timeZone,w=d._getMaxUtc(!0),_=d._getMaxUtc(),y=d.northYearSpinnerEl.find("input").val(),x=e.string.toNumber(d.northMonthSpinnerEl.find("input").val())-1,T=d.dayEl.val(),D=d.southSpinnerEl.find("input"),S=e.string.lpad(l,2,"0");if(e.isNotNull(w)&&E[0]===d.spinnerTimeType){var k=d._initFormElVal(y,x,T,S,e(D[1]).val(),e(D[2]).val());d._isTimeZoneNull&&(v=d._getTempZone(k.replace(/-/g,"/")+""));var L=e.date.dateToUTC((k+"").replace(/-/g,"/"),v);L>_&&(e(D[1]).val("00"),e(D[2]).val("00"))}else if(e.isNotNull(w)&&E[1]===d.spinnerTimeType){var k=d._initFormElVal(y,x,T,e(D[0]).val(),S,e(D[2]).val());d._isTimeZoneNull&&(v=d._getTempZone(k.replace(/-/g,"/")+""));var L=e.date.dateToUTC((k+"").replace(/-/g,"/"),v);L>_&&e(D[2]).val("00")}f.val(S)}else{if(b[1]!==c)return d._error("_onSpinnerFlipClick(): Unsupported type. Type equals 1 or 2. type="+c),t;if(n>r)return;if(f[0].disabled)return;f.val(e.string.lpad(r,2,"0"))}1===u.length&&(C[0]===g?(d.year=e.string.toNumber(d.northYearSpinnerEl.find("input").val()),d.month=e.string.toNumber(d.northMonthSpinnerEl.find("input").val()),d._changeDateMidContent(d),d._setDayEl(null,d,d.day)):(d._changeMonthInput(),d._setDayEl(null,d,d.day)))}},_createMonthPanel:function(t){for(var a,n,o=[],r=t.monthDivEl=e("<div>").addClass(i+" "+t.floatBgClass).hide(),l=0,s=0;12>l;l++,s++)(0===l||6===l)&&(a=e("<li>"),n=e("<ul>"),a.appendTo(n),n.appendTo(r)),o[s]=e("<a>").val(l+1).text(Sweet.core.i18n.month[l]),o[s].appendTo(a);return n.appendTo(r),t.monthAEl=o,r.bind("click",function(e){e.stopImmediatePropagation()}),r},_changeMonthPanel:function(i,a,n){function o(t){i.monthAEl[t].bind("click",function(){var t=e(this);n.val(e.string.lpad(t.val(),2,"0")),i.monthDivEl.hide(),i.year=e.string.toNumber(i.northYearSpinnerEl.find("input").val()),i.month=e.string.toNumber(n.val()),i._changeDateMidContent(i),i._setDayEl(null,i,i.day)})}function r(e){i.monthAEl[e].removeClass().unbind("click").select(function(){return!1})}if(e.isNull(a))return i._error("_changeYearPanel() The input parameter 'month' is null."),t;for(var l,s,d=i.options,c=d.timeZone,h=(i.options.format,i._getMaxUtc(!0)),u=i._getMinUtc(!0),f=parseInt(i.northYearSpinnerEl.find("input").val(),10),g=new Date(h.replace(/-/g,"/")).getMonth()+1,m=new Date(u.replace(/-/g,"/")).getMonth()+1,v=new Date(h.replace(/-/g,"/")).getFullYear(),w=new Date(u.replace(/-/g,"/")).getFullYear(),_=e.date.format(new Date(v,g-1,"01","00","00","00"),i.options.format),C=e.date.dateToUTC((_+"").replace(/-/g,"/"),c),b=e.date.format(new Date(w,m-1,"01","00","00","00"),i.options.format),E=e.date.dateToUTC((b+"").replace(/-/g,"/"),c),y=0,x=0;12>y;y++,x++)r(x),l=e.date.format(new Date(f,y,"01","00","00","00"),i.options.format),s=e.date.dateToUTC((l+"").replace(/-/g,"/"),c),e.isNotNull(h)&&e.isNotNull(u)?C>=s&&s>=E?o(x):i.monthAEl[x].addClass(p):e.isNotNull(h)&&!e.isNotNull(u)?C>=s?o(x):i.monthAEl[x].addClass(p):!e.isNotNull(h)&&e.isNotNull(u)?s>=E?o(x):i.monthAEl[x].addClass(p):o(x),i.monthAEl[x].val(y+1).text(Sweet.core.i18n.month[y])},_changeMonthInput:function(){var t=this,i=(t.options,t._getMaxUtc(!0)),a=t._getMinUtc(!0),n=t.northYearSpinnerEl.find("input"),o=t.northMonthSpinnerEl.find("input"),r=e.string.toNumber(n.val()),l=e.string.toNumber(o.val()),s=new Date(i.replace(/-/g,"/")).getMonth()+1,d=new Date(a.replace(/-/g,"/")).getMonth()+1,c=new Date(i.replace(/-/g,"/")).getFullYear(),h=new Date(a.replace(/-/g,"/")).getFullYear();e.isNotNull(i)&&e.isNotNull(a)&&c>h&&(c===r?l>s&&o.val(e.string.lpad(s,2,"0")):h===r&&d>l&&o.val(e.string.lpad(d,2,"0"))),e.isNotNull(i)&&!e.isNotNull(a)&&c===r&&l>s&&o.val(e.string.lpad(s,2,"0")),!e.isNotNull(i)&&e.isNotNull(a)&&h===r&&d>l&&o.val(e.string.lpad(d,2,"0")),t.year=e.string.toNumber(n.val()),t.month=e.string.toNumber(o.val()),t._changeDateMidContent(t),t._changeTimeInput(t)},_createYearPanel:function(i){var n,o,r,l,s,d,c,h=this,u=i.val()||2013,p="sweet-form-date-float-panel-spinner-year-pre",f="sweet-form-date-float-panel-spinner-year-center",g="sweet-form-date-float-panel-spinner-year-nxt",m="sweet-form-date-float-panel-spinner-year-item",v=e("<ul>"),w=h.yearDivEl=e("<div>").addClass(a+" "+h.floatBgClass).hide(),_=[];if(e.isNull(u)||!e.isNumeric(u))return h._error("_createYearPanel(): The value is null or not a number! value="+u),t;"number"!=typeof u&&(u=parseInt(u,10)),d=u-5,c=u+5;for(var C=d,b=0;c>C;C++,b++)(d===C||u===C)&&(n=e("<li>").appendTo(v)),_[b]=e("<a>").val(C).text(C),_[b].appendTo(n);
return v.appendTo(w),o=e("<div>").addClass(m).appendTo(w),r=e("<a>").addClass(p).appendTo(o).bind("click",{me:h,type:D[0],objs:_,inputObj:i},h._onNorthYearFilp),l=e("<a>").addClass(f).appendTo(o).bind("click",function(){w.hide()}),s=e("<a>").addClass(g).appendTo(o).bind("click",{me:h,type:D[1],objs:_,inputObj:i},h._onNorthYearFilp),w.bind("click",function(e){e.stopImmediatePropagation()}),h.yearAEl=_,h.yearUlEl=v,w},_onNorthYearFilp:function(i){var a,n,o=i.data,r=o.me,l=o.type,s=o.objs,d=o.inputObj,c=(r.options,r._getMaxUtc(!0)),h=r._getMinUtc(!0),u=new Date(c.replace(/-/g,"/")).getFullYear(),p=new Date(h.replace(/-/g,"/")).getFullYear();if(D[0]===l)a=parseInt(s[0].val(),10)-10;else{if(D[1]!==l)return r._error("_onNorthYearFilp(): Unsupported type. Type equals 1 or 2. type="+l),t;a=parseInt(s[0].val(),10)+10}if(n=a+10,e.isNotNull(c)&&e.isNotNull(h)){if(p>n||a>u)return;r._addYearRange(r,d,a,n)}else if(e.isNotNull(c)&&!e.isNotNull(h)){if(a>u)return;r._addYearRange(r,d,a,n)}else if(!e.isNotNull(c)&&e.isNotNull(h)){if(p>n)return;r._addYearRange(r,d,a,n)}else r._addYearRange(r,d,a,n)},_addYearRange:function(t,i,a,n){function o(a){t.yearAEl[a].bind("click",function(){var a=e(this);i.val(a.val()),t.yearDivEl.hide(),t._changeMonthInput(),t.year=e.string.toNumber(i.val()),t.month=e.string.toNumber(t.northMonthSpinnerEl.find("input").val()),t._changeDateMidContent(t),t._setDayEl(null,t,t.day)})}function r(e){t.yearAEl[e].removeClass().unbind("click").select(function(){return!1})}for(var l=(t.options,t._getMaxUtc(!0)),s=t._getMinUtc(!0),d=new Date(l.replace(/-/g,"/")).getFullYear(),c=new Date(s.replace(/-/g,"/")).getFullYear(),h=a,u=0;n>h;h++,u++)r(u),e.isNotNull(l)&&e.isNotNull(s)?c>h||h>d?t.yearAEl[u].addClass(p):o(u):e.isNotNull(l)&&!e.isNotNull(s)?h>d?t.yearAEl[u].addClass(p):o(u):!e.isNotNull(l)&&e.isNotNull(s)?c>h?t.yearAEl[u].addClass(p):o(u):o(u),t.yearAEl[u].val(h).text(h)},_changeYearPanel:function(i,a,n){if(e.isNull(a))return i._error("_changeYearPanel() The input parameter 'year' is null."),t;"string"===e.type(a)&&(a=parseInt(a,10));var o=a-5,r=a+5;i._addYearRange(i,n,o,r)},_createDateMiddlleItem:function(){var t=this,i="sweet-form-date-float-middle-content",a="sweet-form-date-float-middle-week",n=t.middleItemEl=e("<div>").appendTo(t.floatEl),o=t.dateContentEl=e("<div>").addClass(i).appendTo(n),r=e("<div>"),l=Sweet.core.i18n;r.html("<em>"+l.week[6]+"</em><em>"+l.week[0]+"</em><em>"+l.week[1]+"</em><em>"+l.week[2]+"</em><em>"+l.week[3]+"</em><em>"+l.week[4]+"</em><em>"+l.week[5]+"</em>").addClass(a).appendTo(o),t._createDateMidContent()},_createDateMidContent:function(t){for(var i,a,n="sweet-form-date-float-middle-month",o="sweet-form-date-float-middle-month-other",r=t&&t.data?t.data:null,l=r&&r.me?r.me:this,s=e("<ul>").appendTo(l.dateContentEl),d=l.dateEmEl=[],c=0;S>c;c++)0===c%7&&(i=e("<li>").addClass(n+" "+o).appendTo(s)),a=e("<em>").appendTo(i),d[c]=a},_changeDateMidContent:function(t){function i(e){m[e].removeClass().unbind("click").select(function(){return!1})}var a,n,o,r,l=t.year,s=t.month,d=t.months,p=new Date(l,s-1,1),f=p.getDay(),g=[],m=t.dateEmEl,v=t.options,w=(v.format,t._getMaxUtc(!0)),_=t._getMinUtc(!0),C=v.timeZone;d[1]=e.date.isLeapYear(l)?29:28,n=d[s-1],a=f+n-1,o=1===s?d[11]:d[s-2],r=12===s?d[0]:d[s];var b,E,y,x,T,D=new Date(w.replace(/-/g,"/")).getFullYear(),k=new Date(w.replace(/-/g,"/")).getMonth()+1,L=new Date(w.replace(/-/g,"/")).getDate(),N=new Date(_.replace(/-/g,"/")).getFullYear(),I=new Date(_.replace(/-/g,"/")).getMonth()+1,A=new Date(_.replace(/-/g,"/")).getDate(),P=e.date.format(new Date(D,k-1,L,"00","00","00"),t.options.format),M=e.date.dateToUTC((P+"").replace(/-/g,"/"),C),F=e.date.format(new Date(N,I-1,A,"00","00","00"),t.options.format),W=e.date.dateToUTC((F+"").replace(/-/g,"/"),C),B=t._getValue()?t._getValue().value:"",O=B?B.split(" "):"",R=2===O.length?O[1]:"00:00:00";(isNaN(D)||isNaN(k)||isNaN(L))&&(M=null),(isNaN(N)||isNaN(I)||isNaN(A))&&(W=null);for(var H=0,j=0,z=0;S>H;H++)if(i(H),f>H)g[H]=o-f+H+1,s>1&&(y=l+"/"+(s-1)+"/"+g[H]+" "+R,x=e.date.dateToUTC(y,C)),1===s&&(y=l-1+"/"+12+"/"+g[H]+" "+R,x=e.date.dateToUTC(y,C)),T=t._isDayValid(M,W,x),T?m[H].addClass(c):m[H].addClass(h),v.showDays?m[H].text("").val(g[H]).removeClass(c).addClass(h):(m[H].text(g[H]).val(g[H]),T&&m[H].bind("click",{me:t,dayEl:m[H],invalidType:"up",minUtc:W,jumpUpUtc:x},t._setInvalDayEl));else if(H>a){var V,U,G,Y;if(g[H]=++j,12>s&&(G=l,Y=s+1,y=l+"/"+Y+"/"+g[H]+" "+"00:00:00",V=l+"/"+Y+"/"+g[H]+" "+R,x=e.date.dateToUTC(y,C),U=e.date.dateToUTC(V,C)),12===s&&(G=l+1,Y=1,y=G+"/"+1+"/"+g[H]+" "+"00:00:00",V=G+"/"+1+"/"+g[H]+" "+R,x=e.date.dateToUTC(y,C),U=e.date.dateToUTC(V,C)),T=t._isDayValid(M,W,x),T?m[H].addClass(c):m[H].addClass(h),v.showDays)m[H].text("").val(g[H]).removeClass(c).addClass(h);else if(m[H].text(g[H]).val(g[H]),T){var q={year:G,month:Y,day:g[H]};m[H].bind("click",{me:t,dayEl:m[H],invalidType:"down",maxUtc:M,jumpDownUtc:U,jumpDownDay:q},t._setInvalDayEl)}}else g[H]=++z,b=e.date.format(new Date(l,s-1,g[H],"00","00","00"),t.options.format),E=e.date.dateToUTC((b+"").replace(/-/g,"/"),C),e.isNotNull(w)&&e.isNotNull(_)?M>=E&&E>=W?(m[H].bind("click",{me:t,dayEl:m[H]},t._setDayEl),(0===H%7||6===H%7)&&m[H].addClass(u)):m[H].addClass(h):e.isNotNull(w)&&!e.isNotNull(_)?M>=E?(m[H].bind("click",{me:t,dayEl:m[H]},t._setDayEl),(0===H%7||6===H%7)&&m[H].addClass(u)):m[H].addClass(h):!e.isNotNull(w)&&e.isNotNull(_)?E>=W?(m[H].bind("click",{me:t,dayEl:m[H]},t._setDayEl),(0===H%7||6===H%7)&&m[H].addClass(u)):m[H].addClass(h):(m[H].bind("click",{me:t,dayEl:m[H]},t._setDayEl),(0===H%7||6===H%7)&&m[H].addClass(u)),m[H].text(g[H]).val(g[H])},_isDayValid:function(i,a,n){var o=this,r=o._getMaxUtc(!0),l=o._getMinUtc(!0);return e.isNotNull(n)?e.isNotNull(r)&&e.isNotNull(i)&&e.isNull(a)?n>i?!1:!0:e.isNotNull(a)&&e.isNotNull(l)&&e.isNull(i)?a>n?!1:!0:e.isNotNull(r)&&e.isNotNull(l)&&e.isNotNull(i)&&e.isNotNull(a)?i>=n&&n>=a?!0:!1:!0:t},_setInvalDayEl:function(t,i){if(t){var a=t.data,n=a.me,o=a.dayEl[0].value,r=a.invalidType,l=n._getMinUtc(!0),s=n.northMonthSpinnerEl.find("input"),d=parseInt(n.northYearSpinnerEl.find("input").val(),10),c=parseInt(e.string.toNumber(s.val()),10);if(e.isNull(d)&&e.isNull(c)){var h=new Date;d=h.getFullYear(),c=parseInt(h.getMonth()+1,10)}if("up"===r&&(c>1&&(n.day=o,n._onPreMonthClick(t),n._setInvalidClickDayEi(n,n.day)),1===c&&(n.day=o,n.month=12,s.val(n.month),n._onPreYearClick(t),n._setInvalidClickDayEi(n,n.day)),a.minUtc&&a.jumpUpUtc&&a.jumpUpUtc<a.minUtc)){var u,p,f,g,m,v=n.southSpinnerEl.find("input");"string"==typeof l&&(g=l),"number"==typeof l&&(g=i._getTimeStrByUtc(l)),m=g.split(" "),f=f[1].split(":"),u=f[0],p=f[1],e(v[0]).val(u),e(v[1]).val(p),e(v[2]).val("00")}if("down"===r&&(12>c&&(n.day=o,n._onNextMonthClick(t),n._setInvalidClickDayEi(n,n.day)),12===c&&(n.day=o,n.month="01",s.val(n.month),n._onNextYearClick(t),n._setInvalidClickDayEi(n,n.day)),a.maxUtc&&a.jumpDownUtc&&a.jumpDownUtc>a.maxUtc)){var v=n.southSpinnerEl.find("input");e(v[0]).val("00"),e(v[1]).val("00"),e(v[2]).val("00")}}},_setInvalidClickDayEi:function(e,t){for(var i,a,n=0;e.dateEmEl.length>n;n++)if(i=e.dateEmEl[n],a=parseInt(i[0].innerHTML,10),!i.hasClass(h)&&!i.hasClass(c)&&a===parseInt(t,10)){i.addClass(d);break}},_setDayEl:function(t,i,a){if(t){var n=t.data.me,o=t.data.dayEl;e.each(n.dateEmEl,function(e,t){t.removeClass(d)}),o.addClass(d),n.dayEl=o,n.day=parseInt(o[0].value,10);var r,l,s=n.southSpinnerEl.find("input"),u=(n.options.format,n.options.timeZone),p=n.northMonthSpinnerEl.find("input"),f=parseInt(n.northYearSpinnerEl.find("input").val(),10),g=parseInt(e.string.toNumber(p.val()),10),m=n._getMaxUtc(),v=e(s[0]).val(),w=e(s[1]).val(),_=e(s[2]).val();if(l=e.date.format(new Date(f,g-1,n.day,v,w,_),n.options.format),r=e.date.dateToUTC((l+"").replace(/-/g,"/"),u),e.isNotNull(m)){var C=n._getMaxUtc(!0),b=new Date(C.replace(/-/g,"/")+""),E=b.getFullYear(),y=b.getMonth()+1,x=b.getDate();E===f&&y===g&&x===n.day&&r>m&&(e(s[0]).val("00"),e(s[1]).val("00"),e(s[2]).val("00"))}n._changeTimeInput(n)}else{var T,D,S,k,L,N,I,A,P,M,F=i._getMaxUtc(!0),W=i._getMinUtc(!0),p=i.northMonthSpinnerEl.find("input"),B=parseInt(i.northYearSpinnerEl.find("input").val(),10),O=parseInt(e.string.toNumber(p.val()),10),R=i.year,H=i.month,j=i.months;if(j[1]=e.date.isLeapYear(R)?29:28,k=parseInt(1===H?j[11]:j[H-1],10),a=parseInt(a,10),a>k&&(a=1,i.day=a),e.isNotNull(F)&&(M=new Date(F.replace(/-/g,"/")+""),I=M.getFullYear(),A=M.getMonth()+1,D=M.getDate(),B===I&&O===A&&a>D)){a=D,i.day=a;var z=i.southSpinnerEl.find("input"),V=(i.options.format,i.options.timeZone),U=i._getMaxUtc(),G=e(z[0]).val(),Y=e(z[1]).val(),q=e(z[2]).val(),$=e.date.format(new Date(I,A-1,a,G,Y,q),i.options.format),K=e.date.dateToUTC(($+"").replace(/-/g,"/"),V);U&&K>U&&(e(z[0]).val("00"),e(z[1]).val("00"),e(z[2]).val("00"))}e.isNotNull(W)&&(P=new Date(W.replace(/-/g,"/")+""),L=P.getFullYear(),N=P.getMonth()+1,S=P.getDate(),B===L&&O===N&&S>a&&(a=S,i.day=a)),e.each(i.dateEmEl,function(t,n){e.isNotNull(n.html())&&(T=e.string.toNumber(n.html())),n.hasClass(c)||n.hasClass(h)||!e.isNotNull(T)||T!==a||(i.dayEl?i.dayEl.removeClass(d):"",n.addClass(d),i.dayEl=n)}),i._changeTimeInput(i)}},_createTimePanel:function(t,i){for(var a,o,r=[],l=t.timeDivEl=e("<div>").addClass(n+" "+t.floatBgClass).hide(),s=0;i.length>s;s++)a=e("<li>"),o=e("<ul>"),a.appendTo(o),o.appendTo(l),r[s]=e("<a>").val(i[s]).text(i[s]).appendTo(a);switch(o.appendTo(l),l.bind("click",function(e){e.stopImmediatePropagation()}),i.length){case y.length:t.timeHourAEl=r,t.timeHourDivEl=l;break;case x.length:t.timeMiniteAEl=r,t.timeMiniteDivEl=l;break;case T.length:t.timeSecondAEl=r,t.timeSecondDivEl=l}return l},_changeTimePanel:function(i,a,n,o){function r(t){i.timeAEl[t].bind("click",function(){var t=e(this),a=e.string.lpad(t.val(),2,"0");if(e.isNotNull(b)&&E[0]===o){var r=e.date.format(new Date(L,N,g,a,e(I[1]).val(),e(I[2]).val()),i.options.format),l=e.date.dateToUTC((r+"").replace(/-/g,"/"),C);l>S&&(e(I[1]).val("00"),e(I[2]).val("00"))}else if(e.isNotNull(b)&&E[1]===o){var r=e.date.format(new Date(L,N,g,e(I[0]).val(),a,e(I[2]).val()),i.options.format),l=e.date.dateToUTC((r+"").replace(/-/g,"/"),C);l>S&&e(I[2]).val("00")}n.val(a),i.timeDivEl.hide()})}function l(e){i.timeAEl[e].removeClass().unbind("click").select(function(){return!1})}function s(t){for(var a=0;t.length>a;a++)l(a),E[0]===o?(m=t[a],v="00",w="00"):E[1]===o?(m=e(I[0]).val(),v=t[a],w="00"):E[2]===o&&(m=e(I[0]).val(),v=e(I[1]).val(),w=t[a]),c=e.date.format(new Date(L,N,g,m,v,w),i.options.format),h=e.date.dateToUTC((c+"").replace(/-/g,"/"),C),e.isNotNull(b)&&e.isNotNull(D)?S>=h&&h>=k?r(a):i.timeAEl[a].addClass(p):e.isNotNull(b)&&!e.isNotNull(D)?S>=h?r(a):i.timeAEl[a].addClass(p):!e.isNotNull(b)&&e.isNotNull(D)?h>=k?r(a):i.timeAEl[a].addClass(p):r(a),i.timeAEl[a].val(t[a]).text(t[a])}if(e.isNull(a))return i._error("_changeYearPanel() The input parameter 'time' is null."),t;var c,h,u,f,g,m,v,w,_=i.options,C=(_.format,_.timeZone),b=i._getMaxUtc(!0),D=i._getMinUtc(!0),S=i._getMaxUtc(),k=i._getMinUtc(),L=i.northYearSpinnerEl.find("input").val(),N=e.string.toNumber(i.northMonthSpinnerEl.find("input").val())-1,I=i.southSpinnerEl.find("input");g=i.dayEl?i.dayEl.val():"1";for(var A=0;i.dateEmEl.length>A;A++)if(i.dateEmEl[A].hasClass(d)){f=i.dateEmEl[A],u=parseInt(f[0].value,10);break}g=u?u:i.dayEl.val(),E[0]===o?(i.timeAEl=i.timeHourAEl,i.timeDivEl=i.timeHourDivEl,s(y)):E[1]===o?(i.timeAEl=i.timeMiniteAEl,i.timeDivEl=i.timeMiniteDivEl,s(x)):E[2]===o&&(i.timeAEl=i.timeSecondAEl,i.timeDivEl=i.timeSecondDivEl,s(T))},_changeTimeInput:function(i){var a,n,o,r=i,l=(r.options.format,r.options.timeZone),s=r.northYearSpinnerEl.find("input").val(),d=e.string.toNumber(r.northMonthSpinnerEl.find("input").val())-1,c=r.southSpinnerEl.find("input"),h=e(c[0]).val(),u=e(c[1]).val(),p=e(c[2]).val();r.dayEl&&e.isNotNull(r.dayEl.val())?o=r.dayEl.val():(o=(new Date).getDate(),2>(o+"").length&&(o="0"+o)),"0"===d&&(d=1),a=r._initFormElVal(s,d,o,h,u,p),n=r._isTimeZoneNull?e.date.dateToUTC((a+"").replace(/-/g,"/"),r._getTempZone(a.replace(/-/g,"/")+"")):e.date.dateToUTC((a+"").replace(/-/g,"/"),l);var f=r._checkMaxMin(n),g=r._getTimeStrByUtc(f).replace(/-/g,"/"),m=g.split(" "),v=m[0].split("/"),w=(v[0],v[1]-1,v[2],m[1]===t?["00","00","00"]:m[1].split(":")),_=w[0]===t?"00":w[0],C=w[1]===t?"00":w[1],b=w[2]===t?"00":w[2];e(c[0]).val(_),e(c[1]).val(C),e(c[2]).val(b)},_createDateSouthItem:function(){var t=this,i=Sweet.core.i18n.date,a=Sweet.constants.symbol.COLON,n=t.options,o="sweet-form-date-float-south",r="sweet-form-date-float-south-label",l="sweet-form-date-float-button-span",s="sweet-form-date-float-button-ok",d=(n.format,t.southItemEl=e("<div>").addClass(o).appendTo(t.floatEl)),c=e("<span>").addClass(l).appendTo(d),h=t.okButtonEl=e("<button>").addClass(s).text(i.okButton).appendTo(c);e("<label>").text(i.time+a).addClass(r).appendTo(d),t.southSpinnerEl=t._createDateSpinner(C[2]).appendTo(d),h.bind("click",function(){var i,a=t.northYearSpinnerEl.find("input").val(),n=e.string.toNumber(t.northMonthSpinnerEl.find("input").val())-1,o=t.dayEl.val(),r=t.southSpinnerEl.find("input"),l=e(r[0]).val(),s=e(r[1]).val(),d=e(r[2]).val();t.formElement.val(t._initFormElVal(a,n,o,l,s,d)),t.formElement.blur(),t.openDropDownFlag=!1,t._closeFloatPanel(),t._checkFun(),i=t.formElement.val(),t.oldValue!==i&&(t.oldValue=i)})},__setDisabled:function(e){var t=this;e?t.datePicEl.removeClass(f).addClass(w):t.datePicEl.removeClass(w).addClass(f),t.datePicEl.attr("disabled",e)},_checkAllFun:function(t){var i,a=this,n=a.formElement.val();return a._super(t)===!1&&(i=!1),e.isNull(n)&&(i=!0),i=a._setRightTimeValue(a)},_setRightTimeValue:function(t){var i=t,a=i.options,n=a.timeZone,o=i.formElement.val(),r="yyyy-MM-dd hh"===i.options.format?i.regMap["yyyy-MM-dd hh:mm"]:i.regMap[i.options.format],l=RegExp(r),s=n,d=n;if(null===o.match(l)){if(e.isNull(o)&&e.isNull(a.maxDate)&&e.isNull(a.minDate)&&!a.required)i.formElement.val("");else if(e.isNotNull(i.oldValue)){i._isTimeZoneNull&&(s=i._getTempZone(i.oldValue.replace(/-/g,"/")+""));var c=e.date.dateToUTC(i.oldValue.replace(/-/g,"/")+"",s);i._setUtcTimefield(c)}}else{o=i._findError(o),i._isTimeZoneNull&&(d=i._getTempZone(o.replace(/-/g,"/")+""));var h=e.date.dateToUTC(o.replace(/-/g,"/")+"",d);i._setUtcTimefield(h),i.closeTip()}return!0},_afterCreateFormWidget:function(){var e=this;e.allowdChars=e.baseChars,e.formElement.focus(function(){e.oldValue=e.formElement.val()}),e.formElement.keypress({me:e},e._onKeyPress),e.formElement.keydown({me:e},e._onKeyDown)},_onKeyPress:function(i){if(Sweet.constants.keyCode.BACKSPACE!==i.which&&Sweet.constants.keyCode.SPACE!==i.which&&Sweet.constants.keyCode.ENTER!==i.which&&0!==i.which){var a=i.data.me,n=(a.options,String.fromCharCode(e.e.getCharCode(i))),o=RegExp("["+a.allowdChars+"]");return o.test(n)?t:(i.preventDefault(),t)}},_onKeyDown:function(t){var i=(t.data.me,Sweet.constants.keyCode),a=t.keyCode,n=t.charCode||a;String.fromCharCode(e.e.getCharCode(t)),i.BACKSPACE!==a&&i.ENTER!==a&&i.DELETE!==a&&i.LEFT!==a&&i.RIGHT!==a&&i.DOWN!==a&&i.UP!==a&&i.TAB!==a&&(n>47&&58>n||n>95&&106>n||16===n||186===n||59===n||189===n||109===n||173===n||32===n||t.preventDefault())},_initFormElVal:function(t,i,a,n,o,r){var l,s=this;return l=e.date.getSDstSwitchDate(t),l&&l[0]==parseInt(t)&&l[1]==parseInt(i)&&l[2]==parseInt(a)&&l[3]==parseInt(n)&&l[4]<=parseInt(o)&&(n=parseInt(n)+1),"yyyy-MM-dd hh"===s.options.format?e.date.format(new Date(t,i,a,n,o,r),s.options.format)+":00":e.date.format(new Date(t,i,a,n,o,r),s.options.format)},_getTempZone:function(t){var i=-1*((new Date).getTimezoneOffset()/60);if(e.isNull(t))return i;if("string"!=typeof t)return i;var a=t.split(" "),n=a[0].split("/"),o=n[0],r=n[1]-1,l=n[2],s=a[1]?a[1].split(":"):["00","00","00"],d=s[0]?s[0]:"00",c=s[1]?s[1]:"00",h=s[2]?s[2]:"00";return-1*(new Date(o,r,l,d,c,h,0).getTimezoneOffset()/60)}}),Sweet.form.Date=e.sweet.widgetFormDate}(jQuery),function(e){var t="sweet-form-textarea",i="sweet-form-textarea-gray",a="sweet-form-textarea-errorRedBorder";e.widget("sweet.widgetFormTextarea",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-textarea]",type:"textarea",options:{},_doLayout:function(){this._super()},_createInputField:function(){var i=this,n=i.options,o=i.formElement=e("<textarea>").addClass(a),r=i.formDiv1El,l=i.formDiv2El=e("<div>").appendTo(r),s=e.nullToString(n.value);o.val(s),e.isNotNull(n.vID)&&o.attr("id",n.vID),o.appendTo(l),l.addClass(i.defaultPaddingDivClass).addClass(t),n.maxLength<Number.MAX_VALUE&&o.attr("maxLength",n.maxLength)},_setDisabled:function(e){var t=this;e?t.formDiv2El.addClass(i):t.formDiv2El.removeClass(i),t.__setDisabled(e)}}),Sweet.form.TextArea=e.sweet.widgetFormTextarea}(jQuery),function(e){var t="sweet-from-searchfield",i="sweet-from-searchfield-disabled",a="sweet-from-searchfield-a",n="click",o="keyup",r="javascript:void(0);";e.widget("sweet.widgetFormSearchfield",e.sweet.widgetFormTextfield,{version:"1.0",sweetWidgetName:"[widget-form-searchfield]",type:"text",eventNames:{click:"搜索按钮单击事件",keyup:"搜索框的keyup事件"},options:{},_doLayout:function(){this._super()},_afterCreateFormWidget:function(){var i=this,n=i.formElement,o=i.searchPicEl=e("<a>").attr("href",r).insertBefore(n);i.searchPicEl.bind("click",{me:i},i._onClick),n.bind("keyup",{me:i},i._onKeyup),i.formDiv2El.addClass(t),o.addClass(a)},_onClick:function(e){var t=e.data.me;t._triggerHandler(e,n,t.getValue())},_onKeyup:function(e){var t=e.data.me,i=e.charCode||e.keyCode;13===i?t._triggerHandler(e,n,t.getValue()):t._triggerHandler(e,o,t.getValue())},__setDisabled:function(e){var t=this,n=t.searchPicEl,o=t.formDiv2El;e?(n.removeClass(a),o.addClass(i)):(n.addClass(a),o.removeClass(i)),n.attr("disabled",e)}}),Sweet.form.SearchField=e.sweet.widgetFormSearchfield}(jQuery),function(e){var t="sweet-form-button",i="sweet-form-button-disabled",a="sweet-form-selector-button";e.widget("sweet.widgetFormSelector",e.sweet.widgetFormTextfield,{version:"1.0",sweetWidgetName:"[widget-form-selector]",eventNames:{buttonClick:"单击按钮事件"},options:{label:!1,editable:!1},_afterCreateFormWidget:function(){var i=this;i.formButton=e("<input type='button'>").attr("value","...").addClass(t).insertAfter(i.formDiv2El).bind("click",function(){i.options.disabled||i._triggerHandler(null,"buttonClick")})},__setDisabled:function(e){var a=this;a.options.disabled=e,e?a.formButton.removeClass(t).addClass(i):a.formButton.removeClass(i).addClass(t)},_doLayout:function(){var e=this,t=e.formButton,i=e.formDiv1El.width(),n=0,o=0;e._super(),o=e.formDiv1El.width(),i===o?(e.formDiv1El.width(o-e.labelWidth),n=e.formDiv1El.width()):(n=o-30,e.formDiv1El.width(n)),t.css("left",n),t.addClass(a)},_getWidth:function(){var e=this;return e.formEl.externalWidth()},_getHeight:function(){var e=this;return e.formEl.externalHeight()},_setWidth:function(e){var t=this;t.formDiv1El.externalWidth(e-30)},_setHeight:function(e){var t=this;t.formDiv1El.externalHeight(e)}}),Sweet.form.Selector=e.sweet.widgetFormSelector}(jQuery),function(e){"use strict";var t="sweet-form-cell-select",i="sweet-form-cs-cell",a="sweet-form-cs-used",n="sweet-form-cs-old",o="sweet-form-cs-rmv",r="sweet-form-cs-new",l="sweet-form-cs-selecting";e.widget("sweet.widgetFormCellSelect",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-cellselect]",defaultElement:"<div>",eventNames:{change:"改变值事件"},options:{value:null,width:"100%",height:"100%",rows:4,columns:5,padding:3},_setValue:function(t){var a,l,s=this;e.isNull(t)||(s.options.value=t,s.formElement.find("."+i).each(function(i,d){a=e(d),l=s._getCellInfo(a),a.removeClass(r).removeClass(o),l.row<t.value.rows&&l.col<t.value.columns?a.addClass(n):a.removeClass(n)}),s._onValueChange())},_getValue:function(){return this.options.value},_getCellInfo:function(t,i){var o;return o=i===undefined?e(t):this.formElement.find(".row-"+t+" .col-"+i),{row:parseInt(o.attr("_row"),10),col:parseInt(o.attr("_col"),10),old:o.hasClass(n),"new":o.hasClass(r),used:o.hasClass(a)}},_createFormWidget:function(){var a,o,r,s,d,c,h=this,u=h.options;h.formElement=e("<div>").addClass(t).appendTo(this.formEl),a=Math.round(100/u.columns)+"%",o=Math.round(100/u.rows)+"%",c=u.value?u.value.value:{rows:0,columns:0};for(var p=0;u.rows>p;p++){r=e("<ul></ul>").height(o).appendTo(h.formElement),r.addClass("row-"+p);for(var f=0;u.columns>f;f++)s=e("<li>").width(a).appendTo(r),d=e("<div>").addClass(i).appendTo(s),d.addClass("row-"+p).addClass("col-"+f),d.attr("_row",p).attr("_col",f),c.rows>p&&c.columns>f&&d.addClass(n)}h.formElement.unbind().bind("mousemove",function(t){e(t.target).hasClass(i)&&h._onCellHover(t)}).bind("click",function(t){e(t.target).hasClass(i)&&h._onCellClick(t)}).hover(null,function(){h.formElement.find("."+i).removeClass(l)})},_doLayout:function(){this.rendered&&this._super()},_onCellHover:function(t){var a,n,o=e(t.target),r=this,s=r._getCellInfo(o);r.formElement.find("."+i).each(function(t,i){a=e(i),n=r._getCellInfo(a),n.row<=s.row&&n.col<=s.col?a.addClass(l):a.removeClass(l)})},_onCellClick:function(t){var a,l,s=e(t.target),d=this,c=d._getCellInfo(s);d.formElement.find("."+i).each(function(t,i){a=e(i),l=d._getCellInfo(a),l.row<=c.row&&l.col<=c.col&&!a.hasClass(n)?a.addClass(r):a.removeClass(r),(l.row>c.row||l.col>c.col)&&a.hasClass(n)?a.addClass(o):a.removeClass(o)}),d.options.value.value={rows:c.row+1,columns:c.col+1},d._onValueChange()},_onValueChange:function(){var t,i,a,n=this;e.isNull(n.handlers)||e.each(n.handlers,function(o,r){if("change"===o){if(t=n._getValue(),a=t?t.value:{},i=n.oldValue?n.oldValue.value:{},e.isNull(a.rows)&&e.isNull(i.rows))return;(i.rows!==a.rows||i.columns!==a.columns)&&(e.isFunction(r)&&r.call(this,null,t),n.oldValue=e.objClone(t))}})}}),Sweet.form.CellSelect=e.sweet.widgetFormCellSelect}(jQuery),function(e){var t,i="sweet-form-button",a="sweet-form-button-textalign-left",n="sweet-form-button-disabled",o="sweet-form-button-highlight",r="sweet-form-button-highlight-disabled",l="sweet-form-button-formerIma",s="sweet-form-button-formerText",d="sweet-form-button-formerText-image",c="sweet-form-button-menuPanel",h="sweet-form-button-arrow",u="-gray",p=Sweet.constants.operType;imageTypeObj={},imageTypeObj[p.ADD]="sweet-form-button-image-add",imageTypeObj[p.MODIFY]="sweet-form-button-image-modify",imageTypeObj[p.DELETE]="sweet-form-button-image-delete",imageTypeObj[p.MOVE]="sweet-form-button-image-move",imageTypeObj[p.ACTIVE]="sweet-form-button-image-active",imageTypeObj[p.TERMINATE]="sweet-form-button-image-terminate",imageTypeObj[p.SAVEAS]="sweet-form-button-image-saveas",imageTypeObj[p.CONFIRM]="sweet-form-button-image-confirm",imageTypeObj[p.IMPORT]="sweet-form-button-image-import",imageTypeObj[p.EXPORT]="sweet-form-button-image-export",imageTypeObj[p.REFRESH]="sweet-form-button-image-refresh",e.widget("sweet.widgetFormButton",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-button]",defaultElement:"<button>",type:"button",eventNames:{click:"单击事件",menuClick:"按钮菜单击事件"},options:{height:25,width:70,imageType:"",value:{value:"",text:"",data:null},highLight:!1,tip:!1,menu:!1,data:null},setMenuData:function(t){var i=this;e.isNotNull(t)&&i.options.menu&&(i.options.data=t,i.btnMenu&&i.btnMenu.setData(t))},setMenuDisable:function(t){var i=this;e.isNotNull(t)&&i.btnMenu&&i.btnMenu.setDisabled(t)},_doLayout:function(){},_createMenuBtnStyle:function(){var t=this;t.formEl.find("."+h)&&t.formEl.find("."+h).remove(),t.btnDownArrow=e("<span>").addClass(h).appendTo(t.formElement)},_createFormWidget:function(){var e=this,t=e.options;e._createButtonField(),t.menu&&e._createMenuBtnStyle()},_createButtonField:function(){var t=this,i=t.options,n=i.value,o=i.imageType,r=t.formElement=e('<button type="button">').appendTo(t.formEl),c=t.formerTextEl=e("<div class="+s+">");r.bind("click",{me:t},t._onClick),o&&(t.formerImageEl=e('<span style="float:left;">').addClass(l+" "+imageTypeObj[o]).appendTo(r),r.addClass(a),c.addClass(d)),c.html(n.text).appendTo(r),e.isNotNull(i.vID)&&r.attr("id",i.vID),i.tip&&(i.tipText?r.attr("title",i.tipText):r.attr("title",n.text)),e.data(r[0],"value",n)},_closeFloatPanel:function(){var e=this;e.divPanelEl&&(e.divPanelEl.empty().remove(),e.divPanelEl=null)},_onClick:function(i){var a=i.data.me,n=a.options,o=n.click,r=null,l=n.disabled;if(!l){if(r=a._getValue(),n.menu){var s=a.menuId=n.id+"sweet-btnMenu",d=null;t!==s&&(e.isNotNull(t)&&(d=e("#"+t),d.empty().remove(),d.parent("."+c+" "+a.floatBgClass).empty().remove()),t=s),a._createMenuBtnStyle(),a._createMenuCmp(s),a.divPanelEl.show(),a.divPanelEl&&"block"===a.divPanelEl.css("display")&&i.stopPropagation()}o&&e.isFunction(o)&&a._trigger("click",a,r),a._triggerHandler(i,"click",r)}},_createMenuCmp:function(t){var i=this,a=0,n=i.options.height;i.divPanelEl&&(i.divPanelEl.remove(),i.divPanelEl=null),i.divPanelEl=e("<div>").addClass(c+" "+i.floatBgClass).hide().appendTo(i.formEl),i.divFloatPanelEi=e("<div>").appendTo(i.divPanelEl),i.divFloatPanelEi.attr("id",t),i.btnMenu=new Sweet.menu.Menu({renderTo:t,X:a,Y:n,transparent:!1,itemClick:function(e,t){i.selectedMenuData=t,i._triggerHandler(e,"menuClick",i.selectedMenuData)},items:i.options.data})},_setValue:function(t){var i=this,a=i.formElement;t&&(a.html(t.text),e.data(a[0],"value",t),i.options.value=t)},_getValue:function(){var t=this;return e.data(t.formElement[0]).value},_setDisabled:function(e){var t=this,a="",l=t.options,s=t.formElement,d=t.formerImageEl,c=t.options.highLight,p=t.options.imageType,f=imageTypeObj[p];e?(c?s.removeClass(o).addClass(r):s.removeClass(i).addClass(n),l.menu&&t.btnDownArrow&&(a=h+u,t.btnDownArrow.removeClass().addClass(a)),p?d.removeClass(f).addClass(f+u):""):(c?s.removeClass(r).addClass(o):s.removeClass(n).addClass(i),l.menu&&t.btnDownArrow&&(a=h,t.btnDownArrow.removeClass().addClass(a)),p?d.removeClass(f+u).addClass(f):"")},_destroyWidget:function(){var e=this,t=e.formElement;t?t.unbind():""}}),Sweet.form.Button=e.sweet.widgetFormButton}(jQuery),function(e){var t="sweet-form-radioGroupEl",i="sweet-form-autoWid-autoHeight",a="sweet-form-radioGroup-unchecked",n="sweet-form-radioGroup-checked",o="sweet-form-radiobox-li",r="sweet-form-checkbox-labelDiv",l="sweet-form-checkbox-label",s="sweet-form-radio-checked-disabled",d="sweet-form-radio-unchecked-disabled",c=0;e.widget("sweet.widgetFormRadiogroup",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-radioboxgroup]",eventNames:{click:"单击事件",change:"change事件"},options:{averageHeight:!0,data:[],columns:"auto",vertical:!1,padding:5,tip:!1},setData:function(e){this._removeItems(),this.options.data=e,this._createRadioboxGroup(),this._doLayout()},reset:function(){var e=this;e._arrHasObject(e.originalData)||e.setData(e.originalData)},setDisabled:function(t){var i,o,r=this,l=r.options.data,c=r.ulEl.children("li");r.options.disabled=t,r.disabled=t,e.each(l,function(i,a){"object"==typeof a.text&&e.isFunction(a.text.setDisabled)&&"boolean"===e.type(t)&&a.text.setDisabled(t)}),c.each(function(r,l){i=e(l),o=i.children("a"),t?o.hasClass(n)?o.removeClass(n).addClass(s):o.hasClass(a)&&o.removeClass(a).addClass(d):o.hasClass(s)?o.removeClass(s).addClass(n):o.hasClass(d)&&o.removeClass(d).addClass(a)})},_doLayout:function(){var t,i,a,n,o,r,l=this,s=l.options,d=s.data,c=l.ulEl.children("li");l.rendered&&(t=0,n=[],s.averageHeight!==!0?(c.each(function(i,o){r=e(o),a=r.children("div").children("div").height(),a>t&&(t=a),n.push(a)}),20>t&&(t=20),c.height(t+s.padding)):t=c.eq(0).height(),i=c.eq(0).children("a").height(),o=t>i?(t-i)/2:0,c.children("a").css("margin-top",o),c.each(function(i,l){r=e(l),a=n[i]||r.children("div").children("div").height(),o=t>a?(t-a)/2:0,r.children("div").css({"padding-top":o})}),e.each(d,function(t,i){"object"==typeof i.text&&e.isFunction(i.text.doLayout)&&i.text.doLayout()}))},_createFormWidget:function(){var t=this,a=t.options,n=a.data;t.ulEl=e("<ul>").addClass(i).appendTo(t.formEl),t.originalData=n,t._createRadioboxGroup()},_afterRenderFormWidget:function(){this._renderItems()},_renderItems:function(){var t,i,a=this,n=a.options.data,o=a.ulEl.children("li");a.rendered&&e.each(n,function(n,r){if(t=o.eq(n).children("div"),i=t.attr("id"),"object"==typeof r.text)r.text.render(i);else{var s=e("<div>").html(r.text).addClass(l).appendTo(t);a.options.tip&&s.attr("title",r.text)}})},_removeItems:function(){var t,i=this,a=i.options.data;e.each(a,function(t,i){"object"==typeof i.text&&e.isFunction(i.text._destroyDom)&&i.text._destroyDom()}),t=i.ulEl.find("li"),t.remove(),i.dataObj={},i.dataObj.length=0,i.liArrayObj={},i.liArrayObj.length=0},_createRadioboxGroup:function(){var t,i,a,n,o,r=this,l=r.options,s=l.data;1>s.length||(r.dataObj={},r.dataObj.length=0,r.liArrayObj={},r.liArrayObj.length=0,r.haveChecked=null,e.each(s,function(e,t){r._createOneRadiobox(t,e)}),r.haveChecked=null,"number"==typeof l.columns?(i=l.columns,t=parseInt(s.length/i,10),t=i*t===s.length?t:t+1):l.vertical?(i=1,t=s.length):(i=s.length||1,t=1),l.all&&(t+=1),o=this.ulEl.children("li"),l.rows=t,a=Math.floor(100/i)+"%",l.all?o.slice(1).css("width",a):o.css("width",a),l.averageHeight===!0&&(n=Math.floor(100/t)+"%",o.css("height",n)),r._renderItems())},_createOneRadiobox:function(i,l){var s=this,d=e("<li>").addClass(o).appendTo(s.ulEl),h=e("<a>").addClass(t).appendTo(d),u=e("<div>").addClass(r).appendTo(d),p=a,f="sweet-form-checkboxgroup-uiCmp-",g=f+c++;u.attr("id",g),s.dataObj[i.value]={value:i,checked:!1},i.checked&&!s.haveChecked&&(p=n,s.dataObj[i.value]={value:i,checked:i.checked},s.dataObj.length++,s.haveChecked=!0),e.isNotNull(s.options.vID)&&h.attr("id",s.options.vID+"_"+l),h.attr("value",i.value).addClass(p).bind("click",{me:s,obj:h},s._onSingleClick),s.liArrayObj[i.value]=d,s.liArrayObj.length++},_onSingleClick:function(t){var i,a,n=t.data.me,o=t.data.obj;n.oldValue=n.getValue(),n.options.disabled||(n._changImage(o),i=n.getValue(),n._triggerHandler(t,"click",{value:i,checked:a}),e.equals(n.oldValue,i)||n._triggerHandler(t,"change",i))},_changImage:function(e){var t=this;if(!e.hasClass(n))if(e.hasClass(a)){var i=t.ulEl.children("li").children("a."+n);if(i.length>0){var o=i.attr("value");t.dataObj[o].checked=!1,i.removeClass(n).addClass(a)}e.removeClass(a).addClass(n),t.dataObj[e.attr("value")].checked=!0}else t._error("Unsupport type.")},_getValue:function(){var e=this,t=[];for(var i in e.dataObj)"length"!==i&&e.dataObj[i].checked&&t.push(e.dataObj[i].value);return t[0]},_setValue:function(i){var o,r,l,s,d,c=this;if(!(e.isNull(i)||1>i.length||c.options.disabled)){if(c.oldValue=c.getValue(),d=c.ulEl.children("li").children("a."+n),d&&d.length>0){var h=d.attr("value");c.dataObj[h].checked=!1,d.removeClass(n).addClass(a)}for(var u=0;i.length>u;u++)o=i[u],r=c.dataObj[o.value]?c.dataObj[o.value].value:null,r&&(c.liArrayObj[o.value].children("a").removeClass().addClass(t+" "+n),c.dataObj[o.value].checked=!0);if(l=i,s=c.dataObj[l.value]?c.dataObj[l.value].value:null,s&&(c.liArrayObj[l.value].children("a").removeClass(a).addClass(n),c.dataObj[l.value].checked=!0),!c.options.disabled){var p=c.getValue();e.equals(c.oldValue,p)||c._triggerHandler(null,"change",p)}}},_arrHasObject:function(t){var i=!1;return t=t||[],e.each(t,function(e,t){"object"==typeof t.text&&(i=!0)}),i}}),Sweet.form.RadioGroup=e.sweet.widgetFormRadiogroup}(jQuery),function(e){var t="sweet-form-radio",i="sweet-form-radio-label",a="sweet-form-autoWid-autoHeight",n="sweet-form-radiobox-li",o="sweet-form-radio-checked",r="sweet-form-radio-unchecked",l="sweet-form-radio-checked-disabled",s="sweet-form-radio-unchecked-disabled",d="javascript:void(0);";e.widget("sweet.widgetFormRadio",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-radio]",type:"radio",eventNames:{click:"单击事件",change:"change事件"},options:{checked:!1,height:18,width:18,tip:!1},setChecked:function(t){var i=this;return"boolean"!==e.type(t)?(i._error("setChecked() Input parameter is not a Boolean type!"),undefined):(i.options.checked=t,t?i.formElement.removeClass(r).addClass(o):i.formElement.removeClass(o).addClass(r),undefined)
},getChecked:function(){return this.options.checked},_doLayout:function(){var e=this,t=e.options,i=e.labelEl,a=e.formElement,n=e.liEl,o=0,r=0,l=0,s=0,d=0,c=0,h=e.formElement.width();t.value.text&&e.divEl.css("padding-left",h+6),o=i.width(),l=a.width(),r=i.height(),s=a.height(),d=o+l,c=r>s?r:s,n.css("height",c),n.css("min-height",c)},_createFormWidget:function(){var o=this,r=o.options,l=r.value,s=o.ulEl=e("<ul>").addClass(a).appendTo(o.formEl),c=o.liEl=e("<li>").addClass(n).appendTo(s),h=o.formElement=e("<a>").attr("href",d).addClass(t).bind("click",{me:o},o._onclick).appendTo(c),u=o.divEl=e("<div>"),p=o.labelEl=e("<label>").addClass(i);e.isNotNull(r.vID)&&h.attr("id",r.vID),o.setChecked(r.checked),e.data(h[0],"value",l),l.text&&(u.appendTo(c),p.html(l.text).appendTo(u)),r.tip&&p.attr("title",l.text),e.isNotNull(l.text)&&!r.disabled&&o.labelEl.bind("click",{me:o},o._onclick)},_onclick:function(t){var i,a=t.data.me,n=null,r=a.options;r.disabled||(n=a._getValue(),a.formElement.hasClass(o)?a.setChecked(!1):a.setChecked(!0),r.click&&e.isFunction(r.click)&&(i=a._trigger("click",a,r.checked)),i=a._triggerHandler(t,"click",r.checked),"boolean"!==e.type(i)||i||t.stopImmediatePropagation())},_setValue:function(t){var i=this;i.oldValue=i.getValue(),t.text&&(i.divEl.appendTo(i.liEl),i.labelEl.html(t.text).appendTo(i.divEl),e.data(i.formElement[0],"value",t),i.options.value=t),e.equals(i.oldValue,t)||i._triggerHandler(null,"change",i.getValue())},_getValue:function(){var t=this;return t.options.checked?e.data(t.formElement[0]).value:null},_setDisabled:function(e){var t=this,i=t.formElement;e?i.hasClass(o)?i.removeClass(o).addClass(l):i.hasClass(r)&&i.removeClass(r).addClass(s):i.hasClass(l)?i.removeClass(l).addClass(o):i.hasClass(s)&&i.removeClass(s).addClass(r)},_removeListener:function(t){var i=this,a=i.formElement,n=i.options.value;e.isNull(t)?e.each(i.handlers,function(e){a.unbind(e),n.text&&i.labelEl.unbind(e)}):(a.unbind(t),n.text&&i.labelEl.unbind(t))},_destroyWidget:function(){var e=this,t=e.formElement,i=e.labelEl;t?t.unbind():"",i?i.unbind():""}}),Sweet.form.Radio=e.sweet.widgetFormRadio}(jQuery),function(e){var t="sweet-form-checkboxgroup",i="sweet-form-checkbox-unchecked",a="sweet-form-checkbox-checked",n="sweet-form-checkbox-li",o="sweet-form-checkbox-labelDiv",r="sweet-form-checkbox-label",l="sweet-form-autoWid-autoHeight",s="sweet-form-checkbox-unchecked-disabled",d="sweet-form-checkbox-checked-disabled",c=0;e.widget("sweet.widgetFormCheckboxgroup",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-checkboxgroup]",eventNames:{click:"单击事件",change:"change事件"},options:{averageHeight:!0,all:!1,data:[],columns:"auto",vertical:!1,padding:5,tip:!1},setData:function(e){this._removeItems(),this.options.data=e,this._createCheckboxGroup(),this._doLayout()},reset:function(){var e=this;e._arrHasObject(e.originalData)||e.setData(e.originalData)},setDisabled:function(t){var n,o,r=this,l=r.options.data,c=r.ulEl.children("li");r.options.disabled=t,r.disabled=t,e.each(l,function(i,a){"object"==typeof a.text&&e.isFunction(a.text.setDisabled)&&"boolean"===e.type(t)&&a.text.setDisabled(t)}),c.each(function(r,l){n=e(l),o=n.children("a"),t?o.hasClass(a)?o.removeClass(a).addClass(d):o.hasClass(i)&&o.removeClass(i).addClass(s):o.hasClass(d)?o.removeClass(d).addClass(a):o.hasClass(s)&&o.removeClass(s).addClass(i)})},_doLayout:function(){var t,i,a,n,o,r,l=this,s=l.options,d=s.data,c=l.ulEl.children("li");l.rendered&&(t=0,n=[],s.averageHeight!==!0?(c.each(function(i,o){r=e(o),a=r.children("div").children("div").height(),a>t&&(t=a),n.push(a)}),20>t&&(t=20),c.height(t+s.padding)):t=c.eq(0).height(),i=c.eq(0).children("a").height(),o=t>i?(t-i)/2:0,c.children("a").css("margin-top",o),c.each(function(i,l){r=e(l),a=n[i]||r.children("div").children("div").height(),o=t>a?(t-a)/2:0,r.children("div").css({"padding-top":o})}),e.each(d,function(t,i){"object"==typeof i.text&&e.isFunction(i.text.doLayout)&&i.text.doLayout()}))},_createFormWidget:function(){var i,a,s,d,c=this,h=c.options,u=h.data,p=c.ulEl=e("<ul>").addClass(l).appendTo(c.formEl);c.originalData=u,h.all&&(i=c.allEl=e("<li>").addClass(n),a=c.allAEl=e("<a>").addClass(t).appendTo(i),s=e("<div>").addClass(o).appendTo(i),d=e("<div>").addClass(r).appendTo(s),e.isNotNull(h.vID)&&a.attr("id",h.vID+"_"+"all"),a.bind("click",function(t){c._onAllClick(t,e(this))}),d.text(Sweet.core.i18n.combobox.checkAll),i.appendTo(p)),c._createCheckboxGroup(),h.all&&c._setImage(a,c.dataObj.length===c.checkedLength)},_afterRenderFormWidget:function(){this._renderItems()},_renderItems:function(){var t,i,a=this,n=a.options.data,o=a.ulEl.children("li"),l=a.options.all?1:0;a.rendered&&e.each(n,function(n,s){if(t=o.eq(n+l).children("div"),i=t.attr("id"),"object"==typeof s.text)s.text.render(i);else{var d=e("<div>").html(s.text).addClass(r).appendTo(t);a.options.tip&&d.attr("title",s.text)}})},_removeItems:function(){var t,i=this,a=i.options.data;e.each(a,function(t,i){"object"==typeof i.text&&e.isFunction(i.text._destroyDom)&&i.text._destroyDom()}),t=i.ulEl.find("li"),i.options.all&&(t=t.slice(1)),t.remove(),i.dataObj={},i.dataObj.length=0,i.liArrayObj={},i.liArrayObj.length=0},_onAllClick:function(e,t){var i=this,a=!1;i.options.disabled||(a=i._changImage(t),a?(i.checkedLength=i.dataObj.length,i._setDataObj(a)):(i.checkedLength=0,i._setDataObj(a)),i._triggerHandler(e,"click",{value:i.getValue(),checked:a}),i._triggerHandler(e,"change",i.getValue()))},_setDataObj:function(e){var t=this;for(var i in t.dataObj)"length"!==i&&(t.dataObj[i].checked=e,t._setImage(t.liArrayObj[i].children("a"),e))},_createCheckboxGroup:function(){var t,i,a,n,o,r=this,l=r.options,s=l.data;r.checkedLength=0,1>s.length||(r.dataObj={},r.dataObj.length=0,r.liArrayObj={},r.liArrayObj.length=0,e.each(s,function(e,t){r._createOneCheckbox(t,e)}),r.allEl&&r._setImage(r.allAEl,r.dataObj.length===r.checkedLength),"number"==typeof l.columns?(i=l.columns,t=parseInt(s.length/i,10),t=i*t===s.length?t:t+1):l.vertical?(i=1,t=s.length):(i=s.length||1,t=1),l.all&&(t+=1),o=r.ulEl.children("li"),l.rows=t,a=Math.floor(100/i)+"%",l.all?o.slice(1).css("width",a):o.css("width",a),l.averageHeight===!0&&(n=Math.floor(100/t)+"%",o.css("height",n)),r._renderItems())},_createOneCheckbox:function(r,l){var s=this,d=e("<li>").addClass(n).appendTo(s.ulEl),h=e("<a>").addClass(t).appendTo(d),u=e("<div>").addClass(o).appendTo(d),p=i,f="sweet-form-checkboxgroup-uiCmp-",g=f+c++;u.attr("id",g),r.checked&&(p=a,this.checkedLength++),e.isNotNull(s.options.vID)&&h.attr("id",s.options.vID+"_"+l),h.attr("value",r.value).addClass(p).bind("click",{me:s,obj:h},s._onSingleClick),s.dataObj[r.value]={value:r,checked:r.checked},s.dataObj.length++,s.liArrayObj[r.value]=d,s.liArrayObj.length++},_onSingleClick:function(t){var i,a=t.data.me,n=t.data.obj,o=e(t.target).attr("value");a.options.disabled||(i=a._changImage(n),i?(a.dataObj[o].checked=!0,a.checkedLength++):(a.dataObj[o].checked=!1,a.checkedLength--),a.allEl&&a._setImage(a.allAEl,a.dataObj.length===a.checkedLength),a._triggerHandler(t,"click",{value:a.dataObj[o].value,checked:i}),a._triggerHandler(t,"change",a.getValue()))},_setImage:function(e,t){t?e.removeClass(i).addClass(a):e.removeClass(a).addClass(i)},_changImage:function(e){var t=!1;return e.hasClass(a)?e.removeClass(a).addClass(i):e.hasClass(i)?(e.removeClass(i).addClass(a),t=!0):this._error("Unsupport type."),t},_getValue:function(){var e=this,t=[];for(var i in e.dataObj)"length"!==i&&e.dataObj[i].checked&&t.push(e.dataObj[i].value);return t},_setValue:function(n){var o,r,l=this;if(n&&!(1>n.length)){l.checkedLength=0,l.oldValue=l.getValue(),l.ulEl.children("li").children("a").removeClass().addClass(t).addClass(i);for(var s in l.dataObj)"length"!==s&&(l.dataObj[s].checked=!1);for(var d=0;n.length>d;d++)o=n[d],r=l.dataObj[o.value]?l.dataObj[o.value].value:null,r&&(l.liArrayObj[o.value].children("a").removeClass().addClass(t).addClass(a),l.dataObj[o.value].checked=!0,l.checkedLength++);l.allEl&&l._setImage(l.allAEl,l.dataObj.length===l.checkedLength),e.equals(l.oldValue,n)||l._triggerHandler(null,"change",l.getValue())}},_arrHasObject:function(t){var i=!1;return t=t||[],e.each(t,function(e,t){"object"==typeof t.text&&(i=!0)}),i}}),Sweet.form.CheckboxGroup=e.sweet.widgetFormCheckboxgroup}(jQuery),function(e){var t="sweet-form-checkbox",i="sweet-form-checkbox-label",a="sweet-form-checkbox-li",n="sweet-form-autoWid-autoHeight",o="sweet-form-checkbox-unchecked",r="sweet-form-checkbox-checked",l="sweet-form-checkbox-unchecked-disabled",s="sweet-form-checkbox-checked-disabled",d="sweet-form-checkbox-labelDiv",c="javascript:void(0);";e.widget("sweet.widgetFormCheckbox",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-checkbox]",defaultElement:"<a>",type:"checkbox",eventNames:{click:"单击事件",change:"change事件"},options:{checked:!1,height:18,width:18,tip:!1},setChecked:function(e){var t=this;return"boolean"!=typeof e?(t._error("setChecked() Input parameter is not a Boolean type!"),undefined):(t.options.checked=e,e?t.formElement.removeClass(o).addClass(r):t.formElement.removeClass(r).addClass(o),undefined)},isChecked:function(){return this.options.checked},_doLayout:function(){var e=this;if(e.rendered){e._checkBoxSize===undefined&&(e._checkBoxSize={width:e.formElement.externalWidth(),height:e.formElement.externalHeight()});var t=e.formEl.height();if(e._formElHeight===undefined)e._formElHeight=t;else if(e._formElHeight===t)return;var i=Math.floor((t-e._checkBoxSize.height)/2);e.formElement.css({"margin-top":i}),e.divEl.css({"line-height":e._formElHeight+"px"})}},_createFormWidget:function(){var o=this,r=o.options,l=o.ulEl=e("<ul>").addClass(n).appendTo(o.formEl),s=o.liEl=e("<li>").addClass(a).appendTo(l),h=o.formElement=e("<a>").attr("href",c).addClass(t).bind("click",{me:o},o._onClick).appendTo(s),u=o.divEl=e("<div>").addClass(d),p=o.labelEl=e("<label>").addClass(i);e.isNotNull(r.vID)&&h.attr("id",r.vID),o.setChecked(r.checked),e.data(h[0],"value",r.value),r.value.text&&(u.appendTo(s),p.html(r.value.text).appendTo(u)),r.tip&&p.attr("title",r.value.text),r.value.text&&!r.disabled&&o.labelEl.bind("click",{me:o},o._onClick)},_onClick:function(t){var i,a=t.data.me,n=a.options,o=null;n.disabled||(o=a._getValue(),a.formElement.hasClass(r)?a.setChecked(!1):a.setChecked(!0),n.click&&e.isFunction(n.click)&&(i=a._trigger("click",a,n.checked)),i=a._triggerHandler(t,"click",n.checked),"boolean"!==e.type(i)||i||t.stopImmediatePropagation())},_setValue:function(t){var i=this;i.oldValue=i.getValue(),t.text&&(i.divEl.appendTo(i.liEl),i.labelEl.html(t.text).appendTo(i.divEl),e.data(i.formElement[0],"value",t),i.options.value=t),e.equals(i.oldValue,t)||i._triggerHandler(null,"change",i.getValue())},_getValue:function(){var t=this;return t.options.checked?e.data(t.formElement[0]).value:null},_setDisabled:function(e){var t=this,i=t.formElement;e?i.hasClass(r)?i.removeClass(r).addClass(s):i.hasClass(o)&&i.removeClass(o).addClass(l):i.hasClass(s)?i.removeClass(s).addClass(r):i.hasClass(l)&&i.removeClass(l).addClass(o)},_removeListener:function(t){var i=this,a=i.formElement,n=i.options.value;e.isNull(t)?e.each(i.handlers,function(e){a.unbind(e),n.text&&i.labelEl.unbind(e)}):(a.unbind(t),n.text&&i.labelEl.unbind(t))},_destroyWidget:function(){var e=this,t=e.formElement,i=e.labelEl;t?t.unbind():"",i?i.unbind():""}}),Sweet.form.CheckBox=e.sweet.widgetFormCheckbox}(jQuery),function(e,t){var i="sweet-form-labelfield",a="sweet-form-labelfield-border",n="sweet-form-content",o="sweet-form-labelfield-label",r="sweet-form-colon";e.widget("sweet.widgetFormLabelfield",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-labelfield]",defaultElement:"<div>",options:{label:!1,labelText:null,labelWidth:.3,height:25,type:1,tip:!1},_createFormWidget:function(){var e=this,t=this.options;e._createLabel(),e._createLabelField(),e._setValue(t.value)},_createLabel:function(){if(this.options.label){var t=this,i=t.options,a=i.labelText,n=e.isNull(a)?"":"&nbsp;&nbsp;&nbsp;"+e.htmlEscape(a)+Sweet.constants.symbol.COLON;t.label=e("<label>").addClass(o).html(n).attr("title",a).appendTo(t.formEl),t.labelColon=e("<label>").addClass(r).text(Sweet.constants.symbol.COLON).appendTo(t.formEl)}},_createLabelField:function(){var o=this,r=o.options,l=e.nullToString(r.value),s=l&&l.text?l.text:"",d="",c=o.formDiv1El=e("<div>").addClass(n).appendTo(o.formEl),h=o.formDiv2El=e("<div>").addClass(i).appendTo(c).addClass(1===r.type?a:"");d=l&&t!==l.qtip&&null!==l.qtip?l.qtip:s,o.formElement=e("<div>").html(s).val(s).appendTo(h).attr("title",r.tip?d:""),e.isNotNull(r.vID)&&o.formElement.attr("id",r.vID)},_setValue:function(i){var a=this,n=a.options,i=e.nullToString(i),o=i&&i.text?i.text:"",r="";r=i&&t!==i.qtip&&null!==i.qtip?i.qtip:o,a.formElement.html(o).val(o).attr("title",n.tip?r:"")},_doLayout:function(){var e=this,t=e.formEl.width(),i=e._doLabelLayout(t),a=e.label,n=e.labelColon;if(a){var o=parseInt(a.css("width")),r=parseInt(n.css("width"));i-r/2>o?n.hide():(n.show(),a.css("overflow","hidden").css("text-overflow","ellipsis")),a.css("width",i-r)}e.formDiv1El.css("left",i)},_doLabelLayout:function(e){var t=this,i=t.options,a=i.labelWidth;return a=1>a?Math.floor(e*a):a,a=t.label?a:0},_destroyWidget:function(){var e=this;e.formElement.trigger("mouseout"),e.label&&e.label.trigger("mouseout")}}),Sweet.form.LabelField=e.sweet.widgetFormLabelfield}(jQuery),function(e){var t={},i=Sweet.constants.imgType,a="sweet-form-labelItem-listbox",n="sweet-form-labelItem-listbox_newadd",o="sweet-form-labelItem-formEl",r="sweet-form-labelItem-listbox-deleteImg";t[i.INDEX]="sweet-form-labelItem-table_ope_kpi_pic",t[i.DIM]="sweet-form-labelItem-table_ope_dim_pic",t[i.CUSTOM_INDEX]="sweet-form-labelItem-table_ope_userkpi_pic",e.widget("sweet.widgetFormLabelItem",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-labelItem]",type:"labelItem",eventNames:{close:"删除事件"},options:{height:25,width:70,imageType:"",imagePos:"left",closable:!0,tip:!1,value:{value:"",text:"",data:null}},addIndex:function(){var e=this,a=e.formDiv2El,o=e.formerImageEl,r=t[i.INDEX];a.hasClass(n)||a.removeClass().addClass(n),o.hasClass(r)||o.removeClass().addClass(r)},setTip:function(e){var t=this,i=t.options,a=t.formElement;e^i.tip&&(e?(a.attr("title",i.value.text),i.tip=!0):(a.trigger("mouseout"),a.removeAttr("title"),i.tip=!1))},_createFormWidget:function(){var i=this,n=i.options,l=e.nullToString(n.value),s=l&&l.text?l.text:"",d=t[n.imageType]||"",c=i.formDiv1El=e("<div>").addClass(o).appendTo(i.formEl),h=i.formDiv2El=e("<div>").addClass(a).css("text-align",d?"left":"center").appendTo(c);i.formElement=e("<em>").html(s).val(s).attr("title",n.tip?s:"").appendTo(h),e.isNotNull(n.vID)&&i.formElement.attr("id",n.vID),d&&(i.formerImageEl=e("<span>").addClass(d).css("float",n.imagePos).appendTo(h)),n.closable&&(i.afterImageEl=e("<a>").bind("click",{me:i},i._clickDeleteImg).addClass(r).appendTo(i.formDiv2El))},_clickDeleteImg:function(e){var t=e.data.me,i=t._getValue();t._triggerHandler(e,"close",i),t._trigger("close",e,i),t.destroy()},_setValue:function(t){if(!e.isNull(t)){var i=this,a=i.options,n=e.isNull(t.text)?"":t.text;i.formElement.html(n).val(n).attr("title",a.tip?n:"")}},_destroyWidget:function(){var e=this;e.afterImageEl.unbind("click"),e.formElement.trigger("mouseout")}}),Sweet.form.LabelItem=e.sweet.widgetFormLabelItem}(jQuery),function(e){var t="sweet-form-label",i="sweet-form-label-pic",a={},n={},o={},r={},l={},s=Sweet.constants.operType,d=Sweet.constants.align,c="sweet-form-label-textSpan";n[s.PLUS]="sweet-form-label-plus-gray",n[s.MINUS]="sweet-form-label-minus-gray",n[s.SETTING]="sweet-form-label-setting-gray",n[s.DELETE]="sweet-form-label-delete-gray",a[s.SETTING_STYLE1]="sweet-form-label-setting-style1",a[s.PLUS]="sweet-form-label-pic-plus",a[s.MINUS]="sweet-form-label-pic-minus",a[s.SETTING]="sweet-form-label-pic-setting",a[s.DELETE]="sweet-form-label-pic-delete",a[s.IMPORT]="sweet-form-label-pic-import",a[s.SAVEAS]="sweet-form-label-pic-save",a[s.CRITICAL]="sweet-form-label-pic-critical",a[s.MAJOR]="sweet-form-label-pic-major",a[s.MINOR]="sweet-form-label-pic-minor",a[s.WARNING]="sweet-form-label-pic-warning",a[s.WARNING_R]="sweet-form-label-pic-warning-r",a[s.CRITICAL_R]="sweet-form-label-pic-critical-r",a[s.CUSTOM_1]="sweet-form-label-pic-custom_1",a[s.CUSTOM_2]="sweet-form-label-pic-custom_2",a[s.CUSTOM_3]="sweet-form-label-pic-custom_3",a[s.CUSTOM_4]="sweet-form-label-pic-custom_4",a[s.CUSTOM_5]="sweet-form-label-pic-custom_5",a[s.CUSTOM_6]="sweet-form-label-pic-custom_6",a[s.CUSTOM_7]="sweet-form-label-pic-custom_7",a[s.FOLDER]="sweet-form-label-pic-folder",a[s.CATEGORY]="sweet-form-label-pic-category",a[s.VIEW]="sweet-form-label-pic-view",a[s.FAVORITE_ADD]="sweet-form-label-pic-favorite-add",a[s.FAVORITE_REMOVE]="sweet-form-label-pic-favorite-remove",a[s.LAYOUT]="sweet-form-label-pic-layout",a[s.DASHBOARD]="sweet-form-label-pic-dashboard",a[s.DASHBOARD_SETTING]="sweet-form-label-pic-dashboard-setting",a[s.EDIT]="sweet-form-label-pic-edit",a[s.ENTER_FULLSCREEN]="sweet-form-label-pic-enter-fullscreen",a[s.EXIT_FULLSCREEN]="sweet-form-label-pic-exit-fullscreen",a[s.LOCK]="sweet-form-label-pic-lock",a[s.UNLOCK]="sweet-form-label-pic-unlock",a[s.EXPORT]="sweet-form-label-pic-export",a[s.PRINT]="sweet-form-label-pic-print",a[s.ADD]="sweet-form-label-pic-add",a[s.RESET]="sweet-form-label-pic-reset",a[s.ADDNODE]="sweet-form-label-pic-addnode",a[s.ADDCHILDREN]="sweet-form-label-pic-addchildren",o[s.PLUS]=Sweet.core.i18n.labelImage.plus,o[s.ADD]=Sweet.core.i18n.labelImage.add,o[s.RESET]=Sweet.core.i18n.labelImage.reset,o[s.MINUS]=Sweet.core.i18n.labelImage.minus,o[s.SETTING]=Sweet.core.i18n.labelImage.setting,o[s.DELETE]=Sweet.core.i18n.labelImage.delete,o[s.IMPORT]=Sweet.core.i18n.labelImage.import,o[s.SAVEAS]=Sweet.core.i18n.labelImage.save,o[s.LOCK]=Sweet.core.i18n.labelImage.lock,o[s.UNLOCK]=Sweet.core.i18n.labelImage.unlock,o[s.EXPORT]=Sweet.core.i18n.labelImage.export,o[s.PRINT]=Sweet.core.i18n.labelImage.print,r[d.RIGHT]="sweet-form-label-right",r[d.CENTER]="sweet-form-label-center",l[s.CRITICAL]=!0,l[s.MAJOR]=!0,l[s.MINOR]=!0,l[s.WARNING]=!0,l[s.WARNING_R]=!0,l[s.CRITICAL_R]=!0,l[s.CUSTOM_1]=!0,l[s.CUSTOM_2]=!0,l[s.CUSTOM_3]=!0,l[s.CUSTOM_4]=!0,l[s.CUSTOM_5]=!0,l[s.CUSTOM_6]=!0,l[s.CUSTOM_7]=!0,l[s.FOLDER]=!0,l[s.CATEGORY]=!0,l[s.VIEW]=!0,l[s.FAVORITE_ADD]=!0,l[s.FAVORITE_REMOVE]=!0,l[s.LAYOUT]=!0,l[s.DASHBOARD]=!0,l[s.DASHBOARD_SETTING]=!0,l[s.EDIT]=!0,l[s.ENTER_FULLSCREEN]=!0,l[s.EXIT_FULLSCREEN]=!0,e.widget("sweet.widgetFormLabelImage",e.sweet.widgetForm,{version:"1.0",sweetWidgetName:"[widget-form-label-image]",defaultElement:"<label>",eventNames:{click:"单击事件"},options:{width:19,height:25,align:Sweet.constants.align.LEFT,imageType:null,imageTip:null,value:{text:"",value:"",data:null},imageBgColor:{bgColor:""}},_setValue:function(e){var t=this,i=t.options,a=i.imageType,n=l[a];t.formElement.data("data",e),n&&t.textSpanEl.html(e.text)},_getValue:function(){return this.formElement.data("data")},setBgColor:function(t){for(var i=this,a=i.options,n=a.imageType,o=["critical","major","minor","warning","custom_1","custom_2","custom_3","custom_4","custom_5","custom_6","custom_7"],r=0;o.length>r;r++){var l=".sweet-form-label-pic-"+n;if(n===o[r]){var s="none repeat scroll 0 0 "+t.bgColor;e(l).css("background",s)}}},_createFormWidget:function(){var n=this,s=n.options,d=s.imageType,h=a[d]||"",u=o[d]||"",p=s.imageTip||u,f=s.align,g=r[f],m=l[d],v=s.value||{},w=v.text,_=n.formParentEl=e("<div>").addClass(t+" "+g).appendTo(n.formEl);n.formElement=e("<span>").addClass(i+" "+h).attr("title",p).data("data",v).bind("click",{me:n},n._onClick).appendTo(_),e.isNotNull(s.vID)&&n.formElement.attr("id",s.vID),m&&(n.textSpanEl=e("<span>").addClass(c).html(w).appendTo(_))},_onClick:function(e){var t=e.data.me;if(!t.options.disabled){var i=t._getValue();t._trigger("click",e,i),t._triggerHandler(e,"click",i)}},_setDisabled:function(t){var i=this;if("boolean"!==e.type(t))return i._error("_setDisabled() Unsupport parameter disabled. Not true or false. disabled="+t),undefined;var o=i.formElement,r=i.options.imageType,s=a[r]||"",d=n[r]||"",c=l[r];c||(t?(o.removeClass(s).addClass(d),i.options.disabled=!0):(o.removeClass(d).addClass(s),i.options.disabled=!1))},_destroyWidget:function(){var e=this;e.formElement.unbind("click"),e.formElement.trigger("mouseout")}}),Sweet.form.LabelImage=e.sweet.widgetFormLabelImage}(jQuery),function(e){var t="sweet-form-button",i="sweet-form-fileupload-div",a="sweet-form-fileupload-button",n="sweet-form-fileupload-input-width",o="sweet-form-fileupload-input",r="sweet-form-fileupload-iframe",l="-fileUpload",s="-sweetFileloadFormDiv",d="beforeUpload",c="afterUpload";e.widget("sweet.widgetFormFileUploadfield",e.sweet.widgetFormTextfield,{version:"1.0",sweetWidgetName:"[widget-form-fileuploadfield]",type:"text",eventNames:{beforeUpload:"上传前事件",afterUpload:"上传后触发"},options:{url:""},submit:function(){var t,i=this;t=i._triggerHandler(i,d),!1!==t&&"false"!==t&&i.validate()&&(i.submitEl.click(),Sweet.Task.Timeout.start({id:i._uploadTaskId,run:function(){var t=i._getIframeContentEl().html();e.isNotNull(t)&&(Sweet.Task.Timeout.stop(i._uploadTaskId),Sweet.Task.Delay.start({id:"submitgetdata",run:function(){t=i._getIframeContentEl().html(),i._triggerHandler(null,c,t)},delay:200}))},interval:100}))},clear:function(){var e=this;e.uploadEl.val(""),e.formElement.val(""),e.closeTip()},setUrl:function(t){var i=this,a=i.options.id+s;e.isNotNull(t)&&t!==i.options.url&&(i.options.url=t,e("#"+a).attr("action",i.options.url))},_doLayout:function(){this._super()},_setValue:function(e){var t=this;e&&e.value&&t.formElement.val(e.value)},_getValue:function(){var e=this,t=e.formElement.val();return{value:t,text:t}},_getIframeContentEl:function(){return e(this.iframeEl[0].contentWindow.document.body)},_afterCreateFormWidget:function(){var d=this,c=d.options,h=c.id+l,u=e("<input type='file' name='"+c.id+"-file' size='1'>"),p=e("<input type='button'>"),f=c.id+s;d._uploadTaskId=c.id+"-upload-task",d.uploadEl=u.bind("change",function(){var t=e(this).val();if(!e.isNull(t)){var i=t.lastIndexOf("\\");-1!==i&&(t=t.slice(i+1)),d.formElement.val(t),d._getIframeContentEl().text(""),d.validate()}}),d.formEl.addClass(i),d.formSubmitEl=e("<form id='"+f+"' method='post' enctype='multipart/form-data' action='"+c.url+"'"+"target='"+h+"'>"),d.formDiv2El.wrap(d.formSubmitEl).addClass(n),u.insertAfter(d.formDiv2El).addClass(o),p.attr("value",Sweet.core.i18n.fileUpload.browse+"...").insertAfter(u).addClass(t+" "+a),d.submitEl=e("<input type='submit'>").insertAfter(u),d.iframeEl=e('<iframe id="'+h+'" name="'+h+'" class="'+r+'">').insertAfter(u)},getFileSize:function(){var t,i=this,a=0;if(!i.uploadEl||!i.formSubmitEl)return a;try{e.isFirefox()||e.isChrome()?a=i.uploadEl.get(0).files[0].size:e.isIE()&&(t=e("<img dynsrc='' src=''>").css("display","none").appendTo(i.formSubmitEl),t.get(0).dynsrc=i.uploadEl.val(),a=t.get(0).fileSize,t.remove())}catch(n){t&&t.remove()}return a}}),Sweet.form.FileUpLoadField=e.sweet.widgetFormFileUploadfield}(jQuery),function(e){var t="sweet-form-colorpicker-textButtonDiv",i="sweet-form-colorpicker-inputParent",a="sweet-form-colorpicker-normal",n="sweet-form-colorpicker-gray",o="sweet-form-colorpicker-imageButton",r="sweet-form-colorpicker-input",l="sweet-form-timeschedule-textGray",s="sweet-form-colorpicker-panel",d="sweet-form-colorpicker-ul",c="sweet-form-colorpicker-li",h="sweet-form-colorpicker-cell";e.widget("sweet.widgetColorPicker",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-colorpicker]",type:"colorpicker",defaultElement:"<div>",eventNames:{change:"改变值事件"},options:{width:80,height:25,editable:!1,value:null,colorSource:[["#00c90d","#369cd8","#1099a2","#cf7a37","#7c3ac1"],["#90cc19","#60b2df","#38abb3","#f2a14e","#be53be"],["#b7e042","#7ec8eb","#51c4cc","#ebb36e","#c870c8"],["#c7ea69","#9ebecd","#6bd6dd","#debb91","#ce89ce"]],emptyText:Sweet.core.i18n.combobox.pleaseCheck},_setDisabled:function(t){var i=this;t?i.formElement&&(i.formElement.addClass(l),i.formDiv2El.removeClass(a).addClass(n),i.imageButton.removeClass(a).addClass(n).addClass(l),e.isNotNull(i.options.value)?i._setEmptyText(!0):i._setEmptyText()):i.formElement&&(i.formElement.removeClass(l),i.formDiv2El.removeClass(n).addClass(a),i.imageButton.removeClass(l).removeClass(n).addClass(a),e.isNotNull(i.options.value)?i._setEmptyText(!0):i._setEmptyText())},_setValue:function(t){if(this.formElement){var i,a,n=this;i=n.formElement.css("background-color"),n.oldValue=n._getHexColorValue(i),e.isNotNull(t)&&e.isNotNull(t.value)?(n.oldValue!==t.value&&(a=t.value,n.formElement.css({"background-color":a}),n.options.value=t,n._triggerHandler(null,"change",n._getValue()),n.oldValue=a),n._setEmptyText(!0)):(n.formElement.css("background-color",""),n._setEmptyText())}},setColorRange:function(t){if(this.formElement)for(var i=this,a={rows:4,columns:5},n=0;a.rows>n;n++)for(var o=0;a.columns>o;o++){var r="#"+i.options.id+n+o;e(r).css({background:t.valueRangeColor[n][o]})}},_getValue:function(){return this.options.value},_closeFloatPanel:function(){var t=this;!t.openPanelElFlag&&e.isVisiable(t.divPanelEl)&&t.divPanelEl.hide(),t.openPanelElFlag=!1},_createInputField:function(){var e=this;e._createColorPickerPanel(),e._createTextField()},_createTextField:function(){var a=this,n=a.textButtonDiv=e("<div>").addClass(t).appendTo(a.formDiv1El),l=a.formDiv2El=e("<div>").addClass(i).appendTo(n);a.formElement=e("<input>").addClass(r).appendTo(l),e.isNotNull(a.options.vID)&&a.formElement.attr("id",a.options.vID),a.imageButton=e("<span>").text("···").addClass(o).appendTo(n)},_createColorPickerPanel:function(){for(var t,i,a,n=this,o={rows:4,columns:5},r=n.divPanelEl=e("<div>").addClass(s+" "+n.floatBgClass).hide().appendTo("body"),l=0;o.rows>l;l++){t=e("<ul></ul>").addClass(d).appendTo(r);for(var u=0;o.columns>u;u++){var p=n.options.id+l+u;i=e("<li>").addClass(c).appendTo(t),a=e("<div>").addClass(h).attr("id",p).appendTo(i),a.css({background:n.options.colorSource[l][u]})}}n.divPanelEl.bind("click",function(t){e.isVisiable(n.divPanelEl)&&t.stopImmediatePropagation(),e(t.target).hasClass(h)&&n._onCellClick(t)})},_onCellClick:function(t){var i,a,n,o=this,r=o.options.value;i=e(t.target)[0],a=i.style.backgroundColor,n=o._getHexColorValue(a),o.options.value=e.isNotNull(r)?e.isNotNull(r.data)?{value:n,text:r.text,data:r.data}:{value:n,text:r.text}:{value:n,text:""},o._setValue(o.options.value),o._setEmptyText(!0),o._closeFloatPanel()},_getHexColorValue:function(t){var i=t.split(","),a=i[0].split("("),n=a[1],o=i[1],r=i[2],l="";return l="#"+e.number.toHex(n)+e.number.toHex(o)+e.number.toHex(r)},_afterCreateSweetWidget:function(){var t,i,a=this,o=a.options;a.setEditable(o.editable),a.setDisabled(o.disabled),a.imageButton&&a.imageButton.bind("click",function(){a.imageButton.hasClass(n)||a.divPanelEl&&e.isVisiable(a.divPanelEl)||(a.openPanelElFlag=!0,t=e.getFloatOffset(a.formDiv1El,a.divPanelEl,!0).left,i=e.getFloatOffset(a.formDiv2El,a.divPanelEl).top,a.divPanelEl.css({left:t,display:"block"}).css("top",i-1))})},_destroyWidget:function(){var e=this;e._super(),e.divPanelEl?e.divPanelEl.remove():"",e.divPanelEl?e.divPanelEl.unbind():"",e.imageButton?e.imageButton.unbind():""}}),Sweet.form.ColorPicker=e.sweet.widgetColorPicker}(jQuery),function(e,t){var i="sweet-form-checkbox-unchecked",a="sweet-form-checkbox-checked",n="sweet-select-none",o="select-column",r="multi-sort",l="second-stat",s="clear-filter",d="export",c="csv",h="xls",u="pdf",p="exportC",f="li-csv",g="li-xls",m="li-pdf",v="li-exportC",w="sweet-grid-checkbox",_="sweet-grid-header-table-td",C="sweet-grid-header-table-td-common",b="sweet-grid-header-table-td-common-hover",E="sweet-grid-header-sort-asc",y="sweet-grid-header-sort-desc",x="sweet-grid-resize-drag",T="sweet-grid-resize-down",D="text",S="text-hover",k="sweet-grid-header-filter",L="sweet-grid-header-filter-pic",N="sweet-list-list-con",I="sweet-grid-header-filter-pad",A="filter-one",P="filter-two",M="-grid-filter",F="-grid-filter-btn",W="sweet-grid-sn",B="sweet-grid-content-menu",O="sweet-grid-content-table",R="sweet-grid-content-tr",H="sweet-grid-content-data-left",j="sweet-grid-content-data-right",z="sweet-grid-content-data-center",V="sweet-grid-content-row-selected",U="sweet-grid-content-td-tree",G="sweet-grid-content-td-tree-a",Y="sweet-grid-content-td-plus",q="sweet-grid-content-td-minus",$="sweet-grid-content-td-space",K="sweet-common-opercolumn-edit",X="sweet-common-opercolumn-modify",Q="sweet-common-opercolumn-delete",Z="sweet-common-opercolumn-close",J="sweet-common-opercolumn-pause",et="sweet-common-opercolumn-start",tt="sweet-common-opercolumn-reset",it="sweet-common-opercolumn-detail",at="sweet-common-opercolumn-confirm",nt="sweet-grid-paging",ot="sweet-grid-paging-inner",rt="sweet-grid-paging-dropDown",lt="sweet-grid-paging-prev",st="sweet-grid-paging-num",dt="sweet-grid-paging-next",ct="sweet-grid-paging-go",ht="current",ut="choosed",pt="sweet-grid-select-column-win",ft="sweet-grid-select-column-win-panel",gt="sweet-grid-select-column-win-row",mt="sweet-grid-select-column-win-allRow",vt="sweet-grid-select-column-win-check-wrap",wt="sweet-grid-select-column-win-check-wrap-end",_t="sweet-form-checkbox-unchecked",Ct="sweet-form-checkbox-checked",bt=["row","page"],Et=["left","right"],yt=5,xt=30,Tt=Sweet.core.i18n.grid,Dt=Sweet.core.i18n.exportType,St=Sweet.constants.dataType,kt=Sweet.constants.symbol,Lt=Sweet.constants.exportType,Nt="pageClick",It="cellClick",At="rowClick",Pt="rowDblClick",Mt="checkBoxClick",Ft="treeExpand",Wt="expanded",Bt="treeCollapse",Ot="beforeSetData",Rt="afterSetData",Ht="export",jt="sweet-grid-content-timer",zt={red:"red",orange:"orange",yellow:"yellow",green:"green",blue:"blue",indigo:"indigo",purple:"purple"},Vt=80,Ut=23,Gt=35,Yt=18,qt=19,$t=40,Kt=200,Xt=120,Qt=-1,Zt=1;e.widget("sweet.widgetGrid",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-grid]",defaultElement:"<div>",type:"grid",eventNames:{foldclick:"每一行前面的箭头的点击事件",pageClick:"翻页事件",cellClick:"单元格点击事件",rowClick:"行点击事件",rowDblClick:"行双击事件",treeExpand:"树节点展开事件",expanded:"树节点展开事件,第一次展开后的事件",treeCollapse:"树节点折叠事件",checkBoxClick:"复选框点击事件",menuClick:"菜单点击事件",beforeSetData:"setData前触发事件",afterSetData:"setData后触发事件","export":"导出事件",sort:"排序事件",filter:"过滤事件",multiOrders:"多列排序事件",clearAllFilters:"清除所有过滤的事件",clearAllOrders:"清除所有排序的事件"},options:{width:600,height:200,store:null,data:{},autoColumnWidth:!0,contentDescriptionFunc:null,scrollCallBack:e.noop,beforeSetData:null,beforeOKFilter:null,afterShowFilter:null},setSecondaryStatConfig:function(e){var t=this;t.options.data&&t.options.data.secondaryStat&&(t.options.data.statParams=e)},setData:function(i,a,n){if(!e.isNull(i)){var o=this,r=o.options;o.contentEl&&(o.gridScrollLeft=o.contentEl.scrollLeft(),o.gridScrollTop=o.contentEl.scrollTop()),o._triggerHandler(null,Ot,i),r.beforeSetData&&e.isFunction(r.beforeSetData)&&(i=r.beforeSetData(i),o.onlyUpdateHeader=i.onlyUpdateHeader);var l=1;n&&o.page&&(l=o.page.currentPage);var s=0,d=r.data.data?r.data.data.length:0;if(e.isArray(i)?(r.data=e.extend({},r.data,{data:i}),s=i.length):(r.data.data=[],i.columns&&(r.data.columns=[]),r.data=e.extend(!0,{},r.data,i),o.page=e.extend(!0,o.page,i.page),s=i.data?i.data.length:0),n&&o.options.data.page&&o.page&&!(0!=s&&parseInt(o.page.size,10)>=d))return o.options.data.page.currentPage=l,o.page.currentPage=l,o._createGridPagingBar(!0),o.pagingEl&&o.pagingEl.width(o.gridEl.width()),o._triggerHandler(null,Rt),t;o._createGridWidget(),o._render(r.renderTo),o._doLayout()}},setTreeData:function(t){var i=this,a=t;e.isArray(t)||(a=t.data),i.tempTreeData=i._toJson(a).reverse(),i.tempTreeDataIndex=0,i.treeData=i.treeData.concat(i.tempTreeData),i._addRowId(i.treeData),i.timerGridTreeContent=i.options.id+"-tree-"+jt,Sweet.Task.Timeout.start({id:i.timerGridTreeContent,run:i._buildGridTreeContent,scope:i,interval:10})},getRowValue:function(i){if("number"!==e.type(i))return this._error("getRowValue() The input parameter is not a number."),t;
var a=this,n=a.data;return e.isNull(i)?e.objClone(n):0>i||n&&i>n.length?t:e.objClone(n[i])},getSelectedValue:function(){function t(t){if(e.isNull(t))return[];var i=[];return e.each(t,function(e,t){i.push(t)}),i}var i=this,a=t(i.selectedData),n=t(i.selectedTreeData);return e.objClone(a.concat(n))},insertRows:function(i,a){if(e.isNull(i))return this._error("insertRows() The input data is null."),t;var n=this,o=e.objClone(i);a=a||!0,e.isArray(o)||(o=[o]),n._buildInsertGridContent(o,a)},updateRows:function(i){var a,n,o,r=this,l=i;if(e.isNull(i))return r._error("updateRows() The input data is null."),t;for(e.isArray(i)||(l=[i]),n=l.length,a=0;n>a;a++)o=l[a],r._updateRows(o.row,o.data)},selectRows:function(n){if(e.isNull(n))return this._error("selectRows() The input param is null."),t;var o,r=this;o=e.isArray(n)?n:[n],r._allRowUnSelect(),e(n).each(function(t,n){var o,l,s=r.__findTargetTr(n),d=s.trEl;d&&(d.addClass(V),o=d.find("."+w),o&&o.length>0&&(l=e(o.find("a")).removeClass(i).addClass(a),r._oneRowSelect(l.attr("row"),l.attr("tree"))),r._onTrClick({data:{me:r,tr:d,eventName:At}}))})},selectPrev:function(){var t,i,a=this;return a.hasPrev()&&(t=a._getSelectedFirstRow(),i=t.length>0?e.string.toNumber(e(t).attr("row"))-1:a.contentTableEl.find("tr").length,a.selectRows(i)),a.getSelectedValue()},hasPrev:function(){var t,i=this,a=i.contentTableEl.find("tr").length;return 0===a?!1:(t=i._getSelectedFirstRow(),t.length>0?e.string.toNumber(e(t).attr("row"))>1:!0)},selectNext:function(){var t,i,a=this;return a.hasNext()&&(t=a._getSelectedLastRow(),i=t.length>0?e.string.toNumber(e(t).attr("row"))+1:1,a.selectRows(i)),a.getSelectedValue()},hasNext:function(){var t,i=this,a=i.contentTableEl.find("tr").length;return 0===a?!1:(t=i._getSelectedLastRow(),t.length>0?a>e.string.toNumber(e(t).attr("row")):!0)},clearAllFilters:function(t){var i=this;i.filters={},e.each(i.filterObjs,function(e,t){if(t&&t.filter&&t.filter.reset(),t&&t.tdEl){var i=t.tdEl.find("."+L);i&&i.remove()}}),i.page&&(i.page.currentPage=1),i.options.store&&(i.options.store.clearFilters&&i.options.store.clearFilters(),t&&(i.options.store.setDataPage&&i.options.store.setDataPage(i.getPageInfo()),i.options.store.load(i.getAllConditions()))),i._triggerHandler(null,"clearAllFilters",i.getAllConditions())},clearAllOrders:function(t){var i=this;i.orders=[],e.each(i.headerTdEls,function(e,t){t&&(t.removeClass(b+" "+E+" "+y).addClass(C),t.find("div:first").removeClass(S))}),i.page&&(i.page.currentPage=1),i.options.store?(i.options.store.clearOrders&&i.options.store.clearOrders(),t&&(i.options.store.setDataPage&&i.options.store.setDataPage(i.getPageInfo()),i.options.store.load(i.getAllConditions()))):i._triggerHandler(null,"clearAllOrders",i.getAllConditions()),i._clearMultiSort()},_clearMultiSort:function(){var t=this;if(e.isNotNull(t.firstCol)&&e.isNotNull(t.secondCol)&&e.isNotNull(t.thirdCol)){var i={value:"",text:""};t.firstCol.radioGroup.setValue(i),t.secondCol.radioGroup.setValue(i),t.thirdCol.radioGroup.setValue(i),t.firstCol.combobox.setValue(i),t.secondCol.combobox.setValue(i),t.thirdCol.combobox.setValue(i)}},_getSelectedFirstRow:function(){var e=this;return e.contentTableEl.find("."+V+":first")},_getSelectedLastRow:function(){var e=this;return e.contentTableEl.find("."+V+":last")},_updateRows:function(i,a){var n=this;if(e.isNull(a))return n._error("_updateRows() The input data is null."),t;var o,r,l,s,d,c,h,u,p=e.objClone(a);return u=n.__findTargetTr(i),o=u.trEl,s=u.tree,c=u.realRow,o?(e.each(p,function(t,i){if(d=n.columnRelation[t],!e.isUndefined(d)){s?(r=n.contentTreeTdEls[c][d].empty(),l=n.treeData[c]):(r=n.contentTdEls[c][d].empty(),l=n.data[c]),h=e("<div>"),l[t]=i;var a={row:c,column:d,rowData:l,columnObj:n.headerColumns[d],divEl:h,depth:0,isTree:!1,tdEl:r};n.__getContentTdAlign(a),n.__getContentTdRender(a),r.unbind("click"),n.__bindContentTdClick(a),h.appendTo(r)}}),t):(n._error("_updateRows() The target row does not exist."),t)},deleteRows:function(i){var a,n,o=this,r=i;if(e.isNull(i))return o._error("deleteRows() The input data is null."),t;for(e.isArray(i)||(r=[i]),n=r.length,a=0;n>a;a++)o._deleteRows(r[a]);o._refreshContentSN()},_deleteRows:function(e){var i,a,n,o,r=this;return o=r.__findTargetTr(e),i=o.trEl,a=o.tree,n=o.realRow,i?(i.remove(),a?(r.contentTreeTdEls[n]=null,r.contentTreeTrEls[n]=null,r.checkboxTreeTdEls[n]=null,r.treeData[n]=null):(r.contentTdEls[n]=null,r.contentTrEls[n]=null,r.checkboxTdEls[n]=null,r.data[n]=null),t):(r._error("deleteRows() The target row does not exist."),t)},__findTargetTr:function(t){var i,a,n,o,r,l,s,d=this;for(i=d.__getContentTrEls(),o=i.length,s=0;o>s;s++)if(n=e(i[s]),e.string.toNumber(n.attr("row"))===t){a=n,r=n.attr("tree"),l=d.rowRelations[t];break}return{trEl:a,tree:r,realRow:l}},_addRowId:function(t,i){if(e.isArray(t)){i=i||0;for(var a=0;t.length>a;a++)t[a].rowId=i+a}},_getWidth:function(){return this.gridEl.externalWidth()},_getHeight:function(){return this.gridEl.externalHeight()},_setHeight:function(e){this.gridEl.externalHeight(e)},_setWidth:function(e){this.gridEl.externalWidth(e)},_setWH:function(e,t){this.gridEl.externalWidth(e),this.gridEl.externalHeight(t)},_doLayout:function(e){var t=this,i=t.gridEl.width(),a=t.gridEl.height(),n=0,o=0,r=0,l=0,s=0,d=t.options;if(t.rendered){if(t._gridMenu&&t._gridMenu.destroy(),t.headerEl){d.autoColumnWidth&&t._modifyColumnWidth();for(var c=0;t.headerTdEls.length>c;c++)t.__resetHeaderTdEl(c);if(o=t.headerEl.height(),t.headerEl.width(i),t.headerTableElWidth=s=t.__calHeaderWidth(),t.headerReRender){if(!e&&!d.autoColumnWidth)if(i>s){var h=i-s-Yt;s=i,t.widths[t.headerTdEls.length-1]+=h}else t.widths[t.headerTdEls.length-1]-=Yt;d.autoColumnWidth||t.__resetHeaderTdEl(t.headerTdEls.length-1),t.__resetHeaderWidth(s),t.headerReRender=!1}}t.actionBarEl&&(n=t.actionBarEl.height(),t.actionBarEl.width(i)),t.pagingEl&&(r=t.pagingEl.height(),t.pagingEl.width(i));var u=0;t.contentDespEl&&(u=t.contentDespEl.height()+2,t.contentDespEl.width(i-2)),t.contentEl&&(l=a-o-r-n-u,t.contentEl.width(i).height(l),t.__resetContentWidth(),t._resetContentTdELWidth(),t.contentDivEl.height(10),t.contentTableEl.hasClass(O)||t.contentTableEl.addClass(O)),t._doResizeElLayout()}},__resetHeaderTdEl:function(e){var t=this,i=t.headerTdEls[e];i&&i.find("div:first").externalWidth(t.widths[e])},__resetHeaderWidth:function(e){var t=this;t.headerDivEl.externalWidth(e),t.headerTableElWidth=e},_modifyColumnWidth:function(){var e=this,t=e.headerColumns,i=t.length,a=i,n=0,o=0,r=e.count,l=0,s=e.gridEl.width(),d=0,c=Xt;if(!(Xt>s)){for(l=0;i>l;l++)t[l].hidden?a--:t[l].width?o+=Number(t[l].width):n++;for(l=0;r>l;l++)s-=e.widths[l];for(s-=Yt,s-=a-1+r+1,s-=o,d=Math.floor(s/(0>=n?1:n)),d>Xt&&(c=d),l=r;e.originalWidths.length>l;l++)Qt===e.originalWidths[l]&&(e.widths[l]=c)}},__calHeaderWidth:function(){var t,i=this,a=i.headerColumns,n=i.count,o=0,r=i.gridEl.width(),l=Yt;for(e.each(i.widths,function(e,i){t=a[e-n],!t||t&&t.hidden||(l+=i+1)}),l--,o=0;n>o;o++)l+=i.widths[o];return r>l?r:l},__resetContentWidth:function(){var e=this;e.contentDivEl.width(e.headerTableElWidth-Yt),e.contentTableEl.width(e.headerTableElWidth-Yt)},_doResizeElLayout:function(){if(!this.options.data||this.options.data.resizable){var t=this,i=t.gridEl.height(),a=t.actionBarEl.height(),n=0,o=t.count;if(t.pagingEl&&(n=t.pagingEl.height()),t.headerTdEls)for(var r,l,s,d,c,h,u,p=0,f=0,g=0,m=0;t.headerTdEls.length>m;m++)u=t.headerTdEls[m],m>o-1&&(r=u.position(),p=0,c=e.isVisiable(u),c?(f=u.width(),g=u.height()):(f=0,g=0),l=a,s=e.string.toNumber(u.attr("rowspan")),d=e.string.toNumber(u.attr("depth")),s!==d&&(p=d-1,l+=g*p),h=t.resizeEls[m-o].css({left:r.left+f,top:l}).attr("visiable",c?"true":"false").height(i-n-l),c?(h.hasClass(x)||h.addClass(x),h.show()):h.removeClass(x))}},_closeFloatPanel:function(){var e=this;e.__closeFloatPanel(e.pagingRowDropDownEl,"rowFlag"),e.__closeFloatPanel(e.pagingPageDropDownEl,"pageFlag"),e.__closeFloatPanel(e.exportEl,"exportFlag"),e.__closeFloatPanel(e.selectColEl,"selectColFlag"),e.__closeFloatFilterPanel(e.oldActiveFilterTdEl),e.__closeFloatFilterPanel(e.activeFilterTdEl)},__closeFloatPanel:function(t,i){var a;t&&(a=t.data(i),!a&&e.isVisiable(t)&&t.hide(),t.data(i,!1)),"selectColFlag"==i&&this.selectColList&&this.selectColList.destroyMoveEl()},__closeFloatFilterPanel:function(e){var t=this;e&&(e.data("created")||(e.data("filterPanel").hide(),t.__onHeaderTdMouseLeave(null,e)),e.data("created",!1))},_createSweetWidget:function(){if(!this.renderEl){var t=this,i="sweet-grid",a=t.gridEl=e("<div>"),n=t.options;t.initial=!0,a.addClass(i).attr("id",n.id).width(n.width).height(n.height),t._createGridWidget()}},_createGridWidget:function(){var t=this;if(t.options.data){var i=t._createGridHeader();if(i&&t._createGridActionBar(),0===t.gridScrollLeftFlag&&(t.gridScrollLeft=0,t.gridScrollTop=0,t.gridScrollLeftFlag++),t._createGridContent(),t._createGridPagingBar(),e.isFunction(t.options.contentDescriptionFunc)){var a=t.options.contentDescriptionFunc(t.options.data);t.contentDespEl&&(t.contentDespEl.remove(),t.contentDespEl=null),t.contentDespEl=e("<div>").width("100%").css({"float":"left",border:"1px solid #CCCCCC"}).appendTo(t.gridEl),t.contentDespEl.html(a)}t._addListener(),t.options.store&&(t.options.store.addListener({setData:t.setData,scope:this}),t.options.store.addListener({setTreeData:t.setTreeData,scope:this}))}},_createGridActionBar:function(){this.__destroyTableActionBar();var t=this,i=t.options.data,a=!1,n=t.actionBarEl=e("<div>").addClass("sweet-grid-action-bar"),c=e("<div>").addClass("sweet-grid-action-bar-pic");i.selectColumn&&(a=!0,e("<span>").attr("title",Tt.selectCol).addClass(o).appendTo(c)),i.multiColumnSort&&(a=!0,e("<span>").attr("title",Tt.multiSort).addClass(r).appendTo(c)),i.secondaryStat&&(a=!0,e("<span>").attr("title",Tt.secondStat).addClass(l).appendTo(c)),i.clearFilters&&(a=!0,e("<span>").attr("title",Tt.clearFilter).addClass(s).appendTo(c)),i.export&&(a=!0,e("<span>").attr("title",Tt.export).addClass(d).appendTo(c)),c.bind("click",function(e){t.__onPicBarClick(e)}).appendTo(n),a?n.insertBefore(t.headerEl):n.height(0)},__onPicBarClick:function(t){var i=this,a=e(t.target);a.hasClass(o)?i.__createSelectColumnPanel(a):a.hasClass(r)?i.__createMultiSort():a.hasClass(s)?Sweet.Msg.confirm(Tt.qClearFilter,null,null,function(){i.clearAllFilters(!0)}):a.hasClass(d)?i.__createExportPanel(a):a.hasClass(l)&&i.__createSecondaryStatPanel(a)},__createSecondaryStatPanel:function(){var e,t=this,i=t.options.data;i.statParams&&(t.secondaryPanel&&(t.secondaryPanel.destroy(),t.secondaryPanel=null),e=i.statParams,t.secondaryPanel=new Sweet.cmp.SecondaryStat({dims:e.dims,indicators:e.indicators,statFun:e.statFun}))},__createMultiSort:function(){function i(e,t){var i=[],a=new Sweet.form.ComboBox({label:!0,pleaseSelect:!0,labelWidth:Tt.multiSortWin.comboLabelWidth,width:Tt.multiSortWin.comboWidth,data:t,labelText:e,tip:!0});i.push(a);var n=new Sweet.form.RadioGroup({width:Tt.multiSortWin.radioWidth,columns:"auto",data:[{text:Tt.multiSortWin.asc,value:"ASC"},{text:Tt.multiSortWin.desc,value:"DESC"}],tip:!0});i.push(n);var o=new Sweet.panel.FlowPanel({width:"100%",height:25,items:i,itemExtend:!0});return{combobox:a,radioGroup:n,panel:o}}function a(t,i){t&&Sweet.core.i18n.combobox.pleaseSelect===t.value||e.equals(t,i.combobox.getValue())&&(i.combobox.setValue({value:Sweet.core.i18n.combobox.pleaseSelect,text:Sweet.core.i18n.combobox.pleaseSelect}),i.radioGroup.setValue({}))}function n(e,t){var i=e.getValue(),a=t.getValue();return i&&i.value&&Sweet.core.i18n.combobox.pleaseSelect!==i.value||a&&a.value?!1:!0}function o(e,t){var i=e.getValue(),a=!1,n=t.getValue(),o=!1;return i&&i.value&&Sweet.core.i18n.combobox.pleaseSelect!==i.value||(a=!0),n&&n.value||(o=!0),a&&!o||o&&!a?!0:!1}function r(e,t){var i=e.getValue(),a=t.getValue();return a&&a.text?s.__getOrderFormat(i.data.name,a.value,i.data.dataType):null}function l(e,t){e.value&&e.value.value===Sweet.core.i18n.combobox.pleaseSelect&&t.setValue({})}var s=this,d=[],c=s.options.data?s.options.data.multiSortColumnsArr:[],h=[];if(s._multiSortWin)return s._multiSortWin.show(),t;d=e.isArray(c)&&c.length>0?c:s.headerColumns,e.each(d,function(t,i){!i.hiddenForever&&e.isNotNull(i.header)&&i.sortable&&h.push({text:i.header,value:i.name,data:i})});var u,p,f=s.firstCol=i(Tt.multiSortWin.firstSort,h),g=s.secondCol=i(Tt.multiSortWin.secondSort,h),m=s.thirdCol=i(Tt.multiSortWin.thirdSort,h);f.combobox.addListener("change",function(e,t){a(t,g),a(t,m)}),g.combobox.addListener("change",function(e,t){a(t,f),a(t,m)}),m.combobox.addListener("change",function(e,t){a(t,f),a(t,g)}),f.combobox.addListener("afterCloseFloatWin",function(e,t){l(t,f.radioGroup)}),g.combobox.addListener("afterCloseFloatWin",function(e,t){l(t,g.radioGroup)}),m.combobox.addListener("afterCloseFloatWin",function(e,t){l(t,m.radioGroup)}),u=new Sweet.panel.VPanel({items:[f.panel,g.panel,m.panel]}),s._multiSortWin=p=new Sweet.Window({width:Tt.multiSortWin.winWidth,height:190,title:Tt.multiSortWin.title,content:u,listeners:{ok:function(){if(n(f.combobox,f.radioGroup)&&n(g.combobox,g.radioGroup)&&n(m.combobox,m.radioGroup))return Sweet.Msg.warn(Tt.multiSortWin.firstNoSelectTip),!1;if(o(f.combobox,f.radioGroup))return Sweet.Msg.warn(Tt.multiSortWin.firstNoSelectTip),!1;if(o(g.combobox,g.radioGroup))return Sweet.Msg.warn(Tt.multiSortWin.secondNoSelectTip),!1;if(o(m.combobox,m.radioGroup))return Sweet.Msg.warn(Tt.multiSortWin.thirdNoSelectTip),!1;s.orders=[];var t=r(f.combobox,f.radioGroup),i=r(g.combobox,g.radioGroup),a=r(m.combobox,m.radioGroup);t&&s.orders.push(t),i&&s.orders.push(i),a&&s.orders.push(a),s.page&&(s.page.currentPage=1),s.options.store?(s.options.store._setDataPage(s.getPageInfo()),s.options.store.load(s.getAllConditions())):s._triggerHandler(null,"multiOrders",s.getAllConditions()),e.each(s.headerTdEls,function(e,t){if(t){t.removeClass(b+" "+E+" "+y).addClass(C),t.find("div:first").removeClass(S);for(var i=t.attr("columnName"),a=0;s.orders.length>a;a++)if(i===s.orders[a].name){var n=E;s.orders[a].order===Sweet.constants.sortType.DESC&&(n=y),t.addClass(n),t.removeClass(C),t.find("div:first").addClass(D)}}})}}}),p.show()},__getReszieFloatOffset:function(t,i){var a,n,o=1,r=e(window),l=e(document),s=r.height()+l.scrollTop(),d=r.width()+l.scrollLeft(),c=t.offset(),h=t.outerHeight(!0),u=t.outerWidth(!0),p=i.outerWidth(!0),f=i.outerHeight(!0);return n=c.top+h,a=c.left,0>=d-(p+a)&&(a=a+u>p?a-p+u:o),f>=s-c.top-h&&c.top>=f&&(n=c.top-f),{left:a,top:n}},__doResizeElMove:function(t,i,a){var n,o,r,l,s,d,c,h=t.event,u=t.resizeType,p=5,f=0,g=t.offset,m=5,v=20;return f=g.left,n=g.top,l=h.pageX,s=h.pageY,d=e(document).innerWidth()-p,c=e(document).innerHeight()-p,l>d&&(l=d),s>c&&(s=c),m>=s&&(s=m),m>=l&&(l=m),("xy"==u||"xr"==u||"xl"==u)&&(o="xl"==u?t.resizeInfo.width+f-l:l-f,t.resizeInfo.initWidth>o?t.resizeInfo._$moveEl.width(t.resizeInfo.initWidth-p):(o>a.gridEl.width()-v&&(o=a.gridEl.width()-v),t.resizeInfo._$moveEl.width(o))),("xy"==u||"yt"==u||"yb"==u)&&(r="yt"==u?t.resizeInfo.height+n-s:s-n,t.resizeInfo.initHeight>r?t.resizeInfo._$moveEl.height(t.resizeInfo.initHeight-p):t.resizeInfo._$moveEl.height(r)),!1},__createSelectColumnWinEl:function(t,i,a,n){if(a&&a.setDisabled(!0),t&&!(0>=t.length)&&i){var o,r,l,s,d,c,h,u,p,f,g,m=this,v=i.data,w=i.value,_=3;if(v&&!(0>=v.length)){u=e("<div>").addClass(gt+" "+mt).appendTo(t),f=e("<div>").addClass(vt).appendTo(u),p=e("<a>").addClass(_t).appendTo(f),e("<span>").text(Sweet.core.i18n.combobox.checkAll).appendTo(f),m.__selectColumnWinAEl={},m.__selectColumnWinAEl.allAEl=p,m.__selectColumnWinAEl.rAEls={},m.__selectColumnWinAEl.okBtn=a,m.__selectColumnWinAEl.cancelBtn=n,a.setDisabled(!0),l=e("<div>").addClass(ft).appendTo(t),o=v.length,s=Math.ceil(o/_);for(var C=0;s>C;C++){d=e("<div>").addClass(gt);for(var b=0;_>b&&(g=C*_+b,!(g>=o));b++)r=v[g],h=e("<div>").addClass(vt).appendTo(d),0==(g+1)%_&&h.addClass(wt),c=e("<a>").data(r).addClass(_t).appendTo(h),m.__selectColumnWinAEl.rAEls[r.value]=c,e("<span>").text(r.text).appendTo(h),h.bind("click",{me:m,isAll:!1,aEl:c},m._doColumnCheckChange);d.appendTo(l)}f.bind("click",{me:m,isAll:!0,aEl:p},m._doColumnCheckChange),m._doCheckedSelectColumnWin(w)}}},_doColumnCheckChange:function(e){var t,i,a,n,o,r=e.data.me,l=e.data.aEl,s=0,d=e.data.isAll,c=!1;if(r.__selectColumnWinAEl){if(i=r.__selectColumnWinAEl.allAEl,t=r.__selectColumnWinAEl.rAEls,a=r.__selectColumnWinAEl.okBtn,l.hasClass(_t)?(c=!0,l.removeClass(_t).addClass(Ct)):(c=!1,l.removeClass(Ct).addClass(_t)),d){c?(n=_t,o=Ct):(n=Ct,o=_t);for(var h in t)t[h].removeClass(n).addClass(o)}else if(i){if(c)for(var h in t)if(t[h].hasClass(_t)){c=!1;break}c?i.removeClass(_t).addClass(Ct):i.removeClass(Ct).addClass(_t)}for(var h in t)if(t[h].hasClass(Ct)){s++;break}a&&(s>0?a.setDisabled(!1):a.setDisabled(!0))}},_doCheckedSelectColumnWin:function(e){var i,a,n,o,r=this,l=0,s=!0;if(r.__selectColumnWinAEl&&(a=r.__selectColumnWinAEl.allAEl,i=r.__selectColumnWinAEl.rAEls,o=r.__selectColumnWinAEl.okBtn,i&&a)){if(o&&o.setDisabled(!0),!e||0>=e.length){for(var d in i)i[d].removeClass(Ct).addClass(_t);return a.removeClass(Ct).addClass(_t),t}n={};for(var c=0;e.length>c;c++)n[e[c].value]=!0;for(var d in i)n[i[d].data().value]?(i[d].removeClass(_t).addClass(Ct),l++):(i[d].removeClass(Ct).addClass(_t),s=!1);s?a.removeClass(_t).addClass(Ct):a.removeClass(Ct).addClass(_t),n=null,o&&l>0&&o.setDisabled(!1)}},_getCheckedSelectColumnWin:function(){var e,t=this,i=[];if(!t.__selectColumnWinAEl)return i;if(e=t.__selectColumnWinAEl.rAEls,!e)return i;for(var a in e)e[a].hasClass(Ct)&&i.push(e[a].data());return i},_doOkSelectColumnWin:function(){var e,t=this;if(e=t._getCheckedSelectColumnWin(),e&&e.length>0)for(var i=0;t.headerColumns.length>i;i++)for(var a=0;e.length>a;a++){if(e[a].value==t.headerColumns[i].name){t.headerColumns[i].hidden=!1;break}t.headerColumns[i].hidden=!0}else for(var i=0;t.headerColumns.length>i;i++)t.headerColumns[i].hidden=!0;t._headerChanged(t.headerColumns,!0)},__createSelectColumnPanel:function(i){var a,n,o=this,r=o.options.data.selectColumn,l=o.options.data.selectColumnResizAble;if("win"==r){var s,d,c,h;return o.selectColWin?(o.selectColWin.show(),t):(s=o.options.id+"-select-column-win",d="<div id='"+s+"' class='"+pt+"'></div>",c=new Sweet.form.Button({width:80,value:{value:s+"-okbtn",text:Tt.confirm},click:function(){o.selectColWin.close(),o._doOkSelectColumnWin()}}),h=new Sweet.form.Button({width:80,value:{value:s+"-cancelbtn",text:Sweet.core.i18n.dialog.cancel},click:function(){o.selectColWin.close(),o._doCheckedSelectColumnWin(o.__getSelectColumnData1().value)}}),o.selectColWin=Sweet.Window({width:833,height:400,padding:[10,10,10,10],title:Tt.selectCol,buttons:[c,h],content:{html:d},listeners:{cancel:function(){o._doCheckedSelectColumnWin(o.__getSelectColumnData1().value)}}}),o.__createSelectColumnWinEl(e("#"+s),o.__getSelectColumnData1(),c,h),o.selectColWin.show(),t)}if(1!=l&&"true"!=l&&"xy"!=l&&"x"!=l&&"y"!=l&&(l=!1),o.selectColEl)return n=e.getMaxZIndex(o.selectColEl.css("z-index")),a=l?o.__getReszieFloatOffset(i,o.selectColEl):e.getFloatOffset(i,o.selectColEl,!0),o.selectColEl.css(a).css({"z-index":n}).show().data("selectColFlag",!0),t;var u,p,f=o.options.id+"-select-column",g=e("<div>").attr("id",f).addClass(o.winBgClass+" sweet-grid-select-column").bind("click",function(){g.data("selectColFlag",!0)}).appendTo(e(document.body)),m=[],v=[];p=o.__getSelectColumnData(),m=p.data,v=p.value;var w=o.gridEl.height()-70,_=22*m.length+10,C=w;w>=_&&(C="100%"),u=new Sweet.list.OptimizeList({width:200,height:C,multi:!0,data:m,isBorder:!0,resizAble:l,value:v,minRemains:1,tip:!0,renderTo:f}),u.addListener("checkboxClick",function(e,t){o.__onSingleColumnHiddenClick(e,t.data.index,t.checked)}),l&&(u.addListener("resizeLayout",function(e){o.selectColEl.css(o.__getReszieFloatOffset(i,e))}),u.addListener("resizeElMove",function(e,t){o.__doResizeElMove(e,t,o)})),a=e.getFloatOffset(i,g,!0),n=e.getMaxZIndex(g.css("z-index")),g.css(a).css({"z-index":n}).show().data("selectColFlag",!0),o.selectColEl=g,o.selectColList=u},__getSelectColumnData:function(){var e,t,i,a,n=this,o=n.headerColumns,r=o.length,l=[],s=[];for(t=0;r>t;t++)i=o[t],e=i.hiddenForever||!1,a={text:i.header,value:i.name,data:{index:t}},e||(l.push(a),i.hidden||s.push(a));return{data:l,value:s}},__getSelectColumnData1:function(){var e,t,i,a,n=this,o=n.headerColumns,r=o.length,l=[],s=[];for(t=0;r>t;t++)i=o[t],e=i.hiddenForever||!1,a={text:i.header,value:i.name,data:{index:t}},e?i.hidden=!0:(l.push(a),i.hidden||s.push(a));return{data:l,value:s}},__createExportPanel:function(i){var a,n=this,o=80;if(n.exportEl)return a=e.getFloatOffset(i,n.exportEl,!0),n.exportEl.css(a).show().data("exportFlag",!0),t;var r=n.options.data.exportCType;if(r&&r.length>0)return n.exportEl=n._createExportEl(r),C=e.getMaxZIndex(t,"sweet-grid-action-bar-pic"),n.exportEl.data("exportFlag",!0).bind("click",{me:n},n._onExportCClick).appendTo(e(document.body)).css({left:-1e4,top:-1e4,"z-index":C}),a=e.getFloatOffset(i,n.exportEl,!0),n.exportEl.css(a),t;var l,s,d,p=n.options.data.exportType||[],v=p.length,w=e("<div>").width(o).addClass(n.winBgClass+" sweet-grid-export"),_=e("<ul>");for(s=0;v>s;s++)d=p[s],Lt.CSV===d?(l=e("<li>").addClass(f).text(Dt.csv).appendTo(_),e("<span>").addClass(c).prependTo(l)):Lt.XLS===d?(l=e("<li>").addClass(g).text(Dt.xls).appendTo(_),e("<span>").addClass(h).prependTo(l)):Lt.PDF===d&&(l=e("<li>").addClass(m).text(Dt.pdf).appendTo(_),e("<span>").addClass(u).prependTo(l));_.appendTo(w),a=e.getFloatOffset(i,w,!0);var C=e.getMaxZIndex(t,"sweet-grid-action-bar-pic");w.data("exportFlag",!0).bind("click",{me:n},n._onExportClick).appendTo(e(document.body)).css(a).css("z-index",C),n.exportEl=w},_createExportEl:function(t){for(var i,a,n,o=this,r=e("<div>").addClass(o.winBgClass+" sweet-grid-export sweet-grid-exportC"),l=e("<ul>"),s=0;t.length>s;s++)n=t[s],Lt.CSV===n.icon?(i=e("<li>").addClass(f).text(n.text).appendTo(l),a=e("<span>").addClass(c).prependTo(i)):Lt.XLS===n.icon?(i=e("<li>").addClass(g).text(n.text).appendTo(l),a=e("<span>").addClass(h).prependTo(i)):Lt.PDF===n.icon?(i=e("<li>").addClass(m).text(n.text).appendTo(l),a=e("<span>").addClass(u).prependTo(i)):(i=e("<li>").addClass(v).text(n.text).appendTo(l),a=e("<span>").addClass(p).prependTo(i),n.icon&&a.css({background:"url("+n.icon+")"})),a.addClass(n.value),i.data("data",n);return l.appendTo(r),r},_onExportCClick:function(t){var i,a,n,o=t.data.me,r=e(t.target),l=o.headerColumns,s=[],d={},c={};for(n=0;l.length>n;n++)a=l[n],d={},d.header=a.header,d.name=a.name,d.dataType=a.dataType,d.hidden=a.hidden,s.push(d);i=e(r).data("data"),c={type:i.value,columns:s},o._triggerHandler(t,Ht,c)},_onExportClick:function(i){var a,n,o=i.data.me,r=e(i.target),l=o.headerColumns,s=[],d={},c={};for(n=0;l.length>n;n++)a=l[n],d={},d.header=a.header,d.name=a.name,d.dataType=a.dataType,d.hidden=a.hidden,s.push(d);if(r.hasClass(f))c={type:Dt.csv,columns:s};else if(r.hasClass(g))c={type:Dt.xls,columns:s};else{if(!r.hasClass(m))return o._error("Unknown export type."),t;c={type:Dt.pdf,columns:s}}o._triggerHandler(i,Ht,c)},_createGridHeader:function(){var t=this;if(!t.options.data.columns)return!0;if(t.headerDivEl&&t.headerDivEl.css({left:0}),t.resizeEl&&t.resizeEl.css({left:0}),t.allCheckboxEl&&t.allCheckboxEl.removeClass(a).addClass(i),e.equals(t.historyColumns,t.options.data.columns))return!1;if(t.gridScrollLeftFlag=0,t.historyColumns=e.objClone(t.options.data.columns),t.onlyUpdateHeader){for(var n=0;t.options.data.columns.length>n;n++){var o=t.options.data.columns[n];if(t.headerTextDivs[o.name]){var r=t.headerTextDivs[o.name];o.tooltip&&r.attr("title",o.tooltip);var l=r.find("."+L),s=!1;l&&l.length>0&&(s=!0),r.text(o.header),s&&e("<span>").addClass(L).appendTo(r)}}return!1}t.__destroyTableHeader();var d,c,h=t.options,u=e.objClone(h.data.columns),p=h.data.checkbox,f=h.data.singleSelect,g=h.data.sn,m=h.data.fold,v="sweet-grid-header",b=t.headerEl=e("<div>").addClass(v).appendTo(t.gridEl),E=t.headerDivEl=e("<div>").appendTo(b),y=t.headerTableEl=e("<table>").attr({cellspacing:0,cellpadding:0,border:0}).appendTo(E),x=e("<tr>").appendTo(y),T=[],S=0,k=[],N=[],I=[],A=[];if(t.filterObjs=[],t.filters={},t.filterPanels=[],t.orders=[],t.hiddenColumn=0,t.columnRelation={},t.count=0,t.headerTextDivs={},t._amendColumns(u),t._parseHeader(u,0,N),t.__ColumnNumRelation(u),m){var P="sweet-grid-fold-no-right-border",M=S++;d=e("<td>").attr("rowspan",N.length).addClass(_+" "+C).appendTo(x),(p&&!f||g)&&d.addClass(P),c=e("<div>").appendTo(d),T[M]=d,k[M]=Gt,t.count++}if(p&&!f){var F=S++;d=e("<td>").attr("rowspan",N.length).addClass(_+" "+C).mouseenter({me:t},t.__onHeaderTdMouseEnter).mouseleave({me:t},t.__onHeaderTdMouseLeave).appendTo(x),c=e("<div>").addClass(w).appendTo(d),t.allCheckboxEl=e("<a>").addClass(i).bind("click",{me:t},t._onAllRowClick).appendTo(c),T[F]=d,k[F]=Ut,t.count++}if(g){var W=S++;d=e("<td>").attr("rowspan",N.length).addClass(_+" "+C).mouseenter({me:t},t.__onHeaderTdMouseEnter).mouseleave({me:t},t.__onHeaderTdMouseLeave).appendTo(x),c=e("<div>").text(Tt.SN).addClass(D).appendTo(d),T[W]=d,k[W]=m?50:Vt,t.count++}A=t._generateHeader(N,x,y),I=t._amendHeader(A),t.headerTdEls=T,t.widths=k,t.originalWidths=JSON.parse(JSON.stringify(k)),t.headerColumns=[];for(var B=0;I.length>B;B++){var O=I[B].tdEl.attr("column",B);e.isNotNull(I[B].column)&&O.attr("columnName",I[B].column.name),t.headerTdEls.push(O),t.widths.push(e.isNull(I[B].width)?Xt:I[B].width),t.originalWidths.push(e.isNull(I[B].width)?Qt:I[B].width),t.headerColumns.push(I[B].column)}return t._columnResizable(),t.headerReRender=!0,!0},_headerChanged:function(t,i){if(!(e.isNull(t)||!e.isArray(t)||0>=t.length)){var a,n,o=this,r=0,l=[],s=t.length,d=o.headerColumns,c=0;if(!(s>o.headerColumns.length)){for(r=0;s>r;r++)n=t[r],e.isPlainObject(n)&&(a=o._findIndex(n.name),-1!==a&&((n.hiddenForever||d[a].hiddenForever)&&(n.hidden=!0),l.push({index:a,show:!n.hidden}),d[a]=e.extend(d[a],n)));for(r=0;d.length>r;r++)d[r].hidden&&c++;o.hiddenColumn=c,l.length>0&&(o.__ColumnsHidden(l,!0),o.headerReRender=!0,o._doLayout(!0),"win"==o.options.data.selectColumn&&o.selectColWin?i?o._doCheckedSelectColumnWin(o.__getSelectColumnData1().value):(e.isFunction(o.selectColWin.destroy)&&o.selectColWin.destroy(),o.selectColWin=null,o.__selectColumnWinAEl=null):o.selectColList&&o.selectColList.setValue(o.__getSelectColumnData().value))}}},headerChanged:function(e){var t=this;t._headerChanged(e)},_findIndex:function(e){var t=this,i=0,a=t.headerColumns;for(i=0;a.length>i;i++)if(e===a[i].name)return i;return-1},__ColumnNumRelation:function(t,i){var a=this;return i=i||0,e.each(t,function(e,t){t.children&&t.children.length>0?i=a.__ColumnNumRelation(t.children,i):a.columnRelation[t.name]=i++}),i},_amendColumns:function(t,i){for(var a,n=this,o=0;t.length>o;o++)a=t[o],a.children&&a.hidden?n._amendColumns(a.children,a.hidden):e.isNotNull(i)&&(a.hidden=i)},_columnResizable:function(){var t,i=this,a=i.options,n="sweet-grid-resize";if(a.data.resizable){var o=i.resizeEl=e("<div>").addClass(n).appendTo(i.gridEl),r=i.headerColumns;i.resizeEls=[];for(var l=0;r.length>l;l++)t=i.resizeEls[l]=e("<div>").attr("num",l).mousedown({me:i},i._onResizeElDown).addClass(x).appendTo(o),r[l].hidden&&t.hide()}},_onResizeElDown:function(t){var i=t.data.me,a=e(t.target),o=e.string.toNumber(a.attr("num")),r=o+i.count,l=i.headerTdEls[r];"true"===a.attr("visiable")&&(i._helperEl=a,i._prevHelperEl=null,i._helperElWidth=a.width(),i._startX=t.pageX,i._startLeft=a.position().left,i._startTdLeft=l.position().left,i._startTdWidth=l.externalWidth(),e(document).bind("mousemove",{me:i},i._onResizeElMove),e(document).bind("mouseup",{me:i},i._onResizeElUp),e(document.body).addClass(n),i.__dealResizeElClass(!0,a,o))},_onResizeElUp:function(t){var i=t.data.me,a=i._helperEl;if(a){var o,r=a.position().left-i._startLeft,l=e.string.toNumber(a.attr("num")),s=l+i.count,d=0;e(document).unbind("mousemove",i._onResizeElMove),e(document).unbind("mouseup",i._onResizeElUp),e(document.body).removeClass(n),i.__dealResizeElClass(!1,a,l),i.widths[s]+=r,i.__resetHeaderTdEl(s),d=i.__calHeaderWidth(),i.__resetHeaderWidth(d),i.__resetContentWidth(),i._resetContentTdELWidthByCol(s);for(var c=0;i.resizeEls.length>c;c++)c>l&&(o=i.resizeEls[c],o.css("left",o.position().left+r))}},__dealResizeElClass:function(t,i,a){var n,o,r=this;t?(i.addClass(T).css("z-index",e.getMaxZIndex()),0!==a&&(n=r.__findPrevResizeEl(a),n&&e.isVisiable(n)&&(r._prevHelperEl=n,n.addClass(T).width(1).css("z-index",e.getMaxZIndex())))):(o="auto",i.removeClass(T).css("z-index",o),0!==a&&(n=r._prevHelperEl,n&&e.isVisiable(n)&&n.removeClass(T).width(r._helperElWidth).css("z-index",o)))},__findPrevResizeEl:function(i){var a,n,o=this;return i>0?(a=o.resizeEls[i-1],n=a.attr("visiable"),e.isNull(n)||"true"===n?a:o.__findPrevResizeEl(i-1)):t},_onResizeElMove:function(e){var t=e.data.me,i=t._helperEl;if(i){var a=e.pageX-t._startX;0>a&&$t>t._startTdWidth+a||i.css("left",t._startLeft+a)}},_sort:function(t){var i=t.data.me,a=e(this),n=a.attr("column"),o=Sweet.constants.sortType.ASC;i.sortEl?i.sortEl.attr("column")!==a.attr("column")&&(i.sortEl.removeClass(E+" "+y+" "+b).addClass(C),i.sortEl.find("div:first").removeClass(S)):i.sortEl=a,a.hasClass(E)?(a.removeClass(E).addClass(y),o=Sweet.constants.sortType.DESC):a.hasClass(y)?(a.removeClass(y).addClass(E),o=Sweet.constants.sortType.ASC):(a.addClass(E),o=Sweet.constants.sortType.ASC),i.sortEl=a.removeClass(C),a.find("div:first").addClass(D);var r=i.headerColumns[e.string.toNumber(n)];i.orders=[],i.orders.push(i.__getOrderFormat(r.name,o,r.dataType)),i.page&&(i.page.currentPage=1),i.options.store?(i.options.store._setDataPage(i.getPageInfo()),i.options.store.load(i.getAllConditions())):i._triggerHandler(t,"sort",i.getAllConditions()),i._clearMultiSort(),e.each(i.headerTdEls,function(e,t){t&&a.attr("columnName")!==t.attr("columnName")&&(t.removeClass(b+" "+E+" "+y).addClass(C),t.find("div:first").removeClass(S))})},__getOrderFormat:function(e,t,i){return{name:e,order:t,dataType:i}},_generateHeader:function(t,i,a){for(var n,o,r,l,s=this,d=0,c="sweet-grid-header-bottom",h=[],u=0;t.length>u;u++){l=t[u],h[u]=[],0!==u&&(i=e("<tr>").appendTo(a));for(var p=0;l.length>p;p++)n=l[p],d=n.height||xt,o=e("<td>").height(d).addClass(_+" "+C).mouseenter({me:s},s.__onHeaderTdMouseEnter).mouseleave({me:s},s.__onHeaderTdMouseLeave).appendTo(i),r=e("<div>").text(n.header).addClass(D).appendTo(o),s.headerTextDivs[n.name]=r,n.hidden&&(o.hide(),u===t.length-1&&s.hiddenColumn++),n.tooltip&&r.attr("title",n.tooltip),n.children&&n.children.length>0?(o.attr({colspan:n.colspan}).addClass(c),h[u][p]={width:n.width,column:n,tdEl:o,children:n.children.length}):(n.sortable&&o.bind("click",{me:s},s._sort),n.filter&&e("<span>").addClass(k).click({oTd:o,column:n,me:s},s._headerFilterPanel).hide().appendTo(o),o.attr({rowspan:t.length-u,depth:t.length}),h[u][p]={width:n.width,column:n,tdEl:o})}return h},_headerFilterPanel:function(i){i.stopImmediatePropagation();var a,n=i.data.me,o=i.data.column,r=i.data.oTd,l=e(this),s=r.data("filterPanel");if(n.activeFilterTdEl&&n.activeFilterTdEl.attr("column")!==r.attr("column")&&(n.oldActiveFilterTdEl=n.activeFilterTdEl),n._triggerBodyClick(),n.activeFilterTdEl=r,s)return n.__setFilterPanelPosition(l,s),r.data("created",!0),s.show(),e.isFunction(n.options.afterShowFilter)&&n.options.afterShowFilter({filter:n.getAllConditions(),obj:n._getFilterObj(o.name),type:o.filterType,name:o.name}),t;var d,c,h=e.string.toNumber(r.attr("column")),u=n.options.id+"-"+h+M,p=n.options.id+"-"+h+F,f=e("<div>").addClass("title").text(Tt.filter),g=e("<div>").attr("id",u),m=e("<div>").attr("id",p);switch(s=e("<div>").click(function(){r.data("created",!0)}).addClass(n.floatBgClass+" sweet-grid-header-filter-panel").appendTo(e(document.body)),e.isArray(n.filterPanels)?n.filterPanels.push(s):"",f.appendTo(s),g.appendTo(s),m.appendTo(s),n.__setFilterPanelPosition(l,s),o.filterType){case St.LIST:a=n.__headerFilterListPanel(g,o);
break;case St.STRING:a=n.__headerFilterStringPanel(g);break;case St.NUMBER:a=n.__headerFilterNumberPanel(g);break;case St.DATE:a=n.__headerFilterDatePanel(g);break;default:n._error("Unsupported filter type ["+o.filterType+"].")}d=new Sweet.form.Button({width:70,value:{value:0,text:Tt.okBtn}}),d.addListener("click",function(){n.__onFilterOKClick(r,o.name)}),c=new Sweet.form.Button({width:70,value:{value:1,text:Tt.clearSingleFilter}}),c.addListener("click",function(){n.__onFilterResetClick(r,a,o.name),n._triggerBodyClick()}),new Sweet.panel.FlowPanel({width:"100%",height:25,align:Sweet.constants.align.RIGHT,items:[d,c],renderTo:p}),r.data("created",!0),r.data("filterPanel",s),r.data("filter",a),n.filterObjs.push({name:o.name,filterType:o.filterType,filter:a,tdEl:r}),e.isFunction(n.options.afterShowFilter)&&n.options.afterShowFilter({filter:n.getAllConditions(),obj:a,type:o.filterType,name:o.name})},_getFilterObj:function(e){for(var t=this,i=t.filterObjs,a=0;i.length>a;a++)if(e===i[a].name)return i[a].filter},__setFilterPanelPosition:function(t,i){var a,n;a=e.getFloatOffset(t,i,!0),n=e.getMaxZIndex(),i.css({top:a.top,left:a.left,"z-index":n})},__ColumnsHidden:function(t,i){var a,n,o=this,r=0,l=o.count,s=o.headerColumns,d=[];for(r=0;t.length>r;r++){if(a=t[r].show||!1,d=[],n=t[r].index,o.contentVTdEls.length>0&&(d=o.contentTreeVTdEls.length>0?o.contentVTdEls[n].concat(o.contentTreeVTdEls[n]):o.contentVTdEls[n]),a)i||o.hiddenColumn--,o.headerTdEls[n+l].show(),o.contentColEls[n+l].show(),e.each(d,function(e,t){t.show()});else{if(!i){if(o.hiddenColumn===o.headerColumns.length-1)return;o.hiddenColumn++}o.headerTdEls[n+l].hide(),o.contentColEls[n+l].hide(),e.each(d,function(e,t){t.hide()})}s[n].hidden=!a}},__onSingleColumnHiddenClick:function(e,t,i){var a=this,i=i||!1;a.__ColumnsHidden([{index:t,show:i}]),a.headerReRender=!0,a._doLayout(!0),"win"==a.options.data.selectColumn&&a.selectColWin?a._doCheckedSelectColumnWin(a.__getSelectColumnData1().value):a.selectColList&&a.selectColList.setValue(a.__getSelectColumnData().value)},__onFilterOKClick:function(i,a){var n,o,r=this;if(e.each(r.filterObjs,function(e,t){var i=t.filter,n=t.filterType;if(t.name===a)switch(n){case St.LIST:r.filters[t.name]={type:n,value:i.getValue(),text:i.getText()};break;case St.STRING:r.filters[t.name]={type:n,value:i.getValue()};break;case St.NUMBER:r.filters[t.name]={type:n,value:i.getValue()};break;case St.DATE:r.filters[t.name]={type:n,value:i.getValue()};break;default:r._error("Unsupported filter type ["+t.dataType+"].")}}),n=r.filters[a],o=n.value,!o)return e.isBoolean(o)||r._triggerBodyClick(),t;if(!o||St.LIST!==n.type&&St.STRING!==n.type||o.pass){r._triggerBodyClick(),r.__setColumnFilterPic(i,!0),r.page&&(r.page.currentPage=1);var l=r.getAllConditions();e.isFunction(r.options.beforeOKFilter)&&(l.name=a,r.options.beforeOKFilter(l)),r.options.store?(r.options.store._setPage(r.getPageInfo()),r.options.store.load(l)):r._triggerHandler(null,"filter",l)}},__onFilterResetClick:function(e,t,i){var a=this;t.reset(),e.find("."+L).length>0&&(a.__setColumnFilterPic(e),delete a.filters[i],a.page&&(a.page.currentPage=1),a.options.store?(a.options.store._setPage(a.getPageInfo()),a.options.store.load(a.getAllConditions())):a._triggerHandler(null,"filter",a.getAllConditions()))},__setColumnFilterPic:function(t,i){if(i){var a=t.find("."+D),n=e("<span>");n.addClass(L).appendTo(a)}else t.find("."+L).remove()},__headerFilterListPanel:function(t,i){var a=this,n=function(e,t){var i=e.attr("id");this.listPanel=new Sweet.list.List({width:"100%",height:"auto",maxHeight:150,search:!0,multi:!0,tip:!0,widgetClass:N,data:t.filterList,renderTo:i})};return n.prototype.getValue=function(){var t,i=this,n=[],o=i.listPanel.getValue()||[];return e.each(o,function(e,t){n.push(t.value)}),0!==n.length&&(t=a.__getFilterFormat("IN",n,n.length>0)),t},n.prototype.getText=function(){var t,i=this,n=[],o=i.listPanel.getValue()||[];return e.each(o,function(e,t){n.push(t.text)}),0!==n.length&&(t=a.__getFilterFormat("IN",n,n.length>0)),t},n.prototype.reset=function(){var e=this;Sweet.Task.Delay.start({id:a.options.id+"-grid-list-delay",run:function(){e.listPanel.setValue({})},delay:800})},t.addClass("filter-list"),new n(t,i)},__headerFilterStringPanel:function(i){function a(e,t){kt.EQNULL===t||kt.NOTNULL===t?e.setDisabled(!0):e.setDisabled(!1)}var n=this,o=function(e){var t,i,n=e.attr("id");return t=this.radioGroup=new Sweet.form.RadioGroup({width:150,height:100,columns:1,data:[{text:Tt.exactMatch,value:kt.EQUAL,checked:!0},{text:Tt.fuzzyMatch,value:kt.LIKE},{text:Tt.notEqual,value:kt.NOTEQUAL},{text:Tt.eqNull,value:kt.EQNULL},{text:Tt.notNull,value:kt.NOTNULL}]}),t.addListener("click",function(e,t){a(i,t.value.value)}),i=this.textField=new Sweet.form.TextField({width:"100%",widgetClass:I,editable:!0}),new Sweet.panel.VPanel({width:"100%",height:135,items:[t,i],renderTo:n}),this};return o.prototype.getValue=function(){var i=this.radioGroup.getValue().value,a=this.textField.getValue().value;return kt.EQNULL===i||kt.NOTNULL===i?n.__getFilterFormat(i,"",!0):e.isNotNull(a)?n.__getFilterFormat(i,a,e.isNotNull(a)):t},o.prototype.reset=function(){this.radioGroup.setValue({text:Tt.exactMatch,value:kt.EQUAL,checked:!0}),this.textField.setValue({value:"",text:""}),a(this.textField,kt.EQUAL)},i.addClass(N),new o(i)},__headerFilterDatePanel:function(t){var i=this,a=function(e){var t,i,a=e.attr("id");return e.parent().addClass("sweet-grid-header-filter-date"),t=this.dateFrom=new Sweet.form.Date({blank:!1,label:!0,labelWidth:35,labelText:Tt.from,width:"100%"}),i=this.dateTo=new Sweet.form.Date({blank:!1,label:!0,labelWidth:35,labelText:Tt.to,width:"100%"}),new Sweet.panel.VPanel({width:205,height:55,items:[t,i],widgetClass:I,renderTo:a}),this};return a.prototype.getValue=function(){var t,a,n,o=this.dateFrom.getValue()||{},r=this.dateTo.getValue()||{};if(!e.isNull(o.data)||!e.isNull(r.data))return e.isNull(o.data)?(Sweet.Dialog.warn({message:Tt.validate.beginDate,propagation:!0}),!1):e.isNull(r.data)?(Sweet.Dialog.warn({message:Tt.validate.endDate,propagation:!0}),!1):-1!==e.date.compare(o.value,r.value,"-")?(Sweet.Dialog.warn({message:Tt.validate.compare,propagation:!0}),!1):(t=e.extend(i.__getFilterFormat(kt.GT,o.data),{text:o.value}),a=e.extend(i.__getFilterFormat(kt.LT,r.data),{text:r.value}),n=[t,a])},a.prototype.reset=function(){this.dateFrom.setValue({value:""}),this.dateTo.setValue({value:""})},t.addClass(N),new a(t)},__headerFilterNumberPanel:function(t){var i=this,a={value:""},n=function(e){var t,i,n,o=e.attr("id");return t=this.largeObj=new Sweet.form.NumberField({blank:!1,label:!0,labelWidth:15,allowDecimals:!0,labelText:kt.GT,symbol:!1,width:"100%",decimalPrecision:10}),t.addListener("focus",function(){n.setValue(a)}),i=this.smallObj=new Sweet.form.NumberField({blank:!1,label:!0,labelWidth:15,allowDecimals:!0,labelText:kt.LT,symbol:!1,width:"100%",decimalPrecision:10}),i.addListener("focus",function(){n.setValue(a)}),n=this.equalObj=new Sweet.form.NumberField({blank:!1,label:!0,labelWidth:15,allowDecimals:!0,labelText:kt.EQUAL,symbol:!1,width:"100%",decimalPrecision:10}),n.addListener("focus",function(){t.setValue(a),i.setValue(a)}),new Sweet.panel.VPanel({width:"100%",height:85,items:[t,i,n],widgetClass:I,renderTo:o}),this};return n.prototype.getValue=function(){var t=this,a=[],n=t.largeObj.getValue(),o=t.smallObj.getValue(),r=t.equalObj.getValue();return e.isNotNull(r.value)?a.push(i.__getFilterFormat(kt.EQUAL,r.value)):(e.isNotNull(n.value)&&a.push(i.__getFilterFormat(kt.GT,n.value)),e.isNotNull(o.value)&&a.push(i.__getFilterFormat(kt.LT,o.value))),0===a.length?null:a},n.prototype.reset=function(){var e=this;e.largeObj.setValue(a),e.smallObj.setValue(a),e.equalObj.setValue(a)},t.addClass(N),new n(t)},__getFilterFormat:function(e,t,i){return{symbol:e,value:t,pass:i}},__onHeaderTdMouseEnter:function(i){var a,n=i.data.me,o=e(this),r=o.find("."+k),l=o.position();if(n.__dealHeaderTdTextHover(o,r,!0),r&&r.length>0){if(a=e.string.toNumber(o.attr("rowspan")),1===a)r.addClass(A);else{if(2!==a)return n._error("Unsupported rowspan. rowspan = "+a),t;r.addClass(P)}r.show(),r.css({left:l.left+o.width()-r.width(),top:l.top})}},__onHeaderTdMouseLeave:function(t,i){var a,n=i||e(this),o=n.data("filterPanel"),r=n.find("."+k);o&&e.isVisiable(o)||(a=t?t.data?t.data.me:this:this,a.__dealHeaderTdTextHover(n,r),r&&!n.data("created")&&r.hide())},__dealHeaderTdTextHover:function(e,t,i){e.hasClass(E)||e.hasClass(y)||e.data("created")||(i?(e.addClass(b),e.find("div:first").addClass(S)):(e.removeClass(b),e.find("div:first").removeClass(S)))},_amendHeader:function(e){var t,i,a=[],n=0;if(1===e.length){for(var o=0;e[0].length>o;o++)a[n]=e[0][o],n++;return a}for(var r=e.length-2;r>=0;r--)for(var l=0;e[r].length>l;l++)t=e[r][l],i=t.children,i&&i>1?(a=a.concat(e[r+1].slice(0,i)),e[r+1].splice(0,i),n+=i):(a[n]=e[r][l],n++);return a},_parseHeader:function(e,t,i){for(var a=0;e.length>a;a++)e[a].colspan=1,e[a].children&&e[a].children.length>0&&(e[a].colspan=e[a].children.length,this._parseHeader(e[a].children,t+1,i)),i[t]||(i[t]=[]),i[t][a]?i[t][i[t].length]=e[a]:i[t][a]=e[a]},_createGridContent:function(){this.__destroyTableContent();var t,i=this,a=i.options,n=a.data.data||[],o=a.data.page||{},r="sweet-grid-content",l=i.contentEl=e("<div>").addClass(r).appendTo(i.gridEl),s=i.contentDivEl=e("<div>").appendTo(l),d=(i.contentTableEl=e("<table>").appendTo(s),i.headerColumns?i.headerColumns.length:Kt);i.rows=a.data?a.data.page?n.length<o.size?n.length:o.size:n.length:0,i.singleSelect=a.data.singleSelect||!1,i.checkbox=a.data.checkbox&&!i.singleSelect,i.sn=a.data.sn||!1,i.fold=a.data.fold||!1,i.data=i._toJson(n),i._addRowId(i.data),i.selectedData={},i.selectedDataLength=0,i.selectedTreeData={},i.selectedTreeDataLength=0,i.contentColEls=[],i.contentTrEls=[],i.contentTdEls=[],i.contentVTdEls=[],i.contentTreeTrEls=[],i.contentTreeTdEls=[],i.contentTreeVTdEls=[],i.checkboxTdEls=[],i.checkboxTreeTdEls=[],i.SNTdEls=[],i.dataIndex=0,i.treeDataIndex=0,i.treeData=[],i.treeRow=0,i.rowRelations={},t=Math.floor(Kt/d),i.lazyLoadRows=1>=t?1:t,i._buildGridContentCol(),i.timerGridContent=a.id+"-"+jt,Sweet.Task.Timeout.start({id:i.timerGridContent,run:i._buildGridContent,scope:i,interval:10}),i._gridMenuId=a.id+"-grid-menu",i._bindGridContentEvent()},_buildGridContentCol:function(){var t,i,a,n,o=this,r=o.headerColumns||[],l=r.length,s=o.count||0;for(a=0;s>a;a++)t=e("<col>").appendTo(o.contentTableEl),o.contentColEls.push(t);for(n=0;l>=n;n++)i=r[n],t=e("<col>").appendTo(o.contentTableEl),i&&i.hidden&&t.hide(),o.contentColEls.push(t)},_toJson:function(t){var i=this;return t&&t.length>0&&e.isArray(t[0])?i.__preTreatData()||[]:e.objClone(t)||[]},_bindGridContentEvent:function(){var n=this,o=n.data,r=n.headerColumns,l=n.count;n.contentEl.scroll(function(){n._onScroll()}).click(function(s){var d,c,h,u,p,f=e(s.target);if(f.hasClass(K)?p=Sweet.constants.operType.EDIT:f.hasClass(X)?p=Sweet.constants.operType.MODIFY:f.hasClass(Q)?p=Sweet.constants.operType.DELETE:f.hasClass(Z)?p=Sweet.constants.operType.CLOSE:f.hasClass(J)?p=Sweet.constants.operType.PAUSE:f.hasClass(et)?p=Sweet.constants.operType.START:f.hasClass(tt)?p=Sweet.constants.operType.RESET:f.hasClass(it)?p=Sweet.constants.operType.DETAIL:f.hasClass(at)&&(p=Sweet.constants.operType.CONFIRM),p){d=e.string.toNumber(f.attr("row"));var g=d;return e(f).parent()&&e(f).parent().parent()&&e(f).parent().parent().parent()&&e(f).parent().parent().parent().parent()&&(g=e(f).parent().parent().parent().parent().attr("row")),c=e.string.toNumber(f.attr("column")),h={realRow:g,row:d,column:c,rowData:e.objClone(o[d])},u=r[c-l].rendererArr[p],u.call(this,s,h),t}if(f.hasClass(i))return n._onRowClick(f,!0),n._triggerCheckBoxHandler(s,f,!0),t;if(f.hasClass(a))return n._onRowClick(f,!1),n._triggerCheckBoxHandler(s,f,!1),t;var m=f.parent().parent();if(0===s.button&&m.hasClass(B)){c=e.string.toNumber(m.attr("column"));var v=r[c-l],w=!0;if(v.beforeShowMenu&&e.isFunction(v.beforeShowMenu)&&(h={column:c,name:v.name,rowData:e.objClone(o[d])},w=v.beforeShowMenu.call(this,h)),w){n._gridMenu&&n._gridMenu.destroy(),c=e.string.toNumber(m.attr("column"));var _=s.pageX,C=150;_+C>n.gridEl.width()-Yt-2&&(_=_-Yt-2-C);var b={renderTo:n._gridMenuId,X:_,Y:s.pageY,itemClick:r[c-l].itemClick,items:r[c-l].menus};return r[c-l].itemWidth&&(b.itemWidth=r[c-l].itemWidth),n._gridMenu=new Sweet.menu.Menu(b),s.stopPropagation(),t}}})},_triggerCheckBoxHandler:function(t,i,a){var n,o,r,l=this;n=e.string.toNumber(i.attr("row")),o=i.attr("tree"),r="true"===o?e.objClone(l.treeData[n]):e.objClone(l.data[n]),r.checked=a,l._triggerHandler(t,Mt,r)},__preTreatData:function(){for(var e=this,t=[],i=e.options.data.data,a=i.length,n=e.headerColumns,o=e.headerColumns.length,r=0;a>r;r++){t[r]={};for(var l=0;o>l;l++)t[r][n[l].name]=i[r][l]}return t},_buildGridContent:function(){this._info("_buildGridContent begin");var i,a=e.date.getMilliseconds(),n=this,o=n.lazyLoadRows,r=n.page?n.page.size:0;if(e.isNull(n.data)&&(n.data=[]),0===n.data.length||n.dataIndex>=n.data.length||n.page&&n.dataIndex>=r)return Sweet.Task.Timeout.stop(n.timerGridContent,function(){n.afterSetData=!0,n._refreshRowRelations(),n._triggerHandler(null,Rt),n.contentEl.scrollTop(n.gridScrollTop),n.contentEl.scrollLeft(n.gridScrollLeft)}),n.contentVTdEls=e.matrix.reversal(n.contentTdEls),t;var l=n.data,s=Math.floor((n.rows-n.dataIndex)/o)>0?o:n.rows-n.dataIndex,d=l.slice(n.dataIndex,n.dataIndex+s);n._buildGridTrContent(d),i=e.date.getMilliseconds(),n._info("Render grid content. Time-consuming = "+(i-a)+"ms"),n._info("_buildGridContent end")},_buildInsertGridContent:function(t,i){var a,n=this,o=e.date.getMilliseconds();n._info("_buildInsertGridContent() begin"),n._addRowId(t,n.data.length),n.data=n.data.concat(t),n._buildGridTrContent(t,i),n._refreshContentSN(),a=e.date.getMilliseconds(),n._info("Render grid content. Time-consuming = "+(a-o)+"ms"),n._info("_buildInsertGridContent() end")},_isRowChecked:function(t){return e.isNull(t)||e.isNull(t.isChecked)||t.isChecked===!1||"false"===t.isChecked?!1:!0},_buildGridTrContent:function(t,i){var a,n,o,r,l,s,d=this,c=t.length,h=d.headerColumns||[],u=0,p=0,f=0;if(d.sn){var g=d.options.data.page,m=d.page?d.page.currentPage?d.page.currentPage:1:1,v=20;d.page&&d.page.size?v=d.page.size:g&&g.size&&(v=g.size),u=v*(m-1)}for(var w=0;c>w;w++){if(a=w+d.dataIndex,n=e("<tr>").addClass(R),n.bind("click",{me:d,tr:n,eventName:At},d._onTrClick).bind("dblclick",{me:d,tr:n,eventName:Pt},d._onTrClick),d._addRowColor(n,t[w].options),d.contentTdEls[a]=[],d.fold&&(r=d._getFold(n,a,t[w]).appendTo(n)),d.checkbox){var _=d._isRowChecked(t[w]);l=d._getCheckbox(a,!1,_).appendTo(n),d.checkboxTdEls[a]=l}d.sn&&(p=u+a+1,s=d._getSN(p).appendTo(n)),i?n.prependTo(d.contentTableEl):n.appendTo(d.contentTableEl);for(var C=0;h.length>C;C++)o=d._getContentTd({row:a,column:C+d.count,rowData:t[w],columnObj:h[C],trEl:n,depth:f}).appendTo(n),d.contentTdEls[a][C]=o;d.contentTdEls[a][h.length]=e("<td>").appendTo(n),d.contentTrEls[a]=n}d.dataIndex+=c},_buildGridTreeContent:function(){this._info("_buildGridTreeContent() begin");var i,a=e.date.getMilliseconds(),n=this,o=n.lazyLoadRows;if(0===n.tempTreeData.length||n.treeDataIndex>=n.treeData.length)return Sweet.Task.Timeout.stop(n.timerGridTreeContent,function(){n._refreshContentSN()}),n.contentTreeVTdEls=e.matrix.reversal(n.contentTreeTdEls),t;for(var r,l,s,d,c,h,u=n.treeData,p=u.length,f=Math.floor((p-n.treeDataIndex)/o)>0?o:p-n.treeDataIndex,g=0,m=u.slice(n.treeDataIndex,n.treeDataIndex+f),v=n.headerColumns||[],w=e.string.toNumber(n.rowTreeTdEl.attr("depth"))+1,_=n.rowTreeTdEl.data("treeTrEls"),C=0;f>C;C++){if(r=C+n.treeDataIndex,g=C+n.tempTreeDataIndex,l=e("<tr>").addClass(R).attr("tree","true"),l.bind("click",{me:n,tr:l,eventName:At},n._onTrClick).bind("dblclick",{me:n,tr:l,eventName:Pt},n._onTrClick),n._addRowColor(l,m[C].options),n.contentTreeTdEls[r]=[],n.fold&&(h=n._getFold(l,r,m[C]).appendTo(l)),n.checkbox){var b=n._isRowChecked(m[C]);d=n._getCheckbox(r,!0,b).appendTo(l),n.checkboxTreeTdEls[r]=d}n.sn&&(c=n._getSN("").appendTo(l));for(var E=0;v.length>E;E++)s=n._getContentTd({row:r,column:E+n.count,rowData:m[C],columnObj:v[E],depth:w,isTree:!0}).appendTo(l),n.contentTreeTdEls[r][E]=s;n.contentTreeTdEls[r][v.length]=e("<td>").appendTo(l),l.insertAfter(n.rowTreeEl),n.contentTreeTrEls[r]=l,_[g]=l}n.treeDataIndex+=f,n.tempTreeDataIndex+=f,i=e.date.getMilliseconds(),n._info("Render grid content. Time-consuming = "+(i-a)+"ms"),n._info("_buildGridTreeContent() end")},_addRowColor:function(e,t){if(t){var i=t.color,a=zt[i];a&&e.addClass(a)}},_onTrClick:function(t){var i,a,n,o=t.data.me,r=t.data.tr,l=t.data.eventName,s=e.string.toNumber(r.attr("row")),d=[];(o.singleSelect||l===Pt)&&(i=o.__findTargetTr(s),a=i.realRow,n=o._getSelectedFirstRow(),o.options.data.checkbox?i.tree?d.push(o.treeData[a]):d.push(o.data[a]):(n&&n.length>0&&(n=e(n),n.attr("tree")?(delete o.selectedTreeData,delete o.selectedTreeDataLength,o.selectedTreeData={},o.selectedTreeDataLength=0):(delete o.selectedData,delete o.selectedDataLength,o.selectedData={},o.selectedDataLength=0),n.removeClass(V)),r.addClass(V),i.tree?(o.selectedTreeData[o.treeData[a].rowId]=o.treeData[a],o.selectedTreeDataLength=1):(o.selectedData[o.data[a].rowId]=o.data[a],o.selectedDataLength=1),d=o.getSelectedValue()),o._triggerHandler(t,l,{row:s,rowData:d}))},_resetContentTdELWidth:function(){var t=this;e.each(t.contentColEls,function(e){t._resetContentTdELWidthByCol(e)})},_resetContentTdELWidthByCol:function(e){var t=this;t.widths&&t.contentColEls[e].width(t.widths[e]+Zt)},_refreshContentSN:function(){var t,i,a,n=this;if(n.options.data.sn)for(t=n.contentTableEl.find("."+W),i=t.length,a=0;i>a;a++){var o=a+1;e(t[a]).attr("title",o).text(o)}n._refreshRowRelations()},_refreshRowRelations:function(){var t,i,a,n,o,r,l=this;for(t=l.__getContentTrEls(),i=t.length,n=0;i>n;n++)e(t[n]).attr("row",n+1);for(i=l.contentTrEls.length,o=0;i>o;o++)a=l.contentTrEls[o],a&&(l.rowRelations[a.attr("row")]=o);for(i=l.contentTreeTrEls.length,r=0;i>r;r++)a=l.contentTreeTrEls[r],a&&(l.rowRelations[a.attr("row")]=r)},__getContentTrEls:function(){return this.contentTableEl.find("."+R)},_getFold:function(t,i,a){var n=e("<td>"),o=this,r="sweet-grid-fold",l="sweet-grid-tr-fold",s="sweet-grid-tr-td-div-fold",d="sweet-grid-row-fold",c="sweet-grid-row-open",h=e("<div>").addClass(r).appendTo(n),u=e("<a>").appendTo(h);return u.bind("click",function(n){var r=e(this);if(r.hasClass(d))if(r.removeClass().addClass(c),r.data("hasTr")&&r.data("tr"))r.data("tr").show();else{var h=o.options.id+"-fold-"+i,u=e("<tr>").addClass(l),p=e("<td>").attr("colspan",o.headerTdEls.length+"").appendTo(u),f=e("<div>").addClass(s).attr("id",h).appendTo(p);r.data("hasTr","true"),r.data("tr",u),r.data("trChildDiv",f),u.insertAfter(t);var g=o._triggerHandler(n,"foldclick",a);g&&e.isFunction(g.render)?g.render(h):g&&f.html(g)}else r.hasClass(c)&&(r.removeClass().addClass(d),r.data("hasTr")&&r.data("tr")&&r.data("tr").hide())}),a.open?u.addClass(c):u.addClass(d),n},_getCheckbox:function(t,n,o){var r=e("<td>"),l=e("<div>").addClass(w).appendTo(r),s=e("<a>").addClass(o?a:i).attr({row:t}).appendTo(l);return n&&s.attr("tree","true"),o&&this._oneRowSelect(t,n),r},_getSN:function(t){var i=e("<td>");return e("<div>").addClass(W).attr("title",t).text(t).appendTo(i),i},_getContentTd:function(t){var i,a=this,n=t.row,o=t.column,r=t.rowData,l=t.columnObj,s=t.depth,d=t.isTree,c=t.trEl,h=e("<td>"),u=e("<div>").appendTo(h);return i={row:n,column:o,rowData:r,columnObj:l,divEl:u,depth:s,isTree:d,trEl:c,tdEl:h},a.__getContentTdAlign(i),a.__getContentTdRender(i),a.__bindContentTdClick(i),l.hidden&&h.hide(),h},__bindContentTdClick:function(t){var i=this,a=t.tdEl,n=t.row,o=t.column,r=t.columnObj,l=t.rowData;a.bind("click",{me:i,row:n,column:o,name:r.name,rowData:e.objClone(l)},function(e){var t=e.data.me,i=e.data.row,a=e.data.column,n=e.data.name,o=e.data.rowData,r={row:i,column:a,name:n,rowData:o};t._triggerHandler(e,It,r)})},__getContentTdAlign:function(e){var t=e.columnObj,i=e.divEl;t.align?Sweet.constants.align.RIGHT===t.align?i.addClass(j):Sweet.constants.align.CENTER===t.align?i.addClass(z):i.addClass(H):Sweet.constants.dataType.NUMBER===t.dataType&&i.addClass(j)},__getContentTdRender:function(t){var i,a,n=this,o=t.row,r=t.column,l=t.rowData,s=t.columnObj,d=t.divEl,c=t.depth,h=t.isTree,u=t.trEl,p={},f=l[s.name],g="<a class='"+B+"' column='"+r+"'>";s.renderer?(p={row:o,column:r,data:f,rowData:e.objClone(l),columnDesc:e.objClone(s)},i=s.renderer.call(null,p),s.menus?e(g).html(i).appendTo(d):d.html(i)):(p={data:f,rowData:l,row:o,column:r,depth:c,isTree:h,trEl:u,name:s.name},a=n.__getContentTdTree(p),s.menus?e(g).html(a).appendTo(d):d.html(a)),s.tip&&d.attr("title",e.isPlainObject(f)?e.htmlEscape(f.text):e.htmlEscape(f))},__getContentTdTree:function(i){var a,n,o=this,r=i.data,l=i.rowData,s=i.row,d=i.column,c=i.depth,h=i.isTree,u=i.trEl,p=i.name,f=e("<div>").addClass(U);if(e.isPlainObject(r)&&r.children&&e.isNotNull(r.text)){h&&f.css("padding-left",qt*c);var g=e("<a>").addClass(Y+" "+$+" "+G).bind("click",function(i){i.stopImmediatePropagation();var a,n=e(this);if(o.rowTreeEl=n.parent().parent().parent().parent(),o.rowTreeTdEl=n,a={row:s,column:d,name:p,depth:c,rowData:e.objClone(l)||{}},n.hasClass(Y)){if(n.removeClass(Y).addClass(q),n.data("expand"))return a=o._triggerHandler(i,Wt,a),o._gridContentTreeExpand(n.data("treeTrEls"),!0),t;a=o._triggerHandler(i,Ft,a),o.options.store&&o.options.store.load(a,!0,"setTreeData"),n.data("expand",!0),n.data("treeTrEls",[])}else n.hasClass(q)?(n.removeClass(q).addClass(Y),a=o._triggerHandler(i,Bt,a),o._gridContentTreeExpand(n.data("treeTrEls"),!1)):o._info("__getContentTdTree() Nothing to do.")}).attr({row:s,column:d,depth:c}).appendTo(f);if(a=e.nullToString(r.text),n=e("<div>").html(e.htmlEscape(a)).appendTo(f),r.childs&&r.childs.length>0&&r.expand&&u){var m=r.childs;g.removeClass(Y).addClass(q),g.data("expand",!0),g.data("treeTrEls",[]),o._buildTreeChildContent(m,u,g)}}else n=e("<div>").appendTo(f),f.css("padding-left",qt*c),a=h&&e.isPlainObject(r)?r.text:e.isPlainObject(r)?r.text:r,n.html(e.htmlEscape(e.nullToString(a)));return f[0]},_buildTreeChildContent:function(t,i,a){this._info("_buildGridTreeContent() begin");var n,o=e.date.getMilliseconds(),r=this;r.tempTreeData=r._toJson(t).reverse(),r.tempTreeDataIndex=0,r.treeData=r.treeData.concat(r.tempTreeData),r._addRowId(r.treeData);for(var l,s,d,c,h,u,p=t.length,f=t.reverse(),g=r.headerColumns||[],m=e.string.toNumber(a.attr("depth"))+1,v=a.data("treeTrEls"),w=r.contentTreeTdEls.length,_=0;p>_;_++){if(l=_+w,s=e("<tr>").addClass(R).attr("tree","true"),s.bind("click",{me:r,tr:s,eventName:At},r._onTrClick).bind("dblclick",{me:r,tr:s,eventName:Pt},r._onTrClick),r._addRowColor(s,f[_].options),r.contentTreeTdEls[l]=[],r.fold&&(u=r._getFold(s,l,f[_],"tree").appendTo(s)),r.checkbox){var C=r._isRowChecked(f[_]);c=r._getCheckbox(l,!0,C).appendTo(s),r.checkboxTreeTdEls[l]=c}r.sn&&(h=r._getSN("").appendTo(s));for(var b=0;g.length>b;b++)d=r._getContentTd({row:l,column:b+r.count,rowData:f[_],columnObj:g[b],depth:m,isTree:!0}).appendTo(s),r.contentTreeTdEls[l][b]=d;r.contentTreeTdEls[l][g.length]=e("<td>").appendTo(s),s.insertAfter(i),r.contentTreeTrEls[l]=s,v[_]=s}r._refreshContentSN(),r.contentTreeVTdEls=e.matrix.reversal(r.contentTreeTdEls),n=e.date.getMilliseconds(),r._info("Render grid content. Time-consuming = "+(n-o)+"ms"),r._info("_buildGridTreeContent() end")},_gridContentTreeExpand:function(t,i){var a,n,o;if(i)for(var r=0;t.length>r;r++)t[r].show();else for(var l=0;t.length>l;l++){a=t[l].hide(),n=a.find("."+G);for(var s=0;n.length>s;s++)o=e(n[s]),o.removeClass(q).addClass(Y),this._gridContentTreeExpand(o.data("treeTrEls")||[],!1)}},_onScroll:function(){var t=this,i=t.contentEl.scrollLeft();t._gridMenu&&t._gridMenu.destroy(),t.headerDivEl.css({left:-i}),t.resizeEl&&t.resizeEl.css({left:-i}),t.options.scrollCallBack&&e.isFunction(t.options.scrollCallBack)&&t.options.scrollCallBack({left:i,top:t.contentEl.scrollTop(),scrollWidth:t.contentEl.get(0).scrollWidth,scrollHeight:t.contentEl.get(0).scrollHeight})},_onAllRowClick:function(n){function o(e){for(var t,i={},a=0;e.length>a;a++)t=e[a],t&&(i[t.rowId]=t);return i}var r=n.data.me,l=e(this),s={};if(l.hasClass(i))s.checked=!0,l.removeClass(i).addClass(a),r.selectedData=o(r.data),r.selectedDataLength=r.data.length,r.selectedTreeData=o(r.treeData),r.selectedTreeDataLength=r.treeData.length,r._dealRowSelect(r.checkboxTdEls,r.contentTrEls,{current:a,old:i},{current:V,old:""}),r._dealRowSelect(r.checkboxTreeTdEls,r.contentTreeTrEls,{current:a,old:i},{current:V,old:""});else{if(!l.hasClass(a))return r._info("Nothing we can do."),t;s.checked=!1,l.removeClass(a).addClass(i),r._allRowUnSelect()}r._triggerHandler(n,Mt,s)},_allRowUnSelect:function(){var e=this;e.selectedData={},e.selectedDataLength=0,e.selectedTreeData={},e.selectedTreeDataLength=0,e._dealRowSelect(e.checkboxTdEls,e.contentTrEls,{current:i,old:a},{current:"",old:V}),e._dealRowSelect(e.checkboxTreeTdEls,e.contentTreeTrEls,{current:i,old:a},{current:"",old:V})},_dealRowSelect:function(e,t,i,a){for(var n=0;t.length>n;n++)e[n]&&e[n].find("a").removeClass(i.old).addClass(i.current),t[n].removeClass(a.old).addClass(a.current)},_onRowClick:function(t,n){var o=this,r=e.string.toNumber(t.attr("row")),l=t.attr("tree");if(n)t.removeClass(i).addClass(a),o._oneRowSelect(r,l);else{var s=o.data[r];t.removeClass(a).addClass(i),"true"===l?(s=o.treeData[r],o.contentTreeTrEls[r].removeClass(V),delete o.selectedTreeData[s.rowId],o.selectedTreeDataLength--):(s=o.data[r],o.contentTrEls[r].removeClass(V),delete o.selectedData[s.rowId],o.selectedDataLength--),o.data.length+o.treeData.length!==o.selectedTreeDataLength+o.selectedDataLength&&o.headerTdEls[0].find("a").removeClass().addClass(i)}},_oneRowSelect:function(t,i){var n,o=this;"true"===i?(n=e.objClone(o.treeData[t]),o.contentTreeTrEls[t]&&o.contentTreeTrEls[t].addClass(V),o.selectedTreeData[o.treeData[t].rowId]=n,o.selectedTreeDataLength++):(n=e.objClone(o.data[t]),o.contentTrEls[t]&&o.contentTrEls[t].addClass(V),o.selectedData[o.data[t].rowId]=n,o.selectedDataLength++),o.selectedDataLength+o.selectedTreeDataLength===o.data.length+o.treeData.length&&o.headerTdEls[0].find("a").removeClass().addClass(a)},_createGridPagingBar:function(){if(this.options.data.page){this.__destroyTablePagingBar();var t,i,a,n=this,o=n.options,r=o.data.page,l=r.simple,s=30,d=r.total&&e.isNumeric(r.total)?Math.ceil(r.total/r.size):0,c=n.page?n.page.currentPage?n.page.currentPage:1:1,h=n.page?n.page.size?n.page.size:r.size:r.size,u=l?"":Tt.prev,p=l?"":Tt.next,f="sweet-gird-paging-select",g="sweet-gird-paging-select-rows",m="sweet-grid-paging-select-down-page",v="sweet-grid-paging-text",w="sweet-grid-paging-space",_=e("<a>"),C=n.pagingEl=e("<div>"),b=n.pagingInnerEl=e("<div>");if(r.currentPage&&(c=r.currentPage,delete r.currentPage),n.page={totalPage:d,currentPage:c,size:h},t={selectElClass:f,aElClass:g,downElClass:"",text:Tt.pageRow,size:h,select:r.select,type:bt[0]},i={selectElClass:f,aElClass:g,downElClass:m,text:"{0} / {1}",size:c,select:[],type:bt[1]},l||(a=n._createPagingBarSelectPage(t),n.pagingRowEl=a.selectEl.appendTo(b),n.pagingRowDropDownEl=a.dropDownEl,n.pagingRowDropDownEl.find("li").bind("click",{me:n},n._onPagingRowClick)),n._createPagingBarTotalText(),n._createPagingBarButton(lt,u,Et[0]).bind("click",function(){n._onPagingButtonClick(!0)}).appendTo(b),l){for(var E=0;d>E;E++)i.select[E]=E+1+" / "+d;a=n._createPagingBarSelectPage(i),n.pagingPageEl=a.selectEl.appendTo(b),n.pagingPageDropDownEl=a.dropDownEl,n.pagingPageDropDownEl.bind("click",function(e){n._onPagingBarNumClick(e)})}else n._createPagingBarNumItem();n._createPagingBarButton(dt,p,Et[1]).bind("click",function(){n._onPagingButtonClick(!1)}).appendTo(b),C.addClass(nt).height(s).appendTo(n.gridEl),b.addClass(ot).appendTo(C),l||(_.addClass(w).appendTo(b),n.pagingGoTextEl=e("<input>").addClass(v).blur(function(){n._onGoBlur()}).on("paste",function(){return!1}).keypress(e.e.onlyNumber).val(n.page.currentPage).appendTo(_),n.pagingGoEl=n._createPagingBarButton(ct,"",Et[0],Tt.go).bind("click",function(e){n._onPagingGoClick(e)}).appendTo(b))}},_onGoBlur:function(){var t=this,i=e.string.toNumber(t.pagingGoTextEl.val());1>i?t.pagingGoTextEl.val(1):i>t.page.totalPage&&t.pagingGoTextEl.val(0===t.page.totalPage?1:t.page.totalPage)},_onPagingButtonClick:function(i){var a,n=this,o=!1,r=n.page,l=n.numEls;if(!(r.totalPage<r.currentPage||1>r.currentPage)){if(1===r.currentPage){if(i||1===r.totalPage)return;a=r.currentPage+1}else if(r.totalPage===r.currentPage){if(!i)return;a=r.totalPage-1}else a=i?--r.currentPage:++r.currentPage;if(n.page.currentPage=a,n.options.data.page.simple)return n.pagingPageDropDownEl.find("li:eq("+--n.page.currentPage+")").click(),t;for(var s=0;l.length>s;s++)a===e.string.toNumber(l[s].val())&&(l[s].click(),o=!0);o||(n.goClick=!0,n._onPagingBarNumClick(null,!0))}},_onPagingGoClick:function(t){var i=this,a=e.string.toNumber(i.pagingGoTextEl.val());i.page.currentPage!==a&&(i.page.currentPage=a,i.goClick=!0,i._triggerHandler(t,Nt,e.objClone(i.page)))},_onPagingRowClick:function(t){var i=t.data.me,a=e(this);i.options.data.page.size=i.page.size=e.string.toNumber(a.val()),i.page.currentPage=1,i._triggerHandler(t,Nt,e.objClone(i.page))},_createPagingBarSelectPage:function(t){var i,a=this,n=t.size,o=t.select,r="sweet-gird-paging-select-down",l=e("<div>").addClass(t.selectElClass),s=e("<a>"),d=e("<em>"),c=e("<div>"),h={};return i=a._createDropDown(o),d.appendTo(s),c.addClass(r).appendTo(s),s.addClass(t.aElClass).bind("click",{attachEl:l,dropDown:i,type:t.type},a._onSelectClick).appendTo(l),i.addClass(t.downElClass).appendTo(document.body),h={me:a,obj:t,emEl:d,pageRowDropDown:i},i.find("li").bind("click",h,a._onPageListClick),i.find("li").each(function(){var t=e.string.toNumber(e(this).val());n===t&&a._onPageListClick({data:h},e(this))}),{selectEl:l,dropDownEl:i}},_onPageListClick:function(i,a){var n,o,r=i.data.me,l=i.data.obj,s=i.data.emEl,d=i.data.pageRowDropDown;if(a=a||e(this),n=e.string.toNumber(a.val()),bt[0]===l.type)r.pageRowsChoosedLiEl&&r.pageRowsChoosedLiEl.removeClass(ut),s.text(l.text.replace("{0}",n)),r.pageRowsChoosedLiEl=a;else{if(bt[1]!==l.type)return r._error("Unsupported combobox type. Not in ["+bt[0]+", "+bt[1]+"]."),t;r.pageChoosedLiEl&&r.pageChoosedLiEl.removeClass(ut),o=a.html(),s.text(l.text.replace("{0}",n).replace("{1}",o.substr(o.indexOf("/")+1,o.length))),r.pageChoosedLiEl=a}a.addClass(ut),d.hide(),r.initial||(r._triggerHandler(i,Nt,e.objClone(r.page)),r.initial=!1)},_onSelectClick:function(t){if(!e.isVisiable(t.data.dropDown)){var i=t.data.attachEl,a=t.data.dropDown,n=t.data.type,o=e.getMaxZIndex(e.string.toNumber(a.css("z-index")));bt[0]===n?a.data("rowFlag",!0):bt[1]===n&&a.data("pageFlag",!0),a.css(e.getFloatOffset(i,a,null)).css("z-index",o).show()}},_createDropDown:function(t){var i=this,a=e("<div>"),n=e("<ul>");t=t||[20,50,100];for(var o,r,l=0;t.length>l;l++)o=""+t[l],r=o.indexOf("/"),e("<li>").val(-1===r?o:o.substr(0,r)).text(o).appendTo(n);return n.appendTo(a),a.addClass(rt+" "+i.floatBgClass),a},_createPagingBarTotalText:function(){var t=this,i=t.options,a="sweet-grid-paging-totaltext",n=t.totalTextEl=e("<span>");n.addClass(a).text(Tt.text.replace("{0}",i.data.page.total)).appendTo(t.pagingInnerEl)},_refreshPagingBarTotalText:function(e){var t=this;t.totalTextEl.text(Tt.text.replace("{0}",e))},_createPagingBarButton:function(t,i,a,n){var o="sweet-gird-paging-button",r="sweet-grid-paging-button-text",l=e("<a>"),s=e("<div>"),d=e("<em>");return s.addClass(t).appendTo(l),e.isNotNull(i)&&(Et[0]===a?(d.html(i).insertAfter(s),l.addClass(r)):Et[1]===a?(d.html(i).insertBefore(s),l.addClass(r)):e.log("Nothing we can do. Not in ["+Et[0]+", "+Et[1]+"]. value="+a)),e.isNotNull(n)&&l.attr("title",n),l.addClass(o),l},_createPagingBarNumItem:function(){var t,i,a=this,n=(a.options,yt+2),o=e("<span>").text("...").hide(),r=e("<span>").text("..."),l=a.numItemEl=e("<div>"),s=[],d=[],c=a.page.totalPage,h=a.page.currentPage,u=1;
if(n>=c)for(var p=0;c>p;p++)i=p+1,t=e("<a>").addClass(st).val(i).text(i).appendTo(l),s[p]=t;else{1===c||c===h?u=1===h?h+1:h-yt:yt>h-1?u=2:yt>c-h?u=c-yt:a.goClick?(u=h,a.goClick=!1):u=e.string.toNumber(a.numEls[1].val())===h||e.string.toNumber(a.numEls[yt].val())===h?h-2:e.string.toNumber(a.numEls[1].val());for(var f=0;n>f;f++)i=f+u-1,t=e("<a>").addClass(st).val(i).text(i).appendTo(l),0===f?(t.val(1).text(1),o.insertAfter(t),d[0]=o):yt+1===f&&(t.val(c).text(c),r.insertBefore(t),d[1]=r),s[f]=t}for(var g=0;s.length>g;g++)a.page.currentPage===e.string.toNumber(s[g].val())&&(s[g].addClass(ht),a.pageingcurrentNumEl=s[g]);d.length>0&&(1===e.string.toNumber(s[1].val())-1?d[0].hide():d[0].show(),c===e.string.toNumber(s[yt].val())+1?d[1].hide():d[1].show()),l.bind("click",function(e){a._onPagingBarNumClick(e)}).appendTo(a.pagingInnerEl),a.numEls=s,a.numMoreEls=d},_onPagingBarNumClick:function(t,i){var a,n=this;i?n._triggerHandler(t,Nt,e.objClone(n.page)):(a=e(t.target),(a.hasClass(st)||a.hasClass(ut))&&(n.page.currentPage=e.string.toNumber(a.val()),n._triggerHandler(t,Nt,e.objClone(n.page))))},_triggerHandler:function(i,a,n){var o,r=this;return Nt===a&&r.options.store&&(r.options.store._setDataPage(r.getPageInfo()),r.options.store.loadRecords(r.getAllConditions())),e.isNull(r.handlers)?t:(e.each(r.handlers,function(e,t){a===e&&(r._info(a+" event occured!"),o=t.call(null,i,n))}),o?o:n)},getAllConditions:function(){var i,a,n=this,o={},r=n.getPageInfo(),l=n._getFilters(),s=JSON.parse(JSON.stringify(n._getOrders())),d=0,c=0,h=n.headerColumns,u=h.length;if(r&&t!==r.start&&t!==r.limit&&(o.start=r.start,o.limit=r.limit),l.filter&&(o.filter=l.filter),s.order){for(d=0;s.order.length>d;d++)for(i=s.order[d],c=0;u>c;c++)if(h[c].name===i.name&&"date"===i.dataType&&!i.hidden&&!i.hiddenForever&&e.isNotNull(h[c].useDSTutcOrder)){a=JSON.parse(JSON.stringify(i)),i.name=h[c].useDSTutcOrder,i.dataType="number",i.data=a;break}o.order=s.order}return o},getPageInfo:function(){var e=this;return e.page?{start:(e.page.currentPage-1)*e.page.size,limit:e.page.size,currentPage:e.page.currentPage,size:e.page.size}:{}},_getFilters:function(){var t=this,i=[];return e.each(t.filters,function(e,t){i.push({name:e,type:t.type,value:t.value,text:t.text})}),{filter:i}},_getOrders:function(){var e=this;return{order:e.orders}},_render:function(t){var i=this;return i._super(t)&&i.gridEl?(i.gridEl.appendTo(i.renderEl),i._gridMenuEl=e('<div id="'+i._gridMenuId+'">').appendTo(document.body),i.rendered=!0,!0):!1},_destroyWidget:function(){var e=this;e.timerGridTreeContent&&Sweet.Task.Timeout.stop(e.timerGridTreeContent),e.timerGridContent&&Sweet.Task.Timeout.stop(e.timerGridContent),e.__destroyTableActionBar(),e.__destroyTableHeader(),e.__destroyTableContent(),e.__destroyTablePagingBar(),e.gridEl&&(e.gridEl.remove(),e.gridEl=null),e._gridMenuEl&&(e._gridMenuEl.remove(),e._gridMenuEl=null)},__destroyTableActionBar:function(){var t=this;t.selectColEl&&(t.selectColEl.remove(),t.selectColEl=null),t.selectColList&&e.isFunction(t.selectColList.destroy)&&(t.selectColList.destroy(),t.selectColList=null),t.selectColWin&&(e.isFunction(t.selectColWin.destroy)&&t.selectColWin.destroy(),t.selectColWin=null,t.__selectColumnWinAEl=null),t._multiSortWin&&e.isFunction(t._multiSortWin.destroy)&&(t._multiSortWin.destroy(),t._multiSortWin=null,t.firstCol&&(t.firstCol=null),t.secondCol&&(t.secondCol=null),t.thirdCol&&(t.thirdCol=null)),t.secondaryPanel&&e.isFunction(t.secondaryPanel.destroy)&&(t.secondaryPanel.destroy(),t.secondaryPanel=null),t.actionBarEl&&(t.actionBarEl.remove(),t.actionBarEl=null),t.exportEl&&(t.exportEl.remove(),t.exportEl=null)},__destroyTableHeader:function(){var e=this,t=e.filterPanels,i=t?t.length:0;e.headerEl&&(e.headerEl.remove(),e.headerEl=null),e.resizeEl&&(e.resizeEl.remove(),e.resizeEl=null);for(var a=0;i>a;a++)e.filterPanels[a].remove();e.filterPanels=null,e.oldActiveFilterTdEl=null,e.activeFilterTdEl=null},__destroyTableContent:function(){var e=this;e.contentEl&&(e.contentEl.remove(),e.contentEl=null)},__destroyTablePagingBar:function(){var e=this;e.pagingRowDropDownEl&&(e.pagingRowDropDownEl.find("li").unbind(),e.pagingRowDropDownEl.remove(),e.pagingRowDropDownEl=null),e.pagingPageDropDownEl&&(e.pagingPageDropDownEl.find("li").unbind(),e.pagingPageDropDownEl.remove(),e.pagingPageDropDownEl=null),e.pagingEl&&(e.pagingEl.remove(),e.pagingEl=null)}}),Sweet.grid.Grid=e.sweet.widgetGrid}(jQuery),function(e,t){var i="sweet-form-checkbox-unchecked",a="sweet-form-checkbox-checked",n="sweet-grid-header",o="sweet-grid-content",r="sweet-grid-header-bottom",l="sweet-grid-resize",s="sweet-select-none",d="select-column",c="multi-sort",h="second-stat",u="clear-filter",p="export",f="csv",g="xls",m="pdf",v="li-csv",w="li-xls",_="li-pdf",C="sweet-grid-checkbox",b="sweet-grid-header-table-td",E="sweet-grid-header-table-td-common",y="sweet-grid-header-table-td-common-hover",x="sweet-grid-header-sort-asc",T="sweet-grid-header-sort-desc",D="sweet-grid-resize-drag",S="sweet-grid-resize-down",k="text",L="text-hover",N="sweet-grid-header-filter",I="sweet-grid-header-filter-pic",A="sweet-list-list-con",P="sweet-grid-header-filter-pad",M="filter-one",F="filter-two",W="-grid-filter",B="-grid-filter-btn",O="sweet-grid-sn",R="sweet-grid-content-menu",H="sweet-grid-content-table",j="sweet-grid-content-tr",z="sweet-grid-content-data-left",V="sweet-grid-content-data-right",U="sweet-grid-content-data-center",G="sweet-grid-content-row-selected",Y="sweet-grid-content-td-tree",q="sweet-grid-content-td-tree-a",$="sweet-grid-content-td-plus",K="sweet-grid-content-td-minus",X="sweet-grid-content-td-space",Q="sweet-common-opercolumn-edit",Z="sweet-common-opercolumn-modify",J="sweet-common-opercolumn-delete",et="sweet-common-opercolumn-close",tt="sweet-common-opercolumn-pause",it="sweet-common-opercolumn-start",at="sweet-common-opercolumn-reset",nt="sweet-common-opercolumn-detail",ot="sweet-common-opercolumn-confirm",rt="sweet-grid-paging-dropDown",lt="sweet-grid-paging-num",st="current",dt="choosed",ct=["row","page"],ht=["left","right"],ut=5,pt=30,ft=Sweet.core.i18n.grid,gt=Sweet.core.i18n.exportType,mt=Sweet.constants.dataType,vt=Sweet.constants.symbol,wt=Sweet.constants.exportType,_t="pageClick",Ct="cellClick",bt="rowClick",Et="rowDblClick",yt="checkBoxClick",xt="treeExpand",Tt="beforeSetData",Dt="export",St="sweet-grid-content-timer",kt={red:"red",orange:"orange",yellow:"yellow",green:"green",blue:"blue",indigo:"indigo",purple:"purple"},Lt=80,Nt=23,It=18,At=19,Pt=40,Mt=200,Ft=120,Wt=-1,Bt=1;e.widget("sweet.widgetBigGrid",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-BigGrid]",defaultElement:"<div>",type:"biggrid",eventNames:{pageClick:"翻页事件",cellClick:"单元格点击事件",rowClick:"行点击事件",rowDblClick:"行双击事件",treeExpand:"树节点展开事件",checkBoxClick:"复选框点击事件",menuClick:"菜单点击事件",beforeSetData:"setData前触发事件",afterSetData:"setData后触发事件","export":"导出事件",sort:"排序事件",filter:"过滤事件",multiOrders:"多列排序事件",clearAllFilters:"清除所有过滤的事件"},options:{width:"100%",height:300,data:{},autoColumnWidth:!0,beforeScroll:e.noop,afterScroll:e.noop},setSecondaryStatConfig:function(e){var t=this;t.options.data&&t.options.data.secondaryStat&&(t.options.data.statParams=e)},setData:function(t){if(!e.isNull(t)){var i=this;i._triggerHandler(null,Tt),e.isArray(t)?i.options.data=e.extend({},i.options.data,{data:t}):(i.options.data.data=[],t.columns&&(i.options.data.columns=[]),i.options.data=e.extend(!0,{},i.options.data,t)),i._createGridWidget(),i._render(i.options.renderTo),i._doLayout(),0===i.gridScrollLeftFlag?(i.gridScrollLeft=0,i.gridScrollLeftFlag++,i.contentEl.scrollLeft(i.gridScrollLeft)):i.contentEl.scrollLeft(i.gridScrollLeft)}},setTreeData:function(t){var i=this,a=t;e.isArray(t)||(a=t.data),i.tempTreeData=i._toJson(a).reverse(),i.tempTreeDataIndex=0,i.treeData=i.treeData.concat(i.tempTreeData),i._addRowId(i.treeData),i.timerGridTreeContent=i.options.id+"-tree-"+St,Sweet.Task.Timeout.start({id:i.timerGridTreeContent,run:i._buildGridTreeContent,scope:i,interval:10})},loadingMask:function(){var e=this;e.loadEl&&e.loadEl.show().sweetMask()},loadingMaskVisible:function(){var e=this,t=!1;return e.loadEl&&e.loadEl.is(":visible")&&(t=!0),t},unLoadingMask:function(){var e=this;e.loadEl&&(e.loadEl.unSweetMask(),e.loadEl.hide())},getRowValue:function(i){if("number"!==e.type(i))return this._error("getRowValue() The input parameter is not a number."),t;var a=this,n=a.options.data.data;return e.isNull(i)?e.objClone(n):0>i||n&&i>n.length?t:e.objClone(n[i])},getSelectedValue:function(){function t(t){if(e.isNull(t))return[];var i=[];return e.each(t,function(e,t){i.push(t)}),i}var i=this,a=t(i.selectedData),n=t(i.selectedTreeData);return e.objClone(a.concat(n))},insertRows:function(i,a){if(e.isNull(i))return this._error("insertRows() The input data is null."),t;var n=this,o=e.objClone(i);a=a||!0,e.isArray(o)||(o=[o]),n._buildInsertGridContent(o,a)},updateRows:function(i){var a,n,o,r=this,l=i;if(e.isNull(i))return r._error("updateRows() The input data is null."),t;for(e.isArray(i)||(l=[i]),n=l.length,a=0;n>a;a++)o=l[a],r._updateRows(o.row,o.data)},selectRows:function(n){if(e.isNull(n))return this._error("selectRows() The input param is null."),t;var o,r=this;o=e.isArray(n)?n:[n],r._allRowUnSelect(),e(n).each(function(t,n){var o,l,s=r.__findTargetTr(n),d=s.trEl;d&&(d.addClass(G),o=d.find("."+C),o&&o.length>0&&(l=e(o.find("a")).removeClass(i).addClass(a),r._oneRowSelect(l.attr("row"),l.attr("tree"))),r._onTrClick({data:{me:r,tr:d,eventName:bt}}))})},selectPrev:function(){var t,i,a=this;return a.hasPrev()&&(t=a._getSelectedFirstRow(),i=t.length>0?e.string.toNumber(e(t).attr("row"))-1:a.contentTableEl.find("tr").length,a.selectRows(i)),a.getSelectedValue()},hasPrev:function(){var t,i=this,a=i.contentTableEl.find("tr").length;return 0===a?!1:(t=i._getSelectedFirstRow(),t.length>0?e.string.toNumber(e(t).attr("row"))>1:!0)},selectNext:function(){var t,i,a=this;return a.hasNext()&&(t=a._getSelectedLastRow(),i=t.length>0?e.string.toNumber(e(t).attr("row"))+1:1,a.selectRows(i)),a.getSelectedValue()},hasNext:function(){var t,i=this,a=i.contentTableEl.find("tr").length;return 0===a?!1:(t=i._getSelectedLastRow(),t.length>0?a>e.string.toNumber(e(t).attr("row")):!0)},clearAllFilters:function(t){var i=this;i.filters={},e.each(i.filterObjs,function(e,t){if(t&&t.filter&&t.filter.reset(),t&&t.tdEl){var i=t.tdEl.find("."+I);i&&i.remove()}}),i.page.currentPage=1,i.options.store?(i.options.store.clearFilters&&i.options.store.clearFilters(),t&&(i.options.store._setPage(i.getPageInfo()),i.options.store.load(i.getAllConditions()))):i._triggerHandler(null,"clearAllFilters",i.getAllConditions())},clearAllOrders:function(t){var i=this;i.orders=[],e.each(i.headerTdEls,function(e,t){t&&(t.removeClass(y+" "+x+" "+T).addClass(E),t.find("div:first").removeClass(L))}),i.page.currentPage=1,i.options.store?(i.options.store.clearOrders&&i.options.store.clearOrders(),t&&(i.options.store._setPage(i.getPageInfo()),i.options.store.load(i.getAllConditions()))):i._triggerHandler(null,"clearAllOrders",i.getAllConditions()),i._clearMultiSort()},_clearMultiSort:function(){var t=this;if(e.isNotNull(t.firstCol)&&e.isNotNull(t.secondCol)&&e.isNotNull(t.thirdCol)){var i={value:"",text:""};t.firstCol.radioGroup.setValue(i),t.secondCol.radioGroup.setValue(i),t.thirdCol.radioGroup.setValue(i),t.firstCol.combobox.setValue(i),t.secondCol.combobox.setValue(i),t.thirdCol.combobox.setValue(i)}},_getSelectedFirstRow:function(){var e=this;return e.contentTableEl.find("."+G+":first")},_getSelectedLastRow:function(){var e=this;return e.contentTableEl.find("."+G+":last")},_updateRows:function(i,a){var n=this;if(e.isNull(a))return n._error("_updateRows() The input data is null."),t;var o,r,l,s,d,c,h,u=e.objClone(a);return h=n.__findTargetTr(i),o=h.trEl,l=h.tree,d=h.realRow,o?(e.each(u,function(t,i){if(s=n.columnRelation[t],!e.isUndefined(s)){r=l?n.contentTreeTdEls[d][s].empty():n.contentTdEls[d][s].empty(),c=e("<div>"),n.options.data.data[d][t]=i;var a={row:d,column:s,rowData:l?n.treeData[d]:n.options.data.data[d],columnObj:n.headerColumns[s],divEl:c,depth:0,isTree:!1,tdEl:r};n.__getContentTdAlign(a),n.__getContentTdRender(a),r.unbind("click"),n.__bindContentTdClick(a),c.appendTo(r)}}),t):(n._error("_updateRows() The target row does not exist."),t)},deleteRows:function(i){var a,n,o=this,r=i;if(e.isNull(i))return o._error("deleteRows() The input data is null."),t;for(e.isArray(i)||(r=[i]),n=r.length,a=0;n>a;a++)o._deleteRows(r[a]);o._refreshContentSN()},_deleteRows:function(e){var i,a,n,o,r=this;return o=r.__findTargetTr(e),i=o.trEl,a=o.tree,n=o.realRow,i?(i.remove(),a?(r.contentTreeTdEls[n]=null,r.contentTreeTrEls[n]=null,r.checkboxTreeTdEls[n]=null,r.treeData[n]=null):(r.contentTdEls[n]=null,r.contentTrEls[n]=null,r.checkboxTdEls[n]=null,r.options.data.data[n]=null),t):(r._error("deleteRows() The target row does not exist."),t)},__findTargetTr:function(t){var i,a,n,o,r,l,s=this;for(i=s.__getContentTrEls(),o=i.length,l=0;o>l;l++)if(n=e(i[l]),e.string.toNumber(n.attr("row"))===t){a=n,r=n.attr("tree");break}return{trEl:a,tree:r,realRow:t-1}},_addRowId:function(t,i){if(e.isArray(t)){i=i||1;for(var a=0;t.length>a;a++)t[a].rowId=i+a}},_getWidth:function(){return this.gridEl.externalWidth()},_getHeight:function(){return this.gridEl.externalHeight()},_doLayout:function(e){var t=this,i=t.gridEl.width(),a=t.gridEl.height(),n=0,o=0,r=0,l=0,s=t.options;if(t.rendered){if(t._gridMenu&&t._gridMenu.destroy(),t.headerEl){s.autoColumnWidth&&t._modifyColumnWidth();for(var d=0;t.headerTdEls.length>d;d++){var c=t.headerTdEls[d];c&&c.find("div:first").externalWidth(t.widths[d]?t.widths[d]:0)}if(o=t.headerEl.height(),t.headerEl.width(i),t.headerTableElWidth=l=t.__calHeaderWidth(),t.headerReRender){if(!e&&!s.autoColumnWidth)if(i>l){var h=i-l-It;l=i,t.widths[t.headerTdEls.length-1]+=h}else t.widths[t.headerTdEls.length-1]-=It;s.autoColumnWidth||t.__resetHeaderTdEl(t.headerTdEls.length-1),t.__resetHeaderWidth(l),t.headerReRender=!1}}t.actionBarEl&&(n=t.actionBarEl.height(),t.actionBarEl.width(i)),t.contentEl&&(r=a-o-n,t.contentEl.width(i).height(r),t.__resetContentWidth(),t._resetContentTdELWidth(),t.loadEl.width(i-It).css("top",a-30),t.contentTableEl.hasClass(H)||t.contentTableEl.addClass(H)),t._doResizeElLayout()}},__resetHeaderTdEl:function(e){var t=this,i=t.headerTdEls[e];i&&i.find("div:first").externalWidth(t.widths[e])},__resetHeaderWidth:function(e){var t=this;t.headerDivEl.externalWidth(e),t.headerTableElWidth=e},_modifyColumnWidth:function(){var e=this,t=e.headerColumns,i=t.length,a=i,n=0,o=0,r=e.count,l=0,s=e.gridEl.width(),d=0,c=Ft;if(!(Ft>s)){for(l=0;i>l;l++)t[l].hidden?a--:t[l].width?o+=Number(t[l].width):n++;for(l=0;r>l;l++)s-=e.widths[l];for(s-=It,s-=a-1+r+1,s-=o,d=Math.floor(s/(0>=n?1:n)),d>Ft&&(c=d),l=r;e.originalWidths.length>l;l++)Wt===e.originalWidths[l]&&(e.widths[l]=c)}},__calHeaderWidth:function(){var t,i=this,a=i.headerColumns,n=i.count,o=0,r=i.gridEl.width(),l=It;for(e.each(i.widths,function(e,i){t=a[e-n],!t||t&&t.hidden||(l+=i+1)}),l--,o=0;n>o;o++)l+=i.widths[o];return r>l?r:l},__resetContentWidth:function(){var e=this;e.contentDivEl.width(e.headerTableElWidth-It),e.contentTableEl.width(e.headerTableElWidth-It)},_doResizeElLayout:function(){if(!this.options.data||this.options.data.resizable){var t=this,i=t.gridEl.height(),a=t.actionBarEl.height(),n=0,o=t.count;t.pagingEl&&(n=t.pagingEl.height()),t.headerTdEls&&e.each(t.headerTdEls,function(r,l){if(r>o-1){var s,d=l.position(),c=0,h=l.width(),u=l.height(),p=a,f=e.string.toNumber(l.attr("rowspan")),g=e.string.toNumber(l.attr("depth")),m=e.isVisiable(l);f!==g&&(c=g-1,p+=u*c),s=t.resizeEls[r-o].css({left:d.left+h,top:p}).attr("visiable",m?"true":"false").height(i-n-p),m?s.hasClass(D)||s.addClass(D):s.removeClass(D)}})}},_closeFloatPanel:function(){var e=this;e.__closeFloatPanel(e.pagingRowDropDownEl,"rowFlag"),e.__closeFloatPanel(e.pagingPageDropDownEl,"pageFlag"),e.__closeFloatPanel(e.exportEl,"exportFlag"),e.__closeFloatPanel(e.selectColEl,"selectColFlag"),e.__closeFloatFilterPanel(e.oldActiveFilterTdEl),e.__closeFloatFilterPanel(e.activeFilterTdEl)},__closeFloatPanel:function(t,i){var a;t&&(a=t.data(i),!a&&e.isVisiable(t)&&t.hide(),t.data(i,!1))},__closeFloatFilterPanel:function(e){var t=this;e&&(e.data("created")||(e.data("filterPanel").hide(),t.__onHeaderTdMouseLeave(null,e)),e.data("created",!1))},_createSweetWidget:function(){if(!this.renderEl){var t=this,i="sweet-grid",a=t.gridEl=e("<div>");t.initial=!0,t.locked=!1,a.addClass(i).attr("id",t.options.id).width(t.options.width).height(t.options.height),t._createGridWidget()}},_createGridWidget:function(){var e=this;if(e.options.data){var t=e._createGridHeader();t&&e._createGridActionBar(),e._createGridContent(),e._addListener(),e._addLoading()}},_createGridActionBar:function(){this.__destroyTableActionBar();var t=this,i=t.options.data,a=!1,n=t.actionBarEl=e("<div>").addClass("sweet-grid-action-bar"),o=e("<div>").addClass("sweet-grid-action-bar-pic");i.selectColumn&&(a=!0,e("<span>").attr("title",ft.selectCol).addClass(d).appendTo(o)),i.multiColumnSort&&(a=!0,e("<span>").attr("title",ft.multiSort).addClass(c).appendTo(o)),i.secondaryStat&&(a=!0,e("<span>").attr("title",ft.secondStat).addClass(h).appendTo(o)),i.clearFilters&&(a=!0,e("<span>").attr("title",ft.clearFilter).addClass(u).appendTo(o)),i.export&&(a=!0,e("<span>").attr("title",ft.export).addClass(p).appendTo(o)),o.bind("click",function(e){t.__onPicBarClick(e)}).appendTo(n),a?n.insertBefore(t.headerEl):n.height(0)},__onPicBarClick:function(t){var i=this,a=e(t.target);a.hasClass(d)?i.__createSelectColumnPanel(a):a.hasClass(c)?i.__createMultiSort():a.hasClass(u)?Sweet.Msg.confirm(ft.qClearFilter,null,null,function(){i.clearAllFilters(!0)}):a.hasClass(p)?i.__createExportPanel(a):a.hasClass(h)&&i.__createSecondaryStatPanel()},__createSecondaryStatPanel:function(){var e,t=this,i=t.options.data;i.statParams&&(t.secondaryPanel&&(t.secondaryPanel.destroy(),t.secondaryPanel=null),e=i.statParams,t.secondaryPanel=new Sweet.cmp.SecondaryStat({dims:e.dims,indicators:e.indicators,statFun:e.statFun}))},__createMultiSort:function(){function i(e,t){var i=[],a=new Sweet.form.ComboBox({label:!0,pleaseSelect:!0,labelWidth:ft.multiSortWin.comboLabelWidth,width:ft.multiSortWin.comboWidth,data:t,labelText:e,tip:!0});i.push(a);var n=new Sweet.form.RadioGroup({width:ft.multiSortWin.radioWidth,columns:"auto",data:[{text:ft.multiSortWin.asc,value:"ASC"},{text:ft.multiSortWin.desc,value:"DESC"}],tip:!0});i.push(n);var o=new Sweet.panel.FlowPanel({width:"100%",height:25,items:i,itemExtend:!0});return{combobox:a,radioGroup:n,panel:o}}function a(t,i){t&&Sweet.core.i18n.combobox.pleaseSelect===t.value||e.equals(t,i.combobox.getValue())&&(i.combobox.setValue({value:Sweet.core.i18n.combobox.pleaseSelect,text:Sweet.core.i18n.combobox.pleaseSelect}),i.radioGroup.setValue({}))}function n(e,t){var i=e.getValue(),a=t.getValue();return i&&i.value&&Sweet.core.i18n.combobox.pleaseSelect!==i.value||a&&a.value?!1:!0}function o(e,t){var i=e.getValue(),a=!1,n=t.getValue(),o=!1;return i&&i.value&&Sweet.core.i18n.combobox.pleaseSelect!==i.value||(a=!0),n&&n.value||(o=!0),a&&!o||o&&!a?!0:!1}function r(e,t){var i=e.getValue(),a=t.getValue();return a&&a.text?l.__getOrderFormat(i.data.name,a.value,i.data.dataType):null}var l=this,s=[],d=l.options.data?l.options.data.multiSortColumnsArr:[],c=[];if(l._multiSortWin)return l._multiSortWin.show(),t;s=e.isArray(d)&&d.length>0?d:l.headerColumns,e.each(s,function(t,i){!i.hiddenForever&&e.isNotNull(i.header)&&i.sortable&&c.push({text:i.header,value:i.name,data:i})});var h,u,p=l.firstCol=i(ft.multiSortWin.firstSort,c),f=l.secondCol=i(ft.multiSortWin.secondSort,c),g=l.thirdCol=i(ft.multiSortWin.thirdSort,c);p.combobox.addListener("change",function(e,t){a(t,f),a(t,g)}),f.combobox.addListener("change",function(e,t){a(t,p),a(t,g)}),g.combobox.addListener("change",function(e,t){a(t,p),a(t,f)}),h=new Sweet.panel.VPanel({items:[p.panel,f.panel,g.panel]}),l._multiSortWin=u=new Sweet.Window({width:ft.multiSortWin.winWidth,height:190,title:ft.multiSortWin.title,content:h,listeners:{ok:function(){if(n(p.combobox,p.radioGroup)&&n(f.combobox,f.radioGroup)&&n(g.combobox,g.radioGroup))return Sweet.Msg.warn(ft.multiSortWin.firstNoSelectTip),!1;if(o(p.combobox,p.radioGroup))return Sweet.Msg.warn(ft.multiSortWin.firstNoSelectTip),!1;if(o(f.combobox,f.radioGroup))return Sweet.Msg.warn(ft.multiSortWin.secondNoSelectTip),!1;if(o(g.combobox,g.radioGroup))return Sweet.Msg.warn(ft.multiSortWin.thirdNoSelectTip),!1;l.orders=[];var t=r(p.combobox,p.radioGroup),i=r(f.combobox,f.radioGroup),a=r(g.combobox,g.radioGroup);t&&l.orders.push(t),i&&l.orders.push(i),a&&l.orders.push(a),l.page.currentPage=1,l.options.store?(l.options.store._setDataPage(l.getPageInfo()),l.options.store.load(l.getAllConditions())):l._triggerHandler(null,"multiOrders",l.getAllConditions()),e.each(l.headerTdEls,function(e,t){if(t){t.removeClass(y+" "+x+" "+T).addClass(E),t.find("div:first").removeClass(L);for(var i=t.attr("columnName"),a=0;l.orders.length>a;a++)if(i===l.orders[a].name){var n=x;l.orders[a].order===Sweet.constants.sortType.DESC&&(n=T),t.addClass(n),t.removeClass(E),t.find("div:first").addClass(k)}}})}}}),u.show()},__createSelectColumnPanel:function(i){var a,n=this;if(n.selectColEl)return a=e.getFloatOffset(i,n.selectColEl,!0),n.selectColEl.css(a).show().data("selectColFlag",!0),t;var o,r,l=n.options.id+"-select-column",s=e("<div>").attr("id",l).addClass(n.winBgClass+" sweet-grid-select-column").bind("click",function(){s.data("selectColFlag",!0)}).appendTo(e(document.body)),d=[],c=[];r=n.__getSelectColumnData(),d=r.data,c=r.value;var h=n.gridEl.height()-70,u=22*d.length+10;o=new Sweet.list.OptimizeList({width:200,height:u>h?h:u,multi:!0,data:d,value:c,minRemains:1,tip:!0,renderTo:l}),o.addListener("checkboxClick",function(e,t){n.__onSingleColumnHiddenClick(e,t.data.index,t.checked)}),a=e.getFloatOffset(i,s,!0),s.css(a).show().data("selectColFlag",!0),n.selectColEl=s,n.selectColList=o},__getSelectColumnData:function(){var t,i,a,n,o,r=this,l=r.headerColumns,s=l.length,d=[],c=[];for(a=0;s>a;a++)n=l[a],t=n.enableHdMenu,i=n.hiddenForever||!1,o={text:n.header,value:n.name,data:{index:a}},!e.isUndefined(t)&&!t||i||(d.push(o),n.hidden||c.push(o));return{data:d,value:c}},__createExportPanel:function(i){var a,n=this,o=80;if(n.exportEl)return a=e.getFloatOffset(i,n.exportEl,!0),n.exportEl.css(a).show().data("exportFlag",!0),t;var r,l,s,d=n.options.data.exportType||[],c=d.length,h=e("<div>").width(o).addClass(n.winBgClass+" sweet-grid-export"),u=e("<ul>");for(l=0;c>l;l++)s=d[l],wt.CSV===s?(r=e("<li>").addClass(v).text(gt.csv).appendTo(u),e("<span>").addClass(f).prependTo(r)):wt.XLS===s?(r=e("<li>").addClass(w).text(gt.xls).appendTo(u),e("<span>").addClass(g).prependTo(r)):wt.PDF===s&&(r=e("<li>").addClass(_).text(gt.pdf).appendTo(u),e("<span>").addClass(m).prependTo(r));u.appendTo(h),a=e.getFloatOffset(i,h,!0);var p=e.getMaxZIndex(t,"sweet-grid-action-bar-pic");h.data("exportFlag",!0).bind("click",{me:n},n._onExportClick).appendTo(e(document.body)).css(a).css("z-index",p),n.exportEl=h},_onExportClick:function(i){var a,n,o=i.data.me,r=e(i.target),l=o.headerColumns,s=[],d={},c={};for(n=0;l.length>n;n++)a=l[n],d={},d.header=a.header,d.name=a.name,d.dataType=a.dataType,d.hidden=a.hidden,s.push(d);if(r.hasClass(v))c={type:gt.csv,columns:s};else if(r.hasClass(w))c={type:gt.xls,columns:s};else{if(!r.hasClass(_))return o._error("Unknown export type."),t;c={type:gt.pdf,columns:s}}o._triggerHandler(i,Dt,c)},_createGridHeader:function(){var t=this;if(!t.options.data.columns)return!0;if(t.headerDivEl&&t.headerDivEl.css({left:0}),t.resizeEl&&t.resizeEl.css({left:0}),t.allCheckboxEl&&t.allCheckboxEl.removeClass(a).addClass(i),e.equals(t.historyColumns,t.options.data.columns))return!1;t.gridScrollLeftFlag=0,t.historyColumns=e.objClone(t.options.data.columns),t.__destroyTableHeader();var o,r,l=e.objClone(t.options.data.columns),s=t.options.data.checkbox,d=t.options.data.sn,c=t.headerEl=e("<div>").addClass(n).appendTo(t.gridEl),h=t.headerDivEl=e("<div>").appendTo(c),u=t.headerTableEl=e("<table>").attr({cellspacing:0,cellpadding:0,border:0}).appendTo(h),p=e("<tr>").appendTo(u),f=[],g=0,m=[],v=[],w=[],_=[];if(t.filterObjs=[],t.filters={},t.filterPanels=[],t.orders=[],t.hiddenColumn=0,t.columnRelation={},t.count=0,t._amendColumns(l),t._parseHeader(l,0,v),t.__ColumnNumRelation(l),s){var y=g++;o=e("<td>").attr("rowspan",v.length).addClass(b+" "+E).mouseenter({me:t},t.__onHeaderTdMouseEnter).mouseleave({me:t},t.__onHeaderTdMouseLeave).appendTo(p),r=e("<div>").addClass(C).appendTo(o),t.allCheckboxEl=e("<a>").addClass(i).bind("click",{me:t},t._onAllRowClick).appendTo(r),f[y]=o,m[y]=Nt,t.count++}if(d){var x=g++;o=e("<td>").attr("rowspan",v.length).addClass(b+" "+E).mouseenter({me:t},t.__onHeaderTdMouseEnter).mouseleave({me:t},t.__onHeaderTdMouseLeave).appendTo(p),r=e("<div>").text(ft.SN).addClass(k).appendTo(o),f[x]=o,m[x]=Lt,t.count++}_=t._generateHeader(v,p,u),w=t._amendHeader(_),t.headerTdEls=f,t.widths=m,t.originalWidths=JSON.parse(JSON.stringify(m)),t.headerColumns=[];for(var T=0;w.length>T;T++){var D=w[T].tdEl.attr("column",T);e.isNotNull(w[T].column)&&D.attr("columnName",w[T].column.name),t.headerTdEls.push(D),t.widths.push(e.isNull(w[T].width)?Ft:w[T].width),t.originalWidths.push(e.isNull(w[T].width)?Wt:w[T].width),t.headerColumns.push(w[T].column)}return t._columnResizable(),t.headerReRender=!0,!0},headerChanged:function(t){if(!(e.isNull(t)||!e.isArray(t)||0>=t.length)){var i,a,n=this,o=0,r=[],l=t.length,s=n.headerColumns;if(!(l>n.headerColumns.length)){for(o=0;l>o;o++)a=t[o],e.isPlainObject(a)&&(i=n._findIndex(a.name),-1!==i&&(r.push({index:i,show:!a.hidden}),s[i]=e.extend(s[i],a)));r.length>0&&(n.__ColumnsHidden(r),n.headerReRender=!0,n._doLayout(!0),n.selectColList&&n.selectColList.setValue(n.__getSelectColumnData().value))}}},_findIndex:function(e){var t=this,i=0,a=t.headerColumns;for(i=0;a.length>i;i++)if(e===a[i].name)return i;return-1},__ColumnNumRelation:function(t,i){var a=this;return i=i||0,e.each(t,function(e,t){t.children&&t.children.length>0?i=a.__ColumnNumRelation(t.children,i):a.columnRelation[t.name]=i++}),i},_amendColumns:function(t,i){for(var a,n=this,o=0;t.length>o;o++)a=t[o],a.children&&a.hidden?n._amendColumns(a.children,a.hidden):e.isNotNull(i)&&(a.hidden=i)},_columnResizable:function(){var t,i=this;if(i.options.data.resizable){var a=i.resizeEl=e("<div>").addClass(l).appendTo(i.gridEl),n=i.headerColumns;i.resizeEls=[];for(var o=0;n.length>o;o++)t=i.resizeEls[o]=e("<div>").attr("num",o).mousedown({me:i},i._onResizeElDown).addClass(D).appendTo(a),n[o].hidden&&t.hide()}},_onResizeElDown:function(t){var i=t.data.me,a=e(t.target),n=e.string.toNumber(a.attr("num")),o=n+i.count,r=i.headerTdEls[o];"true"===a.attr("visiable")&&(i._helperEl=a,i._prevHelperEl=null,i._helperElWidth=a.width(),i._startX=t.pageX,i._startLeft=a.position().left,i._startTdLeft=r.position().left,i._startTdWidth=r.externalWidth(),e(document).bind("mousemove",{me:i},i._onResizeElMove).bind("mouseup",{me:i},i._onResizeElUp),e(document.body).addClass(s),i.__dealResizeElClass(!0,a,n))},_onResizeElUp:function(t){var i=t.data.me,a=i._helperEl;if(a){var n,o=a.position().left-i._startLeft,r=e.string.toNumber(a.attr("num")),l=r+i.count,d=0;e(document).unbind("mousemove",i._onResizeElMove).unbind("mouseup",i._onResizeElUp),e(document.body).removeClass(s),i.__dealResizeElClass(!1,a,r),i.widths[l]+=o,i.__resetHeaderTdEl(l),d=i.__calHeaderWidth(),i.__resetHeaderWidth(d),i.__resetContentWidth(),i._resetContentTdELWidthByCol(l);for(var c=0;i.resizeEls.length>c;c++)c>r&&(n=i.resizeEls[c],n.css("left",n.position().left+o))}},__dealResizeElClass:function(t,i,a){var n,o,r=this;t?(i.addClass(S).css("z-index",e.getMaxZIndex()),0!==a&&(n=r.__findPrevResizeEl(a),n&&e.isVisiable(n)&&(r._prevHelperEl=n,n.addClass(S).width(1).css("z-index",e.getMaxZIndex())))):(o="auto",i.removeClass(S).css("z-index",o),0!==a&&(n=r._prevHelperEl,n&&e.isVisiable(n)&&n.removeClass(S).width(r._helperElWidth).css("z-index",o)))},__findPrevResizeEl:function(i){var a,n,o=this;return i>0?(a=o.resizeEls[i-1],n=a.attr("visiable"),e.isNull(n)||"true"===n?a:o.__findPrevResizeEl(i-1)):t},_onResizeElMove:function(e){var t=e.data.me,i=t._helperEl;if(i){var a=e.pageX-t._startX;0>a&&Pt>t._startTdWidth+a||i.css("left",t._startLeft+a)}},_sort:function(t){var i=t.data.me,a=e(this),n=a.attr("column"),o=Sweet.constants.sortType.ASC;if(!i.locked){i.sortEl?i.sortEl.attr("column")!==a.attr("column")&&(i.sortEl.removeClass(x+" "+T+" "+y).addClass(E),i.sortEl.find("div:first").removeClass(L)):i.sortEl=a,a.hasClass(x)?(a.removeClass(x).addClass(T),o=Sweet.constants.sortType.DESC):a.hasClass(T)?(a.removeClass(T).addClass(x),o=Sweet.constants.sortType.ASC):(a.addClass(x),o=Sweet.constants.sortType.ASC),i.sortEl=a.removeClass(E),a.find("div:first").addClass(k);var r=i.headerColumns[e.string.toNumber(n)];i.orders=[],i.orders.push(i.__getOrderFormat(r.name,o,r.dataType)),i.page&&(i.page.currentPage=1),i.options.store?(i.options.store._setDataPage(i.getPageInfo()),i.options.store.load(i.getAllConditions())):i._triggerHandler(t,"sort",i.getAllConditions()),i._clearMultiSort(),e.each(i.headerTdEls,function(e,t){t&&a.attr("columnName")!==t.attr("columnName")&&(t.removeClass(y+" "+x+" "+T).addClass(E),t.find("div:first").removeClass(L))})}},__getOrderFormat:function(e,t,i){return{name:e,order:t,dataType:i}},_generateHeader:function(t,i,a){for(var n,o,l,s,d=this,c=0,h=[],u=0;t.length>u;u++){s=t[u],h[u]=[],0!==u&&(i=e("<tr>").appendTo(a));for(var p=0;s.length>p;p++)n=s[p],c=n.height||pt,o=e("<td>").height(c).addClass(b+" "+E).mouseenter({me:d},d.__onHeaderTdMouseEnter).mouseleave({me:d},d.__onHeaderTdMouseLeave).appendTo(i),l=e("<div>").text(n.header).addClass(k).appendTo(o),n.hidden&&(o.hide(),u===t.length-1&&d.hiddenColumn++),n.tooltip&&l.attr("title",n.tooltip),n.children&&n.children.length>0?(o.attr({colspan:n.colspan}).addClass(r),h[u][p]={width:n.width,column:n,tdEl:o,children:n.children.length}):(n.sortable&&o.bind("click",{me:d},d._sort),n.filter&&e("<span>").addClass(N).click({oTd:o,column:n,me:d},d._headerFilterPanel).hide().appendTo(o),o.attr({rowspan:t.length-u,depth:t.length}),h[u][p]={width:n.width,column:n,tdEl:o})}return h},_headerFilterPanel:function(i){i.stopImmediatePropagation();var a=i.data.me,n=i.data.oTd,o=e(this),r=n.data("filterPanel");if(a.activeFilterTdEl&&a.activeFilterTdEl.attr("column")!==n.attr("column")&&(a.oldActiveFilterTdEl=a.activeFilterTdEl),a._triggerBodyClick(),a.activeFilterTdEl=n,r)return a.__setFilterPanelPosition(o,r),n.data("created",!0),r.show(),t;var l,s,d,c=i.data.column,h=c.enableHdMenu,u=e.string.toNumber(n.attr("column")),p=a.options.id+"-"+u+W,f=a.options.id+"-"+u+B,g=e("<h1>").text(ft.hideCol).attr("column",u),m=e("<div>").addClass("title").text(ft.filter),v=e("<div>").attr("id",p),w=e("<div>").attr("id",f);switch(r=e("<div>").click(function(){n.data("created",!0)}).addClass(a.floatBgClass+" sweet-grid-header-filter-panel").appendTo(e(document.body)),e.isArray(a.filterPanels)?a.filterPanels.push(r):"",(e.isUndefined(h)||h)&&g.bind("click",function(t){t.stopImmediatePropagation(),a.__onSingleColumnHiddenClick(t,e.string.toNumber(e(this).attr("column"))),a._triggerBodyClick()}).appendTo(r),m.appendTo(r),v.appendTo(r),w.appendTo(r),a.__setFilterPanelPosition(o,r),c.filterType){case mt.LIST:l=a.__headerFilterListPanel(v,c);break;case mt.STRING:l=a.__headerFilterStringPanel(v);break;case mt.NUMBER:l=a.__headerFilterNumberPanel(v);break;case mt.DATE:l=a.__headerFilterDatePanel(v);break;default:a._error("Unsupported filter type ["+c.filterType+"].")}s=new Sweet.form.Button({width:70,value:{value:0,text:ft.okBtn}}),s.addListener("click",function(){a.__onFilterOKClick(n,c.name)}),d=new Sweet.form.Button({width:70,value:{value:1,text:ft.clearSingleFilter}}),d.addListener("click",function(){a.__onFilterResetClick(n,l,c.name),a._triggerBodyClick()}),new Sweet.panel.FlowPanel({width:"100%",height:25,align:Sweet.constants.align.RIGHT,items:[s,d],renderTo:f}),n.data("created",!0),n.data("filterPanel",r),n.data("filter",l),a.filterObjs.push({name:c.name,filterType:c.filterType,filter:l,tdEl:n})
},__setFilterPanelPosition:function(t,i){var a,n;a=e.getFloatOffset(t,i,!0),n=e.getMaxZIndex(),i.css({top:a.top,left:a.left,"z-index":n})},__ColumnsHidden:function(t){var i,a,n=this,o=0,r=n.count,l=n.headerColumns,s=[];for(o=0;t.length>o;o++){if(i=t[o].show||!1,s=[],a=t[o].index,n.contentVTdEls.length>0&&(s=n.contentTreeVTdEls.length>0?n.contentVTdEls[a].concat(n.contentTreeVTdEls[a]):n.contentVTdEls[a]),i)n.hiddenColumn--,n.headerTdEls[a+r].show(),n.contentColEls[a+r].show(),e.each(s,function(e,t){t.show()});else{if(n.hiddenColumn===n.headerColumns.length-1)return;n.hiddenColumn++,n.headerTdEls[a+r].hide(),n.contentColEls[a+r].hide(),e.each(s,function(e,t){t.hide()})}l[a].hidden=!i}},__onSingleColumnHiddenClick:function(e,t,i){var a=this,i=i||!1;a.__ColumnsHidden([{index:t,show:i}]),a.headerReRender=!0,a._doLayout(!0),a.selectColList&&a.selectColList.setValue(a.__getSelectColumnData().value)},__onFilterOKClick:function(i,a){var n,o,r=this;return e.each(r.filterObjs,function(e,t){var i=t.filter,n=t.filterType;if(t.name===a)switch(n){case mt.LIST:r.filters[t.name]={type:n,value:i.getValue(),text:i.getText()};break;case mt.STRING:r.filters[t.name]={type:n,value:i.getValue()};break;case mt.NUMBER:r.filters[t.name]={type:n,value:i.getValue()};break;case mt.DATE:r.filters[t.name]={type:n,value:i.getValue()};break;default:r._error("Unsupported filter type ["+t.dataType+"].")}}),n=r.filters[a],(o=n.value)?((!o||mt.LIST!==n.type&&mt.STRING!==n.type||o.pass)&&(r._triggerBodyClick(),r.__setColumnFilterPic(i,!0),r.page.currentPage=1,r.options.store?(r.options.store._setPage(r.getPageInfo()),r.options.store.load(r.getAllConditions())):r._triggerHandler(null,"filter",r.getAllConditions())),t):(e.isBoolean(o)||r._triggerBodyClick(),t)},__onFilterResetClick:function(e,t,i){var a=this;t.reset(),e.find("."+I).length>0&&(a.__setColumnFilterPic(e),delete a.filters[i],a.page.currentPage=1,a.options.store?(a.options.store._setPage(a.getPageInfo()),a.options.store.load(a.getAllConditions())):a._triggerHandler(null,"filter",a.getAllConditions()))},__setColumnFilterPic:function(t,i){if(i){var a=t.find("."+k),n=e("<span>");n.addClass(I).appendTo(a)}else t.find("."+I).remove()},__headerFilterListPanel:function(t,i){var a=this,n=function(e,t){var i=e.attr("id");this.listPanel=new Sweet.list.List({width:"100%",height:"auto",maxHeight:150,search:!0,multi:!0,tip:!0,widgetClass:A,data:t.filterList,renderTo:i})};return n.prototype.getValue=function(){var t,i=this,n=[],o=i.listPanel.getValue()||[];return e.each(o,function(e,t){n.push(t.value)}),0!==n.length&&(t=a.__getFilterFormat("IN",n,n.length>0)),t},n.prototype.getText=function(){var t,i=this,n=[],o=i.listPanel.getValue()||[];return e.each(o,function(e,t){n.push(t.text)}),0!==n.length&&(t=a.__getFilterFormat("IN",n,n.length>0)),t},n.prototype.reset=function(){var e=this;Sweet.Task.Delay.start({id:a.options.id+"-grid-list-delay",run:function(){e.listPanel.setValue({})},delay:800})},t.addClass("filter-list"),new n(t,i)},__headerFilterStringPanel:function(i){function a(e,t){vt.EQNULL===t||vt.NOTNULL===t?e.setDisabled(!0):e.setDisabled(!1)}var n=this,o=function(e){var t,i,n=e.attr("id");return t=this.radioGroup=new Sweet.form.RadioGroup({width:150,height:100,columns:1,data:[{text:ft.exactMatch,value:vt.EQUAL,checked:!0},{text:ft.fuzzyMatch,value:vt.LIKE},{text:ft.notEqual,value:vt.NOTEQUAL},{text:ft.eqNull,value:vt.EQNULL},{text:ft.notNull,value:vt.NOTNULL}]}),t.addListener("click",function(e,t){a(i,t.value.value)}),i=this.textField=new Sweet.form.TextField({width:"100%",widgetClass:P,editable:!0}),new Sweet.panel.VPanel({width:"100%",height:135,items:[t,i],renderTo:n}),this};return o.prototype.getValue=function(){var i=this.radioGroup.getValue().value,a=this.textField.getValue().value;return vt.EQNULL===i||vt.NOTNULL===i?n.__getFilterFormat(i,"",!0):e.isNotNull(a)?n.__getFilterFormat(i,a,e.isNotNull(a)):t},o.prototype.reset=function(){this.radioGroup.setValue({text:ft.exactMatch,value:vt.EQUAL,checked:!0}),this.textField.setValue({value:"",text:""}),a(this.textField,vt.EQUAL)},i.addClass(A),new o(i)},__headerFilterDatePanel:function(t){var i=this,a=function(e){var t,i,a=e.attr("id");return e.parent().addClass("sweet-grid-header-filter-date"),t=this.dateFrom=new Sweet.form.Date({blank:!1,label:!0,labelWidth:35,labelText:ft.from,width:"100%"}),i=this.dateTo=new Sweet.form.Date({blank:!1,label:!0,labelWidth:35,labelText:ft.to,width:"100%"}),new Sweet.panel.VPanel({width:205,height:55,items:[t,i],widgetClass:P,renderTo:a}),this};return a.prototype.getValue=function(){var t,a,n,o=this.dateFrom.getValue()||{},r=this.dateTo.getValue()||{};if(!e.isNull(o.data)||!e.isNull(r.data))return e.isNull(o.data)?(Sweet.Dialog.warn({message:ft.validate.beginDate,propagation:!0}),!1):e.isNull(r.data)?(Sweet.Dialog.warn({message:ft.validate.endDate,propagation:!0}),!1):-1!==e.date.compare(o.value,r.value,"-")?(Sweet.Dialog.warn({message:ft.validate.compare,propagation:!0}),!1):(t=e.extend(i.__getFilterFormat(vt.GT,o.data),{text:o.value}),a=e.extend(i.__getFilterFormat(vt.LT,r.data),{text:r.value}),n=[t,a])},a.prototype.reset=function(){this.dateFrom.setValue({value:""}),this.dateTo.setValue({value:""})},t.addClass(A),new a(t)},__headerFilterNumberPanel:function(t){var i=this,a={value:""},n=function(e){var t,i,n,o=e.attr("id");return t=this.largeObj=new Sweet.form.NumberField({blank:!1,label:!0,labelWidth:15,allowDecimals:!0,labelText:vt.GT,symbol:!1,width:"100%"}),t.addListener("focus",function(){n.setValue(a)}),i=this.smallObj=new Sweet.form.NumberField({blank:!1,label:!0,labelWidth:15,allowDecimals:!0,labelText:vt.LT,symbol:!1,width:"100%"}),i.addListener("focus",function(){n.setValue(a)}),n=this.equalObj=new Sweet.form.NumberField({blank:!1,label:!0,labelWidth:15,allowDecimals:!0,labelText:vt.EQUAL,symbol:!1,width:"100%"}),n.addListener("focus",function(){t.setValue(a),i.setValue(a)}),new Sweet.panel.VPanel({width:"100%",height:85,items:[t,i,n],widgetClass:P,renderTo:o}),this};return n.prototype.getValue=function(){var t=this,a=[],n=t.largeObj.getValue(),o=t.smallObj.getValue(),r=t.equalObj.getValue();return e.isNotNull(r.value)?a.push(i.__getFilterFormat(vt.EQUAL,r.value)):(e.isNotNull(n.value)&&a.push(i.__getFilterFormat(vt.GT,n.value)),e.isNotNull(o.value)&&a.push(i.__getFilterFormat(vt.LT,o.value))),0===a.length?null:a},n.prototype.reset=function(){var e=this;e.largeObj.setValue(a),e.smallObj.setValue(a),e.equalObj.setValue(a)},t.addClass(A),new n(t)},__getFilterFormat:function(e,t,i){return{symbol:e,value:t,pass:i}},__onHeaderTdMouseEnter:function(i){var a,n=i.data.me,o=e(this),r=o.find("."+N),l=o.position();if(n.__dealHeaderTdTextHover(o,r,!0),r&&r.length>0){if(a=e.string.toNumber(o.attr("rowspan")),1===a)r.addClass(M);else{if(2!==a)return n._error("Unsupported rowspan. rowspan = "+a),t;r.addClass(F)}r.show(),r.css({left:l.left+o.width()-r.width(),top:l.top})}},__onHeaderTdMouseLeave:function(t,i){var a,n=i||e(this),o=n.data("filterPanel"),r=n.find("."+N);o&&e.isVisiable(o)||(a=t?t.data?t.data.me:this:this,a.__dealHeaderTdTextHover(n,r),r&&!n.data("created")&&r.hide())},__dealHeaderTdTextHover:function(e,t,i){e.hasClass(x)||e.hasClass(T)||e.data("created")||(i?(e.addClass(y),e.find("div:first").addClass(L)):(e.removeClass(y),e.find("div:first").removeClass(L)))},_amendHeader:function(e){var t,i,a=[],n=0;if(1===e.length){for(var o=0;e[0].length>o;o++)a[n]=e[0][o],n++;return a}for(var r=e.length-2;r>=0;r--)for(var l=0;e[r].length>l;l++)t=e[r][l],i=t.children,i&&i>1?(a=a.concat(e[r+1].slice(0,i)),e[r+1].splice(0,i),n+=i):(a[n]=e[r][l],n++);return a},_parseHeader:function(e,t,i){for(var a=0;e.length>a;a++)e[a].colspan=1,e[a].children&&e[a].children.length>0&&(e[a].colspan=e[a].children.length,this._parseHeader(e[a].children,t+1,i)),i[t]||(i[t]=[]),i[t][a]?i[t][i[t].length]=e[a]:i[t][a]=e[a]},_addLoading:function(){var t=this;t.loadEl=e("<div>").css({background:"#eeeeee",display:"none",height:30,position:"absolute",opacity:.6,top:0}),t.loadEl.appendTo(t.gridEl)},_createGridContent:function(){this.__destroyTableContent();var t=this,i=t.contentEl=e("<div>").addClass(o).appendTo(t.gridEl),a=t.contentDivEl=e("<div>").appendTo(i);t.contentTableEl=e("<table>").appendTo(a),t.headerColumns?t.headerColumns.length:Mt,t.singleSelect=t.options.data.singleSelect||!1,t.checkbox=t.options.data.checkbox,t.sn=t.options.data.sn||!1,t._addRowId(t.options.data.data),t.selectedData={},t.selectedDataLength=0,t.selectedTreeData={},t.selectedTreeDataLength=0,t.contentColEls=[],t.contentTrEls=[],t.contentTdEls=[],t.contentVTdEls=[],t.contentTreeTrEls=[],t.contentTreeTdEls=[],t.contentTreeVTdEls=[],t.checkboxTdEls=[],t.checkboxTreeTdEls=[],t.SNTdEls=[],t.treeData=[],t.treeRow=0,t.rowRelations={},t._readyBuildGridContent()&&(t.options.beforeMoveGrid(),t._buildMoveGridContent(),t.options.afterMoveGrid(),t.contentVTdEls=e.matrix.reversal(t.contentTdEls)),t._gridMenuId=t.options.id+"-grid-menu",t._bindGridContentEvent()},_readyBuildGridContent:function(){var e=this,t=e.options.height,i=(e.options.data.data||[]).length,a=0,n=30,o=30;return e.rowH=o,a=i*e.rowH,e.contentDivEl.height(a).css({position:"absolute",top:"0px"}),-1!==(t+"").indexOf("%")?(e.isNotReady=!1,!1):(e.isNotReady=!0,e.pageCount=Math.floor((t-n)/e.rowH),0!==i&&e.pageCount>=i?e.contentTableEl.height(t-n).css("position","absolute"):e.contentTableEl.height(t-n).css("position","absolute"),!0)},_buildGridContentCol:function(){var t,i,a,n,o=this,r=o.headerColumns||[],l=r.length,s=o.count||0;for(a=0;s>a;a++)t=e("<col>").appendTo(o.contentTableEl),o.contentColEls.push(t);for(n=0;l>=n;n++)i=r[n],t=e("<col>").appendTo(o.contentTableEl),i&&i.hidden&&t.hide(),o.contentColEls.push(t)},_toJson:function(t){var i=this;return t&&t.length>0&&e.isArray(t[0])?i.__preTreatData()||[]:e.objClone(t)||[]},_bindGridContentEvent:function(){var e=this;e.contentEl.scroll({me:e},e._onScroll).click({me:e},e._contentElClick)},_contentElClick:function(n){var o,r,l,s,d,c=e(n.target),h=n.data.me,u=h.headerColumns,p=h.count;if(c.hasClass(Q)?d=Sweet.constants.operType.EDIT:c.hasClass(Z)?d=Sweet.constants.operType.MODIFY:c.hasClass(J)?d=Sweet.constants.operType.DELETE:c.hasClass(et)?d=Sweet.constants.operType.CLOSE:c.hasClass(tt)?d=Sweet.constants.operType.PAUSE:c.hasClass(it)?d=Sweet.constants.operType.START:c.hasClass(at)?d=Sweet.constants.operType.RESET:c.hasClass(nt)?d=Sweet.constants.operType.DETAIL:c.hasClass(ot)&&(d=Sweet.constants.operType.CONFIRM),d)return o=e.string.toNumber(c.attr("row")),r=e.string.toNumber(c.attr("column")),l={row:o,column:r,rowData:e.objClone(h.options.data.data[o])},s=u[r-p].rendererArr[d],s.call(this,n,l),t;if(c.hasClass(i))return h._onRowClick(c,!0),h._triggerCheckBoxHandler(n,c,!0),t;if(c.hasClass(a))return h._onRowClick(c,!1),h._triggerCheckBoxHandler(n,c,!1),t;var f=c.parent().parent();if(0===n.button&&f.hasClass(R)){r=e.string.toNumber(f.attr("column"));var g=u[r-p],m=!0;if(g.beforeShowMenu&&e.isFunction(g.beforeShowMenu)&&(l={column:r,name:g.name,rowData:e.objClone(h.options.data.data[o])},m=g.beforeShowMenu.call(this,l)),m){h._gridMenu&&h._gridMenu.destroy(),r=e.string.toNumber(f.attr("column"));var v=n.pageX;return v+150>h.gridEl.width()-It-2&&(v=h.gridEl.width()-It-2-150),h._gridMenu=new Sweet.menu.Menu({renderTo:h._gridMenuId,X:v,Y:n.pageY,itemClick:u[r-p].itemClick,items:u[r-p].menus}),n.stopPropagation(),t}}},_triggerCheckBoxHandler:function(t,i,a){var n,o,r,l=this;n=e.string.toNumber(i.attr("row")),o=i.attr("tree"),r="true"===o?e.objClone(l.treeData[n]):e.objClone(l.options.data.data[n]),r.checked=a,l._triggerHandler(t,yt,r)},__preTreatData:function(){for(var e=this,t=[],i=e.options.data.data,a=i.length,n=e.headerColumns,o=e.headerColumns.length,r=0;a>r;r++){t[r]={};for(var l=0;o>l;l++)t[r][n[l].name]=i[r][l]}return t},_getCurrentDisplayData:function(e){var t=this,i=t.pageCount,a=[],n=0,o=0,r=t.options.data.data?t.options.data.data.length:0;for(o=e?Math.ceil(e.top*r/e.scrollHeight):0,n=o;o+i>n&&!(n>=r);n++)a.push(t.options.data.data[n]);return a},_buildMoveGridContent:function(){var e=this,i=e.pageCount,a=e.options.data.data?e.options.data.data.length:0,n=[];if(i>a)for(var o=i-a,r=0>=a?0:e.options.data.data[a-1].rowId,l=0;o>l;l++)e.options.data.data.push({rowId:r+l+1});return n=e._getCurrentDisplayData(),0>=n.length?n:(e._buildGridContentCol(),e._buildGridTrContent(n),e._refreshRowRelations(n),t)},_buildInsertGridContent:function(t,i){var a,n=this,o=e.date.getMilliseconds();n._info("_buildInsertGridContent() begin"),n._addRowId(t,n.options.data.data.length),n.options.data.data=n.options.data.data.concat(t),n._buildGridTrContent(t,i),n._refreshContentSN(),a=e.date.getMilliseconds(),n._info("Render grid content. Time-consuming = "+(a-o)+"ms"),n._info("_buildInsertGridContent() end")},_buildGridTrContent:function(t,i){for(var a,n,o,r,l,s,d=this,c=t.length,h=d.headerColumns||[],u=0,p=0;c>p;p++){s=t[p],a=s.rowId-1,n=e("<tr>").addClass(j),n.bind("click",{me:d,tr:n,eventName:bt},d._onTrClick).bind("dblclick",{me:d,tr:n,eventName:Et},d._onTrClick),d._addRowColor(n,s.options),d.contentTdEls[a]=[],d.checkbox&&(r=d._getCheckbox(a).appendTo(n),d.checkboxTdEls[a]=r),d.sn&&(l=d._getSN(s.rowId).appendTo(n));for(var f=0;h.length>f;f++)o=d._getContentTd({row:a,column:f+d.count,rowData:s,columnObj:h[f],depth:u}).appendTo(n),d.contentTdEls[a][f]=o;d.contentTdEls[a][h.length]=e("<td>").appendTo(n),i?n.prependTo(d.contentTableEl):n.appendTo(d.contentTableEl),d.contentTrEls[a]=n}},_buildGridTreeContent:function(){this._info("_buildGridTreeContent() begin");var i,a=e.date.getMilliseconds(),n=this,o=n.lazyLoadRows;if(0===n.tempTreeData.length||n.treeDataIndex>=n.treeData.length)return Sweet.Task.Timeout.stop(n.timerGridTreeContent,function(){n._refreshContentSN()}),n.contentTreeVTdEls=e.matrix.reversal(n.contentTreeTdEls),t;for(var r,l,s,d,c,h=n.treeData,u=h.length,p=Math.floor((u-n.treeDataIndex)/o)>0?o:u-n.treeDataIndex,f=0,g=h.slice(n.treeDataIndex,n.treeDataIndex+p),m=n.headerColumns||[],v=e.string.toNumber(n.rowTreeTdEl.attr("depth"))+1,w=n.rowTreeTdEl.data("treeTrEls"),_=0;p>_;_++){r=_+n.treeDataIndex,f=_+n.tempTreeDataIndex,l=e("<tr>").addClass(j).attr("tree","true"),l.bind("click",{me:n,tr:l,eventName:bt},n._onTrClick).bind("dblclick",{me:n,tr:l,eventName:Et},n._onTrClick),n._addRowColor(l,g[_].options),n.contentTreeTdEls[r]=[],n.checkbox&&(d=n._getCheckbox(r,!0).appendTo(l),n.checkboxTreeTdEls[r]=d),n.sn&&(c=n._getSN("").appendTo(l));for(var C=0;m.length>C;C++)s=n._getContentTd({row:r,column:C+n.count,rowData:g[_],columnObj:m[C],depth:v,isTree:!0}).appendTo(l),n.contentTreeTdEls[r][C]=s;n.contentTreeTdEls[r][m.length]=e("<td>").appendTo(l),l.insertAfter(n.rowTreeEl),n.contentTreeTrEls[r]=l,w[f]=l}n.treeDataIndex+=p,n.tempTreeDataIndex+=p,i=e.date.getMilliseconds(),n._info("Render grid content. Time-consuming = "+(i-a)+"ms"),n._info("_buildGridTreeContent() end")},_addRowColor:function(e,t){if(t){var i=t.color,a=kt[i];a&&e.addClass(a)}},_onTrClick:function(t){var i,a,n,o=t.data.me,r=t.data.tr,l=t.data.eventName,s=e.string.toNumber(r.attr("row")),d=[];o.checkbox||(i=o.__findTargetTr(s),a=i.realRow,n=o._getSelectedFirstRow(),o.options.data.checkbox?i.tree?d.push(o.treeData[a]):d.push(o.options.data.data[a]):(n&&n.length>0&&(n=e(n),n.removeClass(G)),delete o.selectedTreeData,delete o.selectedTreeDataLength,o.selectedTreeData={},o.selectedTreeDataLength=0,delete o.selectedData,delete o.selectedDataLength,o.selectedData={},o.selectedDataLength=0,r.addClass(G),i.tree?(o.selectedTreeData[o.treeData[a].rowId]=o.treeData[a],o.selectedTreeDataLength=1):(o.selectedData[o.options.data.data[a].rowId]=o.options.data.data[a],o.selectedDataLength=1),d=o.getSelectedValue()),o._triggerHandler(t,l,{row:s,rowData:d}))},_resetContentTdELWidth:function(){var t=this;e.each(t.contentColEls,function(e){t._resetContentTdELWidthByCol(e)})},_resetContentTdELWidthByCol:function(e){var t=this;t.widths&&t.contentColEls[e].width(t.widths[e]+Bt)},_refreshContentSN:function(){var t,i,a,n=this;if(n.options.data.sn)for(t=n.contentTableEl.find("."+O),i=t.length,a=0;i>a;a++)e(t[a]).text(a+1)},_refreshRowRelations:function(e){var t,i,a,n,o,r=this,l=e?e.length:0;if(r.options.tree?(t=r.contentTreeTrEls.length,i=r.contentTreeTrEls):(t=r.contentTrEls.length,i=r.contentTrEls),0!==l&&t===l)for(o=0;t>o;o++)n=i[o],a=e[o].rowId,n&&n.attr("row",a)},__getContentTrEls:function(){return this.contentTableEl.find("."+j)},_getCheckbox:function(t,a){var n=e("<td>"),o=e("<div>").addClass(C).appendTo(n),r=e("<a>").addClass(i).attr({row:t}).appendTo(o);return a&&r.attr("tree","true"),n},_getSN:function(t){var i=e("<td>");return e("<div>").addClass(O).attr("title",t).text(t).appendTo(i),i},_getContentTd:function(t){var i,a=this,n=t.row,o=t.column,r=t.columnObj,l=t.depth,s=t.isTree,d=e("<td>"),c=e("<div>").appendTo(d);return i={row:n,column:o,rowData:t.rowData,columnObj:r,divEl:c,depth:l,isTree:s,tdEl:d},a.__getContentTdAlign(i),a.__getContentTdRender(i),a.__bindContentTdClick(i),r.hidden&&d.hide(),d},__bindContentTdClick:function(t){var i=this,a=t.tdEl,n=t.row,o=t.column,r=t.columnObj;a.bind("click",{me:i,row:n,column:o,name:r.name,rowData:e.objClone(t.rowData)},function(e){var t=e.data.row,i=e.data.column,a=e.data.name,n={row:t,column:i,name:a,rowData:e.data.rowData};e.data.me._triggerHandler(e,Ct,n)})},__getContentTdAlign:function(e){var t=e.columnObj,i=e.divEl;t.align?Sweet.constants.align.RIGHT===t.align?i.addClass(V):Sweet.constants.align.CENTER===t.align?i.addClass(U):i.addClass(z):Sweet.constants.dataType.NUMBER===t.dataType&&i.addClass(V)},__getContentTdRender:function(t){var i,a,n=this,o=t.row,r=t.column,l=t.columnObj,s=t.divEl,d=t.depth,c=t.isTree,h={},u="<a class='"+R+"' column='"+r+"'>";l.renderer?(h={row:o,column:r,data:t.rowData[l.name],rowData:e.objClone(t.rowData),columnDesc:e.objClone(l)},i=l.renderer.call(null,h),l.menus?e(u).html(i).appendTo(s):s.html(i)):(h={data:t.rowData[l.name],rowData:t.rowData,row:o,column:r,depth:d,isTree:c,name:l.name},a=n.__getContentTdTree(h),l.menus?e(u).html(a).appendTo(s):s.html(a)),l.tip&&s.attr("title",e.isPlainObject(t.rowData[l.name])?e.htmlEscape(t.rowData[l.name].text):e.htmlEscape(t.rowData[l.name]))},__getContentTdTree:function(i){var a,n,o=this,r=i.data,l=i.rowData,s=i.row,d=i.column,c=i.depth,h=i.isTree,u=i.name,p=e("<div>").addClass(Y);return e.isPlainObject(r)&&r.children&&e.isNotNull(r.text)?(h&&p.css("padding-left",At*c),e("<a>").addClass($+" "+X+" "+q).bind("click",function(i){i.stopImmediatePropagation();var a,n=e(this);if(o.rowTreeEl=n.parent().parent().parent().parent(),o.rowTreeTdEl=n,n.hasClass($)){if(n.removeClass($).addClass(K),n.data("expand"))return o._gridContentTreeExpand(n.data("treeTrEls"),!0),t;a={row:s,column:d,name:u,depth:c,rowData:e.objClone(l)||{}},a=o._triggerHandler(i,xt,a),o.options.store&&o.options.store.load(a,!0,"setTreeData"),n.data("expand",!0),n.data("treeTrEls",[])}else n.hasClass(K)?(n.removeClass(K).addClass($),o._gridContentTreeExpand(n.data("treeTrEls"),!1)):o._info("__getContentTdTree() Nothing to do.")}).attr({row:s,column:d,depth:c}).appendTo(p),a=e.nullToString(r.text),n=e("<div>").html(e.htmlEscape(a)).appendTo(p)):(n=e("<div>").appendTo(p),p.css("padding-left",At*c),a=h&&e.isPlainObject(r)?r.text:e.isPlainObject(r)?r.text:r,n.html(e.htmlEscape(e.nullToString(a)))),p[0]},_gridContentTreeExpand:function(t,i){var a,n,o;if(i)for(var r=0;t.length>r;r++)t[r].show();else for(var l=0;t.length>l;l++){a=t[l].hide(),n=a.find("."+q);for(var s=0;n.length>s;s++)o=e(n[s]),o.removeClass(K).addClass($),this._gridContentTreeExpand(o.data("treeTrEls")||[],!1)}},_onScroll:function(n){var o=n.data.me,r=o.contentEl.scrollLeft();o._gridMenu&&o._gridMenu.destroy(),o.gridScrollLeft=r,o.gridScrollLeftFlag++,o.headerDivEl.css({left:-r}),o.resizeEl&&o.resizeEl.css({left:-r});var l={left:r,top:o.contentEl.scrollTop(),scrollWidth:o.contentEl.get(0).scrollWidth,scrollHeight:o.contentEl.get(0).scrollHeight};if(o.options.scrollCallBack&&e.isFunction(o.options.scrollCallBack)&&o.options.scrollCallBack(l),o.options.move){o.options.beforeMoveGrid();var s=o._getCurrentDisplayData(l);o.contentTableEl.css("top",l.top+"px");var d=o.contentDivEl.height()-o.contentEl.height();l&&l.top>=d?!o.hasShowMask&&o.options.data.total>o.options.data.data.length&&!o.locked?(o.loadEl.show().sweetMask({loading:!0}),s.shift(),o.hasShowMask=!0,o.options.afterMoveGrid(s,d,o.options.data.data.length)):(o.hasShowMask&&s.shift(),o.options.afterMoveGrid(s,t,t)):o.options.afterMoveGrid(s,t,t),o._refreshRowRelations(s);var c=o.getSelectedValue();if(o._dealRowSelect(o.checkboxTdEls,o.contentTrEls,{current:i,old:a},{current:"",old:G}),o._dealRowSelect(o.checkboxTreeTdEls,o.contentTreeTrEls,{current:i,old:a},{current:"",old:G}),c[0]&&c[0].rowId){var h=o.__findTargetTr(c[0].rowId);h.trEl&&h.trEl.addClass(G)}}o.preScrollInfo=l},setLocked:function(e){var t=this;t.locked=e},getScrollInfo:function(){return this.preScrollInfo},getStartIndex:function(){return this.options.data.data.length},setAppendData:function(t,i,a){var n=this,i=i||0;if(t&&n.options.data.data){if(a?(n.options.data.data=null,n.options.data.data=[],e.isArray(t)?n.options.data.data=t:n.options.data=e.extend({},n.options.data,t),i=0):n.options.data.data=e.isArray(t)?n.options.data.data.concat(t):n.options.data.data.concat(t.data||[]),n._addRowId(n.options.data.data),n.options.data.data.length<=n.pageCount){for(var o=n.options.data.data.length,r=n.pageCount-o,l=0>=o?0:n.options.data.data[o-1].rowId,s=0;r>s;s++)n.options.data.data.push({rowId:l+s+1});n._refreshRowRelations(n.options.data.data)}n.contentDivEl.height(n.options.data.data.length*n.rowH),n.hasShowMask=!1,n.loadEl.unSweetMask(),n.loadEl.hide(),n.contentEl.scrollTop(i),n._onScroll({data:{me:n}})}},hideMask:function(){var e=this;e.hasShowMask=!1,e.loadEl.unSweetMask(),e.loadEl.hide(),e._onScroll({data:{me:e}})},_onAllRowClick:function(n){function o(e){for(var t,i={},a=0;e.length>a;a++)t=e[a],t&&(i[t.rowId]=t);return i}var r=n.data.me,l=e(this),s={};if(l.hasClass(i))s.checked=!0,l.removeClass(i).addClass(a),r.selectedData=o(r.options.data.data),r.selectedDataLength=r.options.data.data.length,r.selectedTreeData=o(r.treeData),r.selectedTreeDataLength=r.treeData.length,r._dealRowSelect(r.checkboxTdEls,r.contentTrEls,{current:a,old:i},{current:G,old:""}),r._dealRowSelect(r.checkboxTreeTdEls,r.contentTreeTrEls,{current:a,old:i},{current:G,old:""});else{if(!l.hasClass(a))return r._info("Nothing we can do."),t;s.checked=!1,l.removeClass(a).addClass(i),r._allRowUnSelect()}r._triggerHandler(n,yt,s)},_allRowUnSelect:function(){var e=this;e.selectedData={},e.selectedDataLength=0,e.selectedTreeData={},e.selectedTreeDataLength=0,e._dealRowSelect(e.checkboxTdEls,e.contentTrEls,{current:i,old:a},{current:"",old:G}),e._dealRowSelect(e.checkboxTreeTdEls,e.contentTreeTrEls,{current:i,old:a},{current:"",old:G})},_dealRowSelect:function(e,t,i,a){for(var n=0;t.length>n;n++)e[n]&&e[n].find("a").removeClass(i.old).addClass(i.current),t[n].removeClass(a.old).addClass(a.current)},_onRowClick:function(t,n){var o=this,r=e.string.toNumber(t.attr("row")),l=t.attr("tree");if(n)t.removeClass(i).addClass(a),o._oneRowSelect(r,l);else{var s=o.options.data.data[r];t.removeClass(a).addClass(i),"true"===l?(s=o.treeData[r],o.contentTreeTrEls[r].removeClass(G),delete o.selectedTreeData[s.rowId],o.selectedTreeDataLength--):(s=o.options.data.data[r],o.contentTrEls[r].removeClass(G),delete o.selectedData[s.rowId],o.selectedDataLength--),o.options.data.data.length+o.treeData.length!==o.selectedTreeDataLength+o.selectedDataLength&&o.headerTdEls[0].find("a").removeClass().addClass(i)}},_oneRowSelect:function(t,i){var n,o=this;"true"===i?(n=e.objClone(o.treeData[t]),o.contentTreeTrEls[t].addClass(G),o.selectedTreeData[o.treeData[t].rowId]=n,o.selectedTreeDataLength++):(n=e.objClone(o.options.data.data[t]),o.contentTrEls[t].addClass(G),o.selectedData[o.options.data.data[t].rowId]=n,o.selectedDataLength++),o.selectedDataLength+o.selectedTreeDataLength===o.options.data.data.length+o.treeData.length&&o.headerTdEls[0].find("a").removeClass().addClass(a)},_onGoBlur:function(){var t=this,i=e.string.toNumber(t.pagingGoTextEl.val());1>i?t.pagingGoTextEl.val(1):i>t.page.totalPage&&t.pagingGoTextEl.val(0===t.page.totalPage?1:t.page.totalPage)},_onPagingButtonClick:function(i){var a,n=this,o=!1,r=n.page,l=n.numEls;if(!(r.totalPage<r.currentPage||1>r.currentPage)){if(1===r.currentPage){if(i||1===r.totalPage)return;a=r.currentPage+1}else if(r.totalPage===r.currentPage){if(!i)return;a=r.totalPage-1}else a=i?--r.currentPage:++r.currentPage;if(n.page.currentPage=a,n.options.data.page.simple)return n.pagingPageDropDownEl.find("li:eq("+--n.page.currentPage+")").click(),t;for(var s=0;l.length>s;s++)a===e.string.toNumber(l[s].val())&&(l[s].click(),o=!0);o||(n.goClick=!0,n._onPagingBarNumClick(null,!0))}},_onPagingGoClick:function(t){var i=this,a=e.string.toNumber(i.pagingGoTextEl.val());i.page.currentPage!==a&&(i.page.currentPage=a,i.goClick=!0,i._triggerHandler(t,_t,e.objClone(i.page)))},_onPagingRowClick:function(t){var i=t.data.me,a=e(this);i.options.data.page.size=i.page.size=e.string.toNumber(a.val()),i.page.currentPage=1,i._triggerHandler(t,_t,e.objClone(i.page))},_createPagingBarSelectPage:function(t){var i,a=this,n=t.size,o=t.select,r="sweet-gird-paging-select-down",l=e("<div>").addClass(t.selectElClass),s=e("<a>"),d=e("<em>"),c=e("<div>"),h={};return i=a._createDropDown(o),d.appendTo(s),c.addClass(r).appendTo(s),s.addClass(t.aElClass).bind("click",{attachEl:l,dropDown:i,type:t.type},a._onSelectClick).appendTo(l),i.addClass(t.downElClass).appendTo(document.body),h={me:a,obj:t,emEl:d,pageRowDropDown:i},i.find("li").bind("click",h,a._onPageListClick),i.find("li").each(function(){var t=e.string.toNumber(e(this).val());n===t&&a._onPageListClick({data:h},e(this))}),{selectEl:l,dropDownEl:i}},_onPageListClick:function(i,a){var n,o,r=i.data.me,l=i.data.obj,s=i.data.emEl,d=i.data.pageRowDropDown;if(a=a||e(this),n=e.string.toNumber(a.val()),ct[0]===l.type)r.pageRowsChoosedLiEl&&r.pageRowsChoosedLiEl.removeClass(dt),s.text(l.text.replace("{0}",n)),r.pageRowsChoosedLiEl=a;else{if(ct[1]!==l.type)return r._error("Unsupported combobox type. Not in ["+ct[0]+", "+ct[1]+"]."),t;r.pageChoosedLiEl&&r.pageChoosedLiEl.removeClass(dt),o=a.html(),s.text(l.text.replace("{0}",n).replace("{1}",o.substr(o.indexOf("/")+1,o.length))),r.pageChoosedLiEl=a}a.addClass(dt),d.hide(),r.initial||(r._triggerHandler(i,_t,e.objClone(r.page)),r.initial=!1)},_onSelectClick:function(t){if(!e.isVisiable(t.data.dropDown)){var i=t.data.attachEl,a=t.data.dropDown,n=t.data.type,o=e.getMaxZIndex(e.string.toNumber(a.css("z-index")));ct[0]===n?a.data("rowFlag",!0):ct[1]===n&&a.data("pageFlag",!0),a.css(e.getFloatOffset(i,a,null)).css("z-index",o).show()}},_createDropDown:function(t){var i=this,a=e("<div>"),n=e("<ul>");t=t||[20,50,100];for(var o,r,l=0;t.length>l;l++)o=""+t[l],r=o.indexOf("/"),e("<li>").val(-1===r?o:o.substr(0,r)).text(o).appendTo(n);return n.appendTo(a),a.addClass(rt+" "+i.floatBgClass),a},_createPagingBarTotalText:function(){var t=this,i="sweet-grid-paging-totaltext",a=t.totalTextEl=e("<span>");a.addClass(i).text(ft.text.replace("{0}",t.options.data.page.total)).appendTo(t.pagingInnerEl)},_refreshPagingBarTotalText:function(e){var t=this;t.totalTextEl.text(ft.text.replace("{0}",e))},_createPagingBarButton:function(t,i,a,n){var o="sweet-gird-paging-button",r="sweet-grid-paging-button-text",l=e("<a>"),s=e("<div>"),d=e("<em>");return s.addClass(t).appendTo(l),e.isNotNull(i)&&(ht[0]===a?(d.html(i).insertAfter(s),l.addClass(r)):ht[1]===a?(d.html(i).insertBefore(s),l.addClass(r)):e.log("Nothing we can do. Not in ["+ht[0]+", "+ht[1]+"]. value="+a)),e.isNotNull(n)&&l.attr("title",n),l.addClass(o),l},_createPagingBarNumItem:function(){var t,i,a=this,n=ut+2,o=e("<span>").text("...").hide(),r=e("<span>").text("..."),l=a.numItemEl=e("<div>"),s=[],d=[],c=a.page.totalPage,h=a.page.currentPage,u=1;if(n>=c)for(var p=0;c>p;p++)i=p+1,t=e("<a>").addClass(lt).val(i).text(i).appendTo(l),s[p]=t;else{1===c||c===h?u=1===h?h+1:h-ut:ut>h-1?u=2:ut>c-h?u=c-ut:a.goClick?(u=h,a.goClick=!1):u=e.string.toNumber(a.numEls[1].val())===h||e.string.toNumber(a.numEls[ut].val())===h?h-2:e.string.toNumber(a.numEls[1].val());for(var f=0;n>f;f++)i=f+u-1,t=e("<a>").addClass(lt).val(i).text(i).appendTo(l),0===f?(t.val(1).text(1),o.insertAfter(t),d[0]=o):ut+1===f&&(t.val(c).text(c),r.insertBefore(t),d[1]=r),s[f]=t}for(var g=0;s.length>g;g++)a.page.currentPage===e.string.toNumber(s[g].val())&&(s[g].addClass(st),a.pageingcurrentNumEl=s[g]);d.length>0&&(1===e.string.toNumber(s[1].val())-1?d[0].hide():d[0].show(),c===e.string.toNumber(s[ut].val())+1?d[1].hide():d[1].show()),l.bind("click",function(e){a._onPagingBarNumClick(e)}).appendTo(a.pagingInnerEl),a.numEls=s,a.numMoreEls=d},_onPagingBarNumClick:function(t,i){var a,n=this;i?n._triggerHandler(t,_t,e.objClone(n.page)):(a=e(t.target),(a.hasClass(lt)||a.hasClass(dt))&&(n.page.currentPage=e.string.toNumber(a.val()),n._triggerHandler(t,_t,e.objClone(n.page))))},_triggerHandler:function(i,a,n){var o,r=this;return _t===a&&r.options.store&&(r.options.store._setDataPage(r.getPageInfo()),r.options.store.loadRecords(r.getAllConditions())),e.isNull(r.handlers)?t:(e.each(r.handlers,function(e,t){a===e&&(r._info(a+" event occured!"),o=t.call(null,i,n))}),o?o:n)},getAllConditions:function(){var i,a,n=this,o={},r=n.getPageInfo(),l=n._getFilters(),s=JSON.parse(JSON.stringify(n._getOrders())),d=0,c=0,h=n.headerColumns,u=h.length;if(r&&t!==r.start&&t!==r.limit&&(o.start=r.start,o.limit=r.limit),l.filter&&(o.filter=l.filter),s.order){for(d=0;s.order.length>d;d++)for(i=s.order[d],c=0;u>c;c++)if(h[c].name===i.name&&"date"===i.dataType&&!i.hidden&&!i.hiddenForever&&e.isNotNull(h[c].useDSTutcOrder)){a=JSON.parse(JSON.stringify(i)),i.name=h[c].useDSTutcOrder,i.dataType="number",i.data=a;break}o.order=s.order}return o},getPageInfo:function(){var e=this;return e.page?{start:(e.page.currentPage-1)*e.page.size,limit:e.page.size,currentPage:e.page.currentPage,size:e.page.size}:{}},_getFilters:function(){var t=this,i=[];return e.each(t.filters,function(e,t){i.push({name:e,type:t.type,value:t.value,text:t.text})}),{filter:i}},_getOrders:function(){var e=this;return{order:e.orders}},_render:function(t){var i=this;return i._super(t)?(i.gridEl.appendTo(i.renderEl),i._gridMenuEl=e('<div id="'+i._gridMenuId+'">').appendTo(document.body),i.rendered=!0,!0):!1},_destroyWidget:function(){var e=this;e.__destroyTableActionBar(),e.__destroyTableHeader(),e.__destroyTableContent(),e.__destroyTablePagingBar(),e.gridEl&&(e.gridEl.remove(),e.gridEl=null),e._gridMenuEl&&(e._gridMenuEl.remove(),e._gridMenuEl=null)},__destroyTableActionBar:function(){var t=this;t.selectColEl&&(t.selectColEl.remove(),t.selectColEl=null),t.selectColList&&e.isFunction(t.selectColList.destroy)&&(t.selectColList.destroy(),t.selectColList=null),t._multiSortWin&&e.isFunction(t._multiSortWin.destroy)&&(t._multiSortWin.destroy(),t._multiSortWin=null,t.firstCol&&(t.firstCol=null),t.secondCol&&(t.secondCol=null),t.thirdCol&&(t.thirdCol=null)),t.secondaryPanel&&e.isFunction(t.secondaryPanel.destroy)&&(t.secondaryPanel.destroy(),t.secondaryPanel=null),t.actionBarEl&&(t.actionBarEl.remove(),t.actionBarEl=null),t.exportEl&&(t.exportEl.remove(),t.exportEl=null)},__destroyTableHeader:function(){var e=this,t=e.filterPanels,i=t?t.length:0;e.headerEl&&(e.headerEl.remove(),e.headerEl=null),e.resizeEl&&(e.resizeEl.remove(),e.resizeEl=null);for(var a=0;i>a;a++)e.filterPanels[a].remove();e.filterPanels=null},__destroyTableContent:function(){var e=this;e.contentEl&&(e.contentEl.remove(),e.contentEl=null)},__destroyTablePagingBar:function(){var e=this;e.pagingRowDropDownEl&&(e.pagingRowDropDownEl.find("li").unbind(),e.pagingRowDropDownEl.remove(),e.pagingRowDropDownEl=null),e.pagingPageDropDownEl&&(e.pagingPageDropDownEl.find("li").unbind(),e.pagingPageDropDownEl.remove(),e.pagingPageDropDownEl=null),e.pagingEl&&(e.pagingEl.remove(),e.pagingEl=null)
}}),Sweet.grid.BigGrid=e.sweet.widgetBigGrid}(jQuery),function(e){var t="sweet-widget-menu",i="sweet-widget-menu-alpha",a="sweet-widget-menu-color",n="sweet-widget-menu-list",o="sweet-widget-menu-list-item",r="sweet-widget-menu-item",l="sweet-widget-menu-item-arrow",s="sweet-widget-menu-item-icon",d="sweet-widget-menu-item-text",c="sweet-widget-menu-item-disabled",h="sweet-widget-menu-item-active",u="sweet-widget-menu-item-mouseover-disabled",p=10,f=Sweet.libPath+"themes/default/core/images/menu/s.gif";e.widget("sweet.widgetMenu",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-menu]",type:"menu",eventNames:{itemClick:"菜单选项选择事件"},options:{items:[],X:0,Y:0,itemHeight:26,itemWidth:150,transparent:!1},setDisabled:function(t){if(!(e.isNull(t)||0>=t.length)){var i=this,a=i.options.renderTo;if(t instanceof Array)for(var n=0;t.length>n;n++)e("#"+a).find("#"+t[n].value).addClass(c)}},setData:function(t){if(!(e.isNull(t)||0>=t.length)){var i=this;i.menuEl&&i.menuEl.remove(),i.options.items=t,i._createSweetWidget(),i.rendered=!1,i._render(i.options.renderTo),i._doLayout()}},_createSweetWidget:function(){var n=this,o=n.options,r=(Number(o.X),Number(o.Y),o.items.length),l=(r*o.itemHeight+2,n.menuId=o.id),s=n.menuEl=e("<div>").attr("id",l);document.body.clientWidth,document.body.clientHeight,e(document).scrollTop(),o.width,s.addClass(t),o.transparent?s.addClass(i):s.addClass(a),n._createMenuItems()},_createMenuItems:function(){for(var t,i,a,h,u,p,g,m,v,w,_=this,C=_.options,b=C.items,E=b.length,y=C.itemHeight,x=E*y+2,T=_.menuUl=e("<ul>").addClass(n).attr("id","sweet-menu-ul-"+C.id).css({height:x}),D=0;E>D;D++)t=b[D],i=!1,a=t.value,w=C.id+"-"+D,t.children&&t.children.length>0&&(i=!0),h=!1,(t.disabled||"true"===t.disabled)&&(h=!0),a&&""!==a||(a="sweet-menu-item"+(D+1)),u=e("<li>").addClass(o).attr("id",a).css({height:y}).bind("click",{me:_,hasChild:i,disabled:h},_._itemClick).bind("mouseover",{id:a,me:_,index:D+1,disabled:h,children:b[D].children},_._mouseOver).bind("mouseout",{id:a,hasChild:i,me:_},_._mouseOut),C.itemWidth>150&&u.width(C.itemWidth),p=e("<a>").attr({id:"sweet-menu-a-"+w,href:"#"}).addClass(r),i&&p.addClass(l),h&&u.addClass(c),p.appendTo(u),g=b[D].icon&&""!==b[D].icon?b[D].icon:f,m=e("<img>").attr({id:"sweet-menu-img-"+w,src:g}).addClass(s).appendTo(p),v=e("<span>").attr({id:"sweet-menu-text-"+w}).addClass(d).text(b[D].text).appendTo(p),T.append(u);T.appendTo(_.menuEl)},_mouseOver:function(t){var i,a,n=t.data,o=n.id,r=n.me.options.items,l=n.me,s=n.me.options.itemHeight,d=n.index,c=n.disabled,p=l.menuEl.width()-1,f=(d-1)*s,g=n.me.subMenu;for(document.body.clientWidth,document.body.clientHeight;g;)g._destroyWidget(),g=g.subMenu;for(var m=0;r.length>m;m++)i=r[m].value,i&&""!==i||(i="sweet-menu-item"+(m+1)),e("#"+i).removeClass(h+" "+u);if(c?e("#"+o).addClass(h).addClass(u):e("#"+o).addClass(h),a=n.children,a&&a.length>0&&!c){var v=l.options,w=0,_=0;w=v.X+p,_=v.Y+f,n.me.subMenu=new Sweet.menu.Menu({X:w,Y:_,renderTo:v.renderTo,items:a,transparent:v.transparent,itemClick:function(e,t){l._trigger("itemClick",e,t),l._destroyWidget()}})}},_mouseOut:function(t){t.data.hasChild||e("#"+t.data.id).removeClass(h)},_itemClick:function(e){var t={},i=e.data,a=i.me,n=i.hasChild,o=a.options,r=i.func,l=i.disabled;if(t.text=e.currentTarget.textContent,t.value=e.currentTarget.id,l||n)return e.stopPropagation(),undefined;for(var s=0;o.items.length>s;s++)if(t.value===o.items[s].value){t.data=o.items[s].data;break}return n||(r?r(e,t):a._trigger("itemClick",e,t)),a.subMenu&&a.subMenu._destroyWidget(),a._destroyWidget(),!1},_closeFloatPanel:function(){var e=this;e._destroyWidget()},_destroyWidget:function(){this.menuEl&&this.menuEl.empty().remove()},_removeListener:function(t){var i=this;i.handlers=i.handlers||{},t&&""!==t?e.each(i.handlers,function(e,a){t===e&&i.chartElement.removeListener(i.chartElement,e,a)}):e.each(i.handlers,function(t){e("#"+i.options.renderTo+" ."+o).unbind(t)})},_addListener:function(){var t=this;e.each(t.handlers,function(i,a){e("#"+t.options.renderTo+" ."+o).bind(i,{func:a},function(e){t._itemClick(e)})})},_render:function(e){var t=this;return t._super(e)?(t.menuEl.appendTo(t.renderEl),t.rendered=!0,t._doLayout(),!0):!1},_getWidth:function(){return this.menuEl.width()},_getHeight:function(){return this.menuEl.height()},_doLayout:function(){var t=this.options.renderTo;if(t&&""!==t){var i=this,a=i.options.X,n="px",o=i.options,r=i.options.Y,l=o.items.length,s=10,d=l*o.itemHeight+2+s,c=window.document.body.scrollWidth,h=window.document.body.scrollHeight,u=e(document).scrollTop(),f=e(document).width(),g=i.menuEl.width(),m=i.menuEl.outerWidth(),v=i.menuEl.outerHeight();if(f>c&&(c=f),m>g&&(g=m),a+g>=c){var w=e("#"+o.id).prev();if(w.length>0){var _=e("#"+t+" > div").eq(0),C=parseInt(w.css("left")),b=parseInt(_.css("left"));b>C?a=C-g:C===b&&(a=b-g)}else a=c-g-p}v>d&&(d=v),r-u+d>h&&(r=0>=h-d?u:h-d+u-s,0>r&&(r=0)),i.menuEl.css({left:a+n,top:r+n})}}}),Sweet.menu.Menu=e.sweet.widgetMenu}(jQuery),function(e){e.widget("sweet.widgetChart",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-chart]:",maxPacket:10,colors:{colors1:["#97A9B7"],colors2:["#97a9b6","#3281cb"],colors:["#448bce","#60a2e0","#76b6f1","#378838","#4bb54d","#7ece56","#c26e37","#db8349","#e6a05c","#d5dae0"]},options:{data:[],dataKeys:[],store:null},labelColor:Sweet.constants.chart.titleCfg.labelColor,labelAlpha:Sweet.constants.chart.titleCfg.labelAlpha,fontSizeLarger:Sweet.constants.chart.fontSize.larger,fontSizeNormal:Sweet.constants.chart.fontSize.normal,textColor:Sweet.constants.chart.textColor,chartFontFamily:Sweet.constants.chart.fontFamily,widget:function(){return this.chartElement},setData:function(t,i){var a=this,n=!1;if(e.isNull(t))return e.log("set data is null"),undefined;if(!e.isFunction(a._validate)||a._validate(t))if(e.isArray(t)?(a.options.data=t,n=!0):a._isUpdateData(t)&&(n=!0),e.isNull(a.options.data)&&(a.options.data=[]),0===a.options.data.length&&n&&a._setDefaultData)a._setDefaultData();else{if(e.isFunction(a._setChangeProperty)&&i)return a._setChangeProperty(i),undefined;n?e.isFunction(a._updateData)&&a._updateData():e.isFunction(a._setChangeProperty)&&a._setChangeProperty()}},_getCanvasObject:function(){var t=this;if(t.options.id,!t.rendered)return null;var i=t.chartEl.height(),a=t.chartEl.width(),n=e("<canvas>").attr({width:a,height:i}),o=t.chartEl.get(0),r=[],l=0,s=0,d=0,c=o.getElementsByTagName("svg"),h={x:0,y:0};if(!c||0>=c.length){var u=o.getElementsByTagName("canvas"),p=null;return u&&u.length>0&&(p=u[0]),p}for(var f=0;c.length>f;f++){var g=c[f],m=g.parentNode,v=Number(m.style.left.slice(0,-2)),w=Number(m.style.top.slice(0,-2));"relative"==m.style.position?(s=v?v:s,d=w?w:d):(s=v+h.x,d=w+h.y),r.push({svg:e.dealAttrSVG(g.cloneNode(!0)),offset:{x:s,y:d}}),w&&v||(d+=w?0:m.offsetHeight,l+=m.offsetHeight)}n.attr({width:a,height:l>i?l:i});for(var _=n.get(0),f=0;r.length>f;f++){var C=r[f].svg,b=r[f].offset,E=(new XMLSerializer).serializeToString(C);canvg(_,E,{offsetX:b.x,offsetY:b.y,ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0})}return _},_isUpdateData:function(e){var t=this,i=0,a={},n="data",o="dataKeys",r=t.options[o];if(!e)return!1;for(var l in e)i++,t.options[l]=e[l],a[l]=l;if(i>2)return!1;if(0>=i)return!1;if(1==i){if(a[n])return!0;if(a[o]&&!t._isDataKeysChange(e[o],r))return!0}return 2==i&&a[n]&&a[o]?t._isDataKeysChange(e[o],r)?!1:!0:!1},_isDataKeysChange:function(e,t){var i=0,a=0,n=!1;try{if(e.length==t.length){i=e.length;for(var o=0;i>o;o++)if(a==o){if(e[o]!=t[o]){n=!0;break}}else if(e[o][0]!=t[o][0]){n=!0;break}return n?!0:!1}return!0}catch(r){return!0}},_click:e.noop,_addListener:e.noop,_removeListener:e.noop,_validate:function(t){return e.isNull(t)?(this._error("Input parameter must not be empty!"),!1):this.__validate()?!0:!1},__validate:function(){return!0},_setWidth:function(e){this.chartEl.externalWidth(e)},_setHeight:function(e){this.chartEl.externalHeight(e)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_getWidth:function(){return this.chartEl.externalWidth()},_getHeight:function(){return this.chartEl.externalHeight()},_getWidgetEl:function(e){return e?this.chartEl[0]:this.chartEl},_createSweetWidget:function(){if(this._validate(this.options.data)){var t=this,i=t.options;t.chartEl=e("<div>").width(i.width).height(i.height).attr("id",i.id).addClass(i.widgetClass),e.isNull(i.store)||i.store.addListener({setData:t.setData,scope:this}),this._createJsChart()}},_createJsChart:e.noop,_render:function(e){var t=this;return t._super(e)?(t.chartEl.appendTo(t.renderEl),t.options.renderTo=e,t._chartRender(),t.rendered=!0,!0):!1},_chartRender:e.noop,_doLayout:e.noop,_closeFloatPanel:e.noop,_createFlashChart:e.noop,_destroyWidget:function(){this.chartEl&&this.chartEl.remove()},_getColor:function(e,t,i){var a={};if(this.maxPacket>=e)return a=this.colors["colors"+(2>=e?e:"")],t>0&&e>2&&i&&(t=Math.floor(a.length/e)*t),a[t]}})}(jQuery),function(e){"use strict";var t="#919191",i=.86,a=.33,n=10,o=function(o){function r(){if(null===q)return null;var e=[],t={},i=["#81BC7A:67-#9CE18F:75-#63D04E:85-#3ABD21","#AB9558:67-#F6DA8D:75-#F1C44C:85-#E0A51E","#D25751:67-#E68B8B:75-#D64242:85-#B32424"];return X.flat&&(i=["#51942B","#f5c245","#DA6263"]),q.start===q.end&&(q.end=q.start+10),q.start<q.end?(q.threshold1&&(q.threshold1<q.start||q.threshold1>q.end)&&(q.threshold1=null),q.threshold2&&(q.threshold2<q.start||q.threshold2>q.end)&&(q.threshold2=null)):(q.threshold1&&(q.threshold1<q.end||q.threshold1>q.start)&&(q.threshold1=null),q.threshold2&&(q.threshold2<q.end||q.threshold2>q.start)&&(q.threshold2=null)),q.threshold1||q.threshold2?q.threshold1&&q.threshold2?("good"===q.rule&&i.reverse(),t.fill=i[0],t.start=q.start,t.end=q.threshold1,e.push(t),t={},t.fill=i[1],t.start=q.threshold1,t.end=q.threshold2,e.push(t),t={},t.fill=i[2],t.start=q.threshold2,t.end=q.end,e.push(t)):("good"===q.rule&&i.reverse(),t.fill=i[0],t.start=q.start,t.end=q.threshold1||q.threshold2,e.push(t),t={},t.fill=i[2],t.start=q.threshold1||q.threshold2,t.end=q.end,e.push(t)):(t.fill=i[0],t.start=q.start,t.end=q.end,e.push(t)),e}function l(e){var t;if(t=X.flat?["#51942B","#f5c245","#DA6263"]:["#3ABD21","#E0A51E","#B32424"],null===e||null===q)return t[0];if(q.threshold1||q.threshold2){if(q.threshold1&&q.threshold2)return"good"===q.rule&&t.reverse(),e>=q.start&&q.threshold1>e?t[0]:e>=q.threshold1&&q.threshold2>e?t[1]:t[2];"good"===q.rule&&t.reverse();var i=q.threshold1||q.threshold2;return e>=q.start&&i>e?t[0]:t[2]}return t[0]}function s(t,i,a,n,o){R&&(2*o>a&&(o=a/2),2*o>n&&(o=n/2),R.beginPath(),e.isIE()?R.rect(t,i,a,n):(R.moveTo(t+o,i),R.arcTo(t+a,i,t+a,i+n-o,o),R.arcTo(t+a,i+n,t+o,i+n,o),R.arcTo(t,i+n,t,i+o,o),R.arcTo(t,i,t+o,i,o)),R.closePath())}function d(e){return e*Math.PI/180}function c(t){var i,a,n=1e3,o=1e3*n,r=1e3*o;if("number"!==e.type(t)){if(a=""+t,i=parseFloat(a),isNaN(i))return a}else i=t;return a="",i>=r?(i=Math.round(10*i/r)/10,a=i+"b"):i>=o?(i=Math.round(10*i/o)/10,a=i+"m"):i>=n?(i=Math.round(10*i/n)/10,a=i+"k"):a=i+"",a}function h(e){var t,i,a,n,o,r,l,s,c,h,u,p,f,g,m,v,w,_,C=X.cx,b=X.cy,E=X.r,y=E-X.thick,x=0,T=0;for(x=0;e.length>x;x++)if(m=e[x],t=0===x?180:i,i=180*(1-(m.end-q.start)/(q.end-q.start)),a=d(t),n=d(i),o=C+Math.cos(a)*E,r=b-Math.sin(a)*E,l=C+Math.cos(n)*E,s=b-Math.sin(n)*E,c=C+Math.cos(n)*y,h=b-Math.sin(n)*y,u=C+Math.cos(a)*y,p=b-Math.sin(a)*y,"svg"===X.engine)f=X.flat?m.fill:"r("+C+","+b+","+C+","+b+","+E+")"+m.fill,g=["M",o,r,"A",E,E,0,0,1,l,s,"L",c,h,"A",y,y,0,0,0,u,p,"Z"],v=B.path(g).attr({stroke:"none",fill:f});else if("canvas"===X.engine){for(R.save(),a=2*Math.PI-a,n=2*Math.PI-n,R.beginPath(),R.moveTo(o,r),R.arc(C,b,E,a,n,!1),R.lineTo(c,h),R.arc(C,b,y,n,a,!0),R.closePath(),f=R.createRadialGradient(C,b,0,C,b,E),w=m.fill.split("-"),T=0;w.length>T;T++)_=w[T],_.indexOf(":")>0?f.addColorStop(_.split(":")[1]/100,_.split(":")[0]):0===T?f.addColorStop(0,_):f.addColorStop(1,_);R.fillStyle=f,R.fill(),R.restore()}}function u(){var e,t,i,a,n,o=X.cx,r=X.cy,l=X.r,s=X.thick,d=l-s,c=null,h="";X.showTexture!==!1&&(e=o-l,t=r,i=o+l,a=r,"svg"===X.engine?(h=["M",e,t,"A",l,l,0,0,1,i,a],h+=["L",i-s,a,"A",d,d,0,0,0,e+s,a],h+=["z"],c=B.path(h).attr({"stroke-width":1.5,"stroke-opacity":.2,"fill-opacity":.8,fill:X.texture})):"canvas"===X.engine&&W._complete===!0&&(R.save(),R.beginPath(),R.moveTo(o-l,r),R.arc(o,r,l,Math.PI,2*Math.PI,!1),R.lineTo(o+l-s,r),R.arc(o,r,l-s,2*Math.PI,Math.PI,!0),R.closePath(),n=R.createPattern(W,"repeat"),R.fillStyle=n,R.globalAlpha=.7,R.fill(),R.lineWidth=1,R.strokeStyle="rgba(0, 0, 0, 0.3)",R.stroke(),R.restore()))}function p(){var e,t,i,a,n=X.cx,o=X.cy,r=X.r,l=X.thick,s=null,d=r-l,c="",h="";e=n-r,t=o+2,i=n+r,a=o+2,"svg"===X.engine?(h=["M",e,a,"A",r,r,0,0,0,i,a],h+=["L",i-l,a,"A",d,d,0,0,1,e+l,a],h+=["z"],s=B.path(h).attr({"stroke-width":0,opacity:.1,fill:"270-#D3D3D3-#FFFFFF:90"})):"canvas"===X.engine&&(R.save(),R.beginPath(),R.moveTo(e,t),R.arc(n,o+2,r,Math.PI,0,!0),R.lineTo(i-l,a),R.arc(n,o+2,r-l,0,Math.PI,!1),R.closePath(),c=R.createLinearGradient(e,t,e,t+r),c.addColorStop(0,"#D3D3D3"),c.addColorStop(.8,"rgba(245, 245, 245, 0)"),R.fillStyle=c,R.fill(),R.restore())}function f(){var e,t,i,a,o,r=X.cx,l=X.cy,s=X.r,c=X.thick,h=s-c,u=null,p=3.6,f="",g=0;for(p=180/n,g=1;n>g;g++)e=d(180-p*g),h=0===g%2?s-.35*c:s-.25*c,t=r+Math.cos(e)*(s-1),i=l-Math.sin(e)*(s-1),a=r+Math.cos(e)*h,o=l-Math.sin(e)*h,"svg"===X.engine?(f=["M",t,i,"L",a,o],u=B.path(f).attr({"stroke-width":2,stroke:"white","stroke-opacity":.6})):"canvas"===X.engine&&(R.save(),R.beginPath(),R.moveTo(t,i),R.lineTo(a,o),R.lineWidth=2,R.strokeStyle="rgba(255, 255, 255, 0.6)",R.stroke(),R.restore())}function g(){var e,i,a,n,o,r=X.cx,l=X.cy,s=X.r,h=null,u=3.6,p=0;if(X.showRange){var f={"font-size":Math.floor(12*X.zoom),fill:t};a=r-s-Math.floor(15*X.zoom),n=l,o=c(q.start),"svg"===X.engine?B.text(a,n,o).attr(f):"canvas"===X.engine&&(a=r-s-2,R.save(),R.textBaseline="alphabetic",R.textAlign="right",R.font=f["font-size"]+"px"+" Arial",R.fillStyle=t,R.fillText(o,a,n));var g=[q.threshold1,q.threshold2];for(p in g)g[p]&&(e=180*(1-(g[p]-q.start)/(q.end-q.start)),e=Math.round(e/u)*u,i=d(e),o=c(g[p]),"svg"===X.engine?(a=r+Math.cos(i)*(s+Math.ceil(12*X.zoom)),n=l-Math.sin(i)*(s+Math.ceil(12*X.zoom)),h=B.text(a,n,o).attr(f)):"canvas"===X.engine&&(a=r+Math.cos(i)*(s+Math.ceil(2*X.zoom)),n=l-Math.sin(i)*(s+Math.ceil(2*X.zoom)),R.textAlign=90>=e?"left":"right",R.fillText(o,a,n)));o=c(q.end),"svg"===X.engine?(a=r+s+Math.ceil(15*X.zoom),n=l,B.text(a,n,o).attr(f)):"canvas"===X.engine&&(a=r+s+2,n=l,R.textAlign="left",R.fillText(o,a,n),R.restore())}}function m(){var e=r();null!==e&&0!==e.length&&(h(e),u(),p(),f(),g())}function v(t){var i,a,n,o,r,l,s,c,h,u,p,f,g=X.cx,m=X.cy,v=.8*(X.r-X.thick),w=.18*v,_=.1*v;if("svg"===X.engine)i=g-v,a=m,n=g,o=m-w,r=g,l=m+w,s=g+w,c=m,h=["M",i,a,"L",n,o,"A",w,w,0,1,1,r,l,"z"],f=X.flat?"#5A6470":"70-#1C242E-#718096:70-#1C242E",p=B.path(h).attr({"stroke-width":0,fill:f}),B.circle(g,m,_).attr({stroke:"none",fill:"#F1F2F3"}),j=p;else if("canvas"===X.engine){if("undefined"===e.type(t))return;u=d(t),R.save(),i=g+Math.cos(u)*v,a=m-Math.sin(u)*v,n=g+Math.cos(u-Math.PI/2)*w,o=m-Math.sin(u-Math.PI/2)*w,r=g+Math.cos(u+Math.PI/2)*w,l=m-Math.sin(u+Math.PI/2)*w,X.flat?f="#5A6470":(f=R.createLinearGradient(n,o,r,l),f.addColorStop(0,"#1C242E"),f.addColorStop(.7,"#718096"),f.addColorStop(1,"#1C242E")),u=2*Math.PI-u,R.beginPath(),R.moveTo(i,a),R.arc(g,m,w,u-Math.PI/2,u+Math.PI/2,!0),R.closePath(),R.fillStyle=f,R.fill(),R.beginPath(),R.arc(g,m,_,0,2*Math.PI,!1),R.fillStyle="#F1F2F3",R.fill(),R.restore()}}function w(){function t(e){var t=B.text(i,a,e);return t.attr({"font-family":"Arial","font-size":m,fill:"#394449"}),t}var i,a,n,o,r,s,d,c,h,u,p,f,g,m=10;if(d=e.isNull(q.value)?"--":q.value,c=e.isNull(q.end)?"--":q.end,h=e.isNull(q.unit)||e.isNull(q.value)?"":q.unit,i=X.cx,a=X.cy+(X.r-X.thick)/2,m+=3*Math.floor(X.r/10),m=16>m?16:m>40?40:m,m=Math.floor(m*X.zoom),"svg"===X.engine?(o=B.text(i,a,d+h),o.attr({"font-family":"Arial","font-size":m,"font-weight":"normal"}),z=o):"canvas"===X.engine&&(R.save(),f=""+m+"px"+" Arial,微软雅黑",g="normal "+Math.round(.6*m)+"px"+" Arial,微软雅黑",R.font=f,u=R.measureText(d+""),R.font=g,p=R.measureText(h),R.fillStyle=l(q.value),R.textBaseline="alphabetic",R.font=f,R.textAlign="left",R.fillText(d+"",i-(u.width+p.width)/2,a+m/2),R.font=g,R.textAlign="right",R.fillText(h,i+(u.width+p.width)/2+2,a+m/2)),m=12,X.showValueMax?(a=X.cy+X.r-X.thick,"svg"===X.engine?(o=null,o=B.text(i,a,"("+d+"/"+c+")"),o.attr({"font-family":"sans-serif","font-size":m,fill:"#394449"}),V=o):"canvas"===X.engine&&(R.textAlign="center",R.textBaseline="middle",R.font=m+"px"+" sans-serif",R.fillStyle="#394449",s="("+d+"/"+c+")",r=R.measureText(s),R.fillText(s,i,a)),a=X.cy+X.r+8):a=X.cy+X.r-5,m=12,"svg"===X.engine){if(s=q.name,o=t(s),n=X.width-10,o.getBBox().width>=n){for(;o.getBBox().width>=n;)s=s.substr(0,s.length-1),o.remove(),o=t(s);s=s+"\n"+q.name.substring(s.length),o.remove(),o=t(s),o.attr("title",q.name)}U=o}else"canvas"===X.engine&&(R.textAlign="center",R.textBaseline="middle",R.font=m+"px"+" Arial",R.fillStyle="#394449",s=q.name,r=R.measureText(s),R.fillText(s,i,a),R.restore())}function _(){if(null!==G&&"canvas"===X.engine){var e=X.left+X.width-13,t=X.top+13,i=8;R.save(),R.beginPath(),R.arc(e,t,i,0,2*Math.PI,!1),R.closePath(),R.fillStyle="#4F6BA8",R.fill(),R.beginPath(),R.moveTo(e-5,t),R.lineTo(e-1,t+4),R.lineTo(e+5,t-3),R.lineWidth=2,R.strokeStyle="white",R.stroke(),R.closePath(),R.restore()}}function C(t,i){if(("svg"!==X.engine||null!==j)&&!isNaN(X.r)){var a=$;if((null===a||a===undefined)&&(a=q.start),null!==a&&a!==undefined){var n=t?t:q.start,o=180*(a-q.start)/(q.end-q.start),r=180*(n-q.start)/(q.end-q.start);r>180?r=180:0>r&&(r=0);var s=o>r?-3:3;(e.isIE()||!i)&&(s=r-o),"canvas"===X.engine&&(x(),v(180-o));var d=window.setInterval(function(){if(o+=s,s>0&&o>r&&(o=r),0>s&&r>o&&(o=r),"svg"===X.engine){var e=Raphael.matrix();e.rotate(o,X.cx,X.cy),j.transform(e.toTransformString())}else"canvas"===X.engine&&(x(),v(180-o));o===r&&window.clearInterval(d)},10);$=t,q.value=t,"svg"===X.engine&&(z.attr({text:null===t?"--":t+q.unit,fill:l(t)}),null!==V&&(null!==t?V.attr({text:"("+t+"/"+q.end+")"}):V.attr({text:" "})))}}}function b(e,t){"svg"===X.engine?t?e.attr({"stroke-width":1.5}):e.attr({"stroke-width":1}):"canvas"===X.engine&&(t?(R.save(),R.lineWidth=2,R.strokeStyle="#B6B7B9",s(0,0,X.width,X.height,5),R.stroke(),R.restore()):M())}function E(){var t,i,a=null;t=X.left,i=X.top,"svg"===X.engine?(B.setStart(),B.rect(t,i,X.width,X.height,5).attr({stroke:"none",fill:X.bgColor})):"canvas"===X.engine&&(R.save(),R.clearRect(0,0,X.width,X.height),R.fillStyle=X.bgColor,R.fillRect(0,0,X.width,X.height),R.restore(),a=e("#"+X.renderTo+"-canvas"),a.attr("width",X.width).attr("height",X.height))}function y(){var t,i,a=null,n="pointer";t=X.left,i=X.top,"svg"===X.engine?(a=B.rect(t,i,X.width,X.height,5).attr({"stroke-width":1,stroke:"#B6B7B9",fill:"white","fill-opacity":.01,cursor:n}),"solid"===X.borderStyle?e.noop():"dashed"===X.borderStyle?a.attr({"stroke-dasharray":"- "}):(X.borderStyle="none",a.attr({stroke:"none"})),H=B.setFinish(),T(a)):"canvas"===X.engine&&(R.save(),"none"!==X.borderStyle&&(R.lineWidth=1,R.strokeStyle="#B6B7B9",s(0,0,X.width,X.height,5),R.stroke()),R.restore(),a=e("#"+X.renderTo+"-canvas"),a.css("cursor",n))}function x(){var t,n,o,r;return e.isNumeric(X.width)&&e.isNumeric(X.height)?0>=X.width||0>=X.height?!1:(X.width<X.height*i?(o=X.width/2,t=X.left+o,n=X.top+o):(o=X.height*i/2,t=X.left+X.width/2,n=X.top+o),o=o>X.padding?o-X.padding:1,r=Math.round(o*a),X.cx=t,X.cy=n,X.r=o,X.thick=r,E(),m(),v(),w(),_(),y(),undefined):!1}function T(e){X.hoverInfo===!0&&(e.mouseover(function(t){b(e,!0),L(t,!0)}),e.mouseout(function(t){b(e,!1),L(t,!1)}),e.mousemove(function(t){b(e,!0),L(t,!0)})),e.click(function(e){X.selectable&&(k(),L(e,!1)),I(e)})}function D(t){var i=!1;e.each(t,function(e,t){"value"!==e&&t!==q[e]&&(i=!0)}),q=e.extend(q,t),i?(M(),C(q.value,!1)):C(q.value,!0)}function S(e,t,i){1===X.zoom&&(X.orgWidth=X.width,X.orgHeight=X.height,X.orgLeft=X.left,X.orgTop=X.top,X.orgPadding=X.padding),X.zoom=e,X.zoomX=t,X.zoomY=i,X.width=X.orgWidth*X.zoom,X.height=X.orgHeight*X.zoom,X.padding=X.orgPadding*X.zoom;var a=Raphael.matrix(),n=X.orgLeft,o=X.orgTop;a.scale(e,e,t,i),X.left=a.x(n,o),X.top=a.y(n,o),M(X.width,X.height)}function k(){if(null===G){var e=X.left+X.width-13,t=X.top+13,i=8;if("svg"===X.engine){var a=B.circle(e,t,i).attr({stroke:"none",fill:"#4F6BA8"}),n=["M",e-5,t,"L",e-1,t+4,"L",e+5,t-3],o=B.path(n).attr({stroke:"white","stroke-width":2});G=[],G.push(a),G.push(o),H.push(a,o)}else"canvas"===X.engine&&(G=!0,_())}else{if("svg"===X.engine)for(var r in G)G.hasOwnProperty(r)&&(H.exclude(G[r]),G[r].remove(),G[r]=null);else"canvas"===X.engine&&(G=null,M());G=null}}function L(t,i){if(i&&null===Y){var a='<div class="sweet-chart-speedometer-hover-info"></div>',n="<label>[INFO]</label>";Y=e(a).appendTo("body");var o=Sweet.core.i18n.chart.meter.name+" : "+q.name;Y.append(e(n.replace("[INFO]",o))),o=Sweet.core.i18n.chart.meter.value+" : "+(0===q.value||q.value?q.value+q.unit:"--"),Y.append(e(n.replace("[INFO]",o))),q.threshold2&&(o=Sweet.core.i18n.chart.meter.major+" : "+q.threshold2+q.unit,Y.append(e(n.replace("[INFO]",o)))),q.threshold1&&(o=Sweet.core.i18n.chart.meter.minor+" : "+q.threshold1+q.unit,Y.append(e(n.replace("[INFO]",o)))),o=Sweet.core.i18n.chart.meter.min+" : "+q.start+q.unit,Y.append(e(n.replace("[INFO]",o))),o=Sweet.core.i18n.chart.meter.max+" : "+q.end+q.unit,Y.append(e(n.replace("[INFO]",o)))}null!==Y&&(i===!1?Y.hide():(Y.show(),Y.css("left",t.clientX+5+"px").css("top",t.clientY+20+"px")))}function N(){if(X={},q={name:"--",value:null,start:0,end:1,threshold1:1,threshold2:null,unit:"",rule:"bad"},X.renderTo="",X.renderToObj=null,X.paper=null,X.width=124,X.height=200,X.left=0,X.top=0,X.padding=5,X.borderStyle="none",X.selectable=!1,X.showRange=!1,X.showValueMax=!0,X.bgColor="transparent",X.hoverInfo=!1,X.zoom=1,X.engine="svg",X.flat=!1,X.showTexture=!0,X=e.extend(X,o),K=X.renderTo,O=o.paper,"svg"===X.engine&&null===B)B=e.isNull(O)?Raphael(X.renderToObj||K,X.width,X.height):O,H=B.set();else if("canvas"===X.engine){var t=e("<canvas>").appendTo(e("#"+K)).attr("id",K+"-canvas").attr("width","1000").attr("height","1000");R=document.getElementById(K+"-canvas").getContext("2d"),W=new Image;var i,a=/url\([\"\']?(.*)[\"\']?\)/g;null!==(i=a.exec(X.texture))&&(X.texture=i[1].replace(/[\"\']?$/g,""),W.onload=function(){W._complete=!0,M(X.width,X.height)},W.src=X.texture),T(t)}return!0}function I(t){if(!e.isNull(Q[t.type])){var i=Q[t.type];for(var a in i)if(i.hasOwnProperty(a))try{i[a](t,null!==G)}catch(n){e.noop()}}}function A(t,i){e.isNull(Q[t])&&(Q[t]=[]),Q[t].push(i)}function P(){"svg"===X.engine&&H?(H.forEach(function(e){e.remove()}),H.clear(),null===O&&(B.remove(),B=null)):"canvas"===X.engine&&R.clearRect(0,0,X.width,X.height)}function M(t,i){"svg"===X.engine&&H?(H.forEach(function(e){e.remove()}),H.clear(),j=null,z=null,V=null,U=null,G=null):"canvas"===X.engine&&R.clearRect(0,0,X.width,X.height),Y&&Y.remove(),Y=null,t!==undefined&&(X.width=t),i!==undefined&&(X.height=i),X.paper!==B&&B?B.setSize(X.width,X.height):R&&e("#"+X.holderId+"-canvas").attr("width",X.width).attr("height",X.height),x(),C(q.value)}function F(){Z.init=N,Z.setData=D,Z.redraw=M,Z.setValue=C,Z.setScale=S,Z.destroy=P,Z.addListener=A,Z.init()}var W,B=null,O=null,R=null,H=null,j=null,z=null,V=null,U=null,G=null,Y=null,q=null,$=null,K=null,X={},Q={},Z={};return F(),Z},r="sweet-chart-texture";e.widget("sweet.widgetChartSpeedometer",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-speedometer]:",eventNames:{click:"单击事件"},options:{renderTo:"",paper:null,left:0,top:0,width:110,height:130,padding:10,borderStyle:"solid",selectable:!0,showRange:!1,showValueMax:!0,engine:"svg",flat:!1,showTexture:!0},setValue:function(e){this.chartElement.setValue(e,!0)},setScale:function(e,t,i){this.chartElement.setScale(e,t,i)},setData:function(e){this.options.data=e,this.rendered&&this.chartElement.setData(e)},_addEvent:function(){var e=this;e.chartElement.addListener("click",function(t){e._triggerHandler(t,t.type,e.options&&e.options.data?e.options.data:{})})},_createJsChart:function(){},_chartRender:function(){var t=this,i=t.options,a={};a.renderTo=t.chartEl.attr("id"),a.renderToObj=t.chartEl.get(0),a.paper=i.paper,a.width=this.chartEl.width(),a.height=this.chartEl.height(),a.left=i.left,a.top=i.top,a.padding=i.padding,a.borderStyle=i.borderStyle,a.selectable=i.selectable,a.showRange=i.showRange,a.showValueMax=i.showValueMax,a.hoverInfo=i.hoverInfo,a.engine=i.engine,a.flat=i.flat,a.showTexture=i.showTexture;var n=e("<div></div>").addClass(r).appendTo("body"),l=n.css("background-image");a.texture=l,n.remove();var s=this.chartElement=new o(a);t._addEvent();var d=t.options.data;e.isNull(d)||s.setData(d)},_createFlashChart:function(){this._error("not implemented yet!")},click:function(t){e.log(t)},_doLayout:function(){var t=this;if(!e.isNull(t.chartElement)&&!e.isNull(t.renderEl)){var i=t.chartEl.width(),a=t.chartEl.height();t.chartElement.redraw(i,a)}},_destroyWidget:function(){if(this.chartElement&&e.isFunction(this.chartElement.destroy)){try{this.chartElement.destroy()}catch(t){this._error(t)}this.chartElement=null}this.options.data=null,this.chartEl&&this.chartEl.remove()}}),Sweet.chart.Speedometer=e.sweet.widgetChartSpeedometer}(jQuery),function(e){var t={minTextWidth:150,textHeight:30,cursorType:"pointer",lineColor:"#d2d2d2",textOnLineColor:"#d2d2d2",paddingLeftZoom:75,paperHeight:6e3,paperWidth:8e3,currentTaskConfig:{textOnLineColor:"#0084d8",lineColor:"#0084d8"},font:{size:12,rollSize:12,family:"Tahoma"},stroke:{width:2,rollWidth:2,rollColor:"#84aed9"},zoomAction:{zoomIn:"zoomin",zoomOut:"zoomout"}},i="sweet-chart-topology-El",a="sweet-chart-topology-node",n="sweet-chart-topology-board",o="sweet-chart-topology-node-click",r="sweet-chart-topology-node-dblclick",l="sweet-chart-node-active",s="sweet-chart-node-start-highlight",d="sweet-chart-topology-node-img",c="sweet-chart-topology-node-label",h="sweet-chart-topology-zoom-in",u="sweet-chart-topology-zoom-out";e.widget("sweet.widgetChartTopology",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-topology]:",eventNames:{nodeclick:"nodeclick",nodedblclick:"nodedblclick",lineclick:"lineclick",linedblclick:"linedblclick"},options:{layoutDirection:"H",draggable:!0,minLevelGapX:250,minLevelGapY:250,paddingBorder:5,nodeWidth:200,nodeHeight:75,fontSize:14,minNodeGap:30},_onClick:function(t){e(this).addClass(o);var i=t.data.nodeInfo,a=t.data.me;a._trigger("nodeclick",t,i)},_onDBClick:function(t){e(this).addClass(r);var i=t.data.nodeInfo,a=t.data.me;a._trigger("nodedblclick",t,i)},_subRemoveListener:function(t,i,n){var o="";t===i.nodeclick?(o="click",e("#"+n+" ."+a).unbind(o)):t===i.nodedblclick&&(o="dblclick",e("#"+n+" ."+a).unbind(o))},_removeListener:function(t){var i=this,a=i.topoId;t&&""!==t?(i._subRemoveListener(t,i.eventNames,a),t===i.eventNames.lineclick?i.lineClickEvent={}:t===i.eventNames.linedblclick&&(i.lineDblclickEvent={})):(i.handlers=i.handlers||{},e.each(i.handlers,function(e){i._subRemoveListener(e,i.eventNames,a),i.lineClickEvent={},i.lineDblclickEvent={}}))},_addListener:function(){var t=this,i=t.topoId,n=t.options.data;e.each(t.handlers,function(r,l){var s="";if(r===t.eventNames.nodeclick||r===t.eventNames.nodedblclick){s="",r===t.eventNames.nodeclick?s="click":r===t.eventNames.nodedblclick&&(s="dblclick");var d=e("#"+i+" ."+a);d.length>0&&(d.unbind(s),d.bind(s,{func:l,nodes:n},function(t){e(this).addClass(o);for(var i,a=t.data.func,n=t.data.nodes,r=e(t.currentTarget).attr("node-id"),l=0;n.length>l;l++)r===n[l].id&&(i=n[l]);a(t,i)}))}else if(r===t.eventNames.lineclick||r===t.eventNames.linedblclick){s="",r===t.eventNames.lineclick?s="click":r===t.eventNames.linedblclick&&(s="dblclick");for(var c=0;n.length>c;c++){var h=n[c];if(h.connect&&h.connect.length>0)for(var u=h.connect,p=0;u.length>p;p++)u[p].nodeLinePath&&("click"===s?t.lineClickEvent[h.id]=l:"dblclick"===s&&(t.lineDblclickEvent[h.id]=l))}}})},_getStartNodes:function(t){var i={},a=[];e.each(t.connections,function(t,n){i[t]=!0,e.each(n,function(e,t){a.push(t.id)})});for(var n=0;a.length>n;n++)delete i[a[n]];return i},_layoutNodes:function(i){if(i){var a,n=this,o=n.options,r=n.topologyEl.width()-t.paddingLeftZoom,l=n.topologyEl.height(),s=n._getStartNodes(i),d=[],c=[],h=0,u=[],p=0,f=[0],g=0;for(var m in s)c.push(m),a=n._findObjById(m,n.nodesArr),"H"===o.layoutDirection?(h+=a.height()+o.minNodeGap,a.width()>f[0]&&(f[0]=a.width())):(h+=a.width()+o.minNodeGap,a.height()>f[0]&&(f[0]=a.height()));d.push(c),g=f[0],u.push(h);var v=n._putNodesToLevel(d,i,{treeMaxWidth:h,treeMaxWidthLevel:p,treeWidth:u,levelMaxDeep:f,treeDeep:g});h=v.treeMaxWidth,u=v.treeWidth,p=v.treeMaxWidthLevel,f=v.levelMaxDeep,g=v.treeDeep,d=v.nodeList;var w=n._calcLevelPadding(g,d,r,l),_=t.paddingLeftZoom;e.each(d,function(e,t){var a=n._calcNodesPadding({nodes:t,level:e},{vHeight:l,vWidth:r},{treeMaxWidthLevel:p,treeWidth:u}),s=a.padding?a.padding:o.minNodeGap,d=a.offset?a.offset:0;n._updateNodePos(t,i,_,d,s),_+=f[e]+w})}},_updateNodePos:function(t,i,a,n,o){var r=this,l=r.options;e.each(t,function(e,t){var s,d,c=r._findObjById(t,r.nodesArr);"H"===l.layoutDirection?(s=a,d=n):(s=n,d=a),s>r.maxWidth-c.width()&&(r.maxWidth=s+c.width()+10),d>r.maxHeight-c.height()&&(r.maxHeight=d+c.height()+10),i.nodes[t].pos={x:s,y:d},c.css("left",s),c.css("top",d),n+=c.height()+o})},_putNodesToLevel:function(t,i,a){for(var n=this,o=n.options,r=0,l=[],s={},d=0,c=0;;){if(l=[],s={},d=0,c=0,e.each(t[r],function(t,a){e.each(i.connections,function(t,i){a===t&&e.each(i,function(e,t){if(!(t.id in s)){l.push(t.id),s[t.id]=!0;var i=n._findObjById(t.id,n.nodesArr);"H"===o.layoutDirection?(d+=i.height(),i.width()>c&&(c=i.width())):(d+=i.width(),i.height()>c&&(c=i.height()))}})})}),!(l.length>0))break;t.push(l),d>a.treeMaxWidth&&(a.treeMaxWidth=d,a.treeMaxWidthLevel=r+1),a.treeWidth.push(d),a.levelMaxDeep.push(c),a.treeDeep+=c,r+=1}return a.nodeList=t,a},_calcNodesPadding:function(e,t,i){var a=this,n=a.options,o=0,r=n.minNodeGap,l=e.nodes.length,s=2*n.paddingBorder,d=i.treeWidth[e.level];if("H"===n.layoutDirection){if(d+n.minLevelGapY*(l-1)+s<t.vHeight-2){var c=t.vHeight-2-s-d;r=l>1?c/(l-1):c}}else if(d+n.minLevelGapX*(l-1)+s<t.vWidth-2){var h=t.vWidth-2-s-d;r=l>1?h/(l-1):h}return r=Math.floor(r),e.level===i.treeMaxWidthLevel?o=n.paddingBorder:(o=Math.floor(r/(l+1)),r=Math.floor((r*(l-1)-2*o)/(l-1))),n.minNodeGap>r&&1===a.scale&&(r=n.minNodeGap),{offset:o,padding:r}},_calcLevelPadding:function(e,t,i,a){var n=this,o=n.options,r=0;return"H"===o.layoutDirection?(r=i-2>e+o.minLevelGapX*(t.length-1)+2*o.paddingBorder?(i-2-2*o.paddingBorder-e)/(t.length-1):o.minLevelGapX,o.minLevelGapX>r&&1===n.scale&&(r=o.minLevelGapX)):(r=a-2>e+o.minLevelGapY*(t.length-1)+2*o.paddingBorder?(a-2-2*o.paddingBorder-e)/(t.length-1):o.minLevelGapY,o.minLevelGapY>r&&1===n.scale&&(r=o.minLevelGapY)),Math.floor(r)},_createConnections:function(i,a){if(i){var n=this,o=n.options;e.each(i.connections,function(r,l){e.each(l,function(e,l){var d,c,h,u,p=n._findObjById(r,n.nodesArr),f=n._findObjById(l.id,n.nodesArr);"H"===o.layoutDirection?(d=i.nodes[r].pos.x+p.width(),h=i.nodes[r].pos.y+p.height()/2,c=i.nodes[l.id].pos.x,u=i.nodes[l.id].pos.y+f.height()/2,a&&(d>c?d-=p.width():d===c&&(d-=p.width()/2))):(d=i.nodes[r].pos.x+p.width()/2,h=i.nodes[r].pos.y+p.height(),c=i.nodes[l.id].pos.x+f.width()/2,u=i.nodes[l.id].pos.y,a&&(h>u?h-=p.height():h===u&&(h-=p.height()/2)));var g=["M",d,h,"L",c,u];if("nodeLinePath"in l)l.nodeLinePath.attr({path:g});else{var m=t.lineColor;l.currentTask&&"true"===l.currentTask&&(m=t.currentTaskConfig.lineColor,n._findObjById(l.id,n.nodesArr).addClass(s)),l.nodeLinePath=n.R.path(g).attr({cursor:"pointer",stroke:m,title:l.label,"stroke-width":t.stroke.width,"arrow-end":"classic-wide-long"}).mouseover(function(e){n._arrowLineMouseOver(e,l)
}).mouseout(function(e){n._arrowLineMouseOut(e,l)}).click(function(e){n._arrowLineClick(e,r,l,n)}).dblclick(function(e){n._arrowLineDblclick(e,r,l,n)})}})})}},_arrowLineClick:function(e,t,i,a){for(var n={},o=a.options.data,r=0;o.length>r;r++)o[r].id===t&&(n.startNode=o[r]),o[r].id===i.id&&(n.endNode=o[r]);if(a.lineClickEvent&&a.lineClickEvent[t]){var l=a.lineClickEvent[t];l&&l(e,n)}else a._trigger("lineclick",e,n)},_arrowLineDblclick:function(e,t,i,a){for(var n={},o=a.options.data,r=0;o.length>r;r++)o[r].id===t&&(n.startNode=o[r]),o[r].id===i.id&&(n.endNode=o[r]);if(a.lineDblclickEvent&&a.lineDblclickEvent[t]){var l=a.lineDblclickEvent[t];l&&l(e,n)}else a._trigger("linedblclick",e,n)},_arrowLineMouseOver:function(e,i){var a=i.nodeLinePath,n=i.nodeLineLabel?i.nodeLineLabel:null;i.currentTask&&"true"===i.currentTask?(a.attr({"stroke-width":t.stroke.rollWidth}),n&&n.attr({"font-size":t.font.rollSize})):(a.attr({stroke:t.stroke.rollColor,"stroke-width":t.stroke.rollWidth}),n&&n.attr({stroke:t.stroke.rollColor,"font-size":t.font.rollSize}))},_arrowLineMouseOut:function(e,i){var a=i.nodeLinePath,n=i.nodeLineLabel?i.nodeLineLabel:null;i.currentTask&&"true"===i.currentTask?(a.attr({"stroke-width":t.stroke.width}),n&&n.attr({"font-size":t.font.size})):(a.attr({stroke:t.lineColor,"stroke-width":t.stroke.width}),n&&n.attr({stroke:t.lineColor,"font-size":t.font.size}))},_getArrowLine:function(e,t,i,a,n){var o=30,r=Raphael.angle(e,t,i,a),l=Raphael.rad(r-o),s=Raphael.rad(r+o),d=i+Math.cos(l)*n,c=a+Math.sin(l)*n,h=i+Math.cos(s)*n,u=a+Math.sin(s)*n,p=["M",e,t,"L",i,a,"L",d,c,"M",i,a,"L",h,u];return p},_getLineLabel:function(e,t,i,a){var n=7,o=Raphael.angle(e,t,i,a),r=Raphael.rad(o+90),l=(e+i)/2,s=(t+a)/2,d=l+Math.cos(r)*n,c=s+Math.sin(r)*n,h=["T",d,c,"R",o+180];return h},_prepare:function(){var t=this;0!==t.topologyPaper.length&&(t.topologyPaper.empty().css("overflow","hidden"),t.topoBoard=e("<div class="+n+" ></div>").appendTo(t.topologyPaper))},_createNodes:function(){var i=this,n=i.options.data;if(0>=n.length)return!1;for(var o='<div node-id="[id]">[content]</div>',r='<img src="[icon]"/>',l='<label style="display: block; cursor: pointer;">[label]</label>',s=0;n.length>s;s++){var h="",u="",p="",f="";n[s].icon&&""!==n[s].icon?(h=r.replace("[icon]",n[s].icon),f+=h):n[s].shape&&""!==n[s].shape&&(l='<label class="'+c+'" style="display: block; cursor: pointer;">[label]</label>'),e.isNull(n[s].text)||(n[s].tips=n[s].text,u=l.replace("[label]",n[s].text),f+=u),p=o.replace("[content]",f),p=p.replace("[id]",n[s].id);var g=e(p),m=i.options.fontSize+"px";g.css({position:"absolute",cursor:t.cursorType,"font-size":m}).addClass(a),(!e.isNull(n[s].icon)&&!n[s].shape||""===n[s].shape)&&g.addClass(d),e.isNull(n[s].shape)||g.addClass(a+"-"+n[s].shape.toLowerCase()).css("min-width",""+t.minTextWidth+"px").width(i.options.nodeWidth).height(i.options.nodeHeight),g.attr("title",n[s].tips).css("overflow","hidden"),g.bind("click",{nodeInfo:n[s],me:i},i._onClick).bind("dblclick",{nodeInfo:n[s],me:i},i._onDBClick).bind("mouseover",i._nodeMouseOver).bind("mouseout",i._nodeMouseOut),g.appendTo(i.topoBoard),i.nodesArr.push({id:n[s].id,obj:g})}return!0},_nodeMouseOver:function(t){e(t.currentTarget).addClass(l)},_nodeMouseOut:function(t){e(t.currentTarget).removeClass(l)},_createJsChart:function(){var a=this;a.nodesArr=[];var o=a.options,r=a.topoId=o.id+"-topology",l=a.id=o.id+"-paper";a.maxWidth=0,a.maxHeight=0,a.scale=1,a.minNodeGap=a.options.minNodeGap,a.minLevelGapX=a.options.minLevelGapX,a.minLevelGapY=a.options.minLevelGapY,a.lineClickEvent={},a.lineDblclickEvent={};var s=a.topologyEl=e("<div>").attr({id:r}).addClass(i),d=a.topologyPaper=e("<div>").attr({id:l}).appendTo(s).width(t.paperWidth).height(t.paperHeight).css({overflow:"visible"});a.board=l+" ."+n,a._prepare(),a.R=new Raphael(d[0],d.width(),d.height());var c=a.topoSVG=e("#"+l+" >svg");c.css("overflow","visible"),!a.options.data||0>=a.options.data.length||a._createNodesLine()},_createNodesLine:function(){var t=this;t.nodeData=t._transData(t.options.data),t._drawZoomIcon(),t._createNodes();var i=t.nodesArr;setTimeout(function(){for(var n,o,r=0;t.options.data.length>r;r++)if(n=t.options.data[r],o=t._findObjById(n.id,i),n.domInfo={divHeight:o.height(),divWidth:o.width()},n.icon&&""!==n.icon){var l=o.find("img");n.domInfo.imgHeight=l.height(),n.domInfo.imgWidth=l.width()}if(t._layoutNodes(t.nodeData),t._createConnections(t.nodeData),t.options.draggable){var s=e("#"+t.topoId+" ."+a);s.draggable(),s.on("drag",{me:t},t._topologyNodeMove)}t.topologyPaper.draggable(),t.topologyPaper.on("drag",{me:t},t._topologyPaperMove),t.addListener()},200)},_zoomer:function(i,n){var o=n.options.data,r=1,l=n.topologyEl.height(),s=n.topologyEl.width(),d=15;if(i===t.zoomAction.zoomIn){var c=s/n.maxWidth,h=l/n.maxHeight;r=h>c?c:h}else r=1;n.scale=r,n.topologyPaper.css({top:0,left:0}),n.options.minNodeGap=n.minNodeGap*r,n.options.minLevelGapX=n.minLevelGapX*r,n.options.minLevelGapY=n.minLevelGapY*r;var u=n.options.fontSize*r;e("#"+n.topoId+" ."+a).css({"font-size":u});for(var p,f,g,m,v,w=0;o.length>w;w++)if(f=o[w],p=f.domInfo,g=e("div[node-id="+f.id+"]"),g.width(d>p.divWidth*r?d:p.divWidth*r).height(d>p.divHeight*r?d:p.divHeight*r),f.icon&&""!==f.icon&&(m=g.find("img"),m.width(d>p.imgWidth*r?d:p.imgWidth*r).height(d>p.imgHeight*r?d:p.imgHeight*r)),f.connect&&f.connect.length>0)for(var _=0;f.connect.length>_;_++)v=f.connect[_],v.nodeLineLabel&&v.nodeLineLabel.attr("font-size",t.font.size*r);var C=n._transData(o);setTimeout(function(){n._layoutNodes(C),n._createConnections(C)},200)},_findObjById:function(e,t){for(var i=0;t.length>i;i++)if(e===t[i].id)return t[i].obj},_transData:function(e){if(e&&0>=e.length)return null;var t={};t.nodes={},t.connections={};for(var i=0;e.length>i;i++){var a=e[i];t.nodes[a.id]=a,a.connect&&(t.connections[a.id]=a.connect)}return t},_drawZoomIcon:function(){var i=this;i.options;var a=e("<div>").addClass(h).appendTo(i.topologyEl).click(function(){a.hide(),n.show(),i._zoomer(t.zoomAction.zoomIn,i)}),n=e("<div>").addClass(u).appendTo(i.topologyEl).click(function(){a.show(),n.hide(),i._zoomer(t.zoomAction.zoomOut,i)});a.show(),n.hide()},_topologyPaperMove:function(t){var i=t.data.me,a=e("#"+i.id+">svg");e("#"+i.board).css("left",a.css("left")).css("top",a.css("top"))},_topologyNodeMove:function(t,i){var a=t.data.me,n=e(t.currentTarget),o=i.position.left,r=i.position.top,l=n.attr("node-id"),s=a.nodeData;s.nodes[l].pos={x:o,y:r};var d=e("div[node-id="+l+"]");d.css("left",o),d.css("top",r),a._createConnections(s,!0)},setData:function(e){if(e&&!(0>=e.length)){var t=this;delete t.nodeData,delete t.options.data,t.options.data=e,t._reDraw()}},_chartRender:function(){this.rendered||e.isNull(this.topologyEl)||this.topologyEl.appendTo(this.chartEl)},_doLayout:function(){var e=this;e.options.renderTo&&""!==e.options.renderTo&&(e.topologyEl.width(e.chartEl.width()),e.topologyEl.height(e.chartEl.height()))},_reDraw:function(){var e=this;e.removeListener(),e.chartEl.empty(),e.options.minNodeGap=e.minNodeGap,e.options.minLevelGapX=e.minLevelGapX,e.options.minLevelGapY=e.minLevelGapY,e._createJsChart(),e.topologyEl.appendTo(e.chartEl)},_createFlashChart:function(){}}),Sweet.chart.Topology=e.sweet.widgetChartTopology}(jQuery),function(e,t){var i=Sweet.constants.colors,a={colors:[i[0],i[3],i[5],i[7],i[8],i[9],i[1],i[6],i[2],i[4],i[10]],graph:{bullet:"round",type:"line",lineThickness:2},balloon:{adjustBorderColor:!0,fillColor:"#ffffff",pointerWidth:5,cornerRadius:0},cursor:{cursorPosition:"mouse",categoryBalloonColor:"#526f9f"},legend:{position:"bottom",align:"center",markerType:"square"},guide:{lineColor:"#d72e2e",lineAlpha:1,dashLength:2,inside:!0,labelRotation:90},stackType:["regular","100%","3d","none"]};e.widget("sweet.widgetChartLine",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-line]:",eventNames:{click:"图的单击事件"},maxPacket:11,options:{isCursor:!0,isScrollbar:!0,isLegend:!0,labelRotation:0,dataKeys:["text"],graphType:Sweet.constants.graphType.LINE,stackType:t,style:1,legendTips:!0,parseDate:!1,xDateFormat:"hh",categoryBalloonDateFormat:"YYYY MMM DD JJ:NN",switchable:!0,definedColor:!1,connect:!1,maxnumLeft:null,maxnumRight:null,minimum:["",""],integersOnly:[!1,!1],balloonTextAlign:"middle",balloonText:"",oneBalloonOnly:!1},_onClick:function(e,t,i){var a={};a.item=JSON.parse(JSON.stringify(e.item.dataContext)),a.legendValue=e.item.graph.title,a.data=e.item.values.value,a.valueField=e.graph.valueField,i?i(e,a):t._trigger("click",e,a)},_removeListener:function(t){var i=this;i.handlers=i.handlers||{},t&&""!==t?e.each(i.handlers,function(e,a){t===e&&i.chartElement.removeListener(i.chartElement,e,a)}):e.each(i.handlers,function(e,t){i.chartElement.removeListener(i.chartElement,e,t)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&t.chartElement.addListener("clickGraphItem",function(e){t._onClick(e,t,i)})})},_createJsChart:function(){var t,i,n=this,o=n.options,r={},l=o.data;e.isNull(o.dataKeys)||0!==o.dataKeys.length||(o.dataKeys=["text"]),0!==l.length||o.parseDate||(r={},r[o.dataKeys[0]]=Sweet.core.i18n.chart.noDataTips,n.options.data=[r]),n.lineId=o.id+"-lineEl",t=n.lineEl=e("<div>").attr("id",n.lineId).width(o.width).height(o.height).appendTo(n.chartEl),i=n.chartElement=new AmCharts.AmSerialChart,i.pathToImages=Sweet.amchartsImagePath,i.categoryField=o.dataKeys[0],i.dataProvider=l,i.numberFormatter={precision:-1,decimalSeparator:".",thousandsSeparator:","},i.balloon.adjustBorderColor=a.balloon.adjustBorderColor,i.balloon.fillColor=a.balloon.fillColor,i.balloon.cornerRadius=5,i.balloon.pointerWidth=a.balloon.pointerWidth,i.balloon.showBullet=!0,i.balloon.textAlign=o.balloonTextAlign,i.color=i.balloon.color=i.balloon.textShadowColor=n.textColor,i.fontSize=n.fontSizeNormal,i.fontFamily=n.chartFontFamily,(o.graphType===Sweet.constants.graphType.COLUMN||o.graphType===Sweet.constants.graphType.MIX_COLUMN_LINE)&&(i.columnWidth=.5),n._setCategoryAxis(),n.yAxis=n._createValueAxis(),n._createGraphs(),n._createJsCursor(),n._createJsScrollbar(),n._createJsLegend(),o.graphType===Sweet.constants.graphType.BAR&&(n._doAddUnitTitleFun=function(){n._addUnitTitle()},n.chartElement.addListener("rendered",n._doAddUnitTitleFun))},_guide:function(e,t,i){var n=new AmCharts.Guide,o=a.guide.lineColor,r=i,l=a.guide.dashLength;return i&&i.color&&(o=i.color),i&&i.value&&(r=i.value),i&&i.dashLength&&(l=i.dashLength),t===Sweet.constants.axisType.VALUE?n.value=r:t===Sweet.constants.axisType.CATEGORY&&(n.category=r),n.lineColor=o,n.lineAlpha=a.guide.lineAlpha,n.dashLength=l,n.inside=a.guide.inside,n.labelRotation=a.guide.labelRotation,n.balloonText=r,i&&i.label&&(n.label=i.label),e.addGuide(n),e},_createGuide:function(e,t,i){var a=this;if(i&&""!==i)if(i instanceof Array)for(var n=0;i.length>n;n++)a._guide(e,t,i[n]);else a._guide(e,t,i)},_setCategoryAxis:function(){var e=this,t=e.options,i=e.chartElement.categoryAxis;t.parseDate?(i.parseDates=!0,i.isParseDate=!0,i.minPeriod=t.xDateFormat,i.equalSpacing=!0):(i.parseDates=!1,i.isParseDate=!1,i.minPeriod="DD",i.equalSpacing=!1),i.isPieText=!1,i.gridPosition="start",i.startOnAxis=t.graphType===Sweet.constants.graphType.AREA?!0:!1,i.autoGridFrequency=t.graphType===Sweet.constants.graphType.BAR?!0:!1,0!==Number(t.labelRotation)&&(i.autoGridFrequency=!0,i.labelRotation=Number(t.labelRotation)),t.xThresholdValue&&e._createGuide(i,Sweet.constants.axisType.CATEGORY,t.xThresholdValue)},_createValueAxis:function(){var t=this,i=t.options,a=t.chartElement.categoryAxis;t.yAxis&&(t.yAxis.left&&t.chartElement.removeValueAxis(t.yAxis.left),t.yAxis.right&&t.chartElement.removeValueAxis(t.yAxis.right),t.yAxis={},t.chartElement.valueAxes=[]);var n,o={},r=Sweet.constants.graphType,l=new AmCharts.ValueAxis;switch(i.maxnumLeft?l.maximum=i.maxnumLeft:"",i.integersOnly&&i.integersOnly[0]&&(l.integersOnly=i.integersOnly[0]),i.graphType){case r.AREA:case r.BAR:case r.COLUMN:case r.MIX_COLUMN_LINE:i.stackType?l.stackType=i.stackType:"",i.graphType===r.BAR?a.labelFrequency=1:i.graphType===r.MIX_COLUMN_LINE&&(n=new AmCharts.ValueAxis,n.position="right",i.integersOnly&&i.integersOnly[1]&&(n.integersOnly=i.integersOnly[1]),i.minimum[1]&&"number"===e.type(i.minimum[1])&&(n.minimum=i.minimum[1]),i.maxnumRight?n.maximum=i.maxnumRight:"",t.chartElement.addValueAxis(n),o.right=n)}return i.minimum[0]&&"number"===e.type(i.minimum[0])&&(l.minimum=i.minimum[0]),i.yThresholdValue&&t._createGuide(l,Sweet.constants.axisType.VALUE,i.yThresholdValue),t.chartElement.addValueAxis(l),o.left=l,o},_addUnitTitle:function(t){var i,n,o,r=this,l=r.options,s=20,d=s,c=r.chartElement.marginTop-r.fontSizeNormal-10;r.chartElement.clearLabels(),e.isNull(l.chartTitle)||r.preTitle===l.chartTitle&&!t||(r.chartElement.titles=[],r.chartElement.addTitle(l.chartTitle,r.fontSizeLarger,r.labelColor,r.labelAlpha,r.chartFontFamily),r.preTitle=l.chartTitle),r.preTitle&&(c+=33),0>c&&(c=0),l.stackType===a.stackType[1]?(i="%",r.chartElement.addLabel(d,c,i,"left",r.fontSizeNormal,r.textColor,0,1)):l.leftUnit&&""!==l.leftUnit&&(n=l.leftUnit,l.graphType===Sweet.constants.graphType.BAR?(d=e("#"+r.options.id).width()-s,r.chartElement.addLabel(d,c,n,"right",r.fontSizeNormal,r.textColor,0,1)):r.chartElement.addLabel(d,c,n,"left",r.fontSizeNormal,r.textColor,0,1)),l.rightUnit&&""!==l.rightUnit&&(l.graphType===Sweet.constants.graphType.BAR&&(c+=r.chartElement.plotAreaHeight+33),d=e("#"+r.options.id).width()-s,o=l.rightUnit,r.chartElement.addLabel(d,c,o,"right",r.fontSizeNormal,r.textColor,0,1))},_createGraphs:function(){var e=this,t=e.options,i=t.dataKeys.length-1,n=a.colors;e._addGraphs(i,n)},_addGraphs:function(t,i){var n,o=this,r=o.options,l=o.chartElement,s=Sweet.constants.graphType,d=r.stackType,c=a.stackType[1],h="",u="[[value]]",p="[[percents]]%",f="[[title]]: ",g=f+p+" ("+u+")",m=f+u;o._graphs={};for(var v=1;t>=v;v++){switch(n=new AmCharts.AmGraph,n.valueField=r.dataKeys[v][0],n.descriptionField=r.dataKeys[v][4],n.title=r.dataKeys[v][1],n.type=a.graph.type,n.connect=r.connect,n.drillField="drillable",r.balloonText?n.balloonText=r.balloonText:(h=r.leftUnit?m+" "+r.leftUnit:m,n.balloonText=d===c?g:h),n.lineThickness=a.graph.lineThickness,t>0&&o.maxPacket>=t&&(n.lineColor=i[v-1]),r.definedColor&&(n.colorField="color",n.lineThickness=0,delete n.lineColor),r.graphType){case s.AREA:n.lineAlphas=1,n.fillAlphas=.6;break;case s.BAR:case s.COLUMN:n.fillAlphas=1,n.type=s.COLUMN,r.graphType===s.BAR?l.rotate=!0:n.labelText="";break;case s.LINE:1===r.style&&(t>0&&o.maxPacket>=t&&(e.isNull(n.lineColor)||(n.bulletBorderColor=n.lineColor),n.bulletColor="#ffffff"),n.bullet=a.graph.bullet);break;case s.MIX_COLUMN_LINE:var w=r.dataKeys[v][3];w===s.LINE?n.type=s.LINE:w===s.COLUMN||w===s.BAR?(n.type=s.COLUMN,n.fillAlphas=1,r.graphType===s.BAR?l.rotate=!0:n.labelText=""):w===s.AREA&&(n.lineAlphas=1,n.fillAlphas=.6),1===r.style&&w===s.LINE&&(n.bullet=a.graph.bullet,e.isNull(n.lineColor)||(n.bulletBorderColor=n.lineColor),n.bulletColor="#ffffff"),"left"===r.dataKeys[v][2]?(e.isNull(w)&&(n.type=s.COLUMN,n.fillAlphas=1),n.valueAxis=o.yAxis.left):(r.balloonText?n.balloonText=r.balloonText:(h=r.rightUnit?m+" "+r.rightUnit:m,n.balloonText=d===c?g:h),n.valueAxis=o.yAxis.right)}o._graphs[n.valueField]=n,l.addGraph(n)}},_setChangeProperty:function(i){var a=this,n=a.options;return(e.isNull(n.dataKeys)||!e.isNull(n.dataKeys)&&0===n.dataKeys.length)&&(n.dataKeys=["text"]),a.chartElement.categoryField=a.options.dataKeys[0],(e.isNull(n.data)||!e.isNull(n.data)&&0===n.data.length)&&a._setNoData(),a._doAddUnitTitleFun&&(a.chartElement.removeListener(a.chartElement,"rendered",a._doAddUnitTitleFun),a._doAddUnitTitleFun=null),i?(a.chartElement&&a.chartElement.destroy(),a.chartEl&&a.chartEl.empty(),a._createJsChart(),a._addListener(),a.chartElement.dataProvider=a.options.data,a.rendered=!1,a._chartRender(a.options.renderTo),a.rendered=!0,a.chartElement.invalidateSize(),a._doAddUnitTitleFun&&(a.chartElement.removeListener(a.chartElement,"rendered",a._doAddUnitTitleFun),a._doAddUnitTitleFun=null),n.graphType===Sweet.constants.graphType.BAR?(e.isNull(n.chartTitle)||a.preTitle===n.chartTitle||(a.chartElement.titles=[],a.chartElement.addTitle(n.chartTitle,a.fontSizeLarger,a.labelColor,a.labelAlpha,a.chartFontFamily),a.preTitle=n.chartTitle),a._doAddUnitTitleFun=function(){a._addUnitTitle(!0)},a.chartElement.addListener("rendered",a._doAddUnitTitleFun)):a._addUnitTitle(!0),t):(a.chartElement.dataProvider=a.options.data,a._setCategoryAxis(),a.yAxis=a._createValueAxis(),a._createGraphs(),a.chartElement.invalidateSize(),n.graphType===Sweet.constants.graphType.BAR?(e.isNull(n.chartTitle)||a.preTitle===n.chartTitle||(a.chartElement.titles=[],a.chartElement.addTitle(n.chartTitle,a.fontSizeLarger,a.labelColor,a.labelAlpha,a.chartFontFamily),a.preTitle=n.chartTitle),a._doAddUnitTitleFun=function(){a._addUnitTitle()},a.chartElement.addListener("rendered",a._doAddUnitTitleFun)):a._addUnitTitle(),t)},_updateData:function(){var e=this;e.chartElement.dataProvider=e.options.data,e.chartElement.validateData()},_createJsCursor:function(){var e=this;if(e.options.isCursor){var t=new AmCharts.ChartCursor;t.bulletsEnabled=!0,t.oneBalloonOnly=e.options.oneBalloonOnly,e.options.parseDate&&(t.categoryBalloonDateFormat=e.options.categoryBalloonDateFormat),t.cursorPosition=a.cursor.cursorPosition,t.dashLength=8,t.cursorColor=t.categoryBalloonColor=a.cursor.categoryBalloonColor,e.chartElement.addChartCursor(t)}},_createJsScrollbar:function(){if(this.options.isScrollbar){var e=new AmCharts.ChartScrollbar;e.backgroundColor="#e2ebf4",e.scrollbarHeight=15,this.chartElement.addChartScrollbar(e)}},_createJsLegend:function(){var e=this;if(e.options.isLegend){var t=new AmCharts.AmLegend;t.position=a.legend.position,t.align=a.legend.align,t.valueAlign="left",t.markerType=a.legend.markerType,t.color=e.textColor,t.valueWidth=110,t.switchType="v",t.switchable=e.options.switchable,e.options.legendTips||(t.valueText=""),t.addListener("hideItem",function(t){e._graphs&&(e._graphs[t.dataItem.valueField].hidden=!0)}),t.addListener("showItem",function(t){e._graphs&&(e._graphs[t.dataItem.valueField].hidden=!1)}),e.chartElement.addLegend(t)}},setChartType:function(t,i){var a=this,n=a.options;e.isNull(t)||(n.graphType=t),n.stackType=i,a.chartElement.rotate=!1,a._setChangeProperty()},_setNoData:function(){var t=this;if(e.isNull(t.chartElement.categoryField)&&(t.chartElement.categoryField="text"),t.options.parseDate)t.options.data=[];else{var i={};i[t.chartElement.categoryField]=Sweet.core.i18n.chart.noDataTips,t.options.data=[i]}},_setDefaultData:function(){var e=this;e._setNoData(),e._updateData()},_chartRender:function(){var e=this;!e.rendered&&e.chartElement&&(e.chartElement.write(e.lineId),e._addUnitTitle())},_doLayout:function(){var e=this;e.options.renderTo&&""!==e.options.renderTo&&e.chartElement&&(e.chartElement.invalidateSize(),e._addUnitTitle())}}),Sweet.chart.Line=e.sweet.widgetChartLine}(jQuery),function(e){var t=[["#369cd8"],["#369cd8","#b7e042"],["#369cd8","#b7e042","#cf7a37"],["#369cd8","#b7e042","#cf7a37","#9a53e4"],["#369cd8","#63ccd3","#b7e042","#cf7a37","#9a53e4"],["#369cd8","#63ccd3","#b7e042","#f2a14e","#cf7a37","#9a53e4"],["#369cd8","#63ccd3","#b7e042","#f2a14e","#cf7a37","#d07dd0","#9a53e4"],["#369cd8","#60b2df","#63ccd3","#b7e042","#f2a14e","#cf7a37","#d07dd0","#9a53e4"],["#369cd8","#60b2df","#63ccd3","#b7e042","#90cc19","#f2a14e","#cf7a37","#d07dd0","#9a53e4"],["#369cd8","#60b2df","#63ccd3","#b7e042","#90cc19","#f2a14e","#cf7a37","#cf4737","#d07dd0","#9a53e4"],["#369cd8","#60b2df","#63ccd3","#b7e042","#90cc19","#f2a14e","#cf7a37","#cf4737","#d07dd0","#9a53e4","#a5a5a5"]],i=Sweet.libPath+"themes/default/core/images/chart/",a={depth3D:0,angle:0,textureMap:{"#369CD8":i+"texture_369CD8.png","#60B2DF":i+"texture_60B2DF.png","#63CCD3":i+"texture_63CCD3.png","#B7E042":i+"texture_B7E042.png","#90CC19":i+"texture_90CC19.png","#F2A14E":i+"texture_F2A14E.png","#CF7A37":i+"texture_CF7A37.png","#CF4737":i+"texture_CF4737.png","#D07DD0":i+"texture_D07DD0.png","#9A53E4":i+"texture_9A53E4.png","#A5A5A5":i+"texture_A5A5A5.png","#777D8B":i+"texture_777D8B.png","#F77007":i+"texture_F77007.png"}};[{text:Sweet.core.i18n.chart.noDataTips}];var n="#A5A5A5";e.widget("sweet.widgetChartPie",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-pie]:",eventNames:{click:"饼图块单击事件"},options:{data:[],dataKeys:["text","value"],labelRadius:15,isLegend:!0,fillGraph:!1,title:"",depth3D:2,angle:0,position:"right",labelText:"[[percents]]%",pullOutOnlyOne:!1,autoScreenDisplay:!1,maxLegendTextZH:10,maxLegendTextEN:20,minRadius:10,precision:2,dashboard:!1,balloonText:"[[title]]: [[percents]]% ([[value]])",descriptionField:"",switchable:!0,isSortForData:!0,hideLabelsPercent:6},_onClick:function(t,i,a){for(var n,o,r=t.chart.mouseX,l=t.chart.mouseY,s=t.dataItem.dataContext,d=t.chart.dataProvider,c=0;d.length>c;c++)if(n=d[c],!e.isNull(n.menu)){o=JSON.parse(JSON.stringify(n.menu)),delete n.menu;var h=e.equals(n,s);if(n.menu=o,h)break;o=null}if(i.menu&&i.menu.hide(),o){var u,p=i.options.id+"-pie-menu";u=0===e("#"+p).length?e("<div>").attr("id",p):e("#"+p),u.appendTo(e("#"+i.options.renderTo)),i.menu=new Sweet.menu.Menu({renderTo:p,X:r,Y:l,items:o,itemSelect:function(e,n){var o={event:e,itemInfo:n,value:s};a?a(t,o):i._trigger("click",t,o)}})}else a?a(t,s):i._trigger("click",t,s)},_closeFloatPanel:function(){},_removeListener:function(t){var i=this;i.handlers=i.handlers||{},t&&""!==t?e.each(i.handlers,function(e,a){t===e&&i.chartElement.removeListener(i.chartElement,e,a)}):e.each(i.handlers,function(e,t){i.chartElement.removeListener(i.chartElement,e,t)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&t.chartElement.addListener("clickSlice",function(e){t._onClick(e,t,i)})})},_setWidth:function(e){this.chartEl.externalWidth(e),this.pieEl.externalWidth(e)},_setHeight:function(e){this.chartEl.externalHeight(e),this.pieEl.externalHeight(e)},_createJsChart:function(){var t,i,n,o=this,r=o.options,l=r.width,s=r.height,d=Sweet.constants.chart;t=o.pieId=o.options.id+"-pieEl",i=o.pieEl=e("<div>").attr("id",t).height(s).width(l).appendTo(o.chartEl),n=o.chartElement=new AmCharts.AmPieChart,n.balloonText=r.balloonText;var c=window.screen.width,h=d.fontSize.larger,u=16,p=10;if(r.autoScreenDisplay&&(1280>c?(u=12,h=d.fontSize.normal,p=0,n.minRadius=30,n.labelsEnabled=!1,n.pullOutRadius="10%",n.balloonText="[[percents]]%([[value]])"):1680>=c&&c>=1280?(h=d.fontSize.normal,n.minRadius=30,p=2,u=14):c>1680&&(p=3)),o.fontSize=h,o.pageFontSize=d.fontSize.normal>h-2?d.fontSize.normal:h-2,n.labelText=r.labelText,o._setChartProperty(),n.depth3D=r.depth3D,n.pullOutOnlyOne=r.pullOutOnlyOne,n.angle=r.angle,n.labelRadius=r.labelRadius,n.fontSize=o.pageFontSize,n.fontFamily=d.fontFamily,n.hideLabelsPercent=r.hideLabelsPercent,n.marginBottom=0,n.marginTop=0,n.numberFormatter={precision:-1,decimalSeparator:".",thousandsSeparator:","},n.percentFormatter={precision:r.precision,decimalSeparator:".",thousandsSeparator:","},n.balloon.adjustBorderColor=!0,n.balloon.fillColor="#ffffff",n.balloon.cornerRadius=0,n.balloon.pointerWidth=5,n.balloon.isPieBalloon=!0,n.color=n.balloon.color=n.balloon.textShadowColor=d.textColor,r.fillGraph&&(n.textureMap=e.objCopy(a.textureMap)),r.isLegend){var f=new AmCharts.AmLegend;f.switchType="V",f.switchable=o.options.switchable,f.textClickEnabled=o.options.switchable?!1:!0,f.fontSize=o.pageFontSize,f.color=d.textColor,f.position=r.position,f.maxLegendTextZH=r.maxLegendTextZH,f.maxLegendTextEN=r.maxLegendTextEN,f.graphType="pie",f.valueText="",f.verticalGap=p,f.marginRight=0,f.marginLeft=0,f.markerSize=u,n.addLegend(f)}},_addTitle:function(){var t=this,i=Sweet.constants.chart,a=t.options;e.isNull(a.title)||t.title===a.title||(t.chartElement.titles=[],t.chartElement.addTitle(a.title,t.fontSize,i.titleCfg.labelColor,i.titleCfg.labelAlpha,i.fontFamily),t.title=a.title)},_setChangeProperty:function(){var e=this;e._setChartProperty(),e.chartElement.validateData(),e._doLayout()},_updateData:function(){var e=this;e._setChartProperty(),e.chartElement.dataProvider=e.options.data,e.chartElement.validateData()},_setChartProperty:function(){var i,a,o,r=this,l=r.options,s=0,d=[],c=Sweet.core.i18n.chart.noDataTips;if(l.data=l.data||[],s=l.data.length,r.chartElement.titleField=l.dataKeys[0],i=e.isArray(l.dataKeys[1])?l.dataKeys[1][0]:l.dataKeys[1],r.chartElement.valueField=i,l.descriptionField&&(r.chartElement.descriptionField=l.descriptionField),l.isSortForData&&l.data.sort(e.objSort(i,Sweet.constants.sortType.DESC)),11>=s)if(l.dashboard){if(1==s)d=t[s-1];else for(var h=0;s>h;h++)d.push(r._getColor(s,h,!0));r.chartElement.colors=d}else r.chartElement.colors=0>=s?d:t[s-1];!l.data||0>=l.data.length?(r.chartElement.balloonText=c,r.chartElement.labelText=c,a={},a[r.chartElement.titleField]=c,a.color=n,o=[a]):(r.chartElement.balloonText=l.balloonText,r.chartElement.labelText=l.labelText,o=l.data),r.chartElement.dataProvider=o,r._addTitle()},_chartRender:function(){var e=this;e.rendered||e.chartElement.write(e.pieId)},_doLayout:function(){var e=this;e.rendered&&Sweet.Task.Delay.start({id:"sweet.widget.chart.pie.layout-"+this.options.id,run:function(){e._reDraw()},delay:100})},_reDraw:function(){var e=this;e.chartElement.invalidateSize()},_destroyWidget:function(){Sweet.Task.Delay.stop("sweet.widget.chart.pie.layout-"+this.options.id),this._super()}}),Sweet.chart.Pie=e.sweet.widgetChartPie}(jQuery),function(e,t){var i="sweet-chart-indicator-color-common",a="sweet-chart-indicator-red-left",n="sweet-chart-indicator-red-all",o="sweet-chart-indicator-yellow-all",r="sweet-chart-indicator-yellow-left",l="sweet-chart-indicator-yellow-middle",s="sweet-chart-indicator-yellow-right",d="sweet-chart-indicator-green-all",c="sweet-chart-indicator-green-right",h="sweet-chart-indicator-gray-all";e.widget("sweet.widgetChartIndicator",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-indicator]:",eventNames:{click:"指示灯单击事件"},options:{height:21,data:{}},setData:function(e){var t=this;t.options.data=e,t._doLayout()},_removeListener:function(){var t=this;t.handlers=t.handlers||{},e.each(t.handlers,function(e){t.indicatorDiv1El.unbind(e)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&t.indicatorDiv1El&&t.indicatorDiv1El.bind(e,{me:t,func:i},t._onClick)})},_createJsChart:function(){var t=this,i=t.options;i.data,t.indicatorDiv1El=e("<div>").appendTo(t.chartEl),t.indicatorLeftEl=e("<div>").appendTo(t.indicatorDiv1El),t.indicatorMiddelEl=e("<div>").appendTo(t.indicatorDiv1El),t.indicatorRightEl=e("<div>").appendTo(t.indicatorDiv1El),t.indicatorLeftEl.data({type:"major"}),t.indicatorMiddelEl.data({type:"minor"}),t.indicatorRightEl.data({type:"normal"}),t.addListener(),t._creatDiffIndicator()},_creatDiffIndicator:function(){var e=this,i=e.options,a=i.data;if(a.major===t||0>a.major||a.minor===t||0>a.minor||a.normal===t||0>a.normal){if(!a.options||a.options.gray===t)return;e._creatGrayIndicator()}else e._madeColorElCss()},__caculateWidth:function(e,t){return 0===e?0:100*(e/t)},_madeColorElCss:function(){var e=this,t=e.options.data,h=e._getColorSegmentWidth(),u=h.majorSize,p=h.normalSize,f=h.minorSize;0!==t.major?0!==t.minor?0!==t.normal?(e.indicatorLeftEl.html(t.major).removeClass().addClass(i+" "+a).width(u),e.indicatorMiddelEl.html(t.minor).removeClass().addClass(i+" "+l).width(f),e.indicatorRightEl.html(t.normal).removeClass().addClass(i+" "+c).width(p)):(e.indicatorLeftEl.html(t.major).removeClass().addClass(i+" "+a).width(u),e.indicatorRightEl.html(t.minor).removeClass().addClass(i+" "+s).width(f)):0!==t.normal?(e.indicatorLeftEl.html(t.major).removeClass().addClass(i+" "+a).width(u),e.indicatorRightEl.html(t.normal).removeClass().addClass(i+" "+c).width(p)):e.indicatorLeftEl.html(t.major).removeClass().addClass(i+" "+n).width(u):0!==t.minor?0!==t.normal?(e.indicatorLeftEl.html(t.minor).removeClass().addClass(i+" "+r).width(f),e.indicatorRightEl.html(t.normal).removeClass().addClass(i+" "+c).width(p)):e.indicatorLeftEl.html(t.minor).removeClass().addClass(i+" "+o).width(f):e.indicatorLeftEl.html(t.normal).removeClass().addClass(i+" "+d).width(e.chartEl.width()),t&&t.unClick&&(("true"===t.unClick.major||!0===t.unClick.major)&&e.indicatorLeftEl&&e.indicatorLeftEl.css({cursor:"default"}),("true"===t.unClick.minor||!0===t.unClick.minor)&&e.indicatorMiddelEl&&e.indicatorMiddelEl.css({cursor:"default"}),("true"===t.unClick.normal||!0===t.unClick.normal)&&e.indicatorRightEl&&e.indicatorRightEl.css({cursor:"default"}))},_getColorSegmentWidth:function(){var e=this,t=e.options.data,i=e.chartEl.width();t.major=parseInt(t.major,10),t.minor=parseInt(t.minor,10),t.normal=parseInt(t.normal,10);var a=t.major+t.minor+t.normal,n=e.__caculateWidth(t.major,a),o=e.__caculateWidth(t.minor,a),r=e.__caculateWidth(t.normal,a),l=25>n&&n>0,s=25>o&&o>0,d=25>r&&r>0,c=0;if(c=l?c+1:c,c=s?c+1:c,c=d?c+1:c,1===c){var h=0,u=0;l&&(n=Math.round(.25*i),h=t.minor+t.normal,u=i-n,o=Math.round(e.__caculateWidth(t.minor,h)/100*u),r=u-o),s&&(o=Math.round(.25*i),h=t.major+t.normal,u=i-o,n=Math.round(e.__caculateWidth(t.major,h)/100*u),r=u-n),d&&(r=Math.round(.25*i),h=t.minor+t.major,u=i-r,o=Math.round(e.__caculateWidth(t.minor,h)/100*u),n=u-o)}else 2===c?(n=Math.round(.25*i),o=Math.round(.25*i),r=Math.round(.25*i),d||(r=Math.round(.5*i)),s||(o=Math.round(.5*i)),l||(n=Math.round(.5*i))):(n=Math.round(n/100*i),o=Math.round(o/100*i),r=Math.round(r/100*i));var p={majorSize:n,minorSize:o,normalSize:r};return e._correctWidthValue(p,i)},_creatGrayIndicator:function(){var e=this,t=e.options,a=t.data;e.indicatorLeftEl.html(a.options.gray).removeClass().addClass(i+" "+h).width(e.chartEl.width()),a&&a.unClick&&("true"===a.unClick.major||!0===a.unClick.major)&&e.indicatorLeftEl&&e.indicatorLeftEl.css({cursor:"default"})},_doLayout:function(){if(this.rendered){var e=this;e.indicatorLeftEl.width(0).text("").removeClass(),e.indicatorMiddelEl.width(0).text("").removeClass(),e.indicatorRightEl.width(0).html("").removeClass(),e._creatDiffIndicator()}},_setValue:function(){this._error("Nothing to do!")},_getValue:function(){this._error("Nothing to do!")},_afterCreateSweetWidget:function(){var e=this;e.indicatorDiv1El&&e.indicatorDiv1El.bind("click",{me:e},e._onClick)},_onClick:function(i){var a=i.data.me,n=e(i.target),o=n.data("type"),r=a.options.data,l={currentVal:n.html(),currentType:o,value:r},s=i.data.func;return r&&r.unClick&&("true"===r.unClick[o]||!0===r.unClick[o])?!1:(s?s.call(this,e.objClone(l)):a._trigger("click",i,e.objClone(l)),t)},_destroyWidget:function(){var e=this;e.indicatorLeftEl&&e.indicatorLeftEl.remove(),e.indicatorMiddelEl&&e.indicatorMiddelEl.remove(),e.indicatorRightEl&&e.indicatorRightEl.remove(),e.indicatorDiv1El&&(e.indicatorDiv1El.unbind(),e.indicatorDiv1El.remove()),e._super()},_correctWidthValue:function(e,t){var i=e,a=e.majorSize+e.minorSize+e.normalSize,n=a-t,o={name:"majorSize",value:e.majorSize};if(0===a)return i;for(var r in e)e[r]>o.value&&(o={name:r,value:e[r]});return i[o.name]=i[o.name]-n,i}}),Sweet.chart.Indicator=e.sweet.widgetChartIndicator}(jQuery),function(e,t){var i=Sweet.libPath+"themes/default/core/images/chart/",a={graph:{bullet:"round",type:"line",lineThickness:2},balloon:{adjustBorderColor:!0,fillColor:"#ffffff",pointerWidth:5,cornerRadius:0},cursor:{cursorPosition:"mouse",corsorColor:"#777d8b",categoryBalloonColor:["#717581","#454e5f"]},legend:{position:"bottom",align:"center",markerType:"square"},guide:{lineColor:["#f5c245","#DA6263"],lineAlpha:1,fillAlpha:.2,dashLength:2,inside:!0,labelRotation:90},axisColor:"#777d8b",stackType:["regular","100%","3d","none"],textureMap:{"#369CD8":i+"texture_369CD8.png","#60B2DF":i+"texture_60B2DF.png","#63CCD3":i+"texture_63CCD3.png","#B7E042":i+"texture_B7E042.png","#90CC19":i+"texture_90CC19.png","#F2A14E":i+"texture_F2A14E.png","#CF7A37":i+"texture_CF7A37.png","#CF4737":i+"texture_CF4737.png","#D07DD0":i+"texture_D07DD0.png","#9A53E4":i+"texture_9A53E4.png","#A5A5A5":i+"texture_A5A5A5.png","#777D8B":i+"texture_777D8B.png","#F77007":i+"texture_F77007.png"},bar:{maxLeftMargin:150}};
[{text:Sweet.core.i18n.chart.noDataTips}];var n="sweet-chart-dashline",o="sweet-chart-dashline-range-tip",r="tip-arrow",l="tip-label";e.widget("sweet.widgetChartDashLine",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget_chart_dashLine]:",eventNames:{click:"图的单击事件"},maxPacket:10,toolHeight:25,options:{isCursor:!0,isScrollbar:!0,isLegend:!0,labelRotation:0,dataKeys:["text"],graphType:Sweet.constants.graphType.LINE,stackType:t,style:1,legendTips:!0,parseDate:!1,xDateFormat:"hh",categoryBalloonDateFormat:"YYYY MMM DD JJ:NN",dashboard:!1,leftUnit:"",rightUnit:"",chartMargin:{top:15,right:5,bottom:28,left:35},showTools:!1,oneBalloonOnly:!1,pointDensityThreshold:23},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&t.chartElement.addListener("clickGraphItem",function(e){t._onClick(e,t,i)})})},_removeListener:function(t){var i=this;i.handlers=i.handlers||{},t&&""!==t?e.each(i.handlers,function(e,a){t===e&&i.chartElement.removeListener(i.chartElement,e,a)}):e.each(i.handlers,function(e,t){i.chartElement.removeListener(i.chartElement,e,t)})},_bindEvent:function(){var e=this;e.chartElement.addListener("clickGraphItem",function(t){e._onClick(t,e)}),e.chartElement.addListener("rollOverGraphItem",function(t){e._onOverItem(t,e)}),e.chartElement.addListener("rollOutGraphItem",function(t){e._onOutItem(t,e)}),e.chartElement.addListener("zoomed",function(t){e.options.showTools||e._onZoom(t)}),e.chartEl.bind("scrollBar",function(t,i){e._onScrollBar(t,i)})},_onOverItem:function(e){var t,i,a=e.item,n=e.chart,o=n.balloon.bulletFillColor;if(a.columnSprite&&a.columnSprite.children&&o&&(t=a.columnSprite.children.length,t>0))for(var r=0;t>r;r++)i=a.columnSprite.children[r].getAttr("fill"),i=this._adjustLuminosity(i,-.2),a.columnSprite.children[r].setAttr("fill",i),a.columnSprite.children[r].setAttr("stroke",i)},_onOutItem:function(e){var t,i=e.item,a=e.chart,n=e.graph;if(i.columnSprite&&i.columnSprite.children&&a.balloon.bulletFillColor&&(t=i.columnSprite.children.length,t>0))for(var o=0;t>o;o++)i.columnSprite.children[o].setAttr("fill",n.fillColors),i.columnSprite.children[o].setAttr("stroke",n.fillColors)},_onClick:function(t,i,a){var n={};n.item=e.objClone(t.item.dataContext);try{if(!0===i.options.parseDate||"true"===i.options.parseDate){var o,r=i.options.dataKeys[0],l="yyyy-MM-dd hh:mm:ss";n.item&&n.item[r]&&(o=n.item[r],Date==o.constructor&&(n.item[r]=e.date.format(o,l)))}}catch(s){}n.legendValue=t.item.graph.title,n.data=t.item.values.value,n.valueField=t.graph.valueField,e.isFunction(a)?a(t,n):i._trigger("click",t,n)},_onZoom:function(t){var i,a,n,o,r,l=this,s="$"+l.options.dataKeys[0]+"$";l.rangeTipEl&&(i=l.options.data[t.startIndex][s],a=l.options.data[t.endIndex][s],i&&a||(i=t.startValue,a=t.endValue),l.options.parseDate&&(o=i,r=a,"date"===e.type(o)&&"date"===e.type(r)&&(n=0!==o.getSeconds()||0!==r.getSeconds()?"hh:mm:ss":0!==o.getMinutes()||0!==r.getMinutes()?"hh:mm":0!==o.getHours()||0!==r.getHours()?"MM-dd hh:mm":"yyyy-MM-dd",i=e.date.format(o,n),a=e.date.format(r,n))),this._setRangeTipValue({start:i,end:a}),this._showRangeTip("zoomed"))},_onScrollBar:function(e,t){this.rangeTipEl&&("changed"===t.type&&this.rangeTipEl.data("data",{left:t.left,width:t.width}),this._showRangeTip(t.type))},_setRangeTipValue:function(e){var t=this;e.start&&t.startEl.find("."+l).text(e.start),e.end&&t.endEl.find("."+l).text(e.end)},_showRangeTip:function(i){var a,n,o,r,s,d,c=this,h="sweet.widget.chart.dashline.tip-"+c.options.id,u=this.options.chartMargin,p=this.rangeTipEl.data("data");return e.isNull(c.startEl.find("."+l).text())||e.isNull(c.endEl.find("."+l).text())?(c.rangeTipEl.stop(!1,!0),t):("hover"===i?this._scrollbarHovered=!0:"out"===i&&(this._scrollbarHovered=!1),c.rangeTipEl.stop(!1,!0).show(),o=this.lineEl.offset(),n=o.left+u.left+p.left,a=o.top+u.top-3,this.startEl.css({left:n,top:a}),n=o.left+u.left+p.left+p.width,a=o.top+u.top-3,this.endEl.css({left:n,top:a}),s=this.startEl.find("."+l),d=this.endEl.find("."+l),r=s.outerWidth()+d.outerWidth(),o=r/2>p.width-5?(r/2-p.width+5)/2:0,s.css({left:0-s.outerWidth()/2-o}),d.css({left:0-d.outerWidth()/2+o}),this._scrollbarHovered?Sweet.Task.Delay.stop(h):Sweet.Task.Delay.start({id:h,run:function(){c.rangeTipEl.fadeOut(200)},delay:1e3}),t)},_createRangeTip:function(){var t=this;t.rangeTipEl||(t.startEl=e("<div>").addClass(o).appendTo(document.body),t.endEl=e("<div>").addClass(o).appendTo(document.body),this.rangeTipEl=t.startEl.add(t.endEl),this.rangeTipEl.each(function(t,i){e("<div>").addClass(l).appendTo(e(i)),e("<div>").addClass(r).appendTo(e(i))}),this.rangeTipEl.hide())},_removeRangeTip:function(){var e=this;e.rangeTipEl&&(e.rangeTipEl.remove(),e.rangeTipEl=null)},_adjustLuminosity:function(e,t){e=(e+"").replace(/[^0-9a-f]/gi,""),6>e.length&&(e=e[0]+""+(e[0]+"")+(e[1]+"")+(e[1]+"")+(e[2]+"")+(e[2]+"")),t=t||0;var i,a,n="#";for(a=0;3>a;a++)i=parseInt(e.substr(2*a,2),16),i=Math.round(Math.min(Math.max(0,i+i*t),255)).toString(16),n+=("00"+i).substr(i.length);return n},_closeFloatPanel:function(){this.viewEl&&(this.viewEl.hide(),this.viewImgEl.removeClass("sweet-chart-tools-view-image-clicked").addClass("sweet-chart-tools-view-image")),this.zoomEl&&this.zoomEl.hide()},_onViewClick:function(i){var a=i.data.me,n=a.options;if(a.viewEl){if(a.viewEl.is(":visible"))return a.viewEl.hide(),t}else{var o=60,r=n.id+"-tools-view-panel";a.viewEl=e("<div>").attr("id",r).addClass("sweet-chart-tools-view").css("z-index",1024).bind("click",function(e){e.stopPropagation()}).width(a.chartEl.width()).height(o).hide().appendTo(document.body);var l=new Sweet.form.CheckBox({width:"100%",value:{value:"1",text:Sweet.core.i18n.chart.legend}});l.addListener("click",function(e,t){t?a.hideLegend():a.showLegend()}),a._legendBox=l;var s=new Sweet.form.CheckBox({width:"100%",value:{value:"1",text:Sweet.core.i18n.chart.balloon}});s.addListener("click",function(e,t){t?a.oneBalloonShow():a.allBalloonShow()}),a._balloonBox=s,new Sweet.panel.VPanel({width:a.chartEl.width(),height:o,padding:10,items:[l,s],renderTo:r,margin:[10,0,0,0]})}a.viewEl.width(a.toolsEl.width());var d=a.subLineEl.offset(),c=d.left,h=d.top;a.viewEl.css({left:c,top:h}),a.viewImgEl.removeClass("sweet-chart-tools-view-image").addClass("sweet-chart-tools-view-image-clicked"),a.viewEl.slideDown("slow"),i.stopPropagation()},_onZoomClick:function(i){var a=i.data.me,n=a.options,o=(n.id+"-zoom",n.id+"-zoom-panel");if(a.zoomEl){if(a.zoomEl.is(":visible"))return a.zoomEl.hide(),t}else{var r=160;a.zoomEl=e("<div>").attr("id",o).addClass("sweet-chart-tools-view").bind("click",function(e){e.stopPropagation()}).css("margin-left","100px").width(35).height(r).hide().appendTo(document.body),e("<div>").addClass("sweet-chart-zoom-out").css({"margin-top":"5px","margin-left":"10px"}).bind("click",function(){var t=e("#"+a.sliderId),i=t.slider("value");i+=.2,a.zoomValue=i,t.slider("value",i),a.zoom(i)}).appendTo(a.zoomEl);var l=n.id+"-zoom-iuo";a.sliderId=l,e("<div>").attr("id",l).width(11).height(90).css("margin-left","10px").css("margin-top","30px").appendTo(a.zoomEl),e("#"+l).slider({orientation:"vertical",range:"max",step:.2,min:1,max:3,value:1,slide:function(e,t){a.zoomValue=t.value,a.zoom(t.value)}}),e("<div>").addClass("sweet-chart-zoom-in").css({"margin-top":"8px","margin-left":"9px"}).bind("click",function(){var t=e("#"+a.sliderId),i=t.slider("value");i-=.2,a.zoomValue=i,t.slider("value",i),a.zoom(i)}).appendTo(a.zoomEl)}a.zoomEl.width(35);var s=a.subLineEl.offset(),d=s.left,c=s.top;a.zoomEl.css({left:d,top:c}),a.zoomEl.slideDown("slow"),i.stopPropagation()},zoom:function(e){var t=this;t.chartElement&&(t.yAxis&&(t.yAxis.left&&(t.yAxis.left.minMaxMultiplier=e),t.yAxis.right&&(t.yAxis.right.minMaxMultiplier=e)),t.chartElement.validateNow())},_createJsChart:function(){var t,i=this,a=i.options;i.options.showTools&&(i.toolsEl=e("<div>").attr("id",a.id+"-tools").width(a.width).height(i.toolHeight).addClass("sweet-chart-tools").appendTo(i.chartEl),i.viewTextEl=e("<div>").addClass("sweet-chart-tools-view-text").text(Sweet.core.i18n.chart.view).bind("click",{me:i},i._onViewClick).appendTo(i.toolsEl),i.viewImgEl=e("<a>").addClass("sweet-chart-tools-view-image").bind("click",{me:i},i._onViewClick).appendTo(i.toolsEl),e("<span>").addClass("sweet-chart-tools-divid-line").appendTo(i.toolsEl),i._zoomTextEl=e("<div>").addClass("sweet-chart-tools-zoom-text").text(Sweet.core.i18n.chart.zoom).appendTo(i.toolsEl),i.zoomImgEl=e("<a>").attr("id",a.id+"-zoom").addClass("sweet-chart-tools-zoom-image").bind("click",{me:i},i._onZoomClick).appendTo(i.toolsEl)),i.lineId=a.id+"-lineEl",t=i.lineEl=e("<div>").attr("id",i.lineId).width("100%").height("100%").addClass(n).appendTo(i.chartEl),i.options.showTools&&(i.subLineId=i.lineId+"-sub",i.subLineEl=e("<div>").attr("id",i.subLineId).width("100%").height("100%").appendTo(i.lineEl)),i.chartElement=new AmCharts.AmSerialChart,i._setChartOptions(),i._setCategoryAxis(),i._createValueAxis(),i._createGraphs(),i._createJsCursor(a.oneBalloonOnly),i._createJsScrollbar(),i._createJsLegend(),i._bindEvent(),i.addListener()},_setChartOptions:function(){var e=this,t=this.options,i=this.chartElement,n=t.chartMargin;i.pathToImages=Sweet.amchartsImagePath,i.categoryField=t.dataKeys[0],i.plotAreaBorderColor=a.axisColor,i.plotAreaBorderAlpha=0,i.color=e.textColor,i.balloon.bulletFillColor="#f77007",i.showFirstLabel=!0,i.numberFormatter={precision:-1,decimalSeparator:".",thousandsSeparator:","},i.fontSize=e.fontSizeNormal,i.fontFamily=e.chartFontFamily,i.columnWidth=.6,i.shadow=!1,this.options.dashboard&&(i.autoMargins=!1,i.marginLeft=n.left,i.marginRight=n.right,i.marginTop=n.top,i.marginBottom=n.bottom,i.columnSpacing=2,i.prefixesOfSmallNumbers=[],t.graphType===Sweet.constants.graphType.BAR&&(i.marginRight=50))},_createGuide:function(t,i,n){var o,r,l,s,d,c,h,u=a.guide,p=!1,f=0;if(!e.isNull(t)&&!e.isNull(n))for(r=e.isArray(n)?n:[n],p=e.isPlainObject(r[0]),r.length>1&&(f=i===Sweet.constants.axisType.CATEGORY?1:p?r[0].value<r[1].value?1:-1:r[0]<r[1]?1:-1),h=0;r.length>h;h++)l=r[h],o=new AmCharts.Guide,c=h%u.lineColor.length,p?(s=l.text?l.text+": ":"",d=l.unit||"",l=l.value):s=d="",i===Sweet.constants.axisType.VALUE?(o.value=l,o.toValue=l):i===Sweet.constants.axisType.CATEGORY&&(o.category=l,o.toCategory=l),o.lineColor=u.lineColor[c],o.lineAlpha=u.lineAlpha,o.fillColor=u.lineColor[c],o.fillAlpha=u.fillAlpha,o.dashLength=u.dashLength,o.balloonText=s+l+d,t.addGuide(o)},_setCategoryAxis:function(){var e=this,t=e.options,i=e.chartElement.categoryAxis;t.parseDate&&t.data.length>0?(i.parseDates=!0,i.isParseDate=!0,i.minPeriod=t.xDateFormat,i.equalSpacing=!0,i.dateFormats=[{period:"fff",format:"JJ:NN:SS"},{period:"ss",format:"JJ:NN:SS"},{period:"mm",format:"JJ:NN"},{period:"hh",format:"JJ:NN"},{period:"DD",format:"MM-DD"},{period:"MM",format:"YYYY-MM"},{period:"YYYY",format:"YYYY"}]):(i.parseDates=!1,i.isParseDate=!1,i.minPeriod="DD",i.equalSpacing=!1),0!==Number(t.labelRotation)&&(i.labelRotation=Number(t.labelRotation)),i.axisColor=a.axisColor,i.gridPosition="start",i.startOnAxis=t.graphType===Sweet.constants.graphType.AREA?!1:!1,i.autoGridFrequency=t.graphType===Sweet.constants.graphType.BAR?!0:!1,this.options.dashboard&&(i.axisAlpha=0,i.gridAlpha=0),t.xThresholdValue&&e._createGuide(i,Sweet.constants.axisType.CATEGORY,t.xThresholdValue)},_createValueAxis:function(){var e=this,t=e.options,i={},n=e.chartElement.categoryAxis;e.yAxis&&(e.yAxis.left&&e.chartElement.removeValueAxis(e.yAxis.left),e.yAxis.right&&e.chartElement.removeValueAxis(e.yAxis.right),e.yAxis={},e.chartElement.valueAxes=[]);var o,r,l,s=new AmCharts.ValueAxis;s.axisColor=a.axisColor,s.minMaxMultiplier=e.zoomValue||1,t.graphType===Sweet.constants.graphType.AREA?(o=a.stackType[1],r=a.stackType[0],s.stackType=t.stackType===o?o:r):t.graphType===Sweet.constants.graphType.BAR?n.labelFrequency=1:t.graphType===Sweet.constants.graphType.COLUMN?t.stackType===a.stackType[1]?s.stackType=a.stackType[1]:t.stackType===a.stackType[0]&&(s.stackType=a.stackType[0]):t.graphType===Sweet.constants.graphType.MIX_COLUMN_LINE&&(l=new AmCharts.ValueAxis,l.axisColor=a.axisColor,l.position="right",l.minimum=0,e.chartElement.addValueAxis(l),i.right=l),this.options.dashboard&&(s.dashLength=5,s.usePrefixes=!0,s.offset=-7,s.axisAlpha=0,l&&(l.axisAlpha=0,l.dashLength=5,l.usePrefixes=!0,l.offset=-7,e.chartElement.marginRight=t.chartMargin.left)),t.yThresholdValue&&e._createGuide(s,Sweet.constants.axisType.VALUE,t.yThresholdValue),e.chartElement.addValueAxis(s),i.left=s,e.yAxis=i},_addUnitTitle:function(){var t,i,n,o,r=this,l=r.options,s=r.chartElement.marginLeft+5,d=r.chartElement.marginTop-r.fontSizeNormal-10;r.chartElement.clearLabels(),e.isNull(l.chartTitle)||r.preTitle===l.chartTitle||(r.chartElement.titles=[],r.chartElement.addTitle(l.chartTitle,r.fontSizeLarger,r.labelColor,r.labelAlpha,r.chartFontFamily),r.preTitle=l.chartTitle),r.preTitle&&(d+=55),0>d&&(d=this.chartElement.marginTop),l.dashboard&&(d=0);var c,h=!0,u=!0;for(c=1;l.dataKeys.length>c;c++)e.isNull(l.dataKeys[c][2])||("right"!==l.dataKeys[c][3]&&l.dataKeys[c][2]!==l.leftUnit?h=!1:"right"===l.dataKeys[c][3]&&l.dataKeys[c][2]!==l.rightUnit&&(u=!1));l.stackType===a.stackType[1]?(t="%",r.chartElement.addLabel(s,d,t,"left",r.fontSizeNormal,r.textColor,0,1)):l.leftUnit&&""!==l.leftUnit&&h&&(i=l.leftUnit,r.chartElement.addLabel(s,d,i,"left",r.fontSizeNormal,r.textColor,0,1)),l.rightUnit&&""!==l.rightUnit&&u&&(o=r.chartElement.marginRight,s=r.chartEl.width()-o-5,n=l.rightUnit,r.chartElement.addLabel(s,d,n,"right",r.fontSizeNormal,r.textColor,0,1))},_createGraphs:function(){var e=this,t=e.options,i=t.dataKeys.length-1;e.chartElement.graphs=[],e._addGraphs(i)},_addGraphs:function(i){for(var n,o,r,l,s=this,d=s.options,c="",h="[[value]]",u="[[percents]]%",p="[[title]]: ",f=p+u+" ("+h+")",g=p+h,m={connect:!1,bulletSize:5,fillAlphas:1,lineAlphas:1,lineThickness:1,drillField:"drillable"},v=0;i>v;v++){o=d.dataKeys[v+1][2],r=d.dataKeys[v+1][3]||"left",o===t&&(o=d.leftUnit),n=new AmCharts.AmGraph,n.valueField=d.dataKeys[v+1][0],n.title=d.dataKeys[v+1][1],n.type=a.graph.type;for(l in m)n[l]=m[l];d.balloonText?n.balloonText=d.balloonText:(c=o?g+" "+o:g,n.balloonText=d.stackType===a.stackType[1]?f:c),n.legendValueText=d.stackType===a.stackType[1]?u:h+" "+(d.leftUnit?d.leftUnit:""),i>0&&s.maxPacket-1>=i?n.lineColor=s._getColor(i,v,!0):d.dataKeys[v+1][4]&&(n.lineColor=d.dataKeys[v+1][4]),d.graphType===Sweet.constants.graphType.AREA?(n.fillAlphas=.6,n.bullet=a.graph.bullet,e.isNull(n.lineColor)||(n.bulletBorderColor=n.lineColor)):d.graphType===Sweet.constants.graphType.COLUMN?(n.type=Sweet.constants.graphType.COLUMN,n.labelText=""):d.graphType===Sweet.constants.graphType.BAR?(s.chartElement.rotate=!0,n.type=Sweet.constants.graphType.COLUMN,n.labelText="[[value]]"+o):d.graphType===Sweet.constants.graphType.LINE&&1===d.style?(n.lineThickness=a.graph.lineThickness,n.fillAlphas=0,i>0&&s.maxPacket>i&&(n.bullet=a.graph.bullet,e.isNull(n.lineColor)||(n.bulletBorderColor=n.lineColor))):d.graphType===Sweet.constants.graphType.MIX_COLUMN_LINE&&(n.lineThickness=1,"left"===r?(n.type=Sweet.constants.graphType.COLUMN,n.valueAxis=s.yAxis.left):(n.fillAlphas=0,n.bullet=a.graph.bullet,e.isNull(n.lineColor)||(n.bulletBorderColor=n.lineColor),n.legendValueText=h+" "+(d.rightUnit?d.rightUnit:""),n.valueAxis=s.yAxis.right,n.balloonText=h+o)),s.chartElement.addGraph(n)}},_setChangeProperty:function(){var t=this,i=t.options;(e.isNull(i.dataKeys)||!e.isNull(i.dataKeys)&&0===i.dataKeys.length)&&(i.dataKeys=["text"]),t.chartElement.categoryField=t.options.dataKeys[0],(e.isNull(i.data)||!e.isNull(i.data)&&0===i.data.length)&&t._setNoData(),t.chartElement.dataProvider=t.options.data,t._setCategoryAxis(),t._createValueAxis(),t._addUnitTitle(),t._createGraphs(),t._createJsCursor(i.oneBalloonOnly),t._updateData()},_updateData:function(){var e=this;e.chartElement.dataProvider=e.options.data,e.rendered&&e._doLayout()},_createJsCursor:function(t){var i,n=this;n.options.isCursor&&(n.chartElement.removeChartCursor(),i=new AmCharts.ChartCursor,i.bulletsEnabled=!0,n._balloonBox&&e.isFunction(n._balloonBox.isChecked)&&(t=n._balloonBox.isChecked()?!0:!1),i.oneBalloonOnly=t,n.options.parseDate&&(i.categoryBalloonDateFormat=n.options.categoryBalloonDateFormat),i.cursorPosition=a.cursor.cursorPosition,i.cursorColor=a.cursor.corsorColor,i.dashLength=8,i.categoryBalloonColor=a.cursor.categoryBalloonColor,n.chartElement.addChartCursor(i))},_createJsScrollbar:function(e){var t=this;if(t.options.isScrollbar||e===!0){var i=new AmCharts.ChartScrollbar;i.backgroundColor="#e2ebf4",i.scrollbarHeight=7,t.chartElement.addChartScrollbar(i),this.rangeTipEl||this._createRangeTip()}},_removeJsScrollBar:function(){this.chartElement&&(this.chartElement.removeChartScrollbar(),this.rangeTipEl&&this._removeRangeTip())},oneBalloonShow:function(){var e=this;e.chartElement&&(e.chartElement.removeChartCursor(),e._createJsCursor(!0),e.chartElement.validateNow())},allBalloonShow:function(){var e=this,e=this;e.chartElement&&(e.chartElement.removeChartCursor(),e._createJsCursor(!1),e.chartElement.validateNow())},hideLegend:function(){var t=this;if(t.subLineEl){var i=e(t.subLineEl).children("div");i.length>1&&(e(i[1]).hide(),t.chartElement.invalidateSize())}},showLegend:function(){var t=this;if(t.subLineEl){var i=e(t.subLineEl).children("div");i.length>1&&(e(i[1]).show(),t.chartElement.invalidateSize())}},_createJsLegend:function(){var e=this;if(e.options.isLegend){var t=new AmCharts.AmLegend;t.position=a.legend.position,e.legend=t,t.align=a.legend.align,t.valueAlign="left",t.markerType=a.legend.markerType,t.color=e.textColor,t.valueWidth=110,t.switchType="v",e.options.showTools&&(t.isScroll=!0,t.autoMargins=!1,t.marginLeft=0,t.marginRight=0),e.options.legendTips||(t.valueText="",t.valueWidth=0),!e.options.showTools&&this.options.dashboard&&(t.position="absolute",t.top=0,t.left=0,t.align="right",t.autoMargins=!1,t.marginLeft=10,t.marginTop=0,t.marginRight=10,t.backgroundAlpha=.2,t.maxColumns=1,t.markerSize=15,t.markerLabelGap=2,t.verticalGap=0,t.valueText="",t.valueWidth=0,t.switchable=!0),e.chartElement.addLegend(t)}},setChartType:function(e,t){var i=this,a=i.options;(e!==a.graphType||t!==a.stackType)&&(a.graphType=e,a.stackType=t,i.chartElement.rotate=!1,i._setChangeProperty())},_setNoData:function(){var t,i=this;e.isNull(i.chartElement.categoryField)&&(i.chartElement.categoryField="text"),i.options.parseDate?i.options.data=[]:(t={},t[i.chartElement.categoryField]=Sweet.core.i18n.chart.noDataTips,i.options.data=[t])},_setDefaultData:function(){var e=this;e._setNoData(),e._updateData()},_chartRender:function(){var e=this,t={},i=e.options.data;if(!e.rendered&&e.chartElement){e.options.showTools&&e.lineEl.css("height","calc(100% - "+e.toolHeight+"px)"),0===i.length&&(t[e.options.dataKeys[0]]=Sweet.core.i18n.chart.noDataTips,e.options.data=[t]),e.chartElement.dataProvider=i;var a=e.options.showTools?e.subLineId:e.lineId;e.chartElement.write(a),e._doLayout()}},_doLayout:function(){var e=this;e.options.renderTo&&""!==e.options.renderTo&&e.chartElement&&Sweet.Task.Delay.start({id:"sweet.widget.chart.dashline.layout-"+this.options.id,run:function(){var t=e.options.data.length,i=e.chartEl.width();t>0&&i>0&&e.options.graphType!==Sweet.constants.graphType.BAR&&(e.options.pointDensityThreshold>i/t?e._createJsScrollbar(!0):e._removeJsScrollBar()),e._reDraw()},delay:100})},_reDraw:function(){var t=this;if(t._layoutLabels(),t._addUnitTitle(),!t.options.showTools&&t.options.isLegend&&(t.chartElement.marginTop=t.options.dataKeys.length>2?t.options.chartMargin.top+20:t.options.chartMargin.top),t.options.showTools&&t.legend.updateMaxHeight(t.subLineEl.height()/3),t.chartElement.validateData(),t.chartElement.validateNow(),t.options.showTools&&t.subLineEl){var i=e(t.subLineEl).children("div");if(i.length>1){var a=e(i[1]);a.css({"overflow-y":"auto","overflow-x":"hidden"})}}},_createFlashChart:function(){e.error("chart.DashLine doesn't support current browser!")},_layoutLabels:function(){var e,t,i,a,n,o,r=this;if(r.options.graphType===Sweet.constants.graphType.BAR)for(r._interInfo=r._calcLabelInter(),r.chartElement.marginLeft=r._interInfo.maxWidth+10,n=r._interInfo.dataLen>0?r._interInfo.dataLen:1,e=r._interInfo.plotSize*r.chartElement.columnWidth/n,r.options.dataKeys.length>2&&(e/=r.options.dataKeys.length-1),t=13>e?null:"[[value]]",o=0;r.chartElement.graphs.length>o;o++)a=r.chartElement.graphs[o],i=r.options.dataKeys[o+1][2],a.labelText=t?t+i:""},_calcLabelInter:function(){"use strict";function t(){var t=0,i=0,a=0;n.children().each(function(n,o){0===n%l&&(t++,i=e(o).outerWidth(!0),a=e(o).outerHeight(!0),d+=m?a:i,i>s&&(s=i))}),c=h/t}var i,n,o,r,l=1,s=0,d=0,c=0,h=this.chartEl.width(),u=this.options.data,p=u.length,f=this.options.dataKeys[0],g=10,m=this.options.graphType===Sweet.constants.graphType.BAR,v=this.options.chartMargin;if(m&&(h=this.chartEl.height()-v.top-v.bottom),0===p||10>=h)return{maxWidth:s,inter:l,plotSize:h,dataLen:p};if(this._interInfo&&this._interInfo.plotSize&&this._interInfo.plotSize===h&&this._interInfo.dataLen===p)return this._interInfo;for(n=e("<div>").appendTo("body"),n.css({position:"absolute",top:"-200px",width:"2000px",height:"200px",display:"block","font-size":this.fontSizeNormal,"font-family":this.chartFontFamily}),i=0;p>i;i++)o=e("<span>"),o.css({display:"block","float":"left","padding-left":0===i?"0":g+"px"}),r=this.options.parseDate?this.options.categoryBalloonDateFormat:u[i][f],o.text(r).appendTo(n);for(t();m&&d+(Math.floor(p/l)-1)*g>h&&p>l||!m&&(s>c+2*g||d>h)&&p>l;)s=c=d=0,l+=1,t();return n.remove(),m&&(s+=10,s>a.bar.maxLeftMargin&&(s=a.bar.maxLeftMargin)),{maxWidth:s,inter:l,plotSize:h,dataLen:p}},_destroyWidget:function(){this._removeRangeTip(),Sweet.Task.Delay.stop("sweet.widget.chart.dashline.tip-"+this.options.id),Sweet.Task.Delay.stop("sweet.widget.chart.dashline.layout-"+this.options.id),this._removeJsScrollBar(),this._removeListener(null),this.chartElement.clearLabels(),this.chartElement.removeLegend(),this.chartElement&&this.chartElement.clear(),this._super()}}),Sweet.chart.DashLine=e.sweet.widgetChartDashLine}(jQuery),function(e){var t="http://www.w3.org/2000/svg",i=20,a=["#a1a8b8","#747f97"],n=["#7cadeb","#3f87e1"],o=1,r="topo-blank-node-";e.widget("sweet.widgetChartSimpleTopology",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-simple-topology]:",eventNames:{nodeclick:"nodeclick",nodedblclick:"nodedblclick",lineclick:"lineclick",linedblclick:"linedblclick"},options:{nodeWidth:150,nodeHeight:50,levelSpace:150,nodeSpace:50,lineColor:"#cccccc",selectable:!0},_createSVGElement:function(e){return document.createElementNS(t,e)},_createJsChart:function(){var t=this,i=t.options;t.topoId=i.id+"-topo",t.topoEl=e("<div>").attr({id:t.topoId}).height(i.height).width(i.width).css("overflow","auto"),t.eventMap={},t._readySVG(),i.data.length>0&&t._draw()},_readySVG:function(){var e=this;e.preClickRectId="",e.rects={},e.nodes={},e.maxLevelNodes=0,e.maxHeight=0,e.maxWidth=0,e.vpath=e._createSVGElement("g"),e.S={},e.S.svg=e._createSVGElement("svg"),e.S.group=e._createSVGElement("g"),e.S.group.appendChild(e.vpath),e.S.defs=e._createSVGElement("defs"),e.marker=e._createMarker(),e.S.defs.appendChild(e.marker),e.linearGradientId=e.options.id+"-linearGradient",e.linearGradient=e._createLinearGradient(a,e.linearGradientId),e.S.defs.appendChild(e.linearGradient),e.options.selectable&&(e.selectedlinearGradId=e.options.id+"-linearGradient-selected",e.selectedlinearGrad=e._createLinearGradient(n,e.selectedlinearGradId),e.S.defs.appendChild(e.selectedlinearGrad)),e.S.svg.appendChild(e.S.defs),e.S.svg.appendChild(e.S.group),e.topoEl.append(e.S.svg)},setData:function(t){if(!e.isNull(t)&&e.isArray(t)){var i=this,a=i.options;a.data=JSON.parse(JSON.stringify(t)),i.topoEl.empty(),i._readySVG(),i._draw()}},setSelected:function(t){var i=this;e.isNull(t)||e.isNull(i.rects[t])||!i.options.selectable||(i.rects[t].setAttribute("fill","url(#"+i.selectedlinearGradId+")"),e.isNull(i.preClickRectId)||i.rects[i.preClickRectId].setAttribute("fill","url(#"+i.linearGradientId+")"),i.preClickRectId=t)},getSelectedNode:function(){if(e.isNull(t.preClickRectId))return-1;var t=this;return t._findById(t.preClickRectId)},_chartRender:function(){var t=this;t.rendered||e.isNull(t.topoEl)||t.topoEl.appendTo(t.chartEl)},_createMarker:function(){var e,t,i=this,a=i.topoId+"-marker";return i.markerId=a,e=i._createSVGElement("marker"),e.setAttribute("id",a),e.setAttribute("viewBox","0 0 10 10"),e.setAttribute("refX",0),e.setAttribute("refY",5),e.setAttribute("markerUnits","strokeWidth"),e.setAttribute("markerWidth",4),e.setAttribute("markerHeight",3),e.setAttribute("fill",i.options.lineColor),e.setAttribute("orient","auto"),t=i._createSVGElement("path"),t.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),e.appendChild(t),e},textSize:function(t,i){var a,n=this,o={},r=n._createSVGElement("text"),l=document.createTextNode(i),s=n._createSVGElement("tspan");return s.appendChild(l),r.appendChild(s),r.setAttribute("text-anchor","middle"),r.setAttribute("x",t.x),r.setAttribute("y",t.y),r.setAttribute("font-size",t.fontSize),r.setAttribute("font-family",t.fontFamily),n.S.svg.appendChild(r),a=r.getBBox(),o=e.isNull(a)?{width:0,height:0}:{width:a.width,height:a.height},n.S.svg.removeChild(r),o},_createText:function(t,i,a,n){var o,r,l=this,s=(t+"").replace(/\n/g,"<br>").split("<br>"),d=e.isNull(i)?{}:i,c=0,h=l._createSVGElement("text"),u=d.fontSize?d.fontSize:14,p=d.fontFamily?d.fontFamily:"Tahoma",f=d.fillColor?d.fillColor:"#666666",g=d.x?d.x:0,m=d.y?d.y:0,v=l.textSize({x:g,y:m,fontSize:u,fontFamily:p},t);if(v.width>a&&1===s.length){var w=(t+"").length,_=Math.floor(w*a/v.width)-2,C=Math.ceil(w/_),b=[];for(c=0;C>c;c++)b.push((t+"").substr(c*_,_));s=b}var E=s.length,y=0,x=m;for(E>1&&!n&&(x=m-l.options.nodeHeight/2+u+5),c=E-1;c>=0;c--)o=document.createTextNode(s[E-1-c]),r=l._createSVGElement("tspan"),r.appendChild(o),r.setAttribute("x",g),y="down"===n?m+u*(E-1-c):"up"===n?m-u*c:x+u*(E-1-c),r.setAttribute("y",y),r.setAttribute("fill",f),h.appendChild(r);return h.setAttribute("text-anchor","middle"),h.setAttribute("x",g),h.setAttribute("y",m),h.setAttribute("font-size",u),h.setAttribute("font-family",p),h.setAttribute("title",t),e.isNull(d.fontWeight)||h.setAttribute("font-weight",d.fontWeight),h},_createLinearGradient:function(e,t){var i,a,n=this;a=n._createSVGElement("linearGradient"),a.setAttribute("id",t),a.setAttribute("x2","0%"),a.setAttribute("y2","100%");for(var o=0;e.length>o;o++)i=n._createSVGElement("stop"),i.setAttribute("offset",(o+1)/e.length),i.setAttribute("stop-color",e[o]),a.appendChild(i);return a},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"nodeclick"===e&&(t.eventMap.nodeClick=i)})},_removeListener:function(t){var i=this;e.isNull(t)?(i.handlers=i.handlers||{},e.each(i.handlers,function(){i.eventMap={}})):"nodeclick"!==t||e.isNull(i.eventMap.nodeClick)||delete i.eventMap.nodeClick},_doNodeText:function(t,i,a){var n,o,r,l,s,d=this,c=14,h=48,u=42,p=35,f=t.lpoint.x,g=(t.rpoint.x,t.lpoint.y),m=d.options.levelSpace,v=d.options.nodeWidth,w=(d.options.nodeHeight,f+m/2);if(e.isNull(t.text)){a.removeChild(i);var _=d._createPath(w,g,w+v,g,!1);a.appendChild(_)}else n=d._createText(t.text,{x:w+v/2,y:g,fontWeight:"bold",fillColor:"#ffffff"},v),i.appendChild(n);if(!e.isNull(t.textInUp)){p=h;var C=t.lLength?parseInt(t.lLength):m/2;o=d._createText(t.textInUp,{x:w-p,y:g-c/2},C,"up"),a.appendChild(o)}if(!e.isNull(t.textInDown)){p=h;var C=t.lLength?parseInt(t.lLength):m/2;r=d._createText(t.textInDown,{x:w-p,y:g+c},C,"down"),a.appendChild(r)}if(!e.isNull(t.textOutUp)){var C=t.rLength?parseInt(t.rLength):m/2;p=u>C?C/2:u,l=d._createText(t.textOutUp,{x:w+v+p,y:g-c/2},C,"up"),a.appendChild(l)}if(!e.isNull(t.textOutDown)){var C=t.rLength?parseInt(t.rLength):m/2;p=u>C?C/2:u,s=d._createText(t.textOutDown,{x:w+v+p,y:g+c},C,"down"),a.appendChild(s)}},_createNode:function(t){var i,a,n,o=this,r=o.options.levelSpace,l=o.options.nodeWidth,s=o.options.nodeHeight,d=t.lpoint.x+r/2,c=t.lpoint.y-s/2;i=o._createSVGElement("g"),a=o._createSVGElement("g"),n=o._createSVGElement("rect"),n.setAttribute("x",d),n.setAttribute("y",c),n.setAttribute("width",l),n.setAttribute("height",s),n.setAttribute("rx",10),n.setAttribute("fill","url(#"+o.linearGradientId+")"),a.appendChild(n),i.appendChild(a),t.clickable&&"true"===t.clickable&&(o.options.selectable&&a.setAttribute("cursor","pointer"),a.addEventListener("click",function(i){if(o.options.selectable&&(e.isNull(o.preClickRectId)||t.id===o.preClickRectId?n.setAttribute("fill","url(#"+o.selectedlinearGradId+")"):(o.rects[o.preClickRectId].setAttribute("fill","url(#"+o.linearGradientId+")"),n.setAttribute("fill","url(#"+o.selectedlinearGradId+")"))),o.preClickRectId=t.id,!e.isNull(o.eventMap.nodeClick)){var a=JSON.parse(JSON.stringify(t));o.eventMap.nodeClick(i,a)}},!0)),o._doNodeText(t,a,i);var h,u,p={},f={},g=!1;if(!e.isNull(t.from)&&t.from.length>0||e.isNotNull(t.textInUp)||e.isNotNull(t.textInDown)){var m=r/2;p.x=t.lpoint.x,p.y=t.lpoint.y,f.x=t.lpoint.x+m,f.y=p.y,e.isNull(t.text)||(g=!0),h=o._createPath(p.x,p.y,f.x,f.y,g),i.appendChild(h)}if(!e.isNull(t.to)&&t.to.length>0||e.isNotNull(t.textOutUp)||e.isNotNull(t.textOutDown)){var m=r/2;p.x=t.rpoint.x-m,p.y=t.rpoint.y,f.x=t.rpoint.x,f.y=p.y,u=o._createPath(p.x,p.y,f.x,f.y),i.appendChild(u)}o.S.group.appendChild(i),o.nodes[t.id]=i,o.rects[t.id]=n},_createPath:function(e,t,i,a,n){var o,r,l=this,s=["M",e,t,"L",i,a];return r=s.join(" "),o=l._createSVGElement("path"),o.setAttribute("stroke",l.options.lineColor),o.setAttribute("stroke-width",3),n&&(o.setAttribute("marker-end","url(#"+l.markerId+")"),s=["M",e,t,"L",i-8,a],r=s.join(" ")),o.setAttribute("d",r),o},_layout:function(){var e,t=this,i=t.options,a=t.topoNodes,n=0,o=!1;t.endOutOffset=0;for(var r=0;a.length>r;r++){if(0===r)for(var l=0;a[r].length>l;l++)if(e=t._findById(a[r][l]),e.textInUp||e.textInDown){o=!0;break}if(r===a.length-1)for(var s=0;a[r].length>s;s++)if(e=t._findById(a[r][s]),e.textOutUp||e.textOutDown){t.endOutOffset=i.levelSpace/2;break}}o&&(n=i.levelSpace/2),t.xoffset=n;for(var d=i.levelSpace,c=0;a.length>c;c++){var h=a[c],u=h.length,p=[],f=[],g=[],m=Math.floor(u/2),v=i.nodeSpace/2+i.nodeHeight/2,w=0;1===u%2&&(1===u?f.push(h[0]):f.push(h[m]),v=0,w=1);for(var _=0;m>_;_++)p.push(h[_]);for(var _=m+w;u>_;_++)g.push(h[_]);for(var C=0;p.length>C;C++){var b=t._findById(p[C]),E=0===v?p.length-C:p.length-1-C,y=t.centerY-v-(i.nodeHeight+i.nodeSpace)*E;b.lpoint={x:n+(d+i.nodeWidth)*c,y:y},b.rpoint={x:n+(d+i.nodeWidth)*(c+1),y:y}}for(var x=0;f.length>x;x++){var b=t._findById(f[x]),y=t.centerY;b.lpoint={x:n+(d+i.nodeWidth)*c,y:y},b.rpoint={x:n+(d+i.nodeWidth)*(c+1),y:y}}for(var T=0;g.length>T;T++){var b=t._findById(g[T]),E=0===v?T+1:T,y=t.centerY+v+(i.nodeHeight+i.nodeSpace)*E;b.lpoint={x:n+(d+i.nodeWidth)*c,y:y},b.rpoint={x:n+(d+i.nodeWidth)*(c+1),y:y}}}t._move(),t._deal1toMore(),t._dealMoreto1();for(var c=0;t.options.data.length>c;c++)t._createNode(t.options.data[c])},_move:function(){for(var t,i=this,a=i.options,n=a.data,o=0;n.length>o;o++)if(!e.isNull(n[o].to)&&n[o].to.length>0){t=n[o].to;var r=t.length;if(1===r){var l=i._findById(t[0].id);if(l&&l.from&&1===l.from.length&&n[o].id===l.from[0]){var s=n[o].rpoint.y-l.lpoint.y;if(0===s)continue;l.lpoint.y=l.rpoint.y=n[o].rpoint.y}}}},_deal1toMore:function(){for(var t,i,a,n,o=this,r=o.options,l=r.data,s=0;l.length>s;s++)if(!e.isNull(l[s].to)&&l[s].to.length>0){t=l[s].to;var d=t.length;if(d>1){for(var c={y:1e5},h={y:0},u=0;d>u;u++){var p=o._findById(t[u].id);p.from&&p.from.length>1||(p.lpoint.y>h.y&&(h.id=p,h.y=p.lpoint.y),p.lpoint.y<c.y&&(c.id=p,c.y=p.lpoint.y))}if(i=c.id,a=h.id,l[s].lpoint.y>a.lpoint.y)a.lpoint.y=a.rpoint.y=l[s].lpoint.y+(r.nodeSpace+r.nodeHeight)/2;else if(l[s].lpoint.y<i.rpoint.y){var f=l[s].lpoint.y-(r.nodeSpace+r.nodeHeight)/2;l[s].lpoint.y>f&&(f=l[s].lpoint.y),i.lpoint.y=i.rpoint.y=f}if(i.id===a.id){var g=l[s].rpoint.y+10;i.lpoint.y=i.rpoint.y=g,a.lpoint.y=a.rpoint.y=g,n=o._createPath(l[s].rpoint.x-r.levelSpace/2,g,a.lpoint.x,a.lpoint.y)
}else n=o._createPath(i.lpoint.x,i.lpoint.y,a.lpoint.x,a.lpoint.y);o.vpath.appendChild(n)}}},_dealMoreto1:function(){for(var t,i,a,n,o=this,r=o.options,l=r.data,s=0;l.length>s;s++)if(!e.isNull(l[s].from)&&l[s].from.length>0){t=l[s].from;var d=t.length;if(d>1){for(var c={y:1e5},h={y:0},u=0;d>u;u++){var p=o._findById(t[u]);p.rpoint.y>h.y&&(h.id=p,h.y=p.rpoint.y),p.rpoint.y<c.y&&(c.id=p,c.y=p.rpoint.y)}i=c.id,a=h.id;var f=(a.lpoint.y+i.lpoint.y)/2;l[s].lpoint.y=l[s].rpoint.y=f,n=o._createPath(i.rpoint.x,i.rpoint.y,a.rpoint.x,a.rpoint.y),o.vpath.appendChild(n)}}},_findById:function(t){if(e.isNull(t))return-1;for(var i=this,a=i.options.data,n=0;a.length>n;n++)if(t===a[n].id)return a[n];return-1},_createBlankNode:function(e,t){return{id:e,text:"",textInUp:"",textInDown:"",textOutUp:"",textOutDown:"",clickable:"false",to:[{id:t,text:""}]}},_draw:function(){var t=this,a=t.options,n=a.data;if(!(e.isNull(n)||0>=n.length)){t.topoNodes=t._parseData(n);var o=[];t.maxLevel={count:0,index:0};for(var r=0;t.topoNodes.length>r;r++)for(var l=0;t.topoNodes[r].length>l;l++){t.topoNodes[r].length>t.maxLevel.count&&(t.maxLevel.count=t.topoNodes[r].length,t.maxLevel.index=r);var s=t._findById(t.topoNodes[r][l]);-1!==s&&(s.level=r+1,o.push(s))}a.data=n=JSON.parse(JSON.stringify(o)),t._parseFromNode(n);for(var d=0;t.topoNodes.length>d;d++)t.topoNodes[d].length>t.maxLevelNodes&&(t.maxLevelNodes=t.topoNodes[d].length);t.svgHeight=(t.maxLevelNodes-1)*a.nodeSpace+t.maxLevelNodes*a.nodeHeight,t.centerY=Math.floor(t.svgHeight/2),t._layout(),t.maxHeight=i+(t.maxLevelNodes-1)*a.nodeSpace+t.maxLevelNodes*a.nodeHeight+i,t.maxWidth=i+(t.topoNodes.length-1)*a.levelSpace+t.topoNodes.length*a.nodeWidth+i+t.xoffset+t.endOutOffset,t.S.group.setAttribute("transform","translate("+(i-a.levelSpace/2)+","+i+")");var c=" width:"+t.maxWidth+"px; height: "+t.maxHeight+"px";t.S.svg.setAttribute("style",c),t.S.svg.setAttribute("version","1.1")}},_parseFromNode:function(t){for(var i,a,n=0;t.length>n;n++){i=t[n],i.from=[];for(var o=0;t.length>o;o++)if(a=t[o].to,i.id!==t[o].id&&!e.isNull(a))for(var r=0;a.length>r;r++)if(i.id===a[r].id){i.from.push(t[o].id);break}}},_parseData:function(t){var i,a=[],n=this,l=[],s=[],d=!1,c=!1,h=0,u=0,p=0;for(h=0;t.length>h;h++)if(i=t[h],!e.isNull(i.to)&&i.to.length>0)for(u=0;i.to.length>u;u++)s.push(i.to[u]);for(h=0;t.length>h;h++){for(i=t[h],d=!1,u=0;s.length>u;u++)if(i.id===s[u].id){d=!0;break}d||l.push(i.id)}if(!(l.length>0))return[];for(a.push(l);!c;){var f={};for(c=!0,h=0;l.length>h;h++)for(u=0;t.length>u;u++)if(t[u].id===l[h]&&!e.isNull(t[u].to)&&t[u].to.length>0)for(c=!1,p=0;t[u].to.length>p;p++)f[t[u].to[p].id]=t[u].to[p].id;l=[];for(var g in f)l.push(g);l.length>0&&a.push(l)}for(var m={},h=a.length-1;h>=0;h--)for(var v=a[h],u=0;v.length>u;u++)if(m[v[u]]){for(var w=0;a[h-1].length>w;w++){var _=n._findById(a[h-1][w]);if(_.to&&_.to.length>0)for(var C=0;_.to.length>C;C++)_.to[C].id===v[u]&&(_.to[C].id=r+o)}for(var b=0;m[v[u]].level-1-h>b;b++){var E=r+o;o++,a[h+b].push(E);var y="";y=b+1===m[v[u]].level-1-h?v[u]:r+o;var x=n._createBlankNode(E,y);n.options.data.push(x)}v.splice(u,1),u--}else m[v[u]]={id:v[u],level:h+1};return a}}),Sweet.chart.SimpleTopology=e.sweet.widgetChartSimpleTopology}(jQuery),function(e){"use strict";var t="sweet-chart-gridlegend",i="title",a="marker",n="label",o="value";e.widget("sweet.widgetChartGridLegend",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-gridlegend]:",eventNames:{},options:{data:[],dataKeys:[],verticalAlign:"top",skipColor:!0},setData:function(e){var t=this;t.options.data=e,t._createItems(),t._doLayout()},_createJsChart:function(){this.legendEl=e("<div>").addClass(t).appendTo(this.chartEl),this.listEl=e("<ul>").appendTo(this.legendEl),this._createItems()},_createItems:function(){var t,r,l,s,d,c,h,u=this.options.data;if(0!==u.length&&0!==this.options.dataKeys.length){this.listEl.empty(),this.options.dataKeys[1].unit&&(t=e("<li>").addClass(i).appendTo(this.listEl),t.text(this.options.dataKeys[1].unit)),d=this.options.dataKeys[0].value,c=this.options.dataKeys[1].value;for(var p=0;u.length>p;p++)t=e("<li>").appendTo(this.listEl),r=e("<span>").addClass(a).appendTo(t),l=e("<span>").addClass(n).appendTo(t),s=e("<span>").addClass(o).appendTo(t),h=this._getColor(u.length,p,this.options.skipColor),r.css("background-color",h),l.text(u[p][d]).attr("title",u[p][d]),s.text(u[p][c])}},_doLayout:function(){var t,i,a,n,o,r,l,s=this;this.rendered&&this.listEl&&(o=s.listEl.width(),this.listEl.children().each(function(r,l){t=e(l),0!==r&&(a=t.children().eq(1),i=t.children().eq(2),n=n||a.position().left,a.width(o-n-i.width()-5))}),"middle"===this.options.verticalAlign?(r=this.listEl.height(),l=this.legendEl.height(),this.legendEl.height()>r?this.listEl.css("margin-top",(l-r)/2+"px"):this.listEl.css("margin-top",0)):"bottom"===this.options.verticalAlign&&(r=this.listEl.height(),l=this.legendEl.height(),this.legendEl.height()>r?this.listEl.css("margin-top",l-r+"px"):this.listEl.css("margin-top",0)))},_destroyWidget:function(){this.legendEl.remove(),this._super()}}),Sweet.chart.GridLegend=e.sweet.widgetChartGridLegend}(jQuery),function(e){"use strict";var t="sweet-chart-tiles",i="label",a="bottom",n="corner";e.widget("sweet.widgetChartTiles",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-tiles]:",eventNames:{},options:{title:"",data:{},dataKeys:[],verticalAlign:"middle",skipColor:!1,minFont:14,maxFont:40},_updateData:function(){this._createItems(),this._doLayout()},_setChangeProperty:function(){this._createItems(),this._doLayout()},_getCanvasObject:function(){var t=this,a=0;if(t.options.id,!t.rendered)return null;var o=t.chartEl.find("ul");if(0>=o.length)return null;o=e(o[0]);var r=parseInt(o.css("margin-top")),l=t.chartEl.height(),s=t.chartEl.width(),d=o.height(),c=o.width(),h=d>l?d:l,u=c>s?c:s,p=e("<canvas>").attr({width:u,height:h});p=p[0];var f=p.getContext("2d"),g=o.find("li"),m=8,v=r;for(a=0;g.length>a;a++){var w=e(g[a]),_=w.find("."+i),C=(w.find("."+n),20),b=_.text(),E=_.css("background-color"),y=_.css("color"),x=w.width(),T=w.height();f.save(),f.fillStyle=f.strokeStyle=E,f.beginPath(),f.moveTo(m,v),f.lineTo(m+x,v),f.lineTo(m+x-C,v+T),f.lineTo(m,v+T),f.closePath(),f.fill(),f.fillStyle=f.strokeStyle=y,f.font="12px Tahoma";var D=t._calcText(f,b,"12px Tahoma",x-C-m);f.fillText(D,m+3,v+15),f.restore(),v+=T+8}return p},_calcText:function(e,t,i,a){var n="...",o=!1,r=t;for(e.save(),e.font=i;;){var l=e.measureText(r).width;if(!(l>a))break;var s=Math.floor(a*r.length/l);r=r.substr(0,s),o=!0}var d=e.measureText(r).width;return o&&a>d&&(r+=n),e.restore(),r},_createJsChart:function(){this.tilesEl=e("<div>").addClass(t).appendTo(this.chartEl),this.listEl=e("<ul></ul>").appendTo(this.tilesEl),this._createItems()},_createItems:function(){var t,o,r,l,s,d,c,h,u=this.options.data,p=this.options.dataKeys;if(!e.isNull(u)&&0!==p.length){this.listEl.empty(),s=p.length;for(var f=0;p.length>f;f++)d=p[f].text,c=p[f].value,t=e("<li>").appendTo(this.listEl),l=e("<div>").addClass(a).appendTo(t),o=e("<span>").addClass(i).appendTo(l),r=e("<div>").addClass(n).appendTo(l),o.text(d).attr("title",d),s>0&&this.maxPacket-1>=s?h=this._getColor(s,f,this.options.skipColor):this.options.dataKeys[f].color&&(h=this.options.dataKeys[f].color),o.css("background-color",h),r.css("border-top-color",h)}},_doLayout:function(){var e,t,i;this.options.minFont,this.options.maxFont,this.rendered&&this.listEl&&(i=this.tilesEl.width(),t=this.tilesEl.height(),e=this.listEl.height(),"middle"===this.options.verticalAlign?(e=this.listEl.height(),t=this.tilesEl.height(),this.tilesEl.height()>e?this.listEl.css("margin-top",(t-e)/2+"px"):this.listEl.css("margin-top",0)):"bottom"===this.options.verticalAlign&&(e=this.listEl.height(),t=this.tilesEl.height(),this.tilesEl.height()>e?this.listEl.css("margin-top",t-e+"px"):this.listEl.css("margin-top",0)))},_destroyWidget:function(){Sweet.Task.Delay.stop("sweet.chart.tiles.layout-"+this.options.id),this.tilesEl.remove(),this._super()}}),Sweet.chart.Tiles=e.sweet.widgetChartTiles}(jQuery),function(e){var t="SequenceChart-sequence",i="sweet-arrayindicator-infoDiv";e.widget("sweet.widgetChartSequenceChart",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-chart-sequence-chart]:",eventNames:{click:"click点击事件"},options:{columnWidth:160,width:1280,height:800,data:{}},setData:function(t){if(!e.isNull(t)){var i=this,a=i.options;i._initData(),a.data=JSON.parse(JSON.stringify(t)),i._dealNEInfo(),i._setCanvasWH(),i._createSequenceChart()}},sortChange:function(t){var i=this;e.isNull(t)||0===t.length||t.length!==i.neInfo.length||(i.neInfo=JSON.parse(JSON.stringify(t)),i.neCount=i.neInfo.length,i._setCanvasWH(),i._createSequenceChart())},_createJsChart:function(){var i=this,a=i.options;i.flowCanvasId=a.id+"-canvas",i.flowEl=e("<div>").attr({id:a.id+"-flow"}).height(a.height).width(a.width).addClass(t).css({overflow:"auto"}),i.flowCanvasEl=e("<Canvas>").attr({id:i.flowCanvasId,width:a.width,height:a.height}).appendTo(i.flowEl),i.context=i.flowCanvasEl.get(0).getContext("2d"),i._readyGo(),i._bindEvent(),!e.isNull(a.data)&&!e.isNull(a.data.result)&&a.data.result.length>0&&(i._dealNEInfo(),i._setCanvasWH(),i._createSequenceChart())},_isScope:function(t,i){var a,n=this,o=0,r=0,l=0;for(e.isFirefox()?(o=t.pageX-n.flowCanvasEl.offset().left,r=t.pageY-n.flowCanvasEl.offset().top):(e.isChrome()||e.isIE())&&(o=t.offsetX,r=t.offsetY),l=0;i.length>l;l++)if(a=i[l],o>=a.left&&a.left+a.width>=o&&r>=a.top&&a.top+a.height>=r)return{isScope:!0,node:JSON.parse(JSON.stringify(a))};return!1},_bindEvent:function(){var t=this;t.context,t.flowCanvasEl.bind("click",function(i){var a=t._isScope(i,t.textOnLineInfo);a&&a.isScope&&!e.isNull(t.eventMap.click)&&e.isFunction(t.eventMap.click)&&t.eventMap.click(i,a.node.line)}),t.flowCanvasEl.bind("mousemove",function(a){var n=t._isScope(a,t.textOnLineInfo),o=t._isScope(a,t.netElementsInfo);e.isNull(t.tipDiv)||t.tipDiv.remove(),n&&n.isScope?(t.flowCanvasEl.css("cursor","pointer"),t.tipDiv=e("<div>").addClass(i).appendTo("body"),e("<span>").html(n.node.line.name).appendTo(t.tipDiv),t.tipDiv.position({my:"left+5 bottom-10",of:a,collision:"flipfit"})):o&&o.isScope?(t.tipDiv=e("<div>").addClass(i).appendTo("body"),e("<span>").html(o.node.neDesc).appendTo(t.tipDiv),t.tipDiv.position({my:"right+5 bottom-10",of:a,collision:"flipfit"})):(e.isNull(t.tipDiv)||t.tipDiv.remove(),t.flowCanvasEl.css("cursor","default"))}),t.flowCanvasEl.bind("mouseout",function(){e.isNull(t.tipDiv)||t.tipDiv.remove()})},_setCanvasWH:function(){var e=this,t=e.options,i=0,a=0,n=0,o=0,r=e.neCount,l=t.columnWidth,s=t.data,d=s.result?s.result:[],c=d.length;for(e.timeTextMaxWidth=0,o=0;c>o;o++)e.context.save(),e.context.font="12px Tahoma",i=e.context.measureText(d[o].time).width,e.context.restore(),i>e.timeTextMaxWidth&&(e.timeTextMaxWidth=i);e.timeTextMaxWidth>e.maxTextWidth&&(e.timeTextMaxWidth=e.maxTextWidth),a=2*e.leftMargin+e.timeTextMaxWidth+e.textToChart+((0===r?1:r)-1)*l,n=((0===c?1:c)-1)*e.rowSpace+e.headerHeight+30,e.flowCanvasEl.attr({width:a,height:n})},_dealNEInfo:function(){var t,i=this,a=0,n={},o=i.options,r=o.data,l=r.result?r.result:[],s=l.length;for(i.neInfo=[],i.neCount=0,a=0;s>a;a++)t=l[a],0===i.neInfo.length?(i.neInfo.push(t.srcname),i.neInfo.push(t.destname),n[t.srcname]=1,n[t.destname]=1,i.neCount=2):(e.isNull(n[t.srcname])&&(n[t.srcname]=1,i.neInfo.push(t.srcname),i.neCount++),e.isNull(n[t.destname])&&(n[t.destname]=1,i.neInfo.push(t.destname),i.neCount++))},_createSequenceChart:function(){var e=this,t=e.options,i=t.data,a=i.result?i.result:[],n=a.length,o=0,r=0,l=e.leftMargin,s=0;for(e.timeTextMaxWidth=0,o=0;n>o;o++)l=e.leftMargin,s=e.rowSpace*o+e.headerHeight,r=e._createText(a[o].time,l,s,{fillStyle:"#3c3c3c",textAlign:"start",maxTextWidth:e.maxTextWidth,font:"12px Tahoma"}),r>e.timeTextMaxWidth&&(e.timeTextMaxWidth=r);e.timeTextMaxWidth>e.maxTextWidth&&(e.timeTextMaxWidth=e.maxTextWidth),e._createNEAndText(),e._drawLineAndName()},_createNEAndText:function(){var e,t=this,i=t.options,a=t.neInfo,n=0,o=0,r={},l={},s=0,d=0,c=0,h=i.columnWidth;for(t.netElsXY=[],t.netElementsInfo=[],n=0;a.length>n;n++)e=a[n],s=t.leftMargin+t.timeTextMaxWidth+t.textToChart+n*i.columnWidth,d=Math.floor(t.headerHeight/2),c=t._createText(e,s,d,{maxTextWidth:h,textAlign:"center",font:"16px Tahoma"}),c>h&&(c=h),t.netElsXY.push({name:e,x:s,y:d}),r={x:s,y:t.headerHeight-23},l={x:s,y:(i.data.result.length-1)*t.rowSpace+t.headerHeight},t._drawLine(r,l,"#d2d2d2",!1),o=s-c/2,t.netElementsInfo.push({neDesc:e,tx:s,ty:d,maxWidth:h,top:d-15,left:o,width:c,height:15})},_drawLineAndName:function(){var t,i=this,a=i.options,n=a.data,o=n.result?n.result:[],r=o.length,l=i.netElsXY.length,s=0,d={},c={},h={},u={},p="blue",f=0;for(i.textOnLineInfo=[],s=0;r>s;s++){t=o[s],f=i.rowSpace*s+i.headerHeight-4,d={x:i.netElsXY[0].x,y:f},c={x:i.netElsXY[l-1].x,y:f},i._drawDotLine(d,c,!1,"#647796"),h.x=i._findByName(t.srcname).x,u.x=i._findByName(t.destname).x,u.x=h.x<u.x?u.x-i.arrowHeight:u.x+i.arrowHeight,h.y=u.y=f,p=i._getColor(t),i._drawLine(h,u,p,!0);var g=i._getDirectionSpaceIndex(t),m=g.space*a.columnWidth,v="#3c3c3c",w="12px Tahoma";"1"===t.isErrorColor?(v=e.isNull(t.textColor)?"red":t.textColor,w="12px Tahoma solid"):v="#3c3c3c";var _=0,C=f-6,b=0,E=0;_="left"===g.direction?u.x+m/2:h.x+m/2,b=i._createText(t.name,_,C,{maxTextWidth:m,fillStyle:v,textAlign:"center",font:w}),b>m&&(b=m),E=_-b/2,i.textOnLineInfo.push({line:t,tx:_,ty:C,maxWidth:m,top:C-10,left:E,width:b,height:10})}},_getDirectionSpaceIndex:function(e){var t=this,i=0,a=0,n=0;for(i=0;t.netElsXY.length>i;i++)e.srcname===t.netElsXY[i].name&&(a=i),e.destname===t.netElsXY[i].name&&(n=i);return{direction:0>n-a?"left":"right",space:Math.abs(a-n)}},_getColor:function(e){var t,i=this;return"1"===e.isErrorColor?e.color:"0"===e.isErrorColor?(t=i._getDirectionSpaceIndex(e).direction,"right"===t?"#369cd8":"#90cc19"):"#000000"},_findByName:function(e){var t=this,i=0;for(i=0;t.netElsXY.length>i;i++)if(e===t.netElsXY[i].name)return t.netElsXY[i]},_createText:function(t,i,a,n){var o=this,r=0,l=t,s=0,d=o.context;return e.isNull(n)&&(n={}),d.save(),d.textAlign=n.textAlign?n.textAlign:"start",d.fillStyle=n.fillStyle?n.fillStyle:"#3c3c3c",d.font=n.font?n.font:"12px Tahoma",d.translate(i,a),e.isNull(n.maxTextWidth)?d.fillText(l,0,0):(r=d.measureText(t).width,r>n.maxTextWidth&&(s=Math.ceil(t.length*n.maxTextWidth/r),l=(t+"").substr(0,s-4)+"..."),d.fillText(l,0,0,n.maxTextWidth)),d.restore(),r},_initData:function(){var e=this;e.timeTextMaxWidth=0,e.neInfo=[],e.neCount=0,e.netElsXY=[],e.textOnLineInfo=[],e.netElementsInfo=[]},_readyGo:function(){var e=this;e.eventMap={},e.leftMargin=30,e.maxTextWidth=200,e.textToChart=24,e.headerHeight=60,e.rowSpace=34,e.arrowHeight=6,e._initData();var t=window.CanvasRenderingContext2D&&CanvasRenderingContext2D.prototype;t.lineTo&&(t._dottedLine=function(e,t,i,a,n){n||(n=[4,2]);var o=this,r=i-e,l=a-t,s=0,d=Math.atan2(l,r);s=Math.sqrt(Math.pow(r,2)+Math.pow(l,2)),o.save(),o.translate(e,t),o.moveTo(0,0),o.rotate(d);var c=n.length,h=0,u=!0;for(e=0;s>e;)e+=n[h++%c],e>s&&(e=s),u?o.lineTo(e,0):o.moveTo(e,0),u=!u;o.restore()})},_drawDotLine:function(e,t,i,a){var n=this,o=n.context;o.save(),i&&n._drawArrow(o,e,t,a),o.strokeStyle=a,o.lineWidth=1,o.beginPath(),o._dottedLine(e.x,e.y,t.x,t.y),o.closePath(),o.stroke(),o.restore()},_drawLine:function(e,t,i,a){var n=this,o=3,r=n.context;a&&n._drawArrow(r,e,t,i),r.save(),r.lineWidth=o,r.strokeStyle=i,r.beginPath(),r.moveTo(e.x,e.y),r.lineTo(t.x,t.y),r.stroke(),r.closePath(),r.restore()},_drawArrow:function(e,t,i,a){var n=this,o=0,r=n.arrowHeight;e.save(),e.fillStyle=e.strokeStyle=a,o=t.x<=i.x?i.x+r:i.x-r,e.translate(o,i.y),i.y-t.y>=0?e.rotate(Math.atan((i.x-t.x)/(i.y-t.y))):e.rotate(Math.PI+Math.atan((i.x-t.x)/(i.y-t.y))),e.beginPath(),e.lineTo(-r,r),e.lineTo(0,r),e.lineTo(r,r),e.lineTo(0,0),e.fill(),e.closePath(),e.restore()},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&(t.eventMap.click=i)})},_removeListener:function(t){var i=this;e.isNull(t)?(i.handlers={},i.eventMap={}):"click"!==t||e.isNull(i.eventMap.click)||delete i.eventMap.click},_chartRender:function(){var t=this;t.rendered||e.isNull(t.flowEl)||t.flowEl.appendTo(t.chartEl)}}),Sweet.chart.SequenceChart=e.sweet.widgetChartSequenceChart}(jQuery),function(e){var t="sweet-chart-fishbone-head",i="sweet-chart-fishbone-point",a="sweet-chart-fishbone-end",n="sweet-chart-fishbone-middle-upArrow",o="sweet-chart-fishbone-middle-downArrow",r="sweet-chart-fishbone-up-outLabel",l="sweet-chart-fishbone--up-label",s="sweet-chart-fishbone-down-label",d="sweet-chart-fishbone-upTable",c="sweet-chart-fishbone-downTable",h="sweet-chart-fishbone-midAll",u="sweet-chart-fishbone-widget";e.widget("sweet.widgetFishbone",e.sweet.widgetChart,{version:"1.0",sweetWidgetName:"[widget-fishbone]",options:{width:"100%",height:500,data:null,desc:null,items:null},setData:function(t){if(!e.isNull(t)){var i=this;i._destroyWidget(),e.isArray(t)&&(i.options.data=t),i.fishBoneEI.empty(),i._createFishWidget(),i._doLayout(),i._creatFishArrowTable()}},_render:function(e){var t=this;return t._super(e)?(t.chartEl.appendTo(t.renderEl),t._creatFishArrowTable(),t.rendered=!0,!0):!1},_createJsChart:function(){var t=this,i=t.options;t.fishBoneEI=e("<div>").appendTo(t.chartEl).width(i.width).height(i.height).addClass(u),t._createFishWidget()},_createFishWidget:function(){var t=this,i=t.options.data;t.fboneMajor=e("<div>").appendTo(t.fishBoneEI).addClass(h),t.upTables=[],t.downTables=[],e.isNull(i)?(t._createFishHead(),t._createFishEnd()):e.isArray(i)&&(t._createFishHead(),t._createFishMiddle(),t._createFishEnd())},_createFishHead:function(){var i,a,n=this,o=n.fishHeadEI=e("<div>").addClass(t),d=n.fishHeadUpEI=e("<div>").appendTo(o).addClass(r),c=n.fishHeadUpLab=e("<div>").appendTo(d).addClass(l),h=n.fishHeadDownLab=e("<div>").appendTo(o).addClass(s);e.isNotNull(n.options.desc)&&(a=n.options.desc[0].replace(/\n/g,"<br>"),i=n.options.desc[1].replace(/\n/g,"<br>")),c.html(a),h.html(i),o.appendTo(n.fboneMajor)},_createFishMiddle:function(){var t,a,h,u,p,f,g,m,v,w=this,_=w.options,C=_.data||[],b=C.length;if(w.data=C,t=w.fishMiddleEI=e("<div>").appendTo(w.fboneMajor),v=150,e.isNotNull(C)&&b>0)for(var E=0;b>E;E++)if(m=C[E],g=m.value.replace(/\n/g,"<br>"),f=m.text.replace(/\n/g,"<br>"),a=w.fishMidPointEI=e("<div>").appendTo(t).addClass(i),h=e("<div>").appendTo(a).addClass(r),u=e("<div>").appendTo(h).addClass(l),p=e("<div>").appendTo(a).addClass(s),u.html(f),p.html(g),e.isArray(m.data)&&m.data.length>0){var y=m.data.length;v+=100*(y+1);for(var x=_.id+"-chart",T=0;y>T;T++){var D=m.data[T].options.data,S=30;if(e.isFunction(m.data[T].options.contentDescriptionFunc)&&(S+=27),S+=D.data&&D.data.length>0?28*D.data.length:30,0===T%2&&0===E%2){var k=e("<div>").appendTo(t).addClass(n),L=e("<div>").appendTo(k);L.realh=S,w.upTables.push(L);var N=x+"-up-"+E+T;m.data[T].fishRenderId=N,L.addClass(d).attr("id",N)}else{var I=e("<div>").appendTo(t).addClass(o),A=e("<div>").appendTo(I);A.realh=S,w.downTables.push(A);var N=x+"-down-"+E+T;m.data[T].fishRenderId=N,A.addClass(c).attr("id",N)}}}else E===b-1?v+=100:(v+=200,e("<div>").appendTo(t).addClass("sweet-chart-fishbone-blank"));t.css("width",v+20)},_creatFishArrowTable:function(){for(var e,t=this,i=t.options,a=i.data,n=a.length,o=0;n>o;o++){var e=a[o].data;if(e)for(var r=0;e.length>r;r++)e[r].render(e[r].fishRenderId)}},_createFishEnd:function(){var t=this,i=t.fishEndEI=e("<div>").addClass(a);i.appendTo(t.fboneMajor)},_doLayout:function(){var e=this,t=e.fishBoneEI.width(),i=e.fishBoneEI.height(),a=Math.floor((i-100)/2);e.fboneMajor.css({top:a});var n=(t-e.fboneMajor.width())/2;0>n&&(n=0),e.fishBoneEI.css({"padding-left":n});for(var n=10,o=a-n,r=0;e.upTables.length>r;r++){var l=e.upTables[r].realh,s=o>l?l:o;e.upTables[r].css("top",-s).css("height",s)}for(var r=0;e.downTables.length>r;r++){var l=e.downTables[r].realh,s=o>l?l:o-10;e.downTables[r].css("top",110).css("height",s)}},_setHeight:function(e){this.fishBoneEI.externalHeight(e)},_setWidth:function(e){this.fishBoneEI.externalWidth(e)},_setWH:function(e,t){this.fishBoneEI.externalWidth(e),this.fishBoneEI.externalHeight(t)},_getHeight:function(){return this.fishBoneEI.externalHeight()},_getWidth:function(){return this.fishBoneEI.externalWidth()},_destroyWidget:function(){for(var t,i=this,a=i.options,n=a.data,o=n.length,r=0;o>r;r++){var t=n[r].data;if(t)for(var l=0;t.length>l;l++)e.isFunction(t[l].destroy)?t[l].destroy():""}}}),Sweet.chart.Fishbone=e.sweet.widgetFishbone}(jQuery),function(e){var t="sweet-container";e.widget("sweet.widgetContainer",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-container]:",widgetClass:"sweet.widgetContainer",options:{width:"auto",fieldset:!1,fieldsetTitle:"",fieldsetHTML:"",collapsible:!0,collapse:!1,toggle:null,margin:0},hide:function(){this.renderEl.hide(),this.visible=!1},show:function(){this.renderEl.show(),this.visible=!0,this.doLayout(!0),this._layoutChildren(!0)},_setWidth:function(e){this.fieldsetEl?this.fieldsetEl.externalWidth(e):this.containerEl.externalWidth(e)},_setHeight:function(e){this.fieldsetEl?this.fieldsetEl.externalHeight(e):this.containerEl.externalHeight(e)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_getWidth:function(){return this.fieldsetEl?this.fieldsetEl.externalWidth():this.containerEl.externalWidth()},_getHeight:function(){return this.fieldsetEl?this.fieldsetEl.externalHeight():this.containerEl.externalHeight()},_render:function(e){var t=this;return t._super(e)?(t.fieldsetEl?t.fieldsetEl.appendTo(t.renderEl):t.containerEl.appendTo(t.renderEl),t._widgetRender(),t.rendered=!0,!0):!1},_widgetRender:e.noop,_toggleFieldSet:function(t){var i=this,a=i.containerEl,n=i.fieldsetEl,o=n.children().first(),r=o.children().first();t?(a.show(),o.height(r.externalHeight()+i.containerHeight),n.height(o.externalHeight()),i.doLayout(!0),i._layoutChildren(!0)):(a.hide(),i.containerHeight=a.externalHeight(),o.height(r.outerHeight()),n.height(o.externalHeight())),e.isFunction(i.options.toggle)&&i.options.toggle(t)},_createSweetWidget:function(){var i=this,a=this.options,n=this.containerEl=e("<div>");if(n.addClass(t),e.isNull(n.attr("id"))&&n.attr("id",a.id),a.fieldset){this._error("#"+this.options.id+" fileset option is deprecated!");var o="sweet-container-fieldset",r="sweet-container-fieldset-content",l="sweet-container-fieldset-title",s="sweet-container-fieldset-title-collapsible",d="sweet-container-fieldset-text",c="sweet-container-fieldset-pic",h="sweet-container-fieldset-pic-fold",u="sweet-container-fieldset-pic-unfold",p="sweet-container-fieldset-html",f=i.fieldsetEl=e("<div>").addClass(o+" "+a.widgetClass),g=e("<div>").addClass(r),m=e("<div>").addClass(l),v=e("<div>"),w=e("<em>").addClass(d),_=e("<a>").addClass(c),C=e("<div>").addClass(p);w.html(a.fieldsetTitle).appendTo(v),a.collapsible&&(m.addClass(s),v.bind("click",function(){_.hasClass(h)?(_.removeClass(h).addClass(u),i._toggleFieldSet(!0)):_.hasClass(u)&&(_.removeClass(u).addClass(h),i._toggleFieldSet(!1))}),_.appendTo(v),a.collapse?(_.addClass(h),n.hide()):_.addClass(u)),C.html(a.fieldsetHTML).appendTo(m),v.appendTo(m),m.appendTo(g),g.appendTo(f),n.appendTo(g),i._setMargin(f),f.externalHeight(a.height).externalWidth(a.width)}else i._setMargin(n),n.addClass(a.widgetClass).externalHeight(a.height).externalWidth(a.width);i._createContainer()},_createContainer:e.noop,_setMargin:function(t){var i=this.options,a=i.margin,n=["padding-top","padding-right","padding-bottom","padding-left"];if(e.isNumeric(a)&&0!==a)t.css("padding",a);else if(e.isArray(a))for(var o=0;a.length>o&&n.length>o;o++)0!==a[o]&&t.css(n[o],a[o])},_destroyWidget:function(){this.fieldsetEl?(this.fieldsetEl.find("*").unbind(),this.fieldsetEl.remove()):this.containerEl&&(this.containerEl.find("*").unbind(),this.containerEl.remove())},_layoutChildren:function(t){"use strict";var i;if(e.isArray(this.options.items))for(var a=0;this.options.items.length>a;a++)i=this.options.items[a],e.isFunction(i.doLayout)&&i.doLayout(t),e.isFunction(i._layoutChildren)&&i._layoutChildren(t)}}),Sweet.container=e.sweet.widgetContainer}(jQuery),function(e){var t="sweet-panel-title",i="sweet-panel-tools",a="sweet-panel-info",n="sweet-panel-toggle-icon",o="sweet-panel-title-label",r="expanded",l="collapsed";e.widget("sweet.widgetContainerPanel",e.sweet.widgetContainer,{version:"1.0",sweetWidgetName:"[widget-container-panel]:",type:"gridPanel",options:{header:!1,title:"",titleTips:null,tools:[],headerStyle:1,html:"",items:[]},setTitle:function(t,i){if(this.options.header){var a=this.panelTitleEl.find("."+o);e.isNull(t)&&(t=""),a.removeAttr("title"),this.options.title=t,i?this.options.titleTips=i:!1===i&&(this.options.titleTips=null),this.options.titleTips&&(!0===this.options.titleTips||"true"===this.options.titleTips?a.text(t).attr("title",t):a.text(t).attr("title",this.options.titleTips)),a.text(t)}},getFormData:function(){var t,i,a=this,n={},o=a._getFormWidgets();return e.each(o,function(o,r){return e.isNull(r.options.name)?(a._info("Form widget "+r.options.id+" has no 'name' attribute"),undefined):(t=r.options.name,i=r.getValue(),n[t]=i,undefined)}),n},setFormData:function(t){var i,a,n,o=this;n=o._getFormWidgets(),e.each(n,function(n,r){if(i=r.options.name,a=t[i],a!==undefined&&e.isFunction(r.setValue))try{r.setValue(a)}catch(l){o._info("Widget "+r.options.id+" setValue failed")}})},validateForm:function(){for(var t,i=this,a=!0,n=i._getFormWidgets(),o=0;n.length>o;o++)if(e.isFunction(n[o].check)){if(e.isFunction(n[o].getDisabled)&&n[o].getDisabled())continue;try{t=n[o].check(),t===!1&&(a=!1)}catch(r){i._info("widget "+n[o].sweetWidgetName+" check throw exception.")}}return a},addItems:function(t){var i,a=this;if(""!==a.options.html&&0===a.options.items.length)return a._error("Cannot add items while initialized by HTML"),undefined;if(e.isArray(t))i=t;else{if("object"!=typeof t)return a._error("Unsupport data type: "+typeof t),undefined;i=[],i.push(t)}return a.rendered?(a._addItems(i),a._doLayout(),undefined):(e.isNull(a._itemBufferBeforeRender)&&(a._itemBufferBeforeRender=[]),a._itemBufferBeforeRender=a._itemBufferBeforeRender.concat(t),undefined)},_addItems:e.noop,removeItems:function(t){var i,a=this;t===undefined?i=null:e.isArray(t)?i=t:(i=[],i.push(t)),null===i&&a._itemBufferBeforeRender&&(a._itemBufferBeforeRender=null),null===i?a._removeItems():a._removeItems(i),a._doLayout()},_removeItems:e.noop,showItem:function(e){"use strict";this._showItem(e)},_showItem:e.noop,hideItem:function(e){"use strict";this._hideItem(e)},_hideItem:e.noop,setHTML:function(e){0===this.options.items.length&&this.panelContentEl.html(e)},collapse:function(){this.containerHeight=this.containerEl.externalHeight(),this.panelContentEl.hide(),this.containerEl.externalHeight(this.panelTitleEl.externalHeight());var t=this.panelTitleEl.find("span."+n);t.removeClass(r).addClass(l),this._expanded=!1,e.isFunction(this.options.toggle)&&this.options.toggle(!1)},expand:function(){this.panelContentEl.show(),this.containerEl.externalHeight(this.containerHeight);var t=this.panelTitleEl.find("span."+n);t.removeClass(l).addClass(r),this._expanded=!0,this.doLayout(!0),this._layoutChildren(!0),e.isFunction(this.options.toggle)&&this.options.toggle(!0)},_createContainer:function(){var e=this,t=this.options;t.header&&e._createPanelTitle(),e._createPanelContent(),0===t.items.length&&""!==t.html&&e.panelContentEl.html(t.html),this._freezeChildren(!0)},_createPanelTools:function(){var t=this.options.tools;e.isNull(t)||0===t.length||(this.panelToolsEl=e("<div>"),this.panelToolsEl.attr("id",this.options.id+"-tools").addClass(i).appendTo(this.panelTitleEl))},_renderPanelTools:function(){this.panelToolsContainer||e.isNull(this.panelToolsEl)||(this.panelToolsContainer=new Sweet.panel.HPanel({itemExtend:!1,align:"right",verticalAlign:"bottom",items:this.options.tools,renderTo:this.panelToolsEl.attr("id"),width:"auto",height:"100%",margin:[0,5,0,0]}))},_layoutPanelTools:function(){e.isNull(this.panelToolsContainer)||e.isNull(this.panelToolsEl)||this.panelToolsContainer.doLayout()},_createPanelTitle:function(){var i=this;if(!i.options.fieldset){var l=i.options,s=t+" title-style-"+this.options.headerStyle,d=i.panelTitleEl=e("<div>").addClass(s);this._createPanelTools();var c=e("<div>").addClass(a).appendTo(d);if(l.collapsible){var h=e("<span>").addClass(n).appendTo(c).append(e("<i>"));h.addClass(r),h.bind("click",{self:i},function(){var t=e(this);t.hasClass(r)?i.collapse():i.expand()})}this.options.titleTips?!0===this.options.titleTips||"true"===this.options.titleTips?e("<label>").html(this.options.title).attr("title",this.options.title).addClass(o).appendTo(c):e("<label>").html(this.options.title).attr("title",this.options.titleTips).addClass(o).appendTo(c):e("<label>").html(this.options.title).addClass(o).appendTo(c)}},_createPanelContent:e.noop,_widgetRender:function(){this.panelTitleEl&&this.panelTitleEl.appendTo(this.containerEl),this.panelContentEl.appendTo(this.containerEl),this._renderPanelTools(),this.options.collapse&&this.collapse()},_destroyWidget:function(){this.panelToolsContainer&&this.panelToolsContainer.destroy(),this._super()},_doLayout:function(){var t,i,a,n=this;if(n.rendered){if(e.isArray(n._itemBufferBeforeRender)&&(a=n._itemBufferBeforeRender,n._itemBufferBeforeRender=null,n.addItems(a)),this._layoutPanelTools(),e.isNull(n.panelTitleEl))if(e.isNull(n.fieldsetEl))t=n.containerEl.width(),i=n.containerEl.height();else{var o=n.fieldsetEl.children("div").first(),r=o.children("div").first();o.externalHeight(n.fieldsetEl.height()),n.containerEl.externalWidth(o.width()),n.containerEl.externalHeight(o.height()-r.externalHeight()),t=n.containerEl.width(),i=n.containerEl.height()}else t=n.containerEl.width(),i=n.containerEl.height()-n.panelTitleEl.externalHeight();this._expanded===!1&&this.containerEl.externalHeight(this.panelTitleEl.externalHeight()),n.panelContentEl&&!n.panelContentEl.is(":hidden")&&(n.panelContentEl.externalWidth(t),n.panelContentEl.externalHeight(i)),this._freezeChildren(!1)}},_getFormWidgets:function(){var t,i=this,a=[];return i.panelContentEl.find("*").each(function(i,n){e.isNull(n.id)||(t=Sweet._widgets[n.id],e.isNull(t)||"sweet.widgetForm"===t.widgetClass&&a.push(t))}),a},_freezeChildren:function(t){"use strict";if((!t||!this.__childrenIsFrozen)&&(t||this.__childrenIsFrozen)&&(this.__childrenIsFrozen=t,e.isArray(this.options.items)))for(var i,a=0;this.options.items.length>a;a++)i=this.options.items[a],i&&e.isFunction(i._freeze)&&i._freeze(t)}}),Sweet.container.Panel=e.sweet.widgetContainerPanel}(jQuery),function(e){var t="sweet-panel-content",i="sweet-panel-grid",a="sweet-panel-grid-table",n="sweet-grid-panel-",o=1e3;e.widget("sweet.widgetContainerGridpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-gridpanel]:",type:"gridPanel",options:{layoutOptions:{rows:1,columns:1},padding:5,itemExtend:!0},getRowCount:function(){return this.options.layoutOptions.rows},getColumnCount:function(){return this.options.layoutOptions.columns},addRow:function(t,i){function a(){if(e.isArray(t[0]))if(s){if(o=t[l++],r._addRow(o),r._doLayout(!1,o.length),t.length>l)return window.setTimeout(a,5),undefined}else for(n=0;t.length>n;n++)r._addRow(t[n]),r._doLayout(!1,t[n].length);else r._addRow(t),r._doLayout();s&&i()}var n,o,r=this,l=0,s=e.isFunction(i);e.isArray(t)&&0!==t.length&&(s?window.setTimeout(a,5):a())},_addRow:function(t){var i,a,n,o=this,r=o.getColumnCount();if(e.isArray(t)){for(i=0,a=0;t.length>a;a++)n=t[a],e.isPlainObject(n)&&e.isNull(n.options)&&(n.options=e.objCopy(n)),e.isNull(n.options.colSpan)&&(n.options.colSpan=1),i+=n.options.colSpan;if(i!==r)return o._error("Items count is incorrect!"),undefined;var l,s,d=e("<tr>").appendTo(o.tableEl.children().first());for(a=0;t.length>a;a++)n=t[a],l=o._addTd(n.options.colSpan,null),l.appendTo(d),s=l.attr("id"),o.rendered&&o._renderItem(n,s),n.__gridContainerId=s,o.options.items.push(n);
o.options.layoutOptions.rows++}},removeRow:function(t,i){function a(t,i){for(l=0;u.options.items.length>l&&(d=u.options.items[l],d.__gridContainerId!==i.id);l++);return l>=u.options.items.length?(u._error("TD#"+i.id+" contains none item!"),undefined):(e.isFunction(d.destroy)&&d.destroy(),u.options.items.splice(l,1),undefined)}function n(e){c=h.eq(e),c.children().each(a),c.remove(),u.options.layoutOptions.rows--}function o(){s=t[r++],n(s),r>=t.length?(u._doLayout(),i()):window.setTimeout(o,5)}var r,l,s,d,c,h,u=this,p=e.isFunction(i);if(t===undefined||null===t)for(t=[],r=0;u.options.layoutOptions.rows>r;r++)t.push(r);if(e.isNumeric(t)&&(t=[t]),e.isArray(t))if(h=u.tableEl.find(">tbody>tr"),t.sort(function(e,t){return t-e}),p)r=0,window.setTimeout(o,5);else{for(r=0;t.length>r;r++)s=t[r],n(s);u._doLayout()}},_doLayout:function(t,i){var a=this;if(a.rendered){a._super();var n=a.options,o=n.layoutOptions.rows,r=n.layoutOptions.columns;a.containerWidth=a.containerEl.width(),a.containerHeight=a.containerEl.height(),i="number"===e.type(i)?i:0,a.gridPanel.externalWidth("100%").externalHeight("100%");var l=a.gridPanel.width(),s=a.gridPanel.height();a.tableEl.width("auto").height("auto");var d,c,h,u=n.padding*(r-1),p=n.padding*(o-1),f=a.averageWidth=Math.floor((l-u)/r),g=a.averageHeight=Math.floor((s-p)/o);e.each(n.items,function(t,m){return a.options.itemExtend===!0?(m.setWH(f,g),undefined):(i>0&&n.items.length>t+i||(h=m.__gridContainerId,r=e("#"+h).parent().children().length,o=a.tableEl.find(">tbody>tr").length-m.options.rowSpan,u=n.padding*(r-1),p=n.padding*(o-1),d=m._initConfig.width,"string"===e.type(d)&&/\d+%/.test(d)&&(d=parseInt(d,10),d=Math.floor((l-u)*d/100)),c=m._initConfig.height,"string"===e.type(c)&&/\d+%/.test(c)&&(c=parseInt(c,10),c=Math.floor(s*c/100)),m.setWH(d,c)),undefined)});var m,v;a.tableEl.find(">tbody>tr").each(function(t,i){e(i).children().each(function(i,n){m=t>0?a.options.padding:0,v=i>0?a.options.padding:0,e(n).css({"padding-top":m,"padding-left":v})})});var w=a.tableEl.externalWidth(),_=a.tableEl.externalHeight();w>l?"auto"!==a.panelContentEl.css("overflow-x")&&(a.panelContentEl.css("overflow-x","auto"),a._doLayout()):a.panelContentEl.css("overflow-x","hidden"),_>s?"auto"!==a.panelContentEl.css("overflow-y")&&(a.panelContentEl.css("overflow-y","auto"),a._doLayout()):a.panelContentEl.css("overflow-y","hidden")}},_widgetRender:function(){var t=this;if(t.containerEl){this._super();var i=t.options;e.each(i.items,function(e,i){t._renderItem(i,i.__gridContainerId)})}},_createPanelContent:function(){var n,o,r,l,s,d,c,h,u,p=this,f=p.options,g=f.layoutOptions.rows,m=f.layoutOptions.columns,v=[];for(p.panelContentEl=e("<div>").addClass(t),n=p.gridPanel=e("<div>"),o=p.tableEl=e("<table>"),s=0,h=0;g>h;h++){for(r=e("<tr>"),u=0,c=v.length;m-c>u&&!(s>=f.items.length);)d=f.items[s],e.isPlainObject(d)&&e.isNull(d.options)&&(d.options=e.objCopy(d)),e.isNull(d.options.colSpan)&&(d.options.colSpan=1),e.isNull(d.options.rowSpan)&&(d.options.rowSpan=1),l=p._addTd(d.options.colSpan,d.options.rowSpan),l.appendTo(r),d.__gridContainerId=l.attr("id"),s++,d.options.rowSpan>1&&v.push(d.options.rowSpan),u+=d.options.colSpan;r.appendTo(o);for(var w=v.length-1;w>=0;w--)v[w]-=1,0===v[w]&&v.splice(w,1)}o.addClass(a).appendTo(n),n.addClass(i).appendTo(p.panelContentEl)},_destroyWidget:function(){this.removeRow(),this._super()},_addTd:function(t,i){var a,r,l=this;return a=n+l.options.id+"-"+ ++o,r=e("<td>").attr("id",a),e.isNull(t)||r.attr("colspan",t),e.isNull(i)||r.attr("rowspan",i),r},_renderItem:function(t,i){e.isFunction(t.render)?t.render(i):e.isNull(t.html)?this._error("item is invalid:"+t):e("#"+i).html(t.html)},_addItems:function(t){if(!e.isNull(t)){var i,a,n,o,r,l=this,s=l.options,d=s.layoutOptions.columns,c=[];i=Math.ceil(t.length/d);for(var h=0;i>h;h++){a=e("<tr>");for(var u=0;d>u;u++)n=l._addTd(null,null),n.appendTo(a),c.push({id:o,parentEl:n});a.appendTo(l.tableEl)}l.options.layoutOptions.rows+=i,l.options.items=l.options.items.concat(t),e.each(c,function(e,i){t.length>e&&(r=t[e],r.render(i.id),r.__gridContainerId=i.id)})}},_removeItems:function(){this._error("GridPanel._removeItems() is not supported, please use removeRow() instead.")}}),Sweet.panel.GridPanel=e.sweet.widgetContainerGridpanel}(jQuery),function(e){"use strict";var t="sweet-panel-content",i="sweet-panel-accordionpanel",a="accordion-active",n="accordion-expanded";e.widget("sweet.widgetContainerAccordionpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-accordionpanel]:",type:"accordionPanel",options:{},panelContentEl:null,maxAreaHeight:0,_getAreaHeight:function(){var t=this,i=0,a=0;return e.each(t.panelContentEl.children("h3"),function(t,a){i+=e(a).externalHeight()}),a=t.panelContentEl.height()-i,0>a&&(a=0),a},_doLayout:function(){var t=this,i=t.options.items,a=0,n=0,o=0;if(t.rendered)for(this._super(),a=t._getAreaHeight(),n=t.panelContentEl.width(),o=0;i.length>o;o++){var r=t.options.id+"-content-"+o,l=e("#"+r);l.externalWidth(n),l.css("overflow-x","auto"),l.externalHeight(a),l.css("overflow-y","auto");try{i[o].doLayout()}catch(s){}}},__renderItem:function(t){if(!(0>t||t>=this.options.items.length)){var i=this._contentIdPrefix+t,a=this.options.items[t];null!==a&&(e.isPlainObject(a)&&!e.isNull(a.html)?e("#"+i).html(a.html):a.render(i))}},__createItemArea:function(t){if(!(0>t||t>=this.options.items.length)){var i=this,o=i.options,r=i.panelContentEl,l=o.items,s=null,d=null,c="",h=l[t];null!==h&&(c=e.isPlainObject(h)?h.title:h.options.title,s=e("<h3>").text(c),s.attr("id",this._headerIdPrefix+t).prepend("<i>").appendTo(r),d=e("<div>"),d.attr("id",this._contentIdPrefix+t),d.appendTo(r),0===t?(s.addClass(a),d.addClass(n)):d.hide(),s.click(i._headerClicked))}},__removeItem:function(t){if(!(0>t||t>=this.options.items.length)){var i=this,a=i.options,n=a.items[t],o="";if(null!==n){try{n.destroy()}catch(r){}finally{a.items[t]=null}o="#"+this._headerIdPrefix+t,e(o).unbind().remove(),o="#"+this._contentIdPrefix+t,e(o).remove()}}},__addItem:function(e){if(null!==e){var t=this.options.items.length;this.options.items.push(e),this.__createItemArea(t),this.__renderItem(t),this._doLayout()}},_widgetRender:function(){var t=this;if(t.containerEl){this._super();var i=t.options.items;e.each(i,function(e){t.__renderItem(e)})}},_headerClicked:function(t){var i=null,n="header",o="content",r=t.currentTarget;r.className.indexOf(a)>=0?(e("#"+r.id.replace(n,o)).slideUp(200),e(r).removeClass(a)):(i=e(r).parent().children("."+a),i.length>0&&(i=i[0],e("#"+i.id.replace(n,o)).slideUp(200),e(i).removeClass(a)),e("#"+r.id.replace(n,o)).slideDown(200),e(r).addClass(a))},_createPanelContent:function(){var a=this,n=a.options,o=a.panelContentEl=e("<div>"),r=n.items,l=0;for(this._headerIdPrefix=n.id+"-header-",this._contentIdPrefix=n.id+"-content-",l=0;r.length>l;l++)a.__createItemArea(l);o.addClass(t).addClass(i)},_addItems:function(t){var i,a=this;if(!e.isNull(t))for(i=0;t.length>i;i++)a.__addItem(t[i])},_removeItems:function(t){var i,a,n=this,o=0,r=0;if(e.isNull(t))for(o=n.options.items.length-1;o>=0;o--)n.__removeItem(o);else for(t.sort(),o=t.length-1;o>=0;o--){if(i=t[o],i>=n.options.items.length)return;for(a=-1,r=0;n.options.items.length>r&&(null===n.options.items[r]||(a+=1,a!==i));r++);this.__removeItem(r)}},_destroyWidget:function(){this._removeItems(),this._super()}}),Sweet.panel.AccordionPanel=e.sweet.widgetContainerAccordionpanel}(jQuery),function(e){"use strict";var t="sweet-panel-content",i="sweet-panel-borderpanel",a="sweet-panel-borderpanel-helper-ns",n="sweet-panel-borderpanel-helper-we",o="jumper",r="collapsed",l="resize-ns",s="resize-we",d="north",c="center",h="south",u="west",p="east",f=[c,d,h,u,p],g=11;e.widget("sweet.widgetContainerBorderpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-borderpanel]:",type:"borderPanel",options:{padding:5,rtSizing:!1,hiddenModel:!0,items:null},setItemSize:function(t,i,a){e.inArray(t,f)&&(e.isNull(i)||(this.initSize[t].width=i),e.isNull(a)||(this.initSize[t].height=a),this._doLayout())},_getCanvasObject:function(){var t=this,i=null,a=t.options,n=a.items?a.items.length:0;if(1===n)i=a.items[0].getCanvasObject();else if(n>1){var o=t.renderEl,r=o.height(),l=o.width();i=e("<canvas>").attr({width:l,height:r}),i=i[0];for(var s=a.padding,f=0,g=0,m=i.getContext("2d"),v=[d,c,h],w=[u,c,p],_=0;v.length>_;_++){var C=v[_],b=t._getItemByPortion(C);if(!e.isNull(b)){if(C===c){var E=v[_+1],y=t._getItemByPortion(E),x=v[_-1],T=t._getItemByPortion(x);if(e.isNull(y)&&e.isNull(T))continue}var D,S=b.getWidth(),k=b.getHeight();if(e.isNotNull(D)&&e.isFunction(D.getContext)){var L=D.getContext("2d"),N=L.getImageData(0,0,S,k);m.putImageData(N,f,g),g+=k+(_===n-1?0:s)}}}for(var _=0;w.length>_;_++){var C=w[_],b=t._getItemByPortion(C);if(!e.isNull(b)){if(C===c){var E=w[_+1],y=t._getItemByPortion(E),x=w[_-1],T=t._getItemByPortion(x);if(e.isNull(y)&&e.isNull(T))continue}var D,S=b.getWidth(),k=b.getHeight();if(e.isNotNull(D)&&e.isFunction(D.getContext)){var L=D.getContext("2d"),N=L.getImageData(0,0,S,k);m.putImageData(N,f,g),g+=S+(_===n-1?0:s)}}}}return i},resizeBtnClick:function(){var e=this;e.handleEl&&e.handleEl.click()},_getItemByPortion:function(t){var i=this.options.items,a=null,n=null;if(e.isNull(t))return null;for(var o=0;i.length>o;o++)if(a=i[o],null!==a&&(n=this._getItemPortion(a),null!==n&&n===t))return a;return null},_getAreaByPortion:function(t){var i=this,a="#"+i.options.id+"-portion-"+t;return e(a)},_getGapByPortion:function(t){var i=this,a="#"+i.options.id+"-gap-"+t;return e(a)},_getItemPortion:function(t){return null===t?null:e.isPlainObject(t)?t.portion?t.portion:c:t.options.portion?t.options.portion:c},_buildItemOptions:function(t){if(e.isPlainObject(t)&&!t.hasOwnProperty("options")){var i={},a=null;for(a in t)t.hasOwnProperty(a)&&(i[a]=t[a]);t.options=i}},_doLayout:function(){function t(){for(N=0;f.length>N;N++)L=f[N],v=s._getItemByPortion(L),e.isNull(m[L])&&(m[L]=null===v?{width:0,height:0}:{width:v.options.width,height:v.options.height})}function i(){for(k=[d,h],N=0;k.length>N;N++)L=k[N],v=s._getItemByPortion(L),w=s._getAreaByPortion(L),_=s._getGapByPortion(L),null!==v?(C=r,b=s.initSize[L].height,"string"==typeof b&&b.match(/\d+%/)&&(b=Math.round((l-T)*parseInt(b,10)/100)),(!1===s.options.hiddenModel||"false"===s.options.hiddenModel)&&w.css({visibility:""}),w.width(C).height(b).show(),n=C,o=v.options&&v.options.resizable?g:D,_.width(n).height(o).show(),e.isPlainObject(v)||(v.setWH(C,b),S=v.getHeight(),S!==b&&0!==b&&(b=S,w.height(b))),0===b&&(!1===s.options.hiddenModel||"false"===s.options.hiddenModel?w.css({visibility:"hidden"}):w.hide()),y=y-b-o):(!1===s.options.hiddenModel||"false"===s.options.hiddenModel?w.width(C).height(0).css({visibility:"hidden"}):w.width(C).height(0).hide(),_.width(C).height(0).hide())}function a(){for(k=[u,p],N=0;k.length>N;N++)if(L=k[N],v=s._getItemByPortion(L),w=s._getAreaByPortion(L),_=s._getGapByPortion(L),null!==v){if(C=m[L].width,b=y,"string"==typeof C&&C.match(/\d+%/)&&(C=Math.round((r-x)*parseInt(C,10)/100)),(!1===s.options.hiddenModel||"false"===s.options.hiddenModel)&&w.css({visibility:""}),w.width(C).height(b).show(),n=v.options&&v.options.resizable?g:D,o=b,_.width(n).height(o).show(),e.isPlainObject(v)||v.setWH(C,b),_.children().length>0){var t=_.children().first(),i=Math.round((_.height()-t.height())/2);t.css("margin-top",i+"px")}0===C&&(!1===s.options.hiddenModel||"false"===s.options.hiddenModel?w.css({visibility:"hidden"}):w.hide()),E=E-C-n}else!1===s.options.hiddenModel||"false"===s.options.hiddenModel?w.width(0).height(b).css({visibility:"hidden"}):w.width(0).height(b).hide(),_.width(0).height(D).hide()}var n,o,r,l,s=this,m=s.initSize,v=null,w=null,_=null,C=0,b=0,E=0,y=0,x=0,T=0,D=s.options.padding,S=0,k=[],L="",N=0;if(s.rendered&&0!==s.options.items.length){for(this._super(),r=E=s.panelContentEl.width(),l=y=s.panelContentEl.height(),N=0;f.length>N;N++)L=f[N],v=s._getItemByPortion(L),null!==v&&(L===d||L===h?(o=v.options&&v.options.resizable?g:D,T+=o):(L===u||L===p)&&(n=v.options&&v.options.resizable?g:D,x+=n));t(),i(),v=s.panelContentEl.children("div[class=portion-middle]"),v.width(r),v.height(y),a(),v=s._getItemByPortion(c),w=s._getAreaByPortion(c),null!==v?(w.width(E).height(y),e.isPlainObject(v)||(v.setWidth(E),v.setHeight(y))):s._error("Center portion is required!")}},_getMaxSize:function(e){var t=this,i=t._getItemByPortion(e),a=i.options.maxWidth||i.maxWidth||0,n=i.options.maxHeight||i.maxHeight||0;return 0!==a||e!==u&&e!==p||(a=t._getAreaByPortion(e).width()+t._getAreaByPortion(c).width()),0!==n||e!==d&&e!==h||(n=t._getAreaByPortion(e).height()+t._getAreaByPortion(c).height()),{width:a,height:n}},_getMinSize:function(e){var t=this,i=t._getItemByPortion(e),a=i.options.minWidth||i.minWidth||0,n=i.options.minHeight||i.minHeight||0;return{width:a,height:n}},_resizable:function(t){function i(i){return e(i.target).hasClass(o)?!1:(E=i.pageX,y=i.pageY,x=C.width(),T=C.height(),S=v._getMaxSize(t),k=v._getMinSize(t),D=!0,e(document).bind("mousemove",g),e(document).bind("mouseup",f),v.options.rtSizing===!1&&(L=e("<div>").appendTo(v.panelContentEl),L.css("z-index",-1),L.css({left:w.position().left,top:w.position().top}),L.width(w.width()).height(w.height()),t===d||t===h?L.addClass(a):L.addClass(n)),i.preventDefault(),undefined)}function f(){D===!0&&(D=!1,e(document).unbind("mousemove",g),e(document).unbind("mouseup",f)),v.options.rtSizing===!1&&(L.remove(),v._doLayout())}function g(i){if(D){var a=i.pageX-E,n=i.pageY-y,o=0,l=0;t===d&&(l=T+n,l=l>S.height?S.height:l,l=k.height>l?k.height:l,v.initSize[t].height=l),t===h&&(l=T-n,l=l>S.height?S.height:l,l=k.height>l?k.height:l,v.initSize[t].height=l),t===u&&(o=x+a,o=o>S.width?S.width:o,o=k.width>o?k.width:o,v.initSize[t].width=o),t===p&&(o=x-a,o=o>S.width?S.width:o,o=k.width>o?k.width:o,v.initSize[t].width=o),C.attr(N,null),b.removeClass(r),v.options.rtSizing===!1?("-1"===L.css("z-index")&&L.css("z-index",e.getMaxZIndex()),t===d?L.css("top",w.position().top+(l-T)):t===h?L.css("top",w.position().top-(l-T)):t===u?L.css("left",w.position().left+(o-x)):t===p&&L.css("left",w.position().left-(o-x))):v._doLayout(),i.preventDefault()}}function m(){var i=C.attr(N);t===d||t===h?e.isNull(i)?(C.attr(N,C.height()),b.addClass(r),v.initSize[t].height=0):(C.attr(N,null),b.removeClass(r),v.initSize[t].height=parseInt(i,10)):e.isNull(i)?(C.attr(N,C.width()),b.addClass(r),v.initSize[t].width=0):(C.attr(N,null),b.removeClass(r),v.initSize[t].width=parseInt(i,10)),v._doLayout()}var v=this,w=null,_=null,C=null,b=null,E=0,y=0,x=0,T=0,D=!1,S=null,k=null,L=null,N="oldSize";w=v._getGapByPortion(t),_=v._getItemByPortion(t),C=v._getAreaByPortion(t),null!==w&&t!==c&&(null!==_&&_.options.resizable===!0?(b=e("<div>").addClass(o).appendTo(w),v.handleEl=b,b.bind("click",m),w.bind("dblclick",m),w.bind("mousedown",i),(t===d||t===h)&&w.addClass(l),(t===u||t===p)&&w.addClass(s)):(b=w.children().first(),b.length>0&&b.unbind(),w.unbind(),w.empty(),w.removeClass(s).removeClass(l)))},_renderItem:function(t,i){var a=this,n=null,o=null;n=a._getAreaByPortion(i),o=a._getGapByPortion(i),null!==t&&(e.isFunction(t.render)?t.render(n.attr("id")):e.isNull(t.html)||n.html(t.html),null!==o&&o.show(),a._resizable(i))},_addItem:function(e){if(null===e)return!1;var t=this;t._buildItemOptions(e);var i=t._getItemPortion(e),a=t._getAreaByPortion(i),n=t._getGapByPortion(i);return a&&a.show(),n&&n.show(),null!==t._getItemByPortion(i)?!1:(t.initSize[i]={width:e.options.width,height:e.options.height},t.options.items.push(e),t._renderItem(e,i),t._doLayout(),!0)},_removeItem:function(t){var i=this,a=null,n=null,o=null,r=0;if(a=i._getAreaByPortion(t),n=i._getGapByPortion(t),o=i._getItemByPortion(t),null===o)return!1;try{for(r=0;i.options.items.length>r&&i.options.items[r]!==o;r++);e.isFunction(o.destroy)&&o.destroy(),i.options.items.splice(r,1)}catch(l){}return a.empty(),(!1===i.options.hiddenModel||"false"===i.options.hiddenModel)&&a.css({visibility:""}),a.width(0).height(0).hide(),n.width(0).height(0).hide(),i.initSize[t].width=0,i.initSize[t].height=0,i._doLayout(),i._resizable(t),!0},_widgetRender:function(){var e=this,t=null,i="",a=0;if(e.containerEl)for(this._super(),a=0;f.length>a;a++)i=f[a],t=e._getItemByPortion(i),e._buildItemOptions(t),e._renderItem(t,i)},_createPanelContent:function(){var a=this,n=a.options,o=a.panelContentEl=e("<div>"),r=n.id+"-portion-",l=n.id+"-gap-",s=null,f="portion-",g="gap-";a.initSize={},null==n.items&&(n.items=[]),e("<div>").attr("id",r+d).addClass(f+d).appendTo(o),e("<div>").attr("id",l+d).addClass(g+d).hide().appendTo(o),s=e("<div>").attr("id",r+"middle").addClass(f+"middle").appendTo(o),e("<div>").attr("id",r+u).addClass(f+u).appendTo(s),e("<div>").attr("id",l+u).addClass(g+u).hide().appendTo(s),e("<div>").attr("id",r+c).addClass(f+c).appendTo(s),e("<div>").attr("id",l+p).addClass(g+p).hide().appendTo(s),e("<div>").attr("id",r+p).addClass(f+p).appendTo(s),e("<div>").attr("id",l+h).addClass(g+h).hide().appendTo(o),e("<div>").attr("id",r+h).addClass(f+h).appendTo(o),o.find("div").width(0).height(0),o.addClass(t).addClass(i)},_addItems:function(t){var i,a=this;if(!e.isNull(t))for(i=0;t.length>i;i++)a._addItem(t[i])},_removeItems:function(t){var i=this;if(e.isNull(t))return i._removeItem(d),i._removeItem(h),i._removeItem(u),i._removeItem(p),i._removeItem(c),undefined;for(var a=0;t.length>a;a++)i._removeItem(t[a])},_destroyWidget:function(){this._removeItems(),this._super()}}),Sweet.panel.BorderPanel=e.sweet.widgetContainerBorderpanel}(jQuery),function(e){"use strict";var t="sweet-panel-content",i="sweet-tabpanel",a="tab-navigator",n="tab-card",o="tab-card-slide",r="tab-content",l="tab-left",s="tab-right",d="tab-list",c="tab-list-close-button",h="tab-list-seperator",u="tab-all",p="sweet-tabpanel-all-list",f="active",g="hover",m="invisible",v="li[visible!=false]",w="li[visible=false]",_=1,C=10,b=25;e.widget("sweet.widgetContainerTabpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-tabpanel]:",eventNames:{tabchanged:"Tab标签切换",tabclosed:"Tab标签关闭"},options:{closable:!1,activeTab:0,style:_,items:[],listeners:[],bgColor:"yes"},setActiveTab:function(t){var i,a;if("string"===e.type(t)){for(a=0;this.options.items.length>a;a++)if(i=this.options.items[a],i.options&&i.options.id===t||i.id&&i.id===t){this._activeTab(a);break}}else"number"===e.type(t)?this._activeTab(t):this._error("target id is invalide["+t+"]")},getActiveTab:function(){return this.options.activeTab},getItem:function(t){var i,a;if("string"===e.type(t)){for(a=0;this.options.items.length>a;a++)if(i=this.options.items[a],i.options&&i.options.id===t||i.id&&i.id===t)return i;return null}return"number"===e.type(t)?0>t||t>=this.options.items.length?null:this.options.items[t]:null},addTab:function(e){var t=this,i=t.options;null!==e&&(t.options.items.push(e),t._addTab(e),t._activeTab(i.items.length-1))},_doLayout:function(){var t=this;if(t.rendered&&(t._super(),null!==t.tabListEl)){C>t.options.style?t._tablistLayoutHorizontal():t._tablistLayoutVertical();var i=t.options.items[t.options.activeTab];!e.isNull(i)&&e.isFunction(i.doLayout)&&i.doLayout()}},_tablistLayoutHorizontal:function(){var t=this,i=0,a=5,n=t.panelContentEl.width()-a,o=0,r=!1;if(t.tabListEl.find("li").each(function(t,a){i+=e(a).externalWidth()}),t.tabLeftEl.hasClass(m)||(r=!0),i>n&&!r){t.tabLeftEl.removeClass(m),t.tabRightEl.removeClass(m),t.tabAllEl.removeClass(m);var l=t.getActiveTab();l===t.options.items.length-1&&t._activeTab(l)}else n>=i&&r&&(t.tabLeftEl.addClass(m),t.tabRightEl.addClass(m),t.tabAllEl.addClass(m),t._scrollList("right",65535));o=n-t.tabLeftEl.externalWidth(),o-=t.tabRightEl.externalWidth(),o-=t.tabAllEl.externalWidth(),t.tabListEl.externalWidth(o)},_tablistLayoutVertical:function(){var t,i,a,n=this,o=0,r=n.panelContentEl.height(),l=!1,s=n.tabListEl.children("div").first();if(n.tabListEl.find("li").each(function(t,i){o+=e(i).externalHeight()}),n.tabLeftEl.hasClass(m)||(l=!0),o>r){n.tabLeftEl.removeClass(m),n.tabRightEl.removeClass(m),s.position().top>=0&&n.tabLeftEl.addClass(m),r>=s.position().top+o&&n.tabRightEl.addClass(m);var d=n.getActiveTab();d===n.options.items.length-1&&n._activeTab(d)}else r>=o&&(n.tabLeftEl.addClass(m),n.tabRightEl.addClass(m),n._scrollList("right",65535));t=n.cardPanelEl.width(),i=n.cardPanelEl.height(),n.cardSlideEl.width(t).height(i*n.options.items.length),n.cardSlideEl.children().each(function(o,r){a=e(r),a.externalWidth(t).externalHeight(i).show(),0===a.children().length&&n._renderItem(n.options.items[o],a.attr("id")),e.isFunction(n.options.items[o].doLayout)&&n.options.items[o].doLayout()})},_widgetRender:function(){var t=this.options,i=this;i.containerEl&&(this._super(),e.each(t.listeners,function(e,t){i.addListener(e,t)}),e.each(t.items,function(e,t){i._addTab(t)}),e.isNull(this.options.activeTab)?this._activeTab(0):this._activeTab(this.options.activeTab))},_createPanelContent:function(){var r=this;this.tabLeftEl=null,this.tabRightEl=null,this.tabListEl=null,this.tabAllEl=null,this.tabHeaderEl=null,this.cardPanelEl=null,this.tabMenuEl=null,this.tabItemId=100;var c=r.panelContentEl=e("<div>"),h="<div><span></span></div>",p=this.tabLeftEl=e(h),f=this.tabRightEl=e(h),g=this.tabListEl=e("<div><div><ul></ul></div></div>"),m=this.tabAllEl=e(h),v=this.tabHeaderEl=e("<div>"),w=this.cardPanelEl=e("<div>"),_=this.cardSlideEl=null;p.addClass(l).bind("mousedown",function(){r.leftPushing=!0,r.rightPushing=!1,r._onLeftClick()}).bind("mouseup mouseleave",function(){r.leftPushing=!1}).appendTo(v),g.addClass(d).appendTo(v),g.children("div").css("left","0px"),g.attr("id",this.options.id+"-tab-list"),g.onMouseWheel(g.get(0),function(e,t){return r._wheelScrollList(e,t),!1}),m.addClass(u).bind("click",{self:r},r._onAllClick).appendTo(v),f.addClass(s).bind("mousedown",function(){r.leftPushing=!1,r.rightPushing=!0,r._onRightClick()}).bind("mouseup mouseleave",function(){r.rightPushing=!1}).appendTo(v),v.addClass(a).appendTo(c),w.addClass(n).appendTo(c),11===r.options.style&&"none"===r.options.bgColor?c.addClass(t).addClass(i+"-"+r.options.style).addClass(i+"-bg-color-"+12):c.addClass(t).addClass(i+"-"+r.options.style).addClass(i+"-bg-color-"+r.options.style),this.options.style>=C&&(_=this.cardSlideEl=e("<div>"),_.addClass(o).appendTo(w),this.tabListSliderEl=this.tabAllEl,p.detach().appendTo(c),f.detach().appendTo(c),m.unbind())},_destroyWidget:function(){this._removeItems(),this.tabLeftEl&&this.tabLeftEl.unbind(),this.tabRightEl&&this.tabRightEl.unbind(),this.tabAllEl&&this.tabAllEl.unbind(),this._super()},_renderItem:function(t,i){if(t.render)t.render(i);else if(e.isNull(t.url)){if(e.isNull(t.html))return this._error("Invalid item object in tab, "+i),!1;e("#"+i).html(t.html)}else{var a='<iframe frameborder="0" style="width:100%; height:100%;" src="'+t.url+'" allowtransparency="true"></iframe>';e("#"+i).css("overflow","hidden").html(a)}return!0},_activeTab:function(t){if(e.isNull(t))return this._error("_activeTab(): id is invalid["+t+"]"),undefined;if(!(0>t||t>=this.options.items.length)){var i=this,a=this.options,n="#"+i.tabListEl.find("li").eq(t).attr("id"),o=i.tabListEl.children("div").first(),r=e(n).attr("target"),l=null,s=null,d=0,c=null;if(0===e("#"+r).children().length&&i._renderItem(a.items[t],r),this.tabListEl.find("li").each(function(t,i){e(i).hasClass(f)&&(c=t,e(i).removeClass(f),l=e(i).attr("target"),C>a.style&&e("#"+l).css("left",-1e4))}),a.activeTab=t,s=e(n),a.style>=C?i.tabListSliderEl.stop().animate({top:e(n).position().top+o.position().top},100,function(){s.addClass(f)}):s.addClass(f),"false"===s.attr("visible")){for(C>a.style?e("#"+r).css("left",""):this._switchCard(r,"slide");"false"===s.attr("visible");)d++,s=s.next();i._scrollList("right",d)}else if(C>a.style){e("#"+r).css("left","");var h=s.position().left+e.externalSize(s).width+i.tabListEl.children("div").first().position().left-i.tabListEl.width(),u=0;if(h>0&&i.tabListEl.width()>0&&i.tabLeftEl.is(":visible")){for(s=i.tabListEl.find(v).first();h>u;)u+=e.externalSize(s).width,d++,s=s.next();i._scrollList("left",d)}}else a.style>=C&&this._switchCard(r,"slide");e.isFunction(a.items[t].doLayout)&&a.items[t].doLayout(!0),i.options.activeTab=t,c!==t&&i._onTabChange(c,t)}},_addTab:function(t){var i=this,a=this.options,n=e("<div>"),o=null,l=null,s=null,d="",u=i.tabItemId++;return e.isPlainObject(t)&&e.isNull(t.options)&&(t.options=e.objClone(t)),d=t.options.title,o=e("<li unselectable='on'></li>"),l=e("<span>").addClass(c),s=e("<span>").addClass(h),o.text(d.length>b?d.substr(0,b-3)+"...":d).attr("id",a.id+"-tab-"+u).attr("target",a.id+"-content-"+u).attr("title",d).bind("click",{self:i},i._onTabClick).hover(function(){e(this).hasClass(f)===!1&&e(this).addClass(g)},function(){e(this).removeClass(g)}).appendTo(i.tabListEl.find("ul")),a.style>=10&&o.attr("title",null),l.appendTo(o),s.appendTo(o),C>a.style&&(a.closable===!0?(l.bind("click",{self:i},i._onTabClose),o.bind("contextmenu",{self:i},i._onTabContextMenu)):l.hide()),n.attr("id",a.id+"-content-"+u).addClass(r).appendTo(this.cardSlideEl||this.cardPanelEl),10>a.style&&n.css("left",-1e4),u},_closeTab:function(t){function i(){o.remove();try{var t=a.options.items[l];a.options.items.splice(l,1),e.isFunction(t.destroy)&&t.destroy()}catch(i){}if(e("#"+r).remove(),n||1===a.options.items.length){if(l>=a.options.items.length){for(l--;l>=0&&a.tabListEl.find("li").hasClass(m);)l--;0>l&&a.tabListEl.find("li").each(function(t,i){l>=0||e(i).hasClass(m)||(l=t)})}l>=0&&a._activeTab(l)}C>a.options.style?a._tablistLayoutHorizontal():a._tablistLayoutVertical()}var a=this,n=!1,o=null,r=null,l=t;o=a.tabListEl.find("li").eq(l),0!==o.length&&(r=o.attr("target"),o.hasClass(f)&&(n=!0),e.isNull(this.handlers)||e.isNull(this.handlers.tabclosed)||this.handlers.tabclosed.call(this.treeEl,new Event("tabclosed"),a.options.items[l]),a.options.items.length-1>l&&a.options.items.length>1?o.animate({width:"0px",opacity:0},{duration:200,complete:i}):i())},_wheelScrollList:function(e,t){var i=t.delta;i>0?this.tabLeftEl.hasClass(m)===!1&&this._onLeftClick():this.tabRightEl.hasClass(m)===!1&&this._onRightClick()},_scrollList:function(e,t){var i=this,a=null,n=null,o=0,r=0,l=null,s=0,d=-1;if(a=i.tabListEl.children("div").first(),"left"===e)for(l=a.find(v).first();0!==l.length&&t>s;)l.attr("visible","false"),l=l.next(),s++;else for(l=a.find(w).last();0!==l.length&&t>s;)l.attr("visible","true"),l=l.prev(),s++;n=a.find(v).first(),n.length>0&&(C>this.options.style?(o=n.position().left,o*=d):(r=n.position().top,r*=d),a.stop().animate({left:o+"px",top:r+"px"},{duration:200,complete:function(){i.options.style>=10&&i._tablistLayoutVertical(),i.leftPushing?i._onLeftClick():i.rightPushing&&i._onRightClick()}}),i.options.style>=C&&a.find("li."+f).length>0&&this.tabListSliderEl.stop().animate({top:a.find("li."+f).first().position().top+r},200))},_switchCard:function(t,i){var a=0,n=e("#"+t);return"slide"!==i?(this._error("animation effect is not supported: "+i),undefined):(null!==this.cardSlideEl&&(a=n.position().top,this.cardSlideEl.animate({top:-a},{duration:300,easing:"easeOutCirc"})),undefined)},_onTabClick:function(t){var i=t.data.self,a=e(this),n=0,o=a.attr("id");i.tabListEl.find("li").each(function(t,i){e(i).attr("id")===o&&(n=t)}),i._activeTab(n)},_onLeftClick:function(){var e=this;e.tabListEl.find(w).length>0&&e._scrollList("right",1)},_onRightClick:function(){var t=this,i=0,a=0;t.tabListEl.find(v).each(function(t,n){i+=e(n).externalWidth(),a+=e(n).externalHeight()}),(C>t.options.style&&i>t.tabListEl.width()||t.options.style>=C&&a>t.tabListEl.height())&&t._scrollList("left",1)},_onAllClick:function(t){function i(t){var n=t.target;n!==r[0]&&n!==r.children("ul")[0]&&(r.find("li").each(function(t,i){i===n&&a._activeTab(parseInt(e(i).attr("index"),10))}),r.remove(),e("body").unbind("click",i))}var a=t.data.self,n="<div><ul></ul></div>",o="<li>",r=e(n),l=a.tabAllEl,s=null,d=0,c=0;return a.tabListEl.find("li").each(function(t,i){e(i).hasClass(m)||(s=e(o).text(e(i).text()).attr("target",i.id).attr("index",t).appendTo(r.children("ul")),e(i).hasClass(f)&&s.addClass(f))}),r.addClass(p).appendTo("body"),d=l.offset().left+l.outerWidth()-r.outerWidth(),c=a.cardPanelEl.offset().top-5,r.css("top",c+"px").css("left",d+"px"),e("body").bind("click",{self:a},i),!1},_onTabContextMenu:function(t){function i(){o._closeTab(s)}function a(){o._activeTab(s);var t=o.tabListEl.find("li");for(s=t.length-1;s>=0;s--)e(t.get(s)).attr("id")!==l&&o._closeTab(s);o._scrollList("right",65535)}function n(){o._activeTab(0);var e=o.tabListEl.find("li");for(s=e.length-1;s>=0;s--)o._closeTab(s);o._scrollList("right",65535)}var o=t.data.self,r=e(t.currentTarget),l=r.attr("id"),s=-1,d=0,c=o.options.id+"-tab-contextmenu";if(o.tabListEl.find("li").each(function(t,i){e(i).attr("id")===l&&(s=t),d++}),!(0>s)){t.preventDefault(),t.stopPropagation();var h=[{value:"1",text:Sweet.core.i18n.tab.menu.closeCurrent}];if(d>1&&(h.push({value:"2",text:Sweet.core.i18n.tab.menu.closeOthers}),h.push({value:"3",text:Sweet.core.i18n.tab.menu.closeAll})),!e.isNull(o.tabMenuEl))try{o.tabMenuEl.destroy()}catch(u){}return 0===e("#"+c).length&&e("<div>").attr("id",c).appendTo("body"),o.tabMenuEl=new Sweet.menu.Menu({renderTo:c,X:t.clientX,Y:t.clientY,items:h,itemClick:function(e,t){"1"===t.value?i():"2"===t.value?a():"3"===t.value&&n()}}),!1}},_onTabClose:function(t){var i=t.data.self;t.stopPropagation();var a=e(t.currentTarget).parent(),n=0;i.tabListEl.find("li").each(function(t,i){e(i).attr("id")===a.attr("id")&&(n=t)}),i._closeTab(n)},_addItems:function(t){var i,a,n,o,r=this;for(i=0;t.length>i;i++){for(n=e.isPlainObject(t[i])?t[i].id:t[i].options.id,a=0;r.options.items.length>a&&(o=r.options.items[a],o.options.id!==n);a++);r.options.items.length>a?r._activeTab(a):(r.options.items=r.options.items.concat(t[i]),r._addTab(t[i]),0===i&&r._activeTab(r.options.items.length-1))}},_removeItems:function(t){var i,a,n=this;if("undefined"!==e.type(t))for(t.sort(),a=t.length-1;a>=0;a--){if(i=t[a],i>=n.options.items.length)return;this._closeTab(i)}else for(a=n.options.items.length-1;a>=0;a--)n._closeTab(a)},_onTabChange:function(t,i){var a=this,n=null,o=null,r=a.options.items,l=null,s=null;if("number"===e.type(t)&&t>=0&&r.length>t&&(n=r[t]),"number"===e.type(i)&&i>=0&&r.length>i&&(o=r[i]),null!==n&&n.url&&(l=a.tabListEl.find("li").eq(t),s=e("#"+l.attr("target")).children("iframe"),s.length>0))try{s.get(0).contentWindow.tabDeactivated()}catch(d){}if(null!==o&&o.url&&(l=a.tabListEl.find("li").eq(i),s=e("#"+l.attr("target")).children("iframe"),s.length>0))try{s.get(0).contentWindow.tabActivated()}catch(d){}e.isNull(a.handlers)||e.isFunction(a.handlers.tabchanged)&&a.handlers.tabchanged(n,o)},_addListener:function(){},_removeListener:function(e){e=e},_showItem:function(t){var i=-1;if("string"===e.type(t))i=this._getIndexById(t);else{if("number"!==e.type(t))return e.error("hideItem指定的参数不正确"),undefined;i=t}0>i||i>=this.options.items.length||this.tabListEl.find("li").eq(i).removeClass("invisible")},_hideItem:function(t){var i=-1;if("string"===e.type(t))i=this._getIndexById(t);else{if("number"!==e.type(t))return e.error("hideItem指定的参数不正确"),undefined;i=t}0>i||i>=this.options.items.length||(i===this.getActiveTab()&&(i>0?this.setActiveTab(i-1):this.setActiveTab(i+1)),this.tabListEl.find("li").eq(i).addClass("invisible"))},_getIndexById:function(e){var t,i;for(t=0;this.options.items.length>t;t++)if(i=this.options.items[t],i.options&&i.options.id===e||i.id&&i.id===e)return t;return-1},tabchanged:function(t,i){e.log(t+","+i)}}),Sweet.panel.TabPanel=e.sweet.widgetContainerTabpanel}(jQuery),function(e){var t="sweet-panel-content",i="sweet-h-panel",a="sweet-h-panel-table",n=1e3,o="sweet-h-panel-";e.widget("sweet.widgetContainerHpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-Hpanel]:",type:"HPanel",options:{padding:5,itemExtend:!0,align:Sweet.constants.align.LEFT,verticalAlign:Sweet.constants.align.TOP,overflow:Sweet.constants.overflow.HIDDEN},_getCanvasObject:function(){var t=this,i=null,n=t.options,o=n.items?n.items.length:0;
if(1===o)i=n.items[0].getCanvasObject();else if(o>1){var r=t.renderEl.find("."+a),l=r.height(),s=r.width();i=e("<canvas>").attr({width:s,height:l}),i=i[0];for(var d=n.padding,c=0,h=0,u=i.getContext("2d"),p=0;o>p;p++){var f,g=n.items[p],m=g.getWidth(),v=g.getHeight();if(f=g.getCanvasObject(),e.isNotNull(f)&&e.isFunction(f.getContext)){var w=f.getContext("2d"),_=w.getImageData(0,0,m,v);u.putImageData(_,c,h),c+=m+(p===o-1?0:d)}}}return i},_doLayout:function(){var t=this,i=t.options,a=i.items.length;if(t.rendered&&(t._super(),!t.panelContentEl.is(":hidden"))){var n=t.panelContentEl.width(),o=t.panelContentEl.height();t.gridPanel.externalWidth(n).externalHeight(o);var r,l,s=t.gridPanel.width(),d=t.gridPanel.height(),c=(a-1)*i.padding,h=Math.floor((s-c)/a),u=d;e.each(i.items,function(t,a){return i.itemExtend?(a.setWH(h,u),undefined):(r=a._initConfig.width,"string"===e.type(r)&&/\d+%/.test(r)&&(r=parseInt(r,10),r=Math.floor((s-c)*r/100)),l=a._initConfig.height,"string"===e.type(l)&&/\d+%/.test(l)&&(l=parseInt(l,10),l=Math.floor(d*l/100)),a.setWH(r,l),undefined)}),t.itemsParentEl.children().each(function(i,a){0===i?e(a).css("padding-left",0):e(a).css("padding-left",t.options.padding)});var p=t.gridPanel.children().first();i.itemExtend===!1&&(p.width("auto"),r=p.externalWidth(),i.overflow!==Sweet.constants.overflow.HIDDEN&&r>s?p.css("margin-left",0):i.align===Sweet.constants.align.LEFT?p.css("margin-left",0):i.align===Sweet.constants.align.RIGHT?(p.css({position:"absolute",right:"0"}),t.containerEl.css("float","right")):i.align===Sweet.constants.align.CENTER&&(p.css("margin-left",Math.floor((s-r)/2)),t.containerEl.css("margin","0 auto")),(i.verticalAlign===Sweet.constants.align.TOP||i.verticalAlign===Sweet.constants.align.BOTTOM||i.verticalAlign===Sweet.constants.align.MIDDLE)&&t.itemsParentEl.children().css("vertical-align",i.verticalAlign))}},_widgetRender:function(){var e=this;if(e.containerEl){this._super();var t,i=e.options,a=i.items;e.itemsParentEl.children().each(function(i,n){a.length>i&&(t=a[i],e._renderItem(t,n.id))})}},_createPanelContent:function(){var n,o,r,l=this,s=l.options,d=s.items.length,c=e("<table>");l.itemsParentEl=e(),l.panelContentEl=e("<div>").addClass(t),n=l.gridPanel=e("<div>"),s.overflow!==Sweet.constants.overflow.HIDDEN&&n.css("overflow-x",s.overflow),l.itemsParentEl=o=e("<tr>");for(var h=0;d>h;h++)r=l._addArea();o.appendTo(c),c.addClass(a).appendTo(n),n.addClass(i).appendTo(l.panelContentEl)},_destroyWidget:function(){this._removeItems(),this._super()},_addArea:function(){var t,i,a=this;return i=o+a.options.id+"-"+ ++n,t=e("<td>").attr("id",i).appendTo(a.itemsParentEl),i},_renderItem:function(t,i){e.isFunction(t.render)?t.render(i):e.isNull(t.html)?this._error("item is invalid:"+t):(e("#"+i).html(t.html),t.setWH=e.noop,t._initConfig=e.objCopy(t))},_removeItem:function(t){var i,a,n=this;0>t||t>=n.options.items.length||(a=n.itemsParentEl.children().eq(t),i=n.options.items[t],e.isFunction(i.destroy)&&i.destroy(),n.options.items.splice(t,1),a.remove())},_addItems:function(t){if(!e.isArray(t))return 0;var i,a,n,o=this;for(n=0;t.length>n;n++)i=t[n],e.isNull(i)||(a=o._addArea(),o._renderItem(i,a),o.options.items.push(i))},_removeItems:function(e){var t,i,a=this;if(e===undefined)for(e=[],t=0;a.options.items.length>t;t++)e.push(t);for(e.sort(),t=e.length-1;t>=0;t--)i=e[t],a._removeItem(i)}}),Sweet.panel.HPanel=e.sweet.widgetContainerHpanel}(jQuery),function(e){"use strict";var t="sweet-panel-content",i="sweet-v-panel-item-panel",a=1e3,n="sweet-v-panel-item-";e.widget("sweet.widgetContainerVpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-Vpanel]:",type:"VPanel",options:{padding:5},moveItemByIdToHeader:function(t){var i=this,a=i.options,n=a.items;if(!(e.isNull(n)||0>=n.length||e.isNull(t))){var o=i.gridPanelEl.children("div");if(!(e.isNull(o)||1>=o.length)){var r=o.get(0);e.each(o,function(a){var l=e(o[a]),s=l.children("div");if(s.length>0&&e(s[0]).attr("id")===t){l.insertBefore(r);for(var d=null,c=0;n.length>c;c++)if(t==n[c].options.id){d=n[c],n.splice(c,1);break}return e.isNotNull(d)&&(n.unshift(d),i._doLayout()),!0}})}}},_getCanvasObject:function(){var i=this,a=null,n=i.options,o=n.items?n.items.length:0;if(1===o)a=n.items[0].getCanvasObject();else if(o>1){var r=i.renderEl.find("."+t),l=r.children(),s=l.height(),d=l.width();a=e("<canvas>").attr({width:d,height:s}),a=a[0];for(var c=n.padding,h=0,u=0,p=a.getContext("2d"),f=0;o>f;f++){var g,m=n.items[f],v=m.getWidth(),w=m.getHeight();if(g=m.getCanvasObject(),e.isNotNull(g)&&e.isFunction(g.getContext)){var _=g.getContext("2d"),C=_.getImageData(0,0,v,w);p.putImageData(C,h,u),u+=w+(f===o-1?0:c)}}}return a},_doLayout:function(){var t,i,a,n,o,r,l=this,s=l.options;if(l.rendered&&(l._super(),!l.panelContentEl.is(":hidden"))){l.gridPanelEl.width("100%").height("auto"),t=l.gridPanelEl.width(),i=l.panelContentEl.height();var d=l.gridPanelEl.children("div"),c=0,h=0;e.each(d,function(d,u){a=s.items[d],a&&(n=e(u),d>0&&l.options.padding?n.css("padding-top",l.options.padding):n.css("padding-top","0px"),n.externalWidth(t),r=a._initConfig.height,"string"===e.type(r)&&/\d+%/.test(r)&&(r=parseInt(r,10),r=Math.floor(i*r/100),a.setHeight(r),n.height(r)),e.isFunction(a.doLayout)&&a.doLayout(),c+=n.externalHeight(),o=n.externalWidth(),o>h&&(h=o))}),i=l.panelContentEl.height(),"auto"===l.options.height?(l._setHeight(l.getHeight()+c-i),l.panelContentEl.externalHeight(c)):(t=l.panelContentEl.width(),i=l.panelContentEl.height(),c>i?"auto"!==l.panelContentEl.css("overflow-y")&&(l.panelContentEl.css("overflow-y","auto"),l._doLayout()):l.panelContentEl.css("overflow-y","hidden"),h>t?"auto"!==l.panelContentEl.css("overflow-x")&&(l.panelContentEl.css("overflow-x","auto"),l._doLayout()):l.panelContentEl.css("overflow-x","hidden"))}},_widgetRender:function(){var t=this;if(t.containerEl){this._super();var i=t.options,a=i.items,n=t.gridPanelEl.children("div");e.each(n,function(e,i){t._renderItem(a[e],i.id)})}},_createPanelContent:function(){var i=this,a=i.options,n=a.items.length;i.panelContentEl=e("<div>").addClass(t),i.gridPanelEl=e("<div>").appendTo(i.panelContentEl);for(var o=0;n>o;o++)i._addItemPanel()},_destroyWidget:function(){this._removeItems(),this._super()},_addItemPanel:function(){var t=this,o=n+t.options.id+"-"+ ++a,r=e("<div>").attr("id",o).addClass(i);return r.appendTo(t.gridPanelEl),o},_renderItem:function(t,i){var a=e("#"+i);if(0!==a.length)if(e.isPlainObject(t))t.options=e.objCopy(t),t._initConfig=e.objCopy(t),"string"==typeof t.html&&a.html(t.html);else try{t.render(i)}catch(n){}},_addItems:function(t){if(!e.isNull(t)){var i,a=this,n=a.options;n.items=n.items.concat(t);for(var o=0;t.length>o;o++)i=a._addItemPanel(),a._renderItem(t[o],i)}},_removeItems:function(t){var i,a,n,o=this,r=o.gridPanelEl.children("div");if(e.isNull(t))return e.each(o.options.items,function(t,i){e.isFunction(i.destroy)&&i.destroy()}),o.options.items=[],o.gridPanelEl.empty(),void 0;t.sort();for(var l=t.length-1;l>=0;l--)n=t[l],n>=o.options.items.length||(a=r.eq(n),i=o.options.items[n],e.isFunction(i.destroy)&&i.destroy(),o.options.items.splice(n,1),a.remove())}}),Sweet.panel.VPanel=e.sweet.widgetContainerVpanel}(jQuery),function(e){var t=0,i="sweet-portal-column",a="sweet-portal-place-holder",n="sweet-portal-column-block";e.widget("sweet.widgetContainerPortal",e.sweet.widgetContainer,{version:"1.0",sweetWidgetName:"[widget-container-portal]:",type:"Portal",options:{columns:1,items:[]},eventNames:{ds_node_minimize:"子组件最小化事件",ds_node_maximize:"子组件最大化事件",ds_node_close:"子组件关闭事件"},_addEventHandler:function(){var t=this;e(t.containerEl).on("ds_node_minimize",function(){}).on("ds_node_maximize",function(){}).on("ds_node_close",function(){})},_doLayout:function(){var t=this;if(t.rendered){var i,a,n,o=t.options,r=o.columns,l=0,s=0;a=t.containerEl.width(),n=t.containerEl.height(),i=Math.floor((a-6*r-20)/r),e.each(t.columnEls,function(e,t){t.css({padding:"5px",width:i}),t.externalHeight()>l&&(l=t.externalHeight()),s+=t.externalWidth()}),e.each(t.widgets,function(e,t){t.widgetContainer.css({"margin-bottom":"5px",width:"100%",height:"300px"})}),l>n?t.containerEl.css("overflow-y","auto"):t.containerEl.css("overflow-y","hidden"),s>a?t.containerEl.css("overflow-x","auto"):t.containerEl.css("overflow-x","hidden")}},_widgetRender:function(){for(var t=this,n=0;t.columnEls.length>n;n++)t.columnEls[n].appendTo(t.containerEl);e("."+i).sortable({connectWith:"."+i,placeholder:a,forcePlaceholderSize:!0,forceHelperSize:!0}),e("."+i).disableSelection(),t._renderItems(),t._addEventHandler()},_createContainer:function(){var e=this,t=e.options,i=t.items;e.items=i,e._createColumnEls(),e._createItems(i)},_createColumnEls:function(){var t,a=this,n=a.options,o=n.columns,r=[];0>=o&&(o=1);for(var l=0;o>l;l++)t=e("<div>").addClass(i),r.push(t);a.columnEls=r},_createItems:function(i){if(!e.isNull(i)){var a,o,r=this,l=r.options,s=r.columnEls,d=r.columnEls.length,c=i.length,h=[],u=[],p=-1;l.items=l.items.concat(i);for(var f=0;c>f;f++)o=i[f],o.options.hasOwnProperty("columnIndex")&&(p=o.options.columnIndex),p=-1===p?f%d:p>=d?d-1:p,u[p]||(u[p]=[]),u[p].push(o);for(var g=0;d>g;g++)if(u[g]){u[g].sort(r._blockSortFunction),a=s[g];for(var m=0;u[g].length>m;m++){var v={};v.id="sweet-container-portal-"+t++,v.widgetContainer=e("<div>").addClass(n),v.widgetContainer.attr("id",v.id),v.widget=u[g][m],a.append(v.widgetContainer),h.push(v)}}r.widgets=h}},addItems:function(e){this.items=e,this._createItems(e),this._renderItems()},_blockSortFunction:function(e,t){var i=0;if(e.options.hasOwnProperty("rowIndex")&&e.options.hasOwnProperty("columnIndex")&&t.options.hasOwnProperty("rowIndex")&&t.options.hasOwnProperty("columnIndex")){var a=e.options.rowIndex,n=e.options.columnIndex,o=t.options.rowIndex,r=t.options.columnIndex;if(n===r){if(a>o)return 1;if(o>a)return-1}else{if(n>r)return 1;if(r>n)return-1}}return i},_renderItems:function(){var t=this;e.each(t.widgets,function(e,t){t.widget.render(t.id)})}}),Sweet.container.Portal=e.sweet.widgetContainerPortal}(jQuery),function(e){var t="sweet-wizard-left-selected",i="sweet-wizard-right",a="sweet-wizard-right-selected",n="sweet-wizard-step-unselected",o="sweet-wizard-step-selected",r="unselected",l="selected",s="sweet-wizard-text-unselected",d="sweet-wizard-text-selected",c="-wizard-bottom",h="-wizard-content",u="sweet-wizard-compact",p=[1,2,3,4];e.widget("sweet.widgetContainerWizardpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-wizardpanel]:",type:"WizardPanel",eventNames:{prevClick:"上一步事件",nextClick:"下一步事件",doneClick:"完成事件",saveClick:"保存事件"},options:{listeners:null,items:[],tip:!1,saveBtn:!1,afterShow:null,compact:!1},setCurrentStep:function(t){if(!(e.isNull(t)||0>t||t>this.maxStep)&&t!==this.currentStep){for(;this.currentStep!==t;)this.currentStep>t?this._onPrevClick(this):this._onNextClick(this);this._refreshButtonStatus()}},getSaveButton:function(){var e=this;return e.options.saveBtn&&e.saveButtonEl?e.saveButtonEl:null},_doLayout:function(){var t,i,a,n,o,s,d,c,h=this;if(h.rendered){h._super();var u=h.options,p=u.items.length,f=h.panelContentEl.width(),g=h.panelContentEl.height(),m=h.leftEl.width(),v=h.rightEl.width(),w=h.wizardEl.find("li > span").width(),_=h.wizardEl.height(),C=h.bottomEl.height();t=f-m-v-w*p,i=t/(2*(p+1)),h.wizardEl.find("."+r).externalWidth(i),h.wizardEl.find("."+l).externalWidth(i),a=m+i,n=f-m-v-2*i+2,o=2*i+w,h.textEl.css("left",a).externalWidth(n).children().externalWidth(o),d=u.compact===!0?0:h.textEl.height(),s=g-_-d-C-10,h.contentEl.externalWidth(f).externalHeight(s),h.contentEl.children("div").each(function(t,i){e(i).externalWidth(h.contentEl.width()).externalHeight(h.contentEl.height())}),h.bottomEl.externalWidth(f);for(var b=0;this.options.items.length>b;b++)c=this.options.items[b].item,!e.isNull(c)&&e.isFunction(c.doLayout)&&c.doLayout()}},_widgetRender:function(){var e,t,i=this,a=i.options,n=a.items,o=n.length;if(i.containerEl){e=i.bottomEl.attr("id"),i.panelContentEl.appendTo(i.containerEl),i.doneButtonEl.render(e),i.nextButtonEl.render(e),i.prevButtonEl.render(e),a.saveBtn&&i.saveButtonEl&&i.saveButtonEl.render(e);for(var r=0;o>r;r++)t=i.contentEls[r].attr("id"),n[r].item.render(t);i._selectedStepAndText(i.currentStep),i._refreshButtonStatus()}},_createPanelContent:function(){var a,n,o=this,d=o.options,f=d.items,g=f.length,m=o.panelContentEl=e("<div>"),v="sweet-wizard",w="sweet-wizard-step",_="sweet-wizard-text",C="sweet-wizard-content",b="sweet-wizard-content-inner",E="sweet-wizard-bottom",y=o.wizardEl=e("<div>"),x=o.leftEl=e("<span>"),T=o.rightEl=e("<span>"),D=e("<ul>"),S={},k=o.textEl=e("<div>"),L={},N=o.contentEl=e("<div>"),I={},A=o.bottomEl=e("<div>").attr("id",d.id+c);d.compact===!0&&m.addClass(u),x.addClass(t).appendTo(y),e("<li>").addClass(l).appendTo(D);for(var P=0;g>P;P++)e("<li>").addClass(r).appendTo(D),a=o._createStepEl(P+1),a.appendTo(D),e("<li>").addClass(r).appendTo(D),n=e("<span>").addClass(s).appendTo(k).html(f[P].header),d.tip&&n.attr("title",f[P].header),S[P]=a,L[P]=n,I[P]=e("<div>").attr("id",d.id+"-"+P+"-"+h).addClass(b).hide().appendTo(N);e("<li>").addClass(r).appendTo(D),D.addClass(w).appendTo(y),T.addClass(i).appendTo(y),y.addClass(v).appendTo(m),k.addClass(_).appendTo(m),N.addClass(C).appendTo(m),A.addClass(E).appendTo(m),o.prevButtonEl=new Sweet.form.Button({width:80,height:35,value:{value:"prev",text:Sweet.core.i18n.container.prev},click:function(){o._onClick(o,p[0])}}),o.nextButtonEl=new Sweet.form.Button({width:80,height:35,value:{value:"next",text:Sweet.core.i18n.container.next},click:function(){o._onClick(o,p[1])}}),o.doneButtonEl=new Sweet.form.Button({width:80,height:35,value:{value:"done",text:Sweet.core.i18n.container.done},disabled:!0,click:function(){o._onClick(o,p[2])}}),o.options.saveBtn&&(o.saveButtonEl=new Sweet.form.Button({width:80,height:35,value:{value:"save",text:Sweet.core.i18n.container.save},click:function(){o._onClick(o,p[3])}})),o.stepEls=S,o.textSpanEls=L,o.contentEls=I,o.currentStep=0,o.maxStep=g-1},_destroyWidget:function(){for(var t,i=0;this.options.items.length>i;i++)if(t=this.options.items[i],e.isFunction(t.destroy))try{t.destroy()}catch(a){this._error(a)}this.options.items=[],this._super()},_createStepEl:function(t){var i=e("<li>"),a=e("<span>").html(t);return a.addClass(n).appendTo(i),i},_onClick:function(t,i){var a,n=t.options;if(p[0]===i)a="prevClick";else if(p[1]===i)a="nextClick";else if(p[2]===i)a="doneClick";else{if(p[3]!==i)return t._error("Unsupport type. Not equal 1 or 2 or 3. Type="+i),undefined;a="saveClick"}var o=!0,r=!0;n.listeners&&"function"==typeof n.listeners[a]&&(o=n.listeners[a].call(this,[t.currentStep+1,t.maxStep+1])),t.handlers&&"function"==typeof t.handlers[a]&&(r=t.handlers[a].call(this,[t.currentStep+1,t.maxStep+1])),o&&r&&(p[0]===i?t._onPrevClick(t):p[1]===i?(t._onNextClick(t),n.afterShow&&e.isFunction(n.afterShow)&&n.afterShow([t.currentStep+1,t.maxStep+1])):p[2]===i&&t._onDoneClick(t))},_onPrevClick:function(e){0!==e.currentStep&&(e._unSelectedStepAndText(e.currentStep),e.currentStep-=1,e._refreshButtonStatus())},_onNextClick:function(e){e.currentStep!==e.maxStep&&(e.currentStep+=1,e._selectedStepAndText(e.currentStep),e._refreshButtonStatus())},_selectedStepAndText:function(e){var t,c,h=this;t=h.stepEls[e],c=h.textSpanEls[e],t.prev().removeClass(r).addClass(l),t.children().removeClass(n).addClass(o),t.next().removeClass(r).addClass(l),c.removeClass(s).addClass(d),0!==e&&h.contentEls[e-1].hide(),h.contentEls[e].show(),h.options.items[e].item.show(),h.currentStep===h.maxStep&&(t.next().next().removeClass(r).addClass(l),h.rightEl.removeClass(i).addClass(a))},_unSelectedStepAndText:function(e){var t,c,h=this;t=h.stepEls[e],c=h.textSpanEls[e],t.prev().removeClass(l).addClass(r),t.children().removeClass(o).addClass(n),t.next().removeClass(l).addClass(r),c.removeClass(d).addClass(s),h.contentEls[e].hide(),e>0&&(h.contentEls[e-1].show(),h.options.items[e-1].item.show()),h.currentStep===h.maxStep&&(t.next().next().removeClass(l).addClass(r),h.rightEl.removeClass(a).addClass(i))},_refreshButtonStatus:function(){var e=this,t=e.currentStep;e.prevButtonEl.setDisabled(!1),e.nextButtonEl.setDisabled(!1),e.doneButtonEl.setDisabled(!1),0===t?(e.prevButtonEl.setDisabled(!0),e.doneButtonEl.setDisabled(!0)):t===e.maxStep?e.nextButtonEl.setDisabled(!0):e.doneButtonEl.setDisabled(!0)},prevClick:function(t){e.log(t)},nextClick:function(t){e.log(t)},doneClick:function(t){e.log(t)}}),Sweet.panel.WizardPanel=e.sweet.widgetContainerWizardpanel}(jQuery),function(e){var t="sweet-panel-flow",i="sweet-panel-flow-li",a="sweet-panel-flow-left",n="sweet-panel-flow-right",o=1e3,r="sweet-panel-flow-";e.widget("sweet.widgetContainerFlowpanel",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-flowpanel]:",type:"FlowPanel",options:{align:Sweet.constants.align.LEFT,verticalAlign:Sweet.constants.align.TOP,padding:5,height:"auto"},_getCanvasObject:function(){var t=this,i=null,a=t.options,n=a.items?a.items.length:0;if(1===n)i=a.items[0].getCanvasObject();else if(n>1){var o=t.renderEl.height(),r=t.renderEl.width();i=e("<canvas>").attr({width:r,height:o}),i=i[0];for(var l=a.padding,s=0,d=0,c=i.getContext("2d"),h=0;n>h;h++){var u,p=a.items[h],f=p.getWidth(),g=p.getHeight();if(u=p.getCanvasObject(),e.isNotNull(u)&&e.isFunction(u.getContext)){var m=u.getContext("2d"),v=m.getImageData(0,0,f,g);s>r&&(s=0,d=l+g),c.putImageData(v,s,d,f,g),s+=f}}}return i},_doLayout:function(){var t,i,a,n,o,r,l,s,d=this,c=0;if(d.rendered&&(this._super(),!d.panelContentEl.is(":hidden")&&d.itemsParentEl&&0!==d.options.items.length&&(i=d.panelContentEl.find(">ul>li"),0!==i.length&&0!==d.panelContentEl.width()&&(r=d.panelContentEl.width(),l=d.panelContentEl.height(),i.each(function(t,s){o=e(s),o.css("padding",0),a=d.options.items[t]._initConfig.width,n=d.options.items[t]._initConfig.height,"string"===e.type(a)&&/\d+%/.test(a)&&(a=parseInt(a,10),a=Math.floor(a*r/100)),"string"===e.type(n)&&/\d+%/.test(n)&&(n=parseInt(n,10),n=Math.floor(n*l/100)),d.options.items[t].setWH(a,n),a!==r&&t!==i.length-1&&o.css("padding-right",d.options.padding)}),i=d.panelContentEl.find(">ul>li:visible"),0!==i.length)))){var h=i.first().position().top;i.each(function(t,i){e(i).position().top!==h&&e(i).css("padding-top",d.options.padding)}),s=d.panelContentEl.find(">ul"),c=s.height();var u=d.panelContentEl.height();c!==u&&"auto"===d.options.height?(d._setHeight(d.getHeight()+c-u),d._super()):u>c&&"auto"!==d.options.height&&(t=d.options.verticalAlign===Sweet.constants.align.MIDDLE?Math.floor((u-c)/2):d.options.verticalAlign===Sweet.constants.align.BOTTOM?u-c:0,s.css("padding-top",t))}},_addItems:function(t){var a,n=this,l=n.options,s=n.itemsParentEl,d="",c=null,h=n.panelContentEl.children("ul");n.options.items=n.options.items.concat(t);for(var u=0;t.length>u;u++)a=t[u],e.isPlainObject(a)&&e.isNull(a.options)&&(a.options=e.objClone(a)),d=r+l.id+"-"+ ++o,c=e("<li>").attr("id",d).addClass(i).appendTo(h),s.push({id:d,parentEl:c}),a.render(d)},_removeItems:function(t){var i,a,n,o,r,l=this;if(o=l.panelContentEl.children("ul"),"undefined"===e.type(t))for(t=[],i=0;l.options.items.length>i;i++)t.push(i);for(t.sort(),i=t.length-1;i>=0;i--)r=t[i],a=l.options.items[r],n=o.children().eq(r),a&&e.isFunction(a.destroy)&&a.destroy(),l.options.items.splice(r,1),n.remove()},_widgetRender:function(){var t=this;if(t.containerEl){this._super();var i,a=t.options,n=a.items;e.each(t.itemsParentEl,function(t,a){i=n[t],e.isPlainObject(i)&&e.isNull(i.options)&&(i.options=e.objClone(i)),i.render(a.id)})}},_createPanelContent:function(){var l,s,d=this,c=d.options,h=c.items.length,u=d.panelContentEl=e("<div>").addClass(t),p=e("<ul>"),f=[];s=Sweet.constants.align.LEFT===c.align?a:Sweet.constants.align.RIGHT===c.align?n:a;for(var g,m=0;h>m;m++)g=r+c.id+"-"+ ++o,l=e("<li>").attr("id",g).addClass(i).appendTo(p),f[m]={id:g,parentEl:l};p.addClass(s).appendTo(u),d.itemsParentEl=f},_destroyWidget:function(){this._removeItems(),this._super()}}),Sweet.panel.FlowPanel=e.sweet.widgetContainerFlowpanel}(jQuery),function(e){"use strict";var t="sweet-grid-portal-content",i="widget-container",a="container-dragging",n="container-empty",o="container-fixed",r="widget-placeholder",l="detect-valid",s="detect-invalid",d="sweet-grid-portal-locked",c="sweet-draggable",h="_row",u="_col",p="_row_span",f="_col_span",g=1e3,m=24,v=24,w=.9;e.widget("sweet.widgetContainerGridPortal",e.sweet.widgetContainer,{version:"1.0",sweetWidgetName:"[widget-container-portal]:",eventNames:{widgetlayoutchanged:"widget布局位置发生变化"},type:"Portal",options:{rows:3,columns:3,padding:5,items:null,widgetTitleClass:"sweet-widget-panel-title",widgetLayoutChanged:null,fitMode:!1,editable:!1},setEditable:function(e){e!==!0?(this.contentEl.addClass(d),this.contentEl.find("."+this.options.widgetTitleClass).removeClass(c)):(this.contentEl.removeClass(d),this.contentEl.find("."+this.options.widgetTitleClass).addClass(c)),this.options.editable=e},changeWidgetSize:function(e,t,i,a,n){var o,r,l,s,d,c;if(0>=i||i>this.options.rows||0>=a||a>this.options.columns)return!1;if(o=this._getAreaByPosition(e,t),r=this._getWidgetByPosition(e,t),null===o||null===r)return!1;if(l=this._getAreaAttr(o),i>l.rowSpan||a>l.colSpan)for(d=l.row;l.row+i>d;d++)for(c=l.col;l.col+a>c;c++)if((d>=l.row+l.rowSpan||c>=l.col+l.colSpan)&&0!==this._detectByPosition(d,c))return!1;if(n===!0)return!0;if(l.rowSpan>i||l.colSpan>a)for(d=l.row;l.row+l.rowSpan>d;d++)for(c=l.col;l.col+l.colSpan>c;c++)(d>=l.row+i||c>=l.col+a)&&(s=this._createAreaByPosition(d,c,1,1),s&&s.appendTo(this.contentEl));return r.options.rowSpan=i,r.options.colSpan=a,o.attr("_row_span",i),o.attr("_col_span",a),this._doLayout(),!0},changeLayout:function(e,t){var i,a,n,o,r;if(0===e||e>v||0===t||t>m)return!1;if(e=e||this.options.rows,t=t||this.options.columns,this.options.rows>e)for(i=e;this.options.rows>i;i++)for(a=0;this.options.columns>a;a++)if(0!==this._detectByPosition(i,a))return!1;if(this.options.columns>t)for(i=0;this.options.rows>i;i++)for(a=t;this.options.columns>a;a++)if(0!==this._detectByPosition(i,a))return!1;if(this.options.rows>e){for(i=e;this.options.rows>i;i++)for(a=0;this.options.columns>a;a++)r=this._getAreaByPosition(i,a),r&&r.remove();this.options.rows=e}if(this.options.columns>t){for(i=0;this.options.rows>i;i++)for(a=t;this.options.columns>a;a++)r=this._getAreaByPosition(i,a),r&&r.remove();this.options.columns=t}if(e>this.options.rows)for(n=this.options.rows,this.options.rows=e,i=n;this.options.rows>i;i++)for(a=0;this.options.columns>a;a++)r=this._createAreaByPosition(i,a),r&&r.appendTo(this.contentEl);if(t>this.options.columns)for(o=this.options.columns,this.options.columns=t,i=0;this.options.rows>i;i++)for(a=o;this.options.columns>a;a++)r=this._createAreaByPosition(i,a),r&&r.appendTo(this.contentEl);return this._doLayout(),!0},addWidget:function(t){var i=this;return"object"!==e.type(t)?!1:null===i._renderWidget(t)?!1:(i.options.items.push(t),i._doLayout(),!0)},removeWidget:function(t,i){var a,o,r,l,s,d=this,c=null,h=d.options.items;if("string"===e.type(t)?e.each(d.options.items,function(e,i){i.options.id===t&&(c=i)}):e.isNumeric(t)&&e.isNumeric(i)?c=d._getWidgetByPosition(t,i):"object"===e.type(t)&&(c=t),e.isNull(c))return!1;if(o=d._getAreaByWidget(c),e.isNull(o))return!1;s=d._getAreaAttr(o),r=-1;for(var u=h.length-1;u>=0;u--)if(l=h[u],l===c){e.isFunction(l.destroy())&&l.destroy(),h.splice(u,1);break}for(o.remove(),a=s.row;s.row+s.rowSpan>a;a++)for(i=s.col;s.col+s.colSpan>i;i++)o=d._createAreaByPosition(a,i),o&&o.addClass(n).appendTo(d.contentEl);return d._doLayout(),!0},detectPlace:function(t,i,a,n){var o,r,d=this,c=null;if("undefined"===e.type(t))return d.__detectIndicator&&(e.isFunction(d.__detectIndicator.remove)&&d.__detectIndicator.remove(),d.__detectIndicator=null),null;d.__detectIndicator||(d.__detectIndicator=e("<div>").appendTo(d.contentEl)),o=d.__detectIndicator;var h=d._getAreaByPoint(t-d.contentEl.offset().left,i-d.contentEl.offset().top);if(e.isNull(h))return d.__detectIndicator.hide(),null;var u=d._getAreaAttr(h);c={row:u.row,col:u.col},u.row+a>d.options.rows&&(c=null,a=d.options.rows-u.row),u.col+n>d.options.columns&&(c=null,n=d.options.columns-u.col);for(var p=u.row;u.row+a>p&&null!==c;p++)for(var f=u.col;u.col+n>f&&null!==c;f++){if(h=d._getAreaByPosition(p,f),null===h){c=null;break}if(r=d._getWidgetByArea(h),null!==r){c=null;break}}var g=d._getCellSize(),m=g.width*n+d.options.padding*(n-1),v=g.height*a+d.options.padding*(a-1);return null===c?o.addClass(s).removeClass(l):o.removeClass(s).addClass(l),o.show().css("left",u.left).css("top",u.top).externalWidth(m).externalHeight(v),c},setFitMode:function(e){e!==this.options.fitMode&&(this.options.fitMode=e,this._doLayout())},_doLayout:function(){var a,r,l,s,d,c,h,u,p,f,g,m,v,w,_,C,b,E,y,x,T=this,D=T.options;T.rendered&&(p=this._getCellSize().width,f=this._getCellSize().height,v=p*D.columns+D.padding*(D.columns-1),w=f*D.rows+D.padding*(D.rows-1),T.contentEl.width(v),T.contentEl.height(w),D.fitMode===!0?(T.containerEl.width()>v&&T.contentEl.css("left",Math.floor((T.containerEl.width()-v)/2)),T.containerEl.height()>w&&T.contentEl.css("top",Math.floor((T.containerEl.height()-w)/2))):this.contentEl.css("left",0),T.contentEl.children().each(function(t,v){if(C=e(v),C.hasClass(i))for(b=T._getAreaAttr(C),d=b.row,c=b.col,h=b.rowSpan,u=b.colSpan,l=p*u+(u-1)*D.padding,s=f*h+(h-1)*D.padding,g=(p+D.padding)*c,m=(f+D.padding)*d,C.externalWidth(l).externalHeight(s),C.css({top:m,left:g}),_=T._getWidgetByArea(C),e.isNull(_)?C.hasClass(n)||C.addClass(n):(C.removeClass(n),a=C.width(),r=C.height(),_.setWH(a,r),_.options.fixed===!0?C.hasClass(o)||C.addClass(o):C.removeClass(o)),E=d;d+h>E;E++)for(y=c;c+u>y;y++)(E!==d||y!==c)&&(C=T._getAreaByPosition(E,y),C&&C.remove())}),x=Math.floor(.7*f),x=x>200?200:x,T.contentEl.children("."+n).text("+").css({"font-size":x+"px","line-height":f+"px"}),T.containerEl.scrollPanel("vertical",{contentClass:t}))},_widgetRender:function(){var t=this;if(t.containerEl){var i=t.options,a=i.items;t.contentEl.appendTo(t.containerEl),e.each(a,function(e,i){t._renderWidget(i)}),t._widgetDrag()}},_createContainer:function(){var i=this;i.options.items||(i.options.items=[]),i.options.rows>v&&(i.options.rows=v),i.options.columns>m&&(i.options.columns=m);var a,n,o,r=i.options.rows,l=i.options.columns;for(i.contentEl=e("<div>").addClass(t),i.options.editable!==!0?this.contentEl.addClass(d):this.contentEl.removeClass(d),a=0;r>a;a++)for(n=0;l>n;n++)o=i._createAreaByPosition(a,n),o.appendTo(i.contentEl)},_createAreaByPosition:function(t,a,n,o){var r,l=this;return"undefined"===e.type(n)&&(n=1),"undefined"===e.type(o)&&(o=1),0>t||t>=l.options.rows||0>a||a>=l.options.columns||t+n>l.rows||a+o>l.options.columns?(l._error("expected area cannot be created"),null):null!==this._getAreaByPosition(t,a)?null:(r=e("<div>"),r.attr(h,t).attr(u,a).attr(p,1).attr(f,1).attr("id",l.options.id+"-"+ ++g).addClass(i),r)},_widgetDrag:function(){var t,i,n,o,l,s,d,c,g,m=this,v=null,w=null,_=null,C=m.options.widgetTitleClass,b=null,E=-1,y=100,x=100,T=!1,D=null;return m.contentEl?(m.contentEl.sweetDrag(function(E){if(!m.options.editable)return!1;var y=E.target,x=e(y);if(!x.hasClass(C))return!1;if(m.contentEl.children().each(function(t,i){e.contains(i,y)&&(w=e(i))}),null===w)return!1;if(v=m._getWidgetByArea(w),v&&v.options.fixed===!0)return w=null,v=null,!1;d=parseInt(w.css("left"),10)||0,c=parseInt(w.css("top"),10)||0,t=E.pageX-d,i=E.pageY-c,n=m.contentEl.width(),o=m.contentEl.height(),l=w.externalWidth(),s=w.externalHeight(),g=m.contentEl.offset();var T=m._getAreaAttr(w),D=e.getMaxZIndex();return b=e("<div>").addClass(r),b.appendTo(m.contentEl).css("left",T.left).css("top",T.top).css("z-index",D).externalWidth(l).externalHeight(s),b.attr(h,T.row).attr(u,T.col).attr(p,T.rowSpan).attr(f,T.colSpan),w.addClass(a),x.css("cursor","move"),_=x,m.__widgetLayoutChanged=!1,null},function(){if(null===w||null===v)return!1;var e=m._calculateAreaPoint(w);w.animate({left:e.left+"px",top:e.top+"px"},{duration:x,complete:function(){m._doLayout(),m.__widgetLayoutChanged&&m._widgetLayoutChanged()}}),b&&b.remove(),_.css("cursor",""),_=null,w.removeClass(a),v=null,w=null,b=null,D=null},function(e){if(null===w||null===v)return!1;var a=e.pageX-t,r=e.pageY-i;if(0>a&&(a=0),0>r&&(r=0),a+l>n&&(a=n-l),r+s>o&&(r=o-s),w.css({left:a,top:r}),T)return!1;var d=e.pageX-g.left,c=e.pageY-g.top,h=m._getAreaByPoint(d,c);return null===h?(E>=0&&(window.clearTimeout(E),E=-1),!1):D===h.attr("id")?!1:(D=h.attr("id"),E>=0&&(window.clearTimeout(E),E=-1),E=window.setTimeout(function(){if(E=-1,(m._adjustPositionHandover(w,h,!1,y)!==!1||m._adjustPositionExchange(w,h,!1,y)!==!1)&&(D=null,m.__widgetLayoutChanged=!0,b)){var e,t,i,a,n=m._calculateAreaPoint(w);e=n.left,t=n.top,i=l,a=s,b.animate({left:e+"px",top:t+"px",width:i+"px",height:a+"px"},{duration:y,complete:function(){b&&(b.externalWidth(i),b.externalHeight(a))}}),T=!0,window.setTimeout(function(){T=!1},Math.ceil(1.5*y))}},50),!1)}),undefined):(m._error("failed to start monitor dragging"),undefined)},_adjustPositionExchange:function(t,i,a,n){var o,r,l,s,d,c,h,u,p,f=this,g=f.options,m=0;if(e.isNull(t)||e.isNull(i))return!1;var v=f._getAreaAttr(t),w=f._getAreaAttr(i);if(v.row===w.row&&v.col===w.col)return!1;if(w.col+v.colSpan>g.columns||w.row+v.rowSpan>g.rows)return!1;for(s=w.row+v.rowSpan,d=w.col+v.colSpan,u=w.row;s>u;u++)for(p=w.col;d>p;p++)if(o=f._getAreaByPosition(u,p),l=f._getAreaAttr(o),r=f._getWidgetByArea(o),null!==o&&null!==l){if(r&&r.options.fixed===!0)return!1;if(l.col+l.colSpan>d||l.row+l.rowSpan>s)return!1;m+=l.colSpan*l.rowSpan}if(m!==v.rowSpan*v.colSpan)return!1;if(a)return!0;for(c=v.col-w.col,h=v.row-w.row,u=w.row;s>u;u++)for(p=w.col;d>p;p++)o=f._getAreaByPosition(u,p),l=f._getAreaAttr(o),null!==o&&null!==l&&(a||(l.row+=h,l.col+=c,f._setAreaPosition(o,l.row,l.col,n)));return a||(v.row-=h,v.col-=c,f._setAreaPosition(t,v.row,v.col,null)),!0},_adjustPositionHandover:function(t,i,a,n){var o,r,l,s,d,c,h,u;if(e.isNull(t)||e.isNull(i))return!1;var p=this._getAreaAttr(t),f=this._getAreaAttr(i);if(p.row===f.row&&p.col===f.col)return!1;if(o=this._getWidgetByArea(i),o&&o.options.fixed===!0)return!1;if(p.col!==f.col&&p.row!==f.row)return!1;if(p.col===f.col){if(s=[],d=[],h=f.colSpan,p.colSpan!==f.colSpan){for(c=f.col+f.colSpan;f.col+p.colSpan>c;c++)if(r=this._getAreaByPosition(f.row,c),l=this._getAreaAttr(r),null!==r){if(l.row!==f.row||l.rowSpan!==f.rowSpan)return!1;s.push(r),d.push(l),h+=l.colSpan}if(h!==p.colSpan)return!1}if(p.row+p.rowSpan!==f.row&&f.row+f.rowSpan!==p.row)return!1;if(!a&&(p.row>f.row?(p.row=f.row,f.row=p.row+p.rowSpan):(f.row=p.row,p.row=f.row+f.rowSpan),this._setAreaPosition(t,p.row,p.col,null),this._setAreaPosition(i,f.row,f.col,n),s.length>0))for(c=0;s.length>c;c++)r=s[c],l=d[c],l.row=f.row,this._setAreaPosition(r,l.row,l.col,n)}if(p.row===f.row){if(s=[],d=[],u=f.rowSpan,p.rowSpan!==f.rowSpan){for(c=f.row+f.rowSpan;f.row+p.rowSpan>c;c++)if(r=this._getAreaByPosition(c,f.col),l=this._getAreaAttr(r),null!==r){if(l.col!==f.col||l.colSpan!==f.colSpan)return!1;s.push(r),d.push(l),u+=l.rowSpan}if(u!==p.rowSpan)return!1}if(p.col+p.colSpan!==f.col&&f.col+f.colSpan!==p.col)return!1;if(!a&&(p.col>f.col?(p.col=f.col,f.col=p.col+p.colSpan):(f.col=p.col,p.col=f.col+f.colSpan),this._setAreaPosition(t,p.row,p.col,null),this._setAreaPosition(i,f.row,f.col,n),s.length>0))for(c=0;s.length>c;c++)r=s[c],l=d[c],l.col=f.col,this._setAreaPosition(r,l.row,l.col,n)}return!0},_setAreaPosition:function(e,t,i,a){var n,o,r=this;e.attr(h,t).attr(u,i),null!==a&&(o=r._calculateAreaPoint(e),e.animate({left:o.left,top:o.top},{duration:a})),n=r._getWidgetByArea(e),n&&(n.options.row=t,n.options.column=i)},_calculateAreaPoint:function(t){var i=this,a=i.options;if(e.isNull(t))return null;var n=a.columns,o=a.rows,r=i.contentEl.width(),l=i.contentEl.height(),s=Math.floor((r-(n-1)*a.padding)/n),d=Math.floor((l-(o-1)*a.padding)/o),c=i._getAreaAttr(t),h=c.col*(s+a.padding),u=c.row*(d+a.padding);
return{left:h,top:u}},_getAreaAttr:function(t){if(e.isNull(t))return null;var i=parseInt(t.attr(h),10),a=parseInt(t.attr(u),10),n=parseInt(t.attr(p),10),o=parseInt(t.attr(f),10),r=parseInt(t.css("left"),10)||0,l=parseInt(t.css("top"),10)||0,s=t.externalWidth(),d=t.externalHeight();return{row:i,col:a,rowSpan:n,colSpan:o,left:r,top:l,width:s,height:d}},_getAreaByPoint:function(t,n){var o,r,l=this,s=null;return l.contentEl.children().each(function(l,d){return o=e(d),r=o.position(),o.hasClass(a)||!o.hasClass(i)?null:(t>=r.left&&r.left+o.externalWidth()>=t&&n>=r.top&&r.top+o.externalHeight()>=n&&(s=e(d)),undefined)}),s},_getAreaByPosition:function(t,a){var n,o=this,r=null;return o.contentEl.children().each(function(o,l){return n=e(l),n.hasClass(i)?(n.attr(h)===t+""&&n.attr(u)===a+""&&(r=e(l)),undefined):null}),r},_getAreaByWidget:function(t){var i=this;if(e.isNull(t))return null;var a,n=t.options.row+"",o=t.options.column+"",r=null;return i.contentEl.children().each(function(t,i){a=e(i),a.attr(h)===n&&a.attr(u)===o&&(r=e(i))}),r},_getWidgetByPosition:function(e,t){for(var i,a=this,n=0;a.options.items.length>n;n++)if(i=a.options.items[n],i.options&&i.options.row===e&&i.options.column===t)return i;return null},_getWidgetByArea:function(t){var i,a=this;if(e.isNull(t))return null;for(var n=t.attr("id"),o=0;a.options.items.length>o;o++)if(i=a.options.items[o],i.options&&i.options.renderTo===n)return i;return null},_detectByPosition:function(e,t){if(0>e||e>=this.options.rows||0>t||t>=this.options.columns)return-1;var i=this._getAreaByPosition(e,t),a=this._getWidgetByArea(i);return i&&a?1:i?0:2},_renderWidget:function(t){var i=this,a=null;if(e.isNull(t))return null;e.isNull(t.options.rowSpan)&&(t.options.rowSpan=1),e.isNull(t.options.colSpan)&&(t.options.colSpan=1);var n=i._getAreaByWidget(t);return null===n?(i._error("widget position is invalid"),null):(a=n.attr("id"),e.isNull(a)?null:(n.text("").css({"font-size":"","line-height":""}),e.isFunction(t.render)?(n.attr(p,t.options.rowSpan).attr(f,t.options.colSpan).show(),t.render(a),i.options.editable&&n.find("."+i.options.widgetTitleClass).addClass(c),a):null))},_destroyWidget:function(){var e,t;for(e=0;this.options.rows>e;e++)for(t=0;this.options.columns>t;t++)this.removeWidget(e,t);this._super()},_getCellSize:function(){var e,t,i=this,a=i.options,n=a.columns,o=a.rows,r=i.contentEl.externalWidth()-i.contentEl.width(),l=i.contentEl.externalHeight()-i.contentEl.height(),s=i.containerEl.width()-r,d=i.containerEl.height()-l;return this.options.fitMode===!1?(e=Math.floor((s-(n-1)*a.padding)/n),t=Math.floor(e*w)):s*w>d?(t=Math.floor((d-(o-1)*a.padding)/o),e=Math.floor(t/w)):(e=Math.floor((s-(n-1)*a.padding)/n),t=Math.floor(e*w)),{width:e,height:t}},_widgetLayoutChanged:function(){var t=this;t.handlers&&e.isFunction(t.handlers.widgetlayoutchanged)&&t.handlers.widgetlayoutchanged(),e.isFunction(t.options.widgetLayoutChanged)&&t.options.widgetLayoutChanged()},widgetlayoutchanged:function(){e.noop()}}),Sweet.portal.GridPortal=e.sweet.widgetContainerGridPortal}(jQuery),function(e){"use strict";var t="sweet-panel-content",i="sweet-widgetlist-container",a="sweet-widgetlist-panel",n="sweet-widgetlist-scroll-left",o="sweet-widgetlist-scroll-right",r="sweet-widgetlist-scroll-disabled",l="sweet-widgetlist-list",s="sweet-widgetlist-item",d="sweet-widgetlist-item-dragging",c="sweet-widgetlist-item-info",h="sweet-widgetlist-item-name",u="sweet-widgetlist-item-detail",p="list-item-",f="sweet-widgetlist-flat",g=1e3,m=500;e.widget("sweet.widgetContainerWidgetlist",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-widgetlist]:",type:"WidgetList",eventNames:{drag:"开始拖动",dragging:"正在拖动",drop:"拖动结束"},options:{rows:2,padding:8,cellWidth:180,flat:!1},_doLayout:function(){function t(t,i){var a,n=[];e.isArray(i)?n=i:n.push(i);for(var o=0;g.length>o;o++)if(a=g[o],m[a.__containerId]===undefined&&!(e.inArray(a,n)>=0)){if(1===t&&1===a.colSpan&&1===a.rowSpan)return a;if(2===t&&1===a.colSpan&&2===a.rowSpan)return a;if(3===t&&2===a.colSpan&&1===a.rowSpan)return a;if(4===t&&2===a.colSpan&&2===a.rowSpan)return a}return null}function i(){h=e("#"+v.__containerId),h.externalWidth(2*p+d).externalHeight(2*f+d),h.css({left:c,top:0}),m[v.__containerId]=v,c+=2*(p+d),x++}function a(){h=e("#"+v.__containerId),h.externalWidth(p).externalHeight(2*f+d),h.css({left:c,top:0}),m[v.__containerId]=v,c+=p+d,x++}function n(){return w=t(3,v),_=t(1),C=t(1,_),b=t(2),E=t(4),null!==w||null!==_&&null!==C||null===b&&null===E?(h=e("#"+v.__containerId),h.externalWidth(2*p+d).externalHeight(f),h.css({left:c,top:0}),m[v.__containerId]=v,x++,w=t(3,v),null!==w?(h=e("#"+w.__containerId),h.externalWidth(2*p+d).externalHeight(f),h.css({left:c,top:f+d}),m[w.__containerId]=w,x++):(w=t(1,v),_=t(1,[w,v]),null!==w&&null!==_?(h=e("#"+w.__containerId),h.externalWidth(p).externalHeight(f),h.css({left:c,top:f+d}),h=e("#"+_.__containerId),h.externalWidth(p).externalHeight(f),h.css({left:c+p+d,top:f+d}),m[w.__containerId]=w,m[_.__containerId]=_,x+=2):(w||null!==_)&&(w=w||_,h=e("#"+w.__containerId),h.externalWidth(p).externalHeight(f),h.css({left:c,top:f+d}),m[w.__containerId]=w,x++)),c+=2*(p+d),undefined):(g.push(v),undefined)}function o(){return w=t(1,v),_=t(3),C=t(2),b=t(4),(null===w&&null!==_||null===w&&null===_)&&null!==(C||b)?(g.push(v),undefined):(h=e("#"+v.__containerId),h.externalWidth(p).externalHeight(f),h.css({left:c,top:0}),m[v.__containerId]=v,x++,null!==w&&null!==_?(h=e("#"+w.__containerId),h.externalWidth(p).externalHeight(f),h.css({left:c+p+d,top:0}),h=e("#"+_.__containerId),h.externalWidth(2*p+d).externalHeight(f),h.css({left:c,top:f+d}),m[w.__containerId]=w,m[_.__containerId]=_,x+=2,c+=2*(p+d)):null!==w?(h=e("#"+w.__containerId),h.externalWidth(p).externalHeight(f),h.css({left:c,top:f+d}),m[w.__containerId]=w,x++,c+=p+d):null!==_?(h=e("#"+_.__containerId),h.externalWidth(2*p+d).externalHeight(f),h.css({left:c,top:f+d}),m[_.__containerId]=_,x++,c+=2*(p+d)):c+=p+d,undefined)}var r=this;if(r.rendered){r._super();var l=r.options,s=l.rows,d=l.padding;r.widgetList.externalHeight(r.panelContentEl.height());var c,h,u=r.widgetList.height(),p=l.cellWidth,f=Math.floor((u-d*(s-1))/s);c=0;var g=[],m={};e.each(l.items,function(e,t){0>=t.colSpan&&(t.colSpan=1),0>=t.rowSpan&&(t.rowSpan=1),g.push(t)});for(var v,w,_,C,b,E,y=0,x=0;;){if(x>=l.items.length)break;v=g[y],m[v.__containerId]===undefined?(2===v.colSpan&&2===v.rowSpan?i():1===v.colSpan&&2===v.rowSpan?a():2===v.colSpan&&1===v.rowSpan?n():1===v.colSpan&&1===v.rowSpan&&o(),y++):y++}this.widgetList.externalWidth(c),this._updateScrollButton()}},_layoutImage:function(){var t,i,a=this,n=!1;e.each(this.options.items,function(a,o){n||(i=e("#"+o.__containerId),t=i.find(">img").first(),e.isNull(t)||(t.height()>0?t.css("margin-top",Math.floor((i.height()-t.height())/2)):n=!0))}),n&&window.setTimeout(function(){a._layoutImage()},200)},_updateScrollButton:function(){var e,t=this,i=t.widgetList.externalWidth(),a=t.panelContentEl.width();i>a?(t.scrollLeft.show(),t.scrollRight.show(),e=this.widgetList.position().left,e>=0?t.scrollLeft.addClass(r):t.scrollLeft.removeClass(r),a>=e+i?t.scrollRight.addClass(r):t.scrollRight.removeClass(r)):(t.scrollLeft.hide(),t.scrollRight.hide(),this.widgetList.css("left",0))},_widgetRender:function(){var t=this;t.containerEl&&(t.panelTitleEl&&t.panelTitleEl.appendTo(t.containerEl),t.containerEl.addClass(i),t.panelContentEl.appendTo(t.containerEl),t.scrollLeft.appendTo(t.containerEl),t.scrollRight.appendTo(t.containerEl),t.options.flat&&t.containerEl.addClass(f),e.each(t.options.items,function(e,i){t._renderItem(i)}),t._addEvents())},_destroyWidget:function(){this._removeItems(),this.scrollLeft.unbind(),this.scrollRight.unbind(),this.widgetList.draggable("destroy"),this._super()},_addEvents:function(){function e(){i.widgetList.stop(!1,!0);var t=i.widgetList.position().left,n=t+2*(i.options.cellWidth+i.options.padding);return t>=0?!1:(n>=0&&(n=0),o=!0,i.widgetList.animate({left:n},{duration:m,easing:"easeOutCirc",complete:function(){o=!1,i._updateScrollButton(),a&&i.scrollLeft.is(":visible")&&e()}}),!0)}function t(){i.widgetList.stop(!1,!0);var e=i.panelContentEl.width(),a=i.widgetList.position().left,r=i.widgetList.externalWidth(),l=a-2*(i.options.cellWidth+i.options.padding);return e>=r+a?!1:(o=!0,i.widgetList.animate({left:l},{duration:m,complete:function(){o=!1,i._updateScrollButton(),n&&i.scrollRight.is(":visible")&&t()}}),!0)}var i=this,a=!1,n=!1,o=!1;i.scrollLeft.unbind().bind("mousedown",function(){a=!0,n=!1,e()}).bind("mouseup mouseleave",function(){a=!1}),i.scrollRight.unbind().bind("mousedown",function(){a=!1,n=!0,t()}).bind("mouseup mouseleave",function(){n=!1}),i.containerEl.onMouseWheel(i.containerEl.get(0),function(i,a){var n=a.delta;return n>0?e():t(),!1})},_addListener:function(){if(!this.__dragRegistered){this.__dragRegistered=!0;var t=this,i=null;this.widgetList.draggable({containment:"body",appendTo:"body",distance:5,cursorAt:{left:0,top:0},helper:function(a){var n=a.target,o=null,r=null,l="";if(t.widgetList.children().each(function(t,i){e.isNull(i)||(n.id===i.id||e.contains(i,n))&&(o=e(i))}),o){r=o.clone(),r.addClass(d),t.options.flat&&r.addClass(f),t.widgetList.draggable("option","cursorAt",{left:r.width()/2,top:r.height()/2}),l=o.attr("id");for(var s=0;t.options.items.length>s;s++)if(t.options.items[s].__containerId===l){i=t.options.items[s];break}}else i=null,r=null;return r},start:function(e){t._trigger("drag",e,i)},stop:function(e){t._trigger("drop",e,i)},drag:function(e){t._trigger("dragging",e,i)}})}},_trigger:function(t,i,a){if(!e.isNull(this.handlers)){var n=this.handlers[t];e.isFunction(n)&&n(i,a)}},_createPanelContent:function(){var i,r=this;r.panelContentEl=e("<div>").addClass(a).addClass(t),i=r.widgetList=e("<div>"),i.addClass(l).appendTo(r.panelContentEl),r.scrollLeft=e("<div>").addClass(n),r.scrollRight=e("<div>").addClass(o)},_renderItem:function(t){if(!e.isNull(t)){var i="<"+t.name+">";e.isNull(t.desc)||(i+="<br>"+t.desc);var a=p+ ++g,n=e("<div>");n.attr("id",a).addClass(s).appendTo(this.widgetList);var o=e("<img>");o.attr("src",t.imagePath).appendTo(n);var r=e("<div>");r.attr("title",i).addClass(c).appendTo(n);var l=e("<span>");l.html(t.name).addClass(h).appendTo(r);var d=e("<span>");d.html(t.desc).addClass(u).appendTo(r),t.__containerId=a}},_addItems:function(e){for(var t,i=0;e.length>i;i++)t=e[i],this.options.items.push(t),this._renderItem(t)},_removeItems:function(t){var i,a;if(e.isNull(t))this.options.items=[],this.widgetList.empty();else{t.sort();for(var n=t.length-1;n>=0;n--)for(var o=0;this.options.items.length>o;o++)if(i=t[n],a=this.options.items[o],"string"===e.type(i)&&i===a.name||"number"===e.type(i)&&i===o){this.widgetList.find("#"+a.__containerId).remove(),this.options.items.splice(o,1);break}}},drag:function(t,i){e.log(t+","+i)},dragging:function(t,i){e.log(t+","+i)},drop:function(t,i){e.log(t+","+i)}}),Sweet.panel.WidgetList=e.sweet.widgetContainerWidgetlist}(jQuery),function(e){var t="sweet-container-date",i="sweet-container-date-title",a="sweet-container-date-title-num",n="sweet-container-date-title-month",o="sweet-container-date-content",r="sweet-container-content-week",l="sweet-container-content-num sweet-container-content-num-others";e.widget("sweet.widgetContainerDate",e.sweet.widgetContainer,{version:"1.0",sweetWidgetName:"[widget-container-date]:",months:e.objClone(Sweet.constants.MONTHS),eventNames:{click:"日期点击事件",change:"日期变化时触发"},options:{year:2012,month:1},_setValue:function(t){if(!(t instanceof Array))return e.error("setValue(): The input argument must be an array type!"),undefined;var i,a,n=this,o=this.options,r=r,l=o.year,s=o.month;e.each(t,function(t,o){a=o.split("-"),l===e.string.toNumber(a[0])&&s===e.string.toNumber(a[1])&&(i=n.dateEmEl[e.string.toNumber(a[2])],i.hasClass(r)||i.click())})},_getValue:function(){var e=[];for(var t in this.value)e.push(this.value[t]);return this._info("getValue(): "+e),e},_widgetRender:function(){this.containerEl&&this.dateEl.appendTo(this.containerEl)},_createContainer:function(){var i=this,a=i.dateEl=e("<div>"),n=i.options;i.value={},i.length=0,i.months[1]=e.date.isLeapYear(n.year)?29:28,i._createDateTitle(),i._createDateContent(),a.addClass(t+" "+n.widgetClass)},_createDateTitle:function(){var t=this.dateTitleEl=e("<div>"),o=this.options,r=e("<em>"),l=e("<em>");r.html(o.month).addClass(a).appendTo(t),l.html(Sweet.core.i18n.month[o.month-1]).addClass(n).appendTo(t),t.addClass(i).appendTo(this.dateEl)},_createDateContent:function(){var t,i,a=this,n=this.dateContentEl=e("<div>"),s=this.options,d=this.months,c=e("<div>"),h=(e("<ul>"),this.dateEmEl={}),u=new Date(s.year,s.month-1,1),p=u.getDay(),f=d[s.month-1],g=Math.ceil((p+f)/7),m=0;c.html("<em>"+Sweet.core.i18n.week[6]+"</em><em>"+Sweet.core.i18n.week[0]+"</em><em>"+Sweet.core.i18n.week[1]+"</em><em>"+Sweet.core.i18n.week[2]+"</em><em>"+Sweet.core.i18n.week[3]+"</em><em>"+Sweet.core.i18n.week[4]+"</em><em>"+Sweet.core.i18n.week[5]+"</em>").addClass(r).appendTo(n);for(var v=0;g>v;v++){if(t=e("<li>"),0===v)for(var w=0;7>w;w++)i=e("<em>"),p>w?i.html("&nbsp;").appendTo(t):(i.text(++m).addClass("num").bind("click",{self:a},this._dateNumClick).appendTo(t),(0===w||6===w)&&i.addClass("rest"),h[m]=i);else if(v===g-1)for(var _=0;7>_;_++)i=e("<em>"),m>=f?i.html("&nbsp;").appendTo(t):(i.text(++m).addClass("num").bind("click",{self:a},this._dateNumClick).appendTo(t),(0===_||6===_)&&i.addClass("rest"),h[m]=i);else for(var C=0;7>C;C++)i=e("<em>"),i.text(++m).addClass("num").bind("click",{self:a},this._dateNumClick).appendTo(t),(0===C||6===C)&&i.addClass("rest"),h[m]=i;t.addClass(l).appendTo(n)}n.addClass(o).appendTo(this.dateEl)},_dateNumClick:function(t){var i=e(this),a=t.data.self,n=a.options,o=a.length,r="current",l=i.text(),s=n.year+"-"+n.month+"-"+l,d=!1;i.hasClass(r)?(d=!1,i.removeClass(r),delete a.value[l],a.length--,a._info("_dateNumClick() Pop: "+s)):(d=!0,i.addClass(r),a.value[l]=s,a.length++,a._info("_dateNumClick() Push: "+s)),a._triggerHandler(t,"click",{value:s,selected:d}),o!==a.length&&a._triggerHandler(t,"change",{value:a.value})},_triggerHandler:function(t,i,a){var n=this;e.isNull(n.handlers)||e.each(n.handlers,function(e,o){i===e&&(n._info(i+" event occured!"),o.call(null,t,a))})}}),Sweet.panel.Date=e.sweet.widgetContainerDate}(jQuery),function(e){var t="sweet-panel-card",i="sweet-panel-card-item",a="sweet-panel-card-cascad",n="sweet-panel-card-visible",o="sweet-panel-card-invisible",r="sweet-panel-card-mask",l=1e3;e.widget("sweet.widgetContainerCard",e.sweet.widgetContainerPanel,{version:"1.0",sweetWidgetName:"[widget-container-cardpanel]:",type:"FlowPanel",options:{style:"default",cardIndent:100,items:null},showCard:function(t){var r=this.options.items;if(!(0>t||!e.isArray(r)||t>=r.length)){var l,s,d,c,h=this.options.style,u=this.panelContentEl.children("div."+i);if("default"===h)u.removeClass(n).addClass(o),e(u.get(t)).removeClass(o).addClass(n);else if("cascad"===h){if(l=e(u.get(t)),c=this.panelContentEl.children("div."+a).length,l.hasClass(n))for(var p=u.length-1;p>t;p--)l=e(u.get(p)),l.hasClass(a)&&this.hideCard();else d=(c+1)*this.options.cardIndent,s=this.panelContentEl.width(),l.css({left:s+"px",right:0-(s-d)+"px"}),l.addClass(a).removeClass(o).addClass(n),l.animate({left:d+"px",right:"0px"},200);c=this.panelContentEl.children("div."+a).length,c>0&&(this.maskEl.detach(),l.before(this.maskEl))}var f=r[t];e.isFunction(f.doLayout)&&f.doLayout()}},hideCard:function(){var t,i,r,l,s;if("cascad"===this.options.style){var d=this.panelContentEl.children("div."+a).length;if(1>d)return this.maskEl.detach(),undefined;l=this.panelContentEl.width(),s=d*this.options.cardIndent,t=e(this.panelContentEl.children("div."+a)),i=t.last(),i.removeClass(a),i.animate({left:l+"px",right:0-(l-s)+"px"},200,function(){i.removeClass(n).addClass(o)}),this.maskEl.detach(),d>1&&(r=e(t.get(t.length-2)),r.addClass(a).before(this.maskEl))}},_doLayout:function(){var t,i,a,n=this;if(n.rendered&&(this._super(),!(n.panelContentEl.is(":hidden")||0===n.options.items.length||1>n.panelContentEl.width()||1>n.panelContentEl.height))){t=n.panelContentEl.width(),i=n.panelContentEl.height();for(var o=0;n.options.items.length>o;o++)a=n.options.items[o],e.isFunction(a.doLayout)&&a.doLayout()}},_addItems:function(e){var t,i=this.options;i.items=i.items.concat(e);for(var a=0;e.length>a;a++)t=e[a],me._renderItem(t,this._addCard())},_addCard:function(){var t=this,a=t.options.id+"-card-"+l++,r=e("<div></div>");return r.attr("id",a).addClass(i).appendTo(t.panelContentEl),t.panelContentEl.children("."+i).length>1?r.addClass(o):r.addClass(n),a},_renderItem:function(t,i){e.isFunction(t.render)?t.render(i):e.isNull(t.html)?this._error("item is invalid:"+t):(e("#"+i).html(t.html),t.options=e.extend({},t.options,t))},_removeItems:function(t){var a,n,o,r,l,s=this;if(r=s.panelContentEl.children("div."+i),"undefined"===e.type(t))for(t=[],a=0;s.options.items.length>a;a++)t.push(a);for(t.sort(),a=t.length-1;a>=0;a--)l=t[a],n=s.options.items[l],o=r.children().eq(l),n&&e.isFunction(n.destroy)&&n.destroy(),s.options.items.splice(l,1),o.remove()},_widgetRender:function(){var t=this;t.containerEl&&(this._super(),e.each(t.options.items,function(e,i){t._renderItem(i,t._addCard())}))},_createPanelContent:function(){this.maskEl=e("<div></div>").addClass(r),this.panelContentEl=e("<div>").addClass(t),null===this.options.items&&(this.options.items=[])},_destroyWidget:function(){this._removeItems(),this._super()}}),Sweet.panel.CardPanel=e.sweet.widgetContainerCard}(jQuery),function(e,t){var i=["7","8","9","+","(","4","5","6","-",")","1","2","3","*","Del","0",".","/"],a="sweet-calculator-textarea-input-emptyDiv",n={NCZERO:0,NCONE:1,NCTWO:2,NCTHREE:3,WIDTH:40,THEIGHT:7,TPERCENTAGE:.1,TAHEIGHT:8,TAWIDTH:8,TAPERCENTAGE:.43,BHEIGHT:10,BPERCENTAGE:.47};e.widget("sweet.widgetCalculator",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-calculator]:",type:"calculator",eventNames:{clear:"删除事件"},options:{width:480,height:300},addFormula:function(t){if(!e.isNull(t)){var i=this,a=t.text,o=e(i.formElement)[0],r="["+t.text+"]";if(a in i.objMap?i.objMap[a]=t:(i.objMap[a]=t,i.objMap.length++),o.selectionStart||n.NCZERO===o.selectionStart){var l=o.selectionStart,s=o.selectionEnd,d=o.scrollTop;o.value=o.value.substring(0,l)+r+o.value.substring(s,o.value.length),d>n.NCZERO&&(o.scrollTop=d),o.focus(),o.selectionStart=l+r.length,o.selectionEnd=l+r.length}else o.value+=r,o.focus()}},getTextAreaObj:function(){var e=this,t=e.formElement;return t},deleteFormula:function(t){var i,a,n,o=this,r=o.formElement.val(),l="",s=[],d=r;if(!e.isNull(t)){for(i in o.objMap)if(e.isNotNull(o.objMap[i].value))for(var c=0;t.length>c;c++)n=!1,o.objMap[i].value===t[c].value&&(n=!0),n!==!0&&(s.push(t[c]),delete o.objMap[t[c].text],o.objMap.length--);for(var h=0;s.length>h;h++){a=e.regExp.escape("["+s[h].text+"]");var u=RegExp(a,"g");l=d.replace(u,""),d=l}o.formElement.val(d)}},setDefaultFormula:function(t){if(!e.isNull(t)){var i,a=this,o=t.text,r=e(a.formElement)[0],l=/\[([^\[])*\]/g,s={},d=[];if(l.test(o)){d=o.match(l);for(var c=t.value.match(l),h=0;d.length>h;h++)i=d[h],s[i]={value:c[h],text:d[h]}}else s=t;if(a.objMap=s,r.selectionStart||n.NCZERO===r.selectionStart){var u=r.selectionStart,p=r.selectionEnd,f=r.scrollTop;r.value=r.value.substring(0,u)+o+r.value.substring(p,r.value.length),f>n.NCZERO&&(r.scrollTop=f),r.focus(),r.selectionStart=u+o.length,r.selectionEnd=u+o.length}}},_getValue:function(){var t,i,a,n=this,o=n.formElement.val(),r="",l=o,s=/\[([^\[])*\]/g;for(t in n.objMap)e.isNotNull(n.objMap[t].value)&&(s.test(t)||s.test(n.objMap[t].value)?(i=t,r=l.replace(i,n.objMap[t].value)):(i=e.regExp.escape("["+t+"]"),a=RegExp(i,"g"),r=l.replace(a,"["+n.objMap[t].value+"]")),l=r);return{value:e.isNotNull(e.trim(r))?r:o,text:o,data:n.objMap}},getAddedFormula:function(){var e=this,t=[];for(var i in e.objMap)"length"!==i&&t.push(e.objMap[i]);return t},_doLayout:function(){var e=this,t=e.options,i=t.width,a=t.height,n=e.calculatorEl;n.width(i),n.height(a)},_createSweetWidget:function(){if(!this.renderEl){var t,i=this,a=i.options,o="sweet-calculator",r=i.calculatorEl=e("<div>");t=i.objMap={},i.objMap.length=n.NCZERO,r.addClass(a.widgetClass+" "+o).attr("id",a.id).width(a.width).height(a.height),i._createCalculatorWidget(),i._setEmptyText(!1)}},_createCalculatorWidget:function(){var t,i=this,a=i.options;t=i.contentEl=e("<div>").appendTo(i.calculatorEl).addClass("sweet-calculator-module").addClass(a.widgetClass).width(a.width).height(a.height),i._createTitleContent(),i._createTextAreaContent(),i._createButtonContent(),i._setEmptyText(!1)},_createTitleContent:function(){var t,i,a,o,r=this,l=r.options;o=e("<div>").appendTo(r.contentEl).width(l.width).height(l.height*n.TPERCENTAGE-n.THEIGHT).addClass("sweet-calculator_title"),i=e("<em>").text(Sweet.core.i18n.calculator.title).css({height:"100%"}).appendTo(o),a=e("<span>").css({height:"100%"}).appendTo(o),t=e("<a>").attr("title",Sweet.core.i18n.calculator.button).bind("click",{me:r},function(){r.formElement.val(""),r.objMap={},r.objMap.length=n.NCZERO,r._setEmptyText(!1),r._triggerHandler(null,"clear",r.getAddedFormula())}).addClass("sweet-calculator-clearPic").appendTo(a)},_createTextAreaContent:function(){var t=this,i=t.options,a="sweet-calculator_textarea",o=t.formElement=e("<textarea>"),r=i.width,l=i.height*n.TAPERCENTAGE,s=t.formDiv1El=e("<div>").width(r).height(l).addClass("sweet-calculator_textarea_input").appendTo(t.contentEl),d=t.formDiv2El=e("<div>").width(r).height(l).appendTo(s),c=e.nullToString(i.value);t.formElement.focus(function(){t._setEmptyText(!0)}),t.formElement.blur(function(){t._setEmptyText(!1)}),o.width(i.width-n.TAWIDTH).height(i.height*n.TAPERCENTAGE-n.TAHEIGHT).keydown(function(){return!1}).addClass(a).val(c),o.appendTo(d)},_createButtonContent:function(){for(var t,a,o=this,r=o.options,l=this.buttonAEl,s=e("<div>").appendTo(o.contentEl).width(r.width).height(r.height*n.BPERCENTAGE-n.BHEIGHT).addClass("sweet-calculator_button_div"),d=.12*r.width,c=.25*(r.height*n.BPERCENTAGE-n.BHEIGHT),h=0;i.length>h;h++){if(14===h)l=e("<button>").val(i[h]).bind("click",{me:o},o._onClick).text(i[h]).addClass("sweet-calculator_btn").addClass("sweet-calculator_delBtn").css({width:d,height:1.8*c}).css({top:r.height*(n.TPERCENTAGE+n.TAPERCENTAGE)+2*c+10});else if(n.NCZERO===h%5&&(t=e("<li>").css({height:"100%",width:h>=10?4*(d+13):5*(d+13)}),a=e("<ul>").css({height:c,width:h>=10?4*(d+13):5*(d+13)}),t.appendTo(a),a.appendTo(s)),l=e("<button>").val(i[h]).bind("click",{me:o},o._onClick).text(i[h]).addClass("sweet-calculator_btn").css({width:d,height:.8*c}),15===h){var u=.24*r.width+13;l.css({width:u})}l.appendTo(t)}return s},_insertAtCursor:function(e,t,i,a,o){if(e._setEmptyText(!0),i.selectionStart||n.NCZERO===i.selectionStart){var r=i.scrollTop;i.value=i.value.substring(0,a)+t+i.value.substring(o,i.value.length),r>n.NCZERO&&(i.scrollTop=r),e.formElement.focus(),i.selectionStart=a+t.length,i.selectionEnd=a+t.length}else i.value+=t,i.focus()},_iSelectField:function(e,i,a){arguments[2]===t&&(a=i),e.selectionStart=i,e.selectionEnd=a,e.focus()},_countSubstr:function(t,i,a){var o,r,l=e.regExp.escape("["+a+"]");r=RegExp(l,"g"),o=null===i.match(r)?n.NCZERO:i.match(r).length,o||(delete t.objMap[a],t.objMap.length--)},_error:function(){Sweet.Dialog.error({width:330,height:130,message:Sweet.core.i18n.calculator.tip})},_onClickDel:function(t,i,a){var o,r;if(a){var l,s=e(t.formElement).val();if(o=t.formElement.val().substring(0,a),r=o.substring(o.length-n.NCONE,o.length),""===s&&t._setEmptyText(!1),"]"===r)l=o.substring(o.lastIndexOf("[")+n.NCONE,a-n.NCONE),e(i).val(s.substring(0,o.lastIndexOf("["))+s.substring(a,s.length)),t._iSelectField(i,a-l.length-n.NCTWO),t._countSubstr(t,e(i).val(),l);else if("["===r){var d=s.substring(a,s.length);l=d.substring(0,d.indexOf("]")),e(i).val(s.substring(0,a-n.NCONE)+s.substring(a+l.length+n.NCONE,s.length)),t._iSelectField(i,a-n.NCONE),t._countSubstr(t,e(i).val(),l)}else if(o.lastIndexOf("[")>o.lastIndexOf("]")){var c=s.substring(o.lastIndexOf("["),s.length);l=c.substring(n.NCONE,c.indexOf("]")),e(i).val(s.substring(0,o.lastIndexOf("["))+s.substring(o.lastIndexOf("[")+l.length+n.NCTWO,s.length)),t._iSelectField(i,o.lastIndexOf("[")),t._countSubstr(t,e(i).val(),l)}else e(i).val(s.slice(0,a-n.NCONE)+s.slice(a)),t._iSelectField(i,a-n.NCONE)}},_onClickOther:function(t,i,a,n,o){var r=this,l=e(r.formElement)[0];"Max"===a||"Min"===a||"Avg"===a||"Sum"===a||"unt"===a?"("===t?r._insertAtCursor(r,t,l,n,o):r._error():"("===i?"+"===t||"-"===t||"*"===t||"/"===t||">"===t||"<"===t||"."===t?r._error():r._insertAtCursor(r,t,l,n,o):")"===i?"+"===t||"-"===t||"*"===t||"/"===t||">"===t||"<"===t||")"===t?r._insertAtCursor(r,t,l,n,o):r._error():">"===i||"<"===i?"+"===t||"-"===t||"*"===t||"/"===t||"."===t||")"===t||">"===t||"<"===t?r._error():r._insertAtCursor(r,t,l,n,o):"."===i?"+"===t||"-"===t||"*"===t||"/"===t||"."===t||"("===t||")"===t||"<"===t||">"===t?r._error():r._insertAtCursor(r,t,l,n,o):"+"===i||"-"===i||"*"===i?"+"===t||"-"===t||"*"===t||"/"===t||"."===t||"<"===t||">"===t||")"===t?r._error():r._insertAtCursor(r,t,l,n,o):"/"===i?"+"===t||"-"===t||"*"===t||"/"===t||"."===t||"<"===t||">"===t||")"===t||"0"===t?r._error():r._insertAtCursor(r,t,l,n,o):"0"===i||"1"===i||"2"===i||"3"===i||"4"===i||"5"===i||"6"===i||"7"===i||"8"===i||"9"===i?"("===t?r._error():r._insertAtCursor(r,t,l,n,o):r._insertAtCursor(r,t,l,n,o)},_onClick:function(t){var i,a,o,r,l,s=this,d=t.data.me,c=e(s).val(),h=e(d.formElement)[0];i=h.selectionStart,a=h.selectionEnd,o=h.value.substring(0,i),r=o.substring(o.length-n.NCONE,o.length),l=o.substring(o.length-n.NCTHREE,o.length),"Del"===c?(d._onClickDel(d,h,i),d._triggerHandler(null,"clear",d.getAddedFormula())):(c=e.htmlInversEscape(c),null===d.formElement.val()?(h.focus(),")"===c?d._error():"+"===c||"-"===c||"*"===c||"/"===c||"."===c||">"===c||"<"===c?d._error():d.formElement.val(c)):d._onClickOther(c,r,l,i,a))},clear:function(){var e=this;e.formElement.val(""),e.objMap={},e.objMap.length=n.NCZERO,e._setEmptyText(!1),e._triggerHandler(null,"clear",e.getAddedFormula())},_setEmptyText:function(t){var i=this;if(Sweet.core.i18n.calculator.emptyText,i.formElement){var n=i.formElement.val();if(!i.emptyDiv){var o=i.emptyDiv=e("<div>").addClass(a).appendTo(i.formDiv2El.css("position","absolute"));o.bind("click",function(){e(this).hide(),i.formElement.focus()}),n&&i.emptyDiv.hide()}t?"block"===i.emptyDiv.css("display")&&i.emptyDiv.hide():""===n&&i.emptyDiv.show()}},_validate:function(){},_render:function(e){var t=this;return t._super(e)?(t.calculatorEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_destroyWidget:function(){this.renderEl&&this.renderEl.remove()},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n}}),Sweet.Calculator=e.sweet.widgetCalculator}(jQuery),function(e){var t,i,a,n,o="sweet-bxCarousel-component",r="sweet-bxCarousel-item-desp",l="sweet-bxCarousel-item-desp-text",s="sweet-bxCarousel-visibleWin",d="sweet-bxCarousel-ArrowPreDiv-gray",c="sweet-bxCarousel-arrow-gray",h="sweet-bxCarousel-leftArrow-preDiv",u="sweet-bxCarousel-rightArrow-preDiv",p="sweet-bxCarousel-upArrow-preDiv",f="sweet-bxCarousel-downArrow-preDiv",g="sweet-bxCarousel-arrow-left",m="sweet-bxCarousel-arrow-right",v="sweet-bxCarousel-arrow-up",w="sweet-bxCarousel-arrow-down",_="sweet-bxCarousel-li",C="sweet-bxCarousel-li-active",b="sweet-bxCarousel-liChild",E="sweet-bxCarousel-liChild-active",y="sweet-bxCarousel-liGrendChild-left",x="sweet-bxCarousel-liGrendChild-right",T="sweet-bxCarousel-arrow-down-red",D="sweet-bxCarousel-arrow-up-red",S="sweet-bxCarousel-arrow-down-yel",k="sweet-bxCarousel-arrow-up-yel",L="sweet-bxCarousel-arrow-down-green",N="sweet-bxCarousel-arrow-up-green",I="sweet-bxCarousel-liEm-left",A="sweet-bxCarousel-leftArrow-preDiv-img",P="sweet-bxCarousel-rightArrow-preDiv-img",M="sweet-bxCarousel-upArrow-preDiv-img",F="sweet-bxCarousel-downArrow-preDiv-img",W="sweet-bxCarousel-li-userImage",B="sweet-bxCarousel-liEm-userDefindPic",O="sweet-bxCarousel-userDefindPic-unSelect",R="sweet-bxCarousel-userDefindPic-select",H="sweet-bxCarousel-userDefindPic-tick",j="sweet-bxCarousel-arrow-left-image",z="sweet-bxCarousel-arrow-right-image",V="sweet-bxCarousel-arrow-up-image",U="sweet-bxCarousel-arrow-down-image",G={interval:1,speed:1,acceleration:0};e.widget("sweet.widgetBxCarousel",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-bxCarousel]",type:"bxCarousel",eventNames:{click:"点击图片事件",change:"选项的change事件"},options:{data:null,vertical:!1,isItemSelectDesp:!1},setData:function(e){var t=this;t.preKey="",t.ulEl.text(""),t._creatUL(e),t._doLayout()},_render:function(e){var t=this;return t._super(e)?(t.carouselEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_setWidth:function(e){var t=this;t.carouselEl.externalWidth(e)},_getWidth:function(){var e=this;return e.carouselEl.externalWidth()},_getHeight:function(){var e=this;return e.carouselEl.externalHeight()},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)},_setHeight:function(e){var t=this;t.carouselEl.externalHeight(e)},_doLayout:function(){var e=this,a=e.options;e.rendered&&(t=e.visibleWin.children("ul").children("li:eq(0)").outerWidth(!0)||0,i=e.visibleWin.children("ul").children("li:eq(0)").outerHeight(!0)||0,e._initArrow(),a.vertical?e._doLayoutV():e._doLayoutH())},_doLayoutH:function(){var e,a,n,o,r,l=this,s=l.options,d=s.width,c=s.height,p=d,f=c;l.ulEl.css("left","0px"),t?(c=i,itemDespH=l._selectedItemDespEl?l._selectedItemDespEl.height():0,l.carouselEl.width(d).height(c+itemDespH),p=l.carouselEl.width(),f=i,l.visibleWin.css("float","left").width(p).height(f),e=l.dataObj.length*t+2,l.ulEl.width(e),l.image?(l.visibleWin.css({"margin-left":"3px","margin-right":"3px"}).width(p-6),l.leftArrowPreDivEl.removeClass(h).addClass(A),l.rightArrowPreDivEl.removeClass(u).addClass(P),l.leftArrowA.removeClass(g).addClass(j),l.rightArrowA.removeClass(m).addClass(z)):(l.leftArrowPreDivEl.height(l.carouselEl.externalHeight()).addClass(h),l.rightArrowPreDivEl.height(l.carouselEl.externalHeight()).addClass(u),(i-l.leftArrowA.height())/2,l.leftArrowA.height(l.carouselEl.externalHeight()),l.rightArrowA.height(l.carouselEl.externalHeight())),l.visibleWin.width()>=l.ulEl.width()?(l._hideArrors(),l.draggable&&(l.ulEl.draggable("destroy"),l.draggable=!1)):(l._setArrayZindex(),a=l.visibleWin.offset().left-(parseFloat(l.ulEl.width())-parseFloat(l.visibleWin.width())),n=l.visibleWin.offset().left,o=l.visibleWin.offset().top,r=o+i,l.draggable&&(l.ulEl.draggable("destroy"),l.draggable=!1),l.ulEl.draggable({axis:"x",cursor:"move",stop:function(){l._changeArrow()}}),l.draggable=!0)):l.carouselEl.width(2*l.leftArrowA.outerWidth(!0)+10).height(98)},_doLayoutV:function(){var e,i,a,n,o,r,l,s=this,d=s.options,c=d.width,h=d.height,u=c,g=h;s.ulEl.css("top","0px"),t?(c=t,s.carouselEl.width(c).height(h),u=t,g=s.carouselEl.height(),s.visibleWin.width(u).height(g),e=t,s.ulEl.width(e),s.image?(s.visibleWin.css({"margin-top":"3px","margin-bottom":"3px"}).height(g-6),s.leftArrowPreDivEl.removeClass(p).addClass(M),s.rightArrowPreDivEl.removeClass(f).addClass(F),s.leftArrowA.removeClass(v).addClass(V),s.rightArrowA.removeClass(w).addClass(U)):(s.leftArrowPreDivEl.width(s.carouselEl.externalWidth()).addClass(p),s.rightArrowPreDivEl.width(s.carouselEl.externalWidth()).addClass(f),l=(e-s.leftArrowA.width())/2,s.leftArrowA.width(s.carouselEl.externalWidth()),s.rightArrowA.width(s.carouselEl.externalWidth())),s.visibleWin.height()>s.ulEl.height()?(s._hideArrors(),s.draggable&&(s.ulEl.draggable("destroy"),s.draggable=!1)):(s._setArrayZindex(),i=s.ulEl.height(),a=s.ulEl.offset().left,n=a+t,o=s.visibleWin.offset().top-(parseFloat(s.ulEl.height())-parseFloat(s.visibleWin.height())),r=s.visibleWin.offset().top,s.draggable&&(s.ulEl.draggable("destroy"),s.draggable=!1),s.ulEl.draggable({axis:"y",cursor:"move",stop:function(){s._changeArrow()
}}),s.draggable=!0)):(s.visibleWin.height(50),s.carouselEl.width(201).height(2*s.leftArrowA.outerHeight(!0)+10))},_initArrow:function(){var e=this,t=e.options,i=t.vertical?v:g,a=t.vertical?w:m;e.leftArrowParentDiv.hide(),e.leftArrowPreDivEl.removeClass().addClass(d),e.leftArrowA.removeClass().addClass(i+" "+c),e.rightArrowParentDiv.hide(),e.rightArrowPreDivEl.removeClass(),e.rightArrowA.removeClass().addClass(a)},_hideArrors:function(){var e=this;e.leftArrowA.addClass(c),e.rightArrowA.addClass(c),e.leftArrowPreDivEl.addClass(d),e.rightArrowPreDivEl.addClass(d)},_setArrayZindex:function(){var t=this,i=e.getMaxZIndex(t.leftArrowPreDivEl.css("z-index"));t.leftArrowPreDivEl.css({"z-index":i}),t.rightArrowPreDivEl.css({"z-index":i}),i+=10,t.leftArrowA.css({"z-index":i}),t.rightArrowA.css({"z-index":i})},_createSweetWidget:function(){var t=this,i=t.options,a=t.carouselEl=e("<div>").addClass(o);a.attr("id",t.options.id),t.eventMap={},t.preKey="",t._createLeftArrow();var n=t.visibleWin=e("<div>").addClass(s).appendTo(t.carouselEl);t.ulEl=e("<ul>").appendTo(n),t._creatUL(),i.isItemSelectDesp&&!i.vertical&&(t._selectedItemDespEl=e("<div>").attr("id",i.id+"-item-desp").addClass(r).appendTo(a),t._despEl=e("<div>").attr("id",i.id+"-item-desp-text").addClass(l).appendTo(t._selectedItemDespEl)),t._createRightArrow()},_createLeftArrow:function(){var t=this,i=t.options,a=(t.leftArrowParentDiv=e("<div>").hide().appendTo(t.carouselEl),t.leftArrowPreDivEl=e("<div>").addClass(d).appendTo(t.leftArrowParentDiv),i.vertical?v:g);t.leftArrowA=e("<a>").addClass(a+" "+c).appendTo(t.leftArrowParentDiv)},_createRightArrow:function(){var t=this,i=t.options,a=t.rightArrowParentDiv=e("<div>").hide().appendTo(t.carouselEl),n=(t.rightArrowPreDivEl=e("<div>").appendTo(a),i.vertical?w:m);t.rightArrowA=e("<a>").addClass(n).appendTo(a)},_creatUL:function(t){var i=this,a=i.options,n=i.dataObj={},o=i.liArrarObj={},r=t||a.data;r&&(n.length=0,o.length=0,i.image=!0,e.each(r,function(t,a){i.image=i.image&&a.image;var r,l=e("<li>").appendTo(i.ulEl),s=e("<div>").attr("value",a.value).appendTo(l);if(a.image)l.addClass(W),s.addClass(O),e("<a>").css("background-image","url("+a.imagePath+")").addClass(B).appendTo(s),e("<a>").appendTo(s),r=s;else{l.addClass(_),s.addClass(b);var d=i._getArrowImage(a),c=i._getCharacterColor(a).left,h=i._getCharacterColor(a).right,u=e("<div>").addClass(y).appendTo(s),p=(e("<span>").addClass(d).appendTo(u),e("<em>").html(a.offset).addClass(I).appendTo(u)),f=e("<div>").addClass(x).appendTo(s),g=e("<span>").html(a.value).appendTo(f);e("<em>").html(a.text).appendTo(f),p.css("color",c),g.css("color",h),r=l}s.bind("click",{me:i,obj:r,image:a.image,key:a.value,desp:a.desp},i._clickImage),n[a.value]=a,n.length++,o[a.value]=l,o.length++}))},_afterCreateSweetWidget:function(){var e=this;e.visibleWin.bind("mouseover",function(){e.leftArrowPreDivEl.hasClass(d)||e.leftArrowParentDiv.show(),e.rightArrowPreDivEl.hasClass(d)||e.rightArrowParentDiv.show()}),e.visibleWin.bind("mouseout",function(){e.leftArrowParentDiv.hide(),e.rightArrowParentDiv.hide()}),e.leftArrowA.bind("mousedown",function(){e._clickLeftArrow()}),e.leftArrowA.bind("mouseup",function(){clearInterval(a)}),e.leftArrowA.bind("mouseover",function(){e.leftArrowParentDiv.show(),e.rightArrowParentDiv.show()}),e.leftArrowA.bind("mouseout",function(){e.leftArrowParentDiv.hide(),e.rightArrowParentDiv.hide(),clearInterval(a)}),e.rightArrowA.bind("mousedown",function(){e._clickRightArrow()}),e.rightArrowA.bind("mouseup",function(){clearInterval(n)}),e.rightArrowA.bind("mouseover",function(){e.leftArrowParentDiv.show(),e.rightArrowParentDiv.show()}),e.rightArrowA.bind("mouseout",function(){e.leftArrowParentDiv.hide(),e.rightArrowParentDiv.hide(),clearInterval(n)}),e.ulEl.attr("id",this.options.id+"-ul-id"),e.ulEl.onMouseWheel(e.ulEl.get(0),function(t,i){return i.delta>0?e._mouseWheelLeft(50):e._mouseWheelRight(50),!1})},_clickImage:function(e){var t=e.data.me,i=e.data.obj,a=e.data.image?!0:!1,n=(e.data.desp,e.data.key);t._setActiveItemCSS(a,i,t,n),t.eventMap&&t.eventMap.click?t.eventMap.click.call(this,t.dataObj[n]):t._trigger("click",t,t.dataObj[n]),t.preKey!==n&&t.eventMap&&t.eventMap.change&&t.eventMap.change.call(this,t.dataObj[n]),t.preKey=n},_setActiveItemCSS:function(e,t,i,a){var n=i,o=n.dataObj[a]?n.dataObj[a].desp:"";n.options.isItemSelectDesp&&!n.options.vertical&&(o=o.split("\n").join("<br>"),n._despEl.html(o).attr("title",o.split("<br>").join(""))),e?(n.ulEl.children("li").children("div ."+R).children("a:eq(1)").removeClass(),n.ulEl.children("li").children("div ."+R).removeClass().addClass(O),t.removeClass().addClass(R),t.children("a:eq(1)").addClass(H)):(n.ulEl.children("."+C).children("."+E).removeClass().addClass(b),n.ulEl.children("."+C).removeClass().addClass(_),t.removeClass().addClass(C),t.children("div ."+b).removeClass().addClass(E))},_getArrowImage:function(e){var t,i=RegExp("-");return i.test(e.offset)?"r"===e.color?t=T:"y"===e.color?t=S:"g"===e.color&&(t=L):"r"===e.color?t=D:"y"===e.color?t=k:"g"===e.color&&(t=N),t},_getCharacterColor:function(e){var t={};return"r"===e.color?(t.left="#FF0000",t.right="#CD0100"):"y"===e.color?(t.left="#F4C042",t.right="#E3A81C"):"g"===e.color&&(t.left="#00C11B",t.right="#009615"),t},_clickLeftArrow:function(){function e(){r=l++*G.interval;var e=(G.speed+G.acceleration*r)*r;i.vertical?0>o?(o+=e,t.ulEl.css("top",o+"px")):clearInterval(a):0>n?(n+=e,t.ulEl.css("left",n+"px")):clearInterval(a),t._changeArrow()}var t=this,i=t.options,n=parseFloat(t.ulEl.css("left")),o=parseFloat(t.ulEl.css("top")),r=0,l=0;t.leftArrowA.hasClass(c)||(a=setInterval(e,G.interval))},_clickRightArrow:function(){function e(){l=s++*G.interval;var e=(G.speed+G.acceleration*l)*l;a.vertical?(t=parseFloat(i.visibleWin.height())-parseFloat(i.ulEl.height()),r>t?(r-=e,i.ulEl.css("top",r+"px")):clearInterval(n)):(t=parseFloat(i.visibleWin.width())-parseFloat(i.ulEl.width()),o>t?(o-=e,i.ulEl.css("left",o+"px")):clearInterval(n)),i._changeArrow()}var t,i=this,a=i.options,o=parseFloat(i.ulEl.css("left")),r=parseFloat(i.ulEl.css("top")),l=0,s=0;i.rightArrowA.hasClass(c)||(n=setInterval(e,G.interval))},_mouseWheelLeft:function(e){var t=this,i=t.options,a=parseFloat(t.ulEl.css("left")),n=parseFloat(t.ulEl.css("top"));if(i.vertical){if(n>=0||n+t.ulEl.height()<t.visibleWin.height())return;0>n&&(n+=e,t.ulEl.css("top",n+"px"))}else{if(a>=0||a+t.ulEl.width()<t.visibleWin.width())return;0>a&&(a+=e,t.ulEl.css("left",a+"px"))}t._changeArrow()},_mouseWheelRight:function(e){var t,i=this,a=i.options,n=parseFloat(i.ulEl.css("left")),o=parseFloat(i.ulEl.css("top"));if(a.vertical){if(t=parseFloat(i.visibleWin.height())-parseFloat(i.ulEl.height()),t>0)return;o>t&&(o-=e,i.ulEl.css("top",o+"px"))}else{if(t=parseFloat(i.visibleWin.width())-parseFloat(i.ulEl.width()),t>0)return;n>t&&(n-=e,i.ulEl.css("left",n+"px"))}i._changeArrow()},_changeArrow:function(){var e,t=this,i=t.options;if(i.vertical){var a=parseFloat(t.ulEl.css("top"));e=parseFloat(t.visibleWin.height())-parseFloat(t.ulEl.height()),0>a?(t.leftArrowA.removeClass(c),t.leftArrowPreDivEl.removeClass(d)):(t.leftArrowA.addClass(c),t.leftArrowPreDivEl.addClass(d),t.leftArrowParentDiv.hide(),t.ulEl.css("top",0)),a>e?(t.rightArrowA.removeClass(c),t.rightArrowPreDivEl.removeClass(d)):(t.rightArrowA.addClass(c),t.rightArrowPreDivEl.addClass(d),t.rightArrowParentDiv.hide(),t.ulEl.css("top",e))}else{var n=parseFloat(t.ulEl.css("left"));e=parseFloat(t.visibleWin.width())-parseFloat(t.ulEl.width()),0>n?(t.leftArrowA.removeClass(c),t.leftArrowPreDivEl.removeClass(d)):(t.leftArrowA.addClass(c),t.leftArrowPreDivEl.addClass(d),t.leftArrowParentDiv.hide(),t.ulEl.css("left",0)),n>e?(t.rightArrowA.removeClass(c),t.rightArrowPreDivEl.removeClass(d)):(t.rightArrowA.addClass(c),t.rightArrowPreDivEl.addClass(d),t.rightArrowParentDiv.hide(),t.ulEl.css("left",e))}},_removeListener:function(){var t=this;t.handlers=t.handlers||{},e.each(t.handlers,function(e){"click"===e&&(t.eventMap.click=null),"change"===e&&(t.eventMap.change=null)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&t.eventMap&&(t.eventMap.click=i),"change"===e&&t.eventMap&&(t.eventMap.change=i)})},_getValue:function(){var e=this,t=e.ulEl.children("."+C).children("."+E).attr("value"),i=e.ulEl.children("li").children("div ."+R).attr("value");return e.dataObj[t||i]||null},_setValue:function(e){var t=this,i=t.dataObj[e.value],a=t.liArrarObj[e.value];if(i){var n=i.image?!0:!1,o=a;n&&(o=a.children("div")),t._setActiveItemCSS(n,o,t,e.value),t.preKey!==e.value&&t.eventMap&&t.eventMap.change&&t.eventMap.change.call(this,i),t.preKey=e.value}else t._error("Value does not exist!")}}),Sweet.BxCarousel=e.sweet.widgetBxCarousel}(jQuery),function(e){var t="sweet-errorInterface-img",i="sweet-errorInterface-imgOnly",a="sweet-errorInterface-gap",n="sweet-errorInterface-align",o="sweet-errorInterface-errorTextSpan",r="sweet-errorInterface-tipTextSpan",l="sweet-errorInterface-textSpan",s="sweet-errorInterface-contentDiv",d="sweet-errorInterface-div",c="sweet-errorInterface-errorTextOnly",h="sweet-errorInterface-tipTextOnly",u="sweet-errorInterface-textOnly",p={},f={},g={};p[Sweet.constants.errorType.UNCONNECTED]="sweet-errorInterface-serverUnconnected",p[Sweet.constants.errorType.UNKNOWN]="sweet-errorInterface-serverUnknown",p[Sweet.constants.errorType.COMMON]="sweet-errorInterface-common",f[Sweet.constants.errorType.UNCONNECTED]="sweet-errorInterface-errorTextUnconnected",f[Sweet.constants.errorType.UNKNOWN]="sweet-errorInterface-errorTextUnknown",f[Sweet.constants.errorType.COMMON]="sweet-errorInterface-errorTextCommon",g[Sweet.constants.errorType.UNCONNECTED]="sweet-errorInterface-tipTextUnconnected",g[Sweet.constants.errorType.UNKNOWN]="sweet-errorInterface-tipTextUnknown",g[Sweet.constants.errorType.COMMON]="sweet-errorInterface-tipTextCommon",e.widget("sweet.widgetErrorInterface",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-errorInterface]",options:{imageType:null,value:{value:"",errorText:"",tipText:"",data:null}},_setValue:function(e){var t=this;t.errorTextSpanEl&&t.errorTextSpanEl.remove(),t.tipTextSpanEl&&t.tipTextSpanEl.remove(),t.textSpanEl&&t.textSpanEl.remove(),t.imageEl&&t.imageEl.remove(),t.options.value=e.value,t.options.imageType=e.imageType,t.options.width=e.width,t.options.height=e.height,t._addElement(e),t._doLayout()},_render:function(e){e&&!this.rendered&&(this.renderEl||this._createRenderEl(e),this.errorEl.appendTo(this.renderEl),this.rendered=!0)},_createSweetWidget:function(){var t=this;options=t.options,t.errorEl=e("<div>").addClass(d),t.contentEl=e("<div>").appendTo(t.errorEl).addClass(s),t._addElement(options)},_addElement:function(t){var i=this;e.isNotNull(t.imageType)&&(i.imageEl=e("<span>").addClass(p[t.imageType]).appendTo(i.contentEl)),i._isTextNotNull(t)&&(i.textSpanEl=e("<span>").appendTo(i.contentEl),i.contentEl.css("width",Sweet.constants.elWidth.DIV_WIDTH),e.isNotNull(t.value.errorText)&&(i.errorTextSpanEl=e("<span>").appendTo(i.textSpanEl).text(t.value.errorText),e.isNotNull(t.imageType)?i.errorTextSpanEl.addClass(f[t.imageType]):i.errorTextSpanEl.addClass(c)),e.isNotNull(t.value.tipText)&&(e.isNotNull(t.value.errorText)&&(i.textGap=e("<div>").appendTo(i.textSpanEl).addClass(a)),i.tipTextSpanEl=e("<span>").appendTo(i.textSpanEl).text(t.value.tipText),e.isNotNull(t.imageType)?i.tipTextSpanEl.addClass(g[t.imageType]):i.tipTextSpanEl.addClass(h))),i._addClass(t)},_addClass:function(a){var s=this;if(e.isNotNull(a.imageType)&&s._isTextNotNull(a))s.imageEl.addClass(t),s.textSpanEl.addClass(l),e.isNotNull(a.value.errorText)&&s.errorTextSpanEl.addClass(o),e.isNotNull(a.value.tipText)&&s.tipTextSpanEl.addClass(r);else if(e.isNotNull(a.imageType))s.imageEl.addClass(i);else{if(s.tipTextSpanEl)var d=s.tipTextSpanEl.width();if(s.errorTextSpanEl)var c=s.errorTextSpanEl.width();var h=d>c?d:c;s.textSpanEl.addClass(n),Sweet.constants.elWidth.MIN_WIDTH>h?s.textSpanEl.css("min-width",h):s.textSpanEl.css("min-width",Sweet.constants.elWidth.MIN_WIDTH),s.textSpanEl.addClass(u),s.errorTextSpanEl&&s.errorTextSpanEl.addClass(o),s.tipTextSpanEl&&s.tipTextSpanEl.addClass(r)}},_isTextNotNull:function(t){return e.isNull(t.value)?!1:e.isNull(t.value.errorText)&&e.isNull(t.value.tipText)?!1:!0},_doLayout:function(){var t=this;if(t.errorEl.css("width",t.options.width),t.errorEl.css("height",t.options.height),e.isNotNull(t.options.imageType)&&t._isTextNotNull(t.options)){var i=0,a=0;t.tipTextSpanEl&&(i=t.tipTextSpanEl.width()),t.errorTextSpanEl&&(a=t.errorTextSpanEl.width());var n=i>a?i:a,o=t.imageEl.width()+n+Sweet.constants.gap.IMG_TEXT;t.contentEl.css("width",o)}},_getWidth:function(){var e=this;return e.contentEl.externalWidth()},_getHeight:function(){var e=this;return e.contentEl.externalHeight()},_setWidth:function(e){var t=this;t.contentEl.externalWidth(e)},_setHeight:function(e){var t=this;t.contentEl.externalHeight(e)}}),Sweet.ErrorInterface=e.sweet.widgetErrorInterface}(jQuery),function(e){var t="sweet-tree-panel";e.widget("sweet.widgetTree",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-tree]:",options:{},_createSweetWidget:function(){var i=this.options,a=this.treeEl=e("<div>");a.height(i.height).width(i.width).attr("id",i.id).addClass(t+" "+i.widgetClass)},_getHeight:function(){return this.treeEl.externalHeight()},_getWidth:function(){return this.treeEl.externalWidth()},_setWidth:function(e){this.treeEl.externalWidth(e)},_setHeight:function(e){this.treeEl.externalHeight(e)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_destroyWidget:function(){this.treeEl&&this.treeEl.remove()}})}(jQuery),function(e){"use strict";var t="sweet-tree-panel",i="sweet-tree-kqitree",a="sweet-kqitree-light",n="sweet-kqitree-zoom",o="fit",r="act";e.widget("sweet.widgetKqiTree",e.sweet.widgetTree,{version:"1.0",sweetWidgetName:"[widget-tree-kqitree]:",eventNames:{},options:{renderTo:"",padding:10,offsetX:14,offsetY:48,elemWidth:110,elemHeight:130,lineWidth:1,lineColor:"#666666",data:null},_doLayout:function(){var t=this.options;this.rendered&&(this._super(),this.treeEl.externalWidth(t.width).externalHeight(t.height),e.isNull(this.R)&&this._createKqiTree())},_beforeCreateSweetWidget:function(){this.nodeClass=Sweet.chart.Speedometer,this.engine="svg",this.R=null,this.treeData=null,this.maxWidth=0,this.maxHeight=0,this.nodeList={},this.lineList=[],this.zoomFactor=1,this.offset=this.options.padding},_createSweetWidget:function(){var a=this.options;this.treeEl=e("<div>"),this.treeEl.addClass(i+" "+t+" "+a.widgetClass).attr("id",a.id)},_layoutChildren:function(e,t){for(var i=this.options,a=e.pos.left,n=e.pos.top+i.elemHeight+i.offsetY,o=a,r=0;e.children.length>r;r++){var l=e.children[r];if(l.pos={},l.pos.left=o,l.pos.top=n,l.children&&l.children.length>0){var s=this._layoutChildren(l,t+1);a=Math.round((o+s.left)/2),l.pos.left=a,o=s.left}a=o,o+=i.elemWidth+i.offsetX}return a>this.maxWidth&&(this.maxWidth=a),n>this.maxHeight&&(this.maxHeight=n),{left:a,top:n}},_layoutTree:function(){var t=this.options,i=this.treeEl.find(">svg");if(e.isNull(this.treeData))return!1;var a=this.treeData.nodes;a.pos={},a.pos.left=t.padding,a.pos.top=t.padding,this.maxWidth=a.pos.left,this.maxHeight=a.pos.top;var n=this._layoutChildren(a,1);a.pos.left=Math.round((a.pos.left+n.left)/2);var o=this.treeEl.width(),r=this.treeEl.height();return this.maxWidth=this.maxWidth+t.elemWidth+t.padding,this.maxHeight=this.maxHeight+t.elemHeight+t.padding,o>this.maxWidth&&(this.offset=Math.floor((o-this.maxWidth)/2)),this.maxWidth>o&&i.externalWidth(this.maxWidth),this.maxHeight>r&&i.externalHeight(this.maxHeight),(this.maxHeight>r||this.maxWidth>o)&&(this.zoomFactor=r/this.maxHeight<o/this.maxWidth?r/this.maxHeight:o/this.maxWidth),!0},_drawTree:function(e){var t=this.options;if(null!==e){e.pos.left+=this.offset;var i={renderTo:"none-div",paper:this.R,left:e.pos.left,top:e.pos.top,width:t.elemWidth,height:t.elemHeight,borderStyle:e.borderStyle?e.borderStyle:"solid"},a=new this.nodeClass(i);a.setData(e),this.nodeList[e.id]=a;for(var n=t.elemWidth,o=t.elemHeight,r=0;e.children.length>r;r++){this._drawTree(e.children[r]);var l=e.children[r],s=["M",e.pos.left+n/2,e.pos.top+o,"L",e.pos.left+n/2,e.pos.top+o+t.offsetY/2,"L",l.pos.left+n/2,e.pos.top+o+t.offsetY/2,"L",l.pos.left+n/2,l.pos.top],d=this.R.path(s).attr({"stroke-width":t.lineWidth,stroke:t.lineColor});"dashed"===e.children[r].borderStyle&&d.attr({"stroke-dasharray":"- "}),this.lineList.push(d)}}},setData:function(t){this.treeData=t,e.isNull(this.treeData)||(this._layoutTree(),this._drawTree(this.treeData.nodes))},_zoom:function(e){for(var t="s"+e+","+e+","+this.maxWidth/2+",0",i=0;this.lineList.length>i;i++)this.lineList[i].transform(t);for(var a in this.nodeList)this.nodeList.hasOwnProperty(a)&&this.nodeList[a].setScale(e,this.maxWidth/2,0);1!==e&&this.treeEl.find(">svg").css({left:0,top:0})},_drawZoomer:function(){var t=this,i=e("<div>").addClass(n).addClass(o).appendTo(this.treeEl);i.unbind().bind("click",function(){i.hasClass(o)?(t._zoom(t.zoomFactor),i.addClass(r).removeClass(o)):(t._zoom(1),i.removeClass(r).addClass(o))})},_drawLight:function(){var t=e.getMaxZIndex(),i=e("<div>").addClass(a).css("z-index",t),n=e("<label>").text(Sweet.core.i18n.tree.info),o=e("<label>").text(Sweet.core.i18n.tree.warn);i.append(n).append(o).appendTo(this.treeEl)},_createKqiTree:function(){null===this.R&&(this.R=Raphael(this.treeEl.get(0),"100%","100%")),this._drawZoomer(),this._drawLight();var t,i,a,n,o=this,l=this.treeEl.find(">svg");return this.treeEl.find(">svg").sweetDrag(function(){return o.treeEl.find("."+r).length>0?!1:(t=l.externalWidth(),i=l.externalHeight(),a=o.treeEl.width(),n=o.treeEl.height(),undefined)},e.noop,function(e,o,r){return o>0?l.css("left",0):a>t+o?l.css("left",a-t):l.css("left",o),r>0?l.css("top",0):n>i+r?l.css("top",n-i):l.css("top",r),!1}),!0},setValue:function(t,i){!e.isNull(this.nodeList[t])&&e.isFunction(this.nodeList[t].setValue)&&this.nodeList[t].setValue(i)}}),Sweet.tree.KQITree=e.sweet.widgetKqiTree}(jQuery),function(e,t){var i="sweet-tree-node",a="sweet-tree-node-select",n="sweet-tree-expand",o="sweet-tree-coll",r="sweet-tree-check",l="sweet-tree-full-check",s="sweet-tree-uncheck",d="sweet-tree-action-node",c="sweet-tree-node-line",h="sweet-tree-leaf-ioc",u="sweet-tree-leaf-userDefine",p="sweet-tree-node-ioc",f="sweet-tree-leaf-dimension",g="sweet-tree-leaf-comp",m="sweet-tree-leaf-index",v="sweet-tree-title",w="sweet-tree-editable",_="sweet-tree-state",C="sweet-tree-tree-",b="sweet-tree-search-div",E="tree-load-more",y="sweet-tree-list-root",x="sweet-tree-list-root1",T="sweet-tree-item-dragging",D="sweet-tree-tree-disabled ",S="sweet-tree-content-timer",k="sweet-tree-item-dragging ui-draggable-dragging",L=1e3,N=100,I="selectMap";e.widget("sweet.widgetTreeTree",e.sweet.widgetTree,{version:"1.0",sweetWidgetName:"[widget-tree-tree]:",eventNames:{nodeClick:"树节点单击事件",nodeDClick:"树节点双击事件",nodeExpand:"树节点展开事件",nodeDrag:"树节点的拖拽事件",nodeCheck:"树节点CheckBox选中事件",nodeUnCheck:"树节点CheckBox反选事件",search:"搜索节点事件",change:"切换树节点事件",afterSetData:"调用完setData方法后事件",afterSetValue:"setValue执行后触发",nodeEdit:"树节点编辑事件",beforeCheckboxClick:"点击checkBox(未选中,半选)之前的事件"},options:{data:null,multi:!1,icon:!1,nodeDraggable:!1,nodeAccept:null,expand:!1,lazyLoad:!1,limit:20,backEndLoad:!1,search:!1,searchDir:!1,searchEmptyText:Sweet.core.i18n.tree.search,maxHeight:0,store:null,remote:!1,disabled:!1,parent:!1,parentAllowNodeClick:!1,handleText:function(e){return e},handleTitle:function(e){return e}},setData:function(t,i,a){var n=this,o=n.options;i=i||!1,a=a||!1,n.afterSetData=!1,o.data=e.objClone(t);var r=e.objClone(t);e.isArray(r)||(r=[r]),i?(n.removeAllNode(),e.isNull(n.data)&&(n.data=[]),e.each(r,function(t,i){e.isNull(i.data)&&(i.data={}),i.data.isSelect=1}),n.data=n.data.concat(r),n.options.data=n.data):(n.removeAllNode(),n.data=r),n._initValue(),a||n._filterCache()},getData:function(){var e=this;return e.data},setSelected:function(t){var i,a=this;e.isNull(t)||(a.timerSetSelectedId=setInterval(function(){a.afterSetData&&(i=a.rootListEl.children("li"),e.each(i,function(t,i){i=e(i),i.find("div").removeClass(d)}),t=e.isArray(t)?t:[t],e.each(t,function(e,t){a._leafNodeSelected(t)}),clearInterval(a.timerSetSelectedId))},500))},removeAllNode:function(){var e=this.treeEl.children("ul");e.children().remove(),e.data("children",[])},removeNode:function(i){if(!e.isNull(i)){var a=this,n=null;e.each(i,function(i,o){return n=a._findNodeUI(o),e.isNull(n)?(a.removeNode(o.children),t):(a._hasChild(n)?o.children&&(a.removeNode(o.children),a._hasChild(n)||(a._removeNodeData(n,n.data("data")),n.empty(),n.remove())):(a._removeNodeData(n,n.data("data")),n.empty(),n.remove()),t)})}},getAllNode:function(t){var i=this,a=this.treeEl.children("ul").data("children"),n=[];return e.isNull(a)?[]:(t=t||!1,e.each(a,function(t,i){i&&n.push(e.objClone(i.data("data")))}),t||i._deleteAttrIsSelect(n),n)},getUnSelectedData:function(){var i=this,a=this.treeEl.children("ul").data("children");return e.isNull(a)?[]:(i._removeAllSelectMapData(),e.each(a,function(t,a){a&&i._checkNode(e(a))}),t)},addNode:function(i,a,n,o,r){if(e.isArray(i)){var l,s,d,c,h,u,p,f,g,m=this,C=20,b=m.options.limit,E="",y="",x=this.options.lazyLoad,T=m.options.expand;a=a||!1,o=o||0,n=n||m.rootListEl;var D=n.data("children")||[];r=r||!1,x?(this.isgetData&&(this.lazyLoadDiv.data({data:i,clickCount:0}),this.lazyLoadDiv.attr("title",Sweet.core.i18n.tree.clickLoad),this.isgetData=!1),u=b*this.lazyLoadDiv.data("clickCount"),o>0&&(u=0)):u=m.dataIndex,e.each(i,function(S,k){if(g=S+u,x){if(g>=m.data.length&&(m.lazyLoadDiv.attr("title",Sweet.core.i18n.tree.clickLoadOver),m._deleteNodeLine()),g+1>b+u)return n.data("children",D),!1}else if(g>=m.dataIndex+N)return n.data("children",D),t;if(e.isNull(i[g]))return!1;if(k=i[g],s=d=h="",k.children&&k.children.length>0){i.length-1===g?(r=!0,l=e("<li>").data({data:k,lazyLoad:!0,depth:o+1,isLeaf:!1,isLastRoot:!0})):(r=!1,l=e("<li>").data({data:k,lazyLoad:!0,depth:o+1,isLeaf:!1,isLastRoot:!1}));for(var L=0;o>L;L++)d+='<span class="sweet-tree-node-line"></span>';h=T?'<a class="sweet-tree-coll" href="javascript:void(0)"></a>':'<a class="sweet-tree-expand" href="javascript:void(0)"></a>'}else{for(var A=0;o>A;A++)if(r){for(var P="",M=0;o-1>M;M++)P+='<span class="sweet-tree-node-line"></span>';d=P+'<span class="sweet-tree-node-blank" style="width: '+C+'px;"></span>'}else d+='<span class="sweet-tree-node-line"></span>';s=g===i.length-1?'<span class="sweet-tree-node-eblow-end"></span>':'<span class="sweet-tree-node-eblow"></span>',l=e("<li>").data({data:k,lazyLoad:!0,depth:o+1,isLeaf:!0})}l.data(I,[]),m.options.multi&&(y=m._createCheckBox(l,y,a)),m.options.icon&&(E=m._createIcon(k,E)),p=k.editable?w:v,e.isNull(k.data)||"1"!==k.data.state||(p=_),c='<div class="sweet-tree-node">'+d+s+h+E+y+"<span class="+p+" title="+"'"+m.options.handleTitle(e.htmlEscape(k.text))+"'"+">"+m.options.handleText(e.htmlEscape(k.text))+"</span>"+"</div>"+"<ul>"+"</ul>",l.html(c),l.appendTo(n),f=l.children("ul"),m.options.expand||f.hide(),D.push(l),k.children&&k.children.length>0&&m.addNode(k.children,a,f,o+1,r)}),n.data("children",D)}},deleteData:function(e,t){for(var i=this,a=0;e.length>a;a++)for(var n=0;t.length>n;n++)e[a].value===t[n].value&&(e[a].children&&e[a].children.length>0&&t[n].children&&t[n].children.length>0?i.deleteData(e[a].children,t[n].children):t[n].isDelete=!0)},deleteFilterData:function(t){for(var i=this,a=0;t.length>a;a++)e.isNull(t[a].children)?e.isNull(t[a].isDelete)||(t.splice(a,1),a--):(i.deleteFilterData(t[a].children),0===t[a].children.length&&(t.splice(a,1),a--))},mergeTree:function(t,i){var a,n=this;e.isNull(i)&&(i=[]),e.isNull(t)&&(t=[]);for(var o=0;i.length>o;o++){a=!0;var r=0;for(r=0;t.length>r;r++)if(i[o].value===t[r].value){a=!1;break}a?t.push(i[o]):e.isNull(t[r])||e.isNull(t[r].children)||n.mergeTree(t[r].children,i[o].children)}return t},_leafNodeSelected:function(t){var n=this,o=n.rootDiv.find("li");e.each(o,function(o,r){r=e(r),r.data("data").value===t.value&&(r.children("div").removeClass(i).addClass(a+" "+d),n._displayRootNode(r))})},_createExpandBotton:function(e,t,i){var a=this;return t=i?'<a class="sweet-tree-full-check"></a>':'<a class="sweet-tree-uncheck"></a>',i&&(a._checkNode(e),a._getSelectedMap()),t},_createCheckBox:function(e,t,i){var a=this;return t=i?'<a class="sweet-tree-full-check"></a>':'<a class="sweet-tree-uncheck"></a>',i&&(a._checkNode(e),a._getSelectedMap()),t},_createIcon:function(t,i){if(i="",t.children&&t.children.length>0)i='<a class="sweet-tree-node-ioc"></a>';else if(e.isNull(t.data))i='<a class="sweet-tree-leaf-ioc"></a>';else switch(t.data.type){case 0:i='<a class="sweet-tree-leaf-dimension"></a>';break;case 1:i='<a class="sweet-tree-leaf-index"></a>';break;case 2:i='<a class="sweet-tree-leaf-userDefine"></a>';break;case 3:i='<a class="sweet-tree-leaf-comp"></a>';break;default:i='<a class="sweet-tree-leaf-ioc"></a>'}return i},createNodes:function(t,i){var a=this,n=a.options,o=n.lazyLoad;i=i||!1,e.isNull(t)||(o?a.addNode(t):(a.data=t,a.dataIndex=0,a.timerTreeContent=n.id+"-"+S,Sweet.Task.Timeout.start({id:a.timerTreeContent,run:a._buildTreeContent,scope:a,args:[{isTrigger:i}],interval:10})))},filter:function(t){var i,a=this,n=RegExp(e.regExp.escape(t),"i");a.options.store?(a.isgetData=!0,a.options.remote?a.options.store.load({filStr:t}):a.options.searchDir?a.options.store.filter(t,n,!0):a.options.store.filter(t,n)):(a.options.expand=e.isNull(t)||a.options.lazyLoad?!1:!0,i=e.fuzzyFilter(a.filterData,t),a.setData(i,!1,!0)),e.isNull(a.eventMap.change)||a.eventMap.change.call(null,null,a.data)},setDisabled:function(e){var t=this;t.options.disabled=e,e?(t.rootDiv.addClass(D),t.options.search&&t.searchField.setDisabled(!0)):(t.rootDiv.removeClass(D),t.options.search&&t.searchField.setDisabled(!1))},_initValue:function(){var e=this,t=e.options.data;e.data=t,e.createNodes(t)},_removeAllSelectMapData:function(t){var i=this;t=t||i.rootListEl,e.each(t.children("li"),function(t,a){e(a).data(I,[]),e(a).children("ul").children("li").length>0&&i._removeAllSelectMapData(e(a).children("ul"))})},_doLayout:function(){if(this.rendered){var e=(this.renderEl,this.options),t=e.width,i=e.height,a=this.rootListEl,n=this.rootDiv,o=this.searchField,r=this.options.lazyLoad,l=this.treeEl;n.width(t),n.height(i),o&&(o.setWidth(t),i-=this.searchFiedlDiv.outerHeight(!0)),l.externalWidth(t),l.externalHeight(i),a.externalWidth(t),r?a.externalHeight(i-23):a.externalHeight(i)}},_deleteNodeLine:function(){var t=this,i=t.rootDiv.children().children("ul").children("li:last"),a=i.find("li").children("div");e.each(a,function(t,i){e(i).children("span:first").removeClass(c).addClass("sweet-tree-node-blank").width(20)})},_buildTreeContent:function(i){var a=this;return 0===a.data.length||a.dataIndex>=a.data.length?(Sweet.Task.Timeout.stop(a.timerTreeContent),a._deleteNodeLine(),a.afterSetData=!0,i[0].isTrigger||(a._trigger("afterSetData",null,null),e.isNull(a.eventMap.afterSetData)||a.eventMap.afterSetData.call()),t):(a.addNode(a.data),a.dataIndex=a.dataIndex+N,t)},_setValue:function(t){var i,a,n=this,o=this.options.multi;n.afterSetValue=!1;var c=setInterval(function(){n.afterSetData&&(a=n.rootListEl.children("li"),e.each(a,function(i,a){a=e(a),o?(a.children("div").children("a:last").hasClass(l)&&(n._unCheckNode(a),a.find("."+l).removeClass().addClass(s),n._checkParent(a)),a.children("div").children("a:last").hasClass(r)&&(n._checkNode(a),n._unCheckNode(a),a.find("."+l).removeClass().addClass(s),n._checkParent(a))):e.isArray(t)&&1!==t.length||a.find("div").removeClass(d)}),e.isArray(t)?e.each(t,function(e,i){t.length>1?n._setNodeStyle(i,!0):n._setNodeStyle(i)}):(t=[t],e.each(t,function(e,t){n._setNodeStyle(t)})),n._updateParentTextColor(),clearInterval(c),n.afterSetValue=!0,e.isNull(n.eventMap.afterSetValue)||n.eventMap.afterSetValue.call(null,null,n._getValue()),i=n._getLeafNodeObj(n._getValue()),e.equals(i,t)||e.isNull(n.eventMap.change)||n.eventMap.change.call(null,null,i))},500)},_removeNodeData:function(t,i){var a,n=t.children("ul");if(n.length>0){var o=t.children("ul").data("children");e.isNull(o)||e.each(o,function(e,t){if(t){var a=t.data("data");if(a.value===i.value)return o[e]=null,!1}})}a=t.parent("ul").parent(""),a.length&&this._removeNodeData(a,i)},_setNodeStyle:function(t,a){var n=this,o=this.options.multi,r=n.rootDiv.find("li");a=a||!1,e.each(r,function(r,l){l=e(l),l.data("data").value===t.value&&(e.isNull(t.data)||n._updateIconAndTextColor(l,t.data),o?(n._checkNode(l),n._checkParent(l),n._getSelectedMap(),n._displayRootNode(l)):a||(l.children("div").addClass(d).removeClass(i),n._displayRootNode(l)))})},_updateParentTextColor:function(){var t,i,a,n=this;t=n.rootDiv.find("li"),e.each(t,function(t,n){if(n=e(n),a=n.data("data").data,e.isNull(a)||e.isNull(a.state))return!0;if(n.data("isLeaf")||(i=n.children("div").children("span:last"),i.removeClass().addClass(v),a.state="0"),i=n.children("div").children("span:last"),i.hasClass(_))for(n=n.parent().parent();n.data("depth")>="1";)a=n.data("data").data,i=n.children("div").children("span:last"),i.removeClass().addClass(_),e.isNull(a)?n.data("data").data={state:"1"}:a.state="1",n=n.parent().parent()})},_updateIconAndTextColor:function(t,i){var a,n=t.data("data").data,o=t.children("div").children("a:first"),r=t.children("div").children("span:last");if(o.hasClass(f)||o.hasClass(h)||o.hasClass(g)||o.hasClass(m)||o.hasClass(u)){if(!e.isNull(i.type))switch(i.type){case 0:a=f;break;case 1:a=m;break;case 2:a=u;break;case 3:a=g;break;default:a=h}o.removeClass().addClass(a)}e.isNull(n)&&(t.data("data").data=e.objClone(i)),e.isNull(i.state)||("1"===i.state?r.removeClass().addClass(_):r.removeClass().addClass(v)),e.extend(n,i)},_displayRootNode:function(t){var i=this,a=t.children("div").children("."+n);i._clickExpandEventTrigger(e(a)),1!==t.data("depth")&&i._displayRootNode(t.parent().parent())},_findNodeUI:function(i){var a=this._findParentNode(i,this.treeEl)||this.treeEl,n=a.children("ul").data("children"),o=null,r=e.isArray(i)?i[0]:i;return e.isNull(n)?null:(e.each(n,function(e,i){return i&&i.data("data").value===r.value?(o=i,!1):t}),o)},_hasChild:function(e){return e?!!e.find("li").length:!1},_findParentNode:function(i,a){if(a=a||this.treeEl,0===a.find("li").length)return null;var n=this,o=a.children("ul").data("children"),r=!1,l=null;return e.isNull(o)?null:(e.each(o,function(e,t){if(t){if(t.data("data").value===i.value)return r=!0,l=a,!1;if(n._hasChild(t)){var o=n._findParentNode(i,t);if(o)return r=!0,l=o,!1;if(r)return!1}}}),r&&l?l:t)},_dblClickEventTrigger:function(t){var a,r,l,s,c=this,h=c.options,u=h.parent,p=e(t.target);c.options.disabled||(r=p.hasClass(i)||p.hasClass(d)?p.parent():p.parent().parent(),l=r.data("data"),u&&(l=c._createNodeData(r,l)),c._trigger("nodeDClick",r,l),e.isNull(c.eventMap.nodeDClick)||c.eventMap.nodeDClick.call(this,t,l),c.options.lazyLoad?e(p.children("."+n)).length>0?c._clickExpandEventTrigger(e(p.children("."+n)),t):c._clickExpandEventTrigger(e(p.children("."+o)),t):(s=r.children("div"),"none"===r.children("ul").css("display")?(r.children("ul").show(),a=s.children("a:first").hasClass(n),a&&s.children("a:first").removeClass(n).addClass(o)):(r.children("ul").hide(),a=s.children("a:first").hasClass(o),a&&s.children("a:first").removeClass(o).addClass(n))))},_clickExpandEventTrigger:function(t,i){var a=this,r=a.options.lazyLoad;if(!a.options.disabled){if(t.hasClass(y)||t.hasClass(x))return!0;if(t.hasClass(o))return t.parent().parent().children("ul").hide(),t.removeClass().addClass(n),e.isNull(i)||e.isNull(a.eventMap.nodeExpand)||a.eventMap.nodeExpand.call(this,i,{isExpand:!1}),!0;if(t.hasClass(n)){t.parent().parent().children("ul").show();var l=t.parent().parent();return t.parent().parent().children("ul"),t.removeClass().addClass(o),e.isNull(i)||e.isNull(a.eventMap.nodeExpand)||a.eventMap.nodeExpand.call(this,i,{isExpand:!0}),r&&l.data("lazyLoad")&&l.data("lazyLoad",!1),!0}}},_beforeOnCheckEventTrigger:function(i){var a=this,n=e(i.target);
if(!a.options.disabled)return n.hasClass(s)||n.hasClass(r)?a._beforeCheckboxClick(i):t},_onCheckEventTrigger:function(t){var i,a=this,n=e(t.target),o=a.options.lazyLoad;if(!a.options.disabled&&n.hasClass(s)){i=n.parent().parent();var r=n.parent().parent().children("ul");return o&&i.data("lazyLoad")&&(i.data("isLastRoot")?a.addNode(i.data("data").children,!1,r,i.data("depth"),!0):a.addNode(i.data("data").children,!1,r,i.data("depth"),!1),i.data("lazyLoad",!1)),a._checkNode(i),a._checkParent(i),a._getSelectedMap(),a._trigger("change",i,i.data("data")),a._trigger("nodeCheck",i,i.data("data")),e.isNull(a.eventMap.nodeCheck)||a.eventMap.nodeCheck.call(this,t,i.data("data")),e.isNull(a.eventMap.change)||a.eventMap.change.call(this,t,i.data("data")),!0}},_beforeCheckboxClick:function(t){var i=this,a=e(t.target),n=a.parent().parent(),o=!0;if(!i.options.disabled)return i._trigger("beforeCheckboxClick",n,n.data("data")),e.isNull(i.eventMap.beforeCheckboxClick)||(o=i.eventMap.beforeCheckboxClick.call(this,t,n.data("data")),e.isNull(o)&&(o=!0)),o?!1:!0},_unCheckEventTrigger:function(i){var a,n=this,o=e(i.target);if(!n.options.disabled)return o.hasClass(l)?(a=o.parent().parent(),n._unCheckNode(a),a.find("."+l).removeClass().addClass(s),n._checkParent(a),n._trigger("nodeUnCheck",a,a.data("data")),e.isNull(n.eventMap.nodeUnCheck)||n.eventMap.nodeUnCheck.call(this,a.data("data")),n._trigger("change",a,a.data("data")),e.isNull(n.eventMap.change)||n.eventMap.change.call(this,a.data("data")),n._getSelectedMap(),!0):t},_checkEventTrigger:function(e){var i,a=this;if(!a.options.disabled)return e.hasClass(r)?(i=e.parent().parent(),a._checkNode(i),a._checkParent(i),a._getSelectedMap(),!0):t},_clickNodeEventTrigger:function(t){var r,l,s=this,c=this.options,h=e(t.target);if(!s.options.disabled&&(c.parentAllowNodeClick||c.multi||!(h.children().hasClass(n)||h.children().hasClass(o)||h.parent().children().hasClass(n)||h.parent().children().hasClass(o))))return s.rootDiv.find("."+d).removeClass(d).addClass(i),s.rootDiv.find("."+a).removeClass(d),s.rootDiv.find("."+a).removeClass(a).addClass(i),h.hasClass(i)?(h.addClass(d),h.removeClass(i),h.addClass(a),l=h.parent().data("data"),r=s._getNodeClickData(),s._trigger("nodeClick",h.parent(),l),e.isNull(s.eventMap.nodeClick)||s.eventMap.nodeClick.call(this,t,l),c.multi||(s._trigger("change",h.parent(),r),e.isNull(s.eventMap.change)||s.eventMap.change.call(this,t,r))):(l=h.parent().parent().data("data"),h.hasClass(w)&&(e.isNull(s.eventMap.nodeEdit)||s.eventMap.nodeEdit.call(this,t,l)),h.parent().addClass(d),h.parent().removeClass(i),h.parent().addClass(a),r=s._getNodeClickData(),s._trigger("nodeClick",h.parent().parent(),l),e.isNull(s.eventMap.nodeClick)||s.eventMap.nodeClick.call(this,t,l),c.multi||(s._trigger("change",h.parent().parent(),r),e.isNull(s.eventMap.change)||s.eventMap.change.call(this,t,r))),!0},_afterCreateSweetWidget:function(){var i=this,a=null;i.options.nodeDraggable&&i._addNodeDragEvent(),i.rootListEl.bind("dblclick",function(e){clearInterval(a),i._dblClickEventTrigger(e)}),i.lazyLoadDiv.bind("click",function(t){var a=e(t.target),n=a.data("clickCount"),o=a.data("data");a.data("clickCount",n+1),i.addNode(o)}),i.rootListEl.bind("click",function(n){clearInterval(a);var o=e(n.target),r=!1;r=i._clickExpandEventTrigger(o,n),r||(r=i._beforeOnCheckEventTrigger(n),r||(r=i._onCheckEventTrigger(n),r||(r=i._unCheckEventTrigger(n),r||(r=i._checkEventTrigger(o),r||(a=setInterval(function(){return r=i._clickNodeEventTrigger(n),r?(clearInterval(a),!1):t},300))))))})},_checkNode:function(t){if(!e.isNull(t)){var i=this,a=t.children("ul").data("children");a&&e.each(a,function(e,t){i._checkNode(t,!0)}),i._onCheckNode(t,!0)}},_onCheckNode:function(e,t){var i,a,n,o,d,c,h,u=e.length;0!==u&&(i=e.children().children("."+s).length>0?e.children().children("."+s):e.children().children("."+r),d=e.data("data"),c=e.data(I),i.removeClass(),n=t?l:r,i.addClass(n),o=e.parent("ul").parent("li"),a=this.options.multi?o.data(I):[],o.length>0&&(h={text:d.text,value:d.value,data:d.data,editable:d.editable},c.length>0&&(h.children=c),a[d.value]=h,o.data(I,a),o.data("selectMap").length++))},_unCheckNode:function(t){if(!e.isNull(t)){var i=this,a=t.children("ul").data("children");i._onUnCheckNode(t),a&&e.each(a,function(e,t){i._unCheckNode(t)})}},_onUnCheckNode:function(e){if(0!==e.length){var t=e.data("data"),i=e.parent("ul").parent("li");if(i.length>0){var a=i.data(I);a.length>0&&(delete a[t.value],i.data("selectMap").length--)}}},_deleteSelectedMap:function(t){var i,a=this,n=[];if(t.data("isLeaf")){n=t.data("data");for(var o=0;a.selectMap.length>o;o++)a.selectMap[o].value===n.value&&a.selectMap[o].text===n.text&&a.selectMap.splice(o,1)}else i=t.find("li"),e.each(i,function(t,i){n=e(i).data("data");for(var o=0;a.selectMap.length>o;o++)a.selectMap[o].value===n.value&&a.selectMap[o].text===n.text&&a.selectMap.splice(o,1)})},_checkParent:function(i){var a,n=this,o=i.parent(),d=o.parent("li"),c=d.data("data"),h=d.data(I),u=d.parent("ul").parent("li"),p=o.children("li").length,f=0,g=0,m=o.children("li"),v=o.parent();if(1===i.data("depth"))return i;if(e.each(m,function(t,i){e(i).children("div").children().hasClass(s)&&f++,e(i).children("div").children().hasClass(l)&&g++}),0===g&&(c={text:t,value:c.value,data:t,editable:t}),a=n.options.icon?2:1,p===g?d.children("div").children("a:eq("+a+")").removeClass().addClass(l):p===f?(d.children("div").children("a:eq("+a+")").removeClass().addClass(s),n._onUnCheckNode(d)):d.children("div").children("a:eq("+a+")").removeClass().addClass(r),u.length>0){var w=u.data(I),_={text:c.text,value:c.value,data:c.data,editable:c.editable};h.length>0&&(_.children=h),w[c.value]=e.isNull(_.text)?t:_,u.data(I,w)}return i=n._checkParent(v)},_addNodeDragEvent:function(){var t,a=this,n=a.options,o=n.parent,r=n.nodeAccept,l=a.treeEl;l.draggable({opacity:1,appendTo:"body",helper:function(n){var r,s,d,c,w,_=e("<div>"),C=n.target,b=null;return l.children("ul").children("li").each(function(t,i){e.isNull(i)||e.contains(i,C)&&(b=e(C))}),null===b?_:(s=b.hasClass(i)?b.parent():b.parent().parent(),d=s.data("data"),o&&(d=a._createNodeData(s,d)),a.dragData=d,c=e(s.children()[0]),w=c.children(),a.options.icon&&(r=w.hasClass(h)?c.children("."+h).clone():w.hasClass(u)?c.children("."+u).clone():w.hasClass(p)?c.children("."+p).clone():w.hasClass(f)?c.children("."+f).clone():w.hasClass(g)?c.children("."+g).clone():c.children("."+m).clone(),r.appendTo(_)),t=c.children("."+v).clone(),_.addClass(T),t.appendTo(_),l.draggable("option","cursorAt",{left:_.width()/2,top:_.height()/2}),_)}}),r&&r.droppable({drop:function(t,i){k===i.helper[0].className&&(a._trigger("nodeDrag",a.dragData,a.dragData),e.isNull(a.eventMap.nodeDrag)||a.eventMap.nodeDrag.call(null,t,a.dragData))}})},_createNodeData:function(e,t){for(var i,a;e.data("depth")>1;)e=e.parent().parent(),i=e.data("data"),a={text:i.text,value:i.value,data:i.data,children:t},t=a;return t},_deleteAttrIsSelect:function(t){return e.each(t,function(e,t){t.data&&delete t.data.isSelect}),t},_getSelectedMap:function(){var t,i,a=this,n=this.treeEl.children("ul").data("children"),o=a.selectMap=[];return e.isNull(n)?[]:(e.each(n,function(e,n){n&&(t=n.data("data"),i=n.data(I),a.options.multi?n.find("."+l).length>0&&(o[t.value]={text:t.text,value:t.value,data:t.data,editable:t.editable,children:i}):n.find("."+d).length>0&&(o[t.value]={text:t.text,value:t.value,data:t.data,editable:t.editable,children:i},o.length++))}),o)},_getNodeClickData:function(){var e,t,i={};for(t=this.treeEl.find("."+d).parent("li"),e=t.data("data"),i=t.data("isLeaf")?{text:e.text,value:e.value,data:e.data,editable:e.editable}:e,t=t.parent().parent();t.data("depth")>0;)e=t.data("data"),i={text:e.text,value:e.value,data:e.data,editable:e.editable,children:[i]},t=t.parent().parent();return[i]},_getValue:function(){var t=this;if(!t.options.multi){var i=this.treeEl.find("."+d).parent("li");i.length>0&&(t._checkNode(i),t._checkParent(i))}return t._getSelectedMap(),e.deleteUndefinedData(t.selectMap)},_createSweetWidget:function(){var t,i,a=this,n=this.options;a.selectMap=[],a.eventMap={},t=this.treeEl=e("<div>").attr("id",n.id).addClass("sweet-tree-list sweet-tree-panel").addClass(n.widgetClass),L++,this.rootDiv=e("<div>").width(n.width).height(n.height),this.rootDiv.attr("id",n.id+C+L),this.lazyLoadDiv=e("<div title='"+Sweet.core.i18n.tree.clickLoad+"'>").text("...").addClass(E),this.isgetData=!0,n.search&&(a.searchFiedlDiv=e("<div>").attr("id",n.id+C+L+"search").addClass(b),a.searchField=new Sweet.form.SearchField({width:n.width,emptyText:n.searchEmptyText}),a.searchField.addListener("keyup",function(t,i){a.filter(i.text),e.isNull(a.eventMap.search)||a.eventMap.search.call(null,t,i)}),a.searchField.addListener("click",function(t,i){a.filter(i.text),e.isNull(a.eventMap.search)||a.eventMap.search.call(null,t,i)}),n.disabled?(a.searchField.setDisabled(!0),a.rootDiv.addClass(D)):(a.searchField.setDisabled(!1),a.rootDiv.removeClass(D))),i=n.height,"auto"===n.height&&0!==n.maxHeight?(i=n.maxHeight,a.rootListEl=e("<ul>").appendTo(a.treeEl).addClass(x).css("max-height",i),a.rootListEl.width(n.width),a.rootListEl.height(n.height)):(a.rootListEl=e("<ul>").appendTo(a.treeEl).addClass(y),a.rootListEl.width(n.width),a.rootListEl.height(n.height)),a._initValue(),n.store?n.store.addListener({setData:a.setData,scope:this}):a._filterCache()},_filterCache:function(){var t=this;t.filterData=e.objClone(t.data),e.isEmptyObject(t.filterData)&&(t.filterData=[])},_destroyWidget:function(){var e=this;this.treeEl&&this.treeEl.remove(),e.timerTreeContent&&Sweet.Task.Timeout.stop(e.timerTreeContent)},_showTreeNode:function(t){t=t||this.treeEl;var i=this,a=t.children("ul"),n=a.data("children");n&&e.each(n,function(e,t){i._showTreeNode(t)}),t.hide()},_render:function(e){var t=this;return t._super(e)?(t.rootDiv.appendTo(t.renderEl),t.searchField&&(t.searchFiedlDiv.appendTo(t.rootDiv),t.searchField.render(t.searchFiedlDiv.attr("id"))),t.treeEl.appendTo(t.rootDiv),t.options.lazyLoad&&t.lazyLoadDiv.appendTo(t.treeEl),t.rendered=!0,!0):!1},_removeListener:function(){var t=this;t.handlers=t.handlers||{},e.each(t.handlers,function(e){"change"===e&&(t.eventMap.change=null,delete t.handlers.change),"search"===e&&(t.eventMap.search=null,delete t.handlers.search),"nodeDClick"===e&&(t.eventMap.nodeDClick=null,delete t.handlers.nodeDClick),"afterSetData"===e&&(t.eventMap.afterSetData=null,delete t.handlers.afterSetData),"afterSetValue"===e&&(t.eventMap.afterSetValue=null,delete t.handlers.afterSetValue),"nodeCheck"===e&&(t.eventMap.nodeCheck=null,delete t.handlers.nodeCheck),"nodeUnCheck"===e&&(t.eventMap.nodeUnCheck=null,delete t.handlers.nodeUnCheck),"nodeClick"===e&&(t.eventMap.nodeClick=null,delete t.handlers.nodeClick),"nodeDrag"===e&&(t.eventMap.nodeDrag=null,delete t.handlers.nodeDrag),"beforeCheckboxClick"===e&&(t.eventMap.beforeCheckboxClick=null,delete t.handlers.beforeCheckboxClick),"nodeExpand"===e&&(t.eventMap.nodeExpand=null,delete t.handlers.nodeExpand),"nodeEdit"===e&&(t.eventMap.nodeEdit=null,delete t.handlers.nodeEdit)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"change"===e&&(t.eventMap.change=i),"search"===e&&(t.eventMap.search=i),"nodeDClick"===e&&(t.eventMap.nodeDClick=i),"afterSetData"===e&&(t.eventMap.afterSetData=i),"afterSetValue"===e&&(t.eventMap.afterSetValue=i),"nodeCheck"===e&&(t.eventMap.nodeCheck=i),"nodeUnCheck"===e&&(t.eventMap.nodeUnCheck=i),"nodeClick"===e&&(t.eventMap.nodeClick=i),"nodeDrag"===e&&(t.eventMap.nodeDrag=i),"beforeCheckboxClick"===e&&(t.eventMap.beforeCheckboxClick=i),"nodeExpand"===e&&(t.eventMap.nodeExpand=i),"nodeEdit"===e&&(t.eventMap.nodeEdit=i)})},_getLeafNodeObj:function(t,i){var a=this;if(i=i||[],t){var n=[];e.isNull(t)?n=[]:e.isArray(t)?n=t:n.push(t);for(var o=0;n.length>o;o++)n[o].children?a._getLeafNodeObj(n[o].children,i):i.push(n[o]);return i}}}),Sweet.tree.Tree=e.sweet.widgetTreeTree}(jQuery),function(e,t){var i="sweet-treev1",a="sweet-treev1-panel",n="sweet-treev1-disabled",o="sweet-treev1-body",r="sweet-treev1-ul",l="sweet-treev1-node",s="sweet-treev1-node-text",d="sweet-treev1-node-cc-text",c="sweet-treev1-node-selected",h="sweet-treev1-node-expanded",u="sweet-treev1-node-collapsed",p="sweet-treev1-node-fullchecked",f="sweet-treev1-node-checked",g="sweet-treev1-node-unchecked",m="sweet-treev1-search",v="sweet-treev1-node-folder-ioc",w="sweet-treev1-node-leaf-ioc",_="sweet-treev1-node-leaf-index",C="sweet-treev1-node-leaf-dimension",b="sweet-treev1-node-leaf-comp",E="sweet-treev1-node-leaf-userDefine",y="sweet-treev1-node-line",x="sweet-treev1-node-line-minus",T="sweet-treev1-node-eblow",D="sweet-treev1-node-eblow-end",S="sweet-treev1-node-eblow-minus",k="sweet-treev1-node-edit-menu",L="change",N="search",I="beforesearch",A="click",P="beforedbclick",M="dbclick",F="beforeexpand",W="expand",B="beforecollapse",O="collapse",R="beforecheckchange",H="checkchange",j="selected",z="beforeload",V="load",U="beforetextchange",G="textchange",Y="beforeedit",q="edit",$="beforeremove",K="remove",X="value",Q="text",Z="data",J="checked",et="expanded",tt="hidden",it="qtip",at="icon",nt="leaf",ot="isLast",rt="depth",lt="path",st="parentPath",dt="children",ct="allChildren",ht="el",ut="li",pt="loaded",ft="expanded",gt="checked",mt="node",vt="name",wt="0",_t="1",Ct="2",bt={0:C,1:_,2:E,3:b},Et=Sweet.core.i18n.tree,yt={add:{text:Et.add,icon:"../../../sweet/themes/default/core/images/tree/tree_add.png"},"delete":{text:Et["delete"],icon:"../../../sweet/themes/default/core/images/tree/tree_delete.png"},edit:{text:Et.edit,icon:"../../../sweet/themes/default/core/images/tree/tree_edit.png"}},xt="#&#*#&#",Tt=300,Dt=Dt||1e3;e.widget("sweet.widgetTreeTree_v1",e.sweet.widgetTree,{version:"1.0",sweetWidgetName:"[widget-tree-tree-v1]:",type:"tree",eventNames:{click:"树节点单击事件, 只针对单选叶子节点操作",beforedbclick:"树节点双击前事件",dbclick:"树节点双击事件",beforeselected:"单选树节点选中前事件",selected:"单选树节点选中事件",checkchange:"树节状态改变时事件",beforecheckchange:"树节状态改变前事件",beforecollapse:"树节点收起前事件,如果返回false则收起操作终止",collapse:"树节点收起事件",beforeexpand:"树节点展开前事件,如果返回false则展开操作终止",expand:"树节点展开事件",beforeload:"延迟加载数据时,加载前事件",load:"延迟加载数据时,数据加载回时事件",search:"查询事件",beforesearch:"查询前事件",drag:"树节点的拖拽事件",change:"切换树节点事件",beforetextchange:"节点文本发生变化前事件",textchange:"节点文本发生变化事件",beforeremove:"节点删除前事件",remove:"节点删除事件",beforeedit:"节点编辑前事件",edit:"节点编辑事件"},options:{data:null,multi:!1,search:!1,tip:!1,disabled:!1,icon:!0,draggable:!1,useArrows:!0,valueKeys:[X,Q,Z,at],loader:null,editable:!1,isDbClickEdit:!0,showCCount:!1,searchEmptyText:Sweet.core.i18n.tree.search,queryDelay:350,isParentNodeSelect:!1},_createSweetWidget:function(){var t,l=this,s=350,d=l.options.id,c=l.options.widgetClass;if(l.liHeight=22,l.searchFieldHeight=25,l.renderSize=10,l.isRenderAll=!1,l.__tempRenderTop=-100,l.data=l.options.data||[],l.listDatas=[],l.objDatas={},l.optListDatas=[],l.optObjDatas={},l.selectedDatas={},l.optShowDatas=[],l.contentType="application/json;charset=UTF-8",l.treeEl=e("<div>").attr("id",l.options.id).addClass(a),l.options.disabled&&l.treeEl.addClass(n),c&&""!=c&&l.treeEl.addClass(c),l.options.multi||!0!==l.options.editable&&"true"!==l.options.editable&&!e.isArray(l.options.editable)||(l.options.search=!1,l.options.useArrows=!1),l.options.search&&(s=parseInt(l.options.queryDelay,10),isNaN(s)&&(s=350),0>s&&(s=0),l.searchFiedlDiv=e("<div>").attr("id",d+i+"-search-"+Dt).appendTo(l.treeEl).addClass(m),l.searchField=new Sweet.form.SearchField({width:l.options.width,emptyText:Sweet.core.i18n.tree.search}),l.searchField.addListener("keyup",function(e,t){Sweet.Task.Delay.start({id:l.options.id+"-treev1-filter-delay1",run:function(e){l.filter(e)},args:t.value,delay:s})}),l.searchField.addListener("click",function(e,t){Sweet.Task.Delay.start({id:l.options.id+"-treev1-filter-delay2",run:function(e){l.filter(e)},args:t.value,delay:s})})),l.treeBodyDiv=e("<div>").addClass(o),l.treeUL=e("<ul>").addClass(r).appendTo(l.treeBodyDiv),l.treeBodyDiv.appendTo(l.treeEl),t=l.options.listeners,!e.isEmptyObject(t))for(var h in t)l.addListener(""+h,t[h]);l.options.loader&&(1!=l.options.loader.autoLoad&&"true"!=l.options.loader.autoLoad&&(l.options.loader.autoLoad=!1),l.options.loader.autoLoad&&(l.data=l._loadDatas().datas||[])),l.options.multi||!0!==l.options.editable&&"true"!==l.options.editable&&!e.isArray(l.options.editable)||(Tt=500),l._initData(l.data)},setData:function(t){var i=this;i.options.disabled||(e.isNull(t)&&(t=[]),e.isArray(t)||(t=[t]),i.data=t,i._reset(),i.searchField&&i.searchField.setValue({value:"",text:""}),i._initData(i.data),i._setData())},_setData:function(){var e=this,t=e.treeBodyDiv;e._removeAllNodeList(),t[0].scrollTop=0,e._doLayout()},_parseChildren:function(e){var t=this,i=[],a=t.optObjDatas[e];if(!a||a.leaf||!a.children||0===a.children.length)return null;var n,o,r;for(var l in a.children)n=t.optObjDatas[a.children[l]],o={checked:n.checked,depth:n.depth,expanded:n.expanded,hidden:n.hidden,leaf:n.leaf,loaded:n.loaded,text:n.text,value:n.value},r=t._parseChildren(n.path),null!=r&&(o.children=r),i.push(o);return i},getAllData:function(){var e,t=this;if(t.options.loader){e=[];var i,a;for(var n in t.optObjDatas)i=t.optObjDatas[n],0===i.depth&&(a={checked:i.checked,depth:i.depth,expanded:i.expanded,hidden:i.hidden,leaf:i.leaf,loaded:i.loaded,text:i.text,value:i.value,children:t._parseChildren(i.path)},e.push(a));return JSON.parse(JSON.stringify(e))}},getData:function(){var t,i,a,n,o,r=this,l=r.options.valueKeys;if(r.options.loader)return[];if(!r.options.multi&&(!0===r.options.editable||"true"===r.options.editable||e.isArray(r.options.editable))){if(n=r.treeUL.find("li"),!n||0>=n.length)return r.listDatas=r.optListDatas=[],r.objDatas=r.optObjDatas={},[];t={},o=[];for(var s=0;n.length>s;s++){a={},i=e(n[s]).data("node");for(var d=0;l.length>d;d++)a[l[d]]=i[l[d]];i[nt]||(a[dt]=[]),i[st]?t[i[st]]&&(t[i[st]][dt]||(t[i[st]][dt]=[]),t[i[st]][dt].push(a)):o.push(a),t[i[lt]]=a}return t=null,o}return JSON.parse(JSON.stringify(r.data))},setValue:function(i){var a=this,n=e.objClone(i),o=[],r={},l={};if(!a.options.disabled){if(n=n||[],e.isArray(n)||(n=[n]),a._reset(),a.parseDatas(e.objClone(n),o,r,"",!1,null),!a.options.multi){a.treeUL.find("li").removeClass(c);for(var s in r)if(r[s][nt]){if(a.optObjDatas[s]){a._doSelected(a.optObjDatas[s]),a._doBubbleExpanded(a.optObjDatas[s]);break}if(a.objDatas[s]){a.selectedDatas[s]=a.objDatas[s];break}}return n=a._getValue(null,!0),a._triggerHandler(n,L,a),t}if(a.isRenderAll){for(var s in a.optObjDatas)a._checked(a.optObjDatas[s],wt),r[s]&&r[s][nt]&&(a._checked(a.optObjDatas[s],Ct),a.selectedDatas[s]=a.optObjDatas[s]);a._bubbleUpdateNodeChecked(a.selectedDatas);for(var s in a.selectedDatas)a.selectedDatas[s][nt]&&a._getUpdateNode(a.optObjDatas[s],l);for(var s in l)a._checked(l[s],l[s][J])}else{for(var s in a.optObjDatas)a.optObjDatas[s][J]=wt,r[s]&&r[s][nt]&&(a._asyncChecked(a.optObjDatas[s],Ct),a.selectedDatas[s]=a.optObjDatas[s]);a._bubbleUpdateNodeChecked(a.selectedDatas);for(var d,h,u,m=a.treeUL.find("li"),v=0;m.length>v;v++)d=e(m[v]),u=d.data(),h=d.find("span[name=checked]"),h&&h.length>0&&(u[J]==Ct?(h.removeClass(g),h.removeClass(f),h.addClass(p)):u[J]==_t?(h.removeClass(g),h.removeClass(p),h.addClass(f)):(h.removeClass(p),h.removeClass(f),h.addClass(g)));a.optShowDatas=a._getShowDatas(a.optListDatas,a.optObjDatas),a.treeUL.height(a.optShowDatas.length*a.liHeight),a._doTriggerScrollEvent()}for(var s in r)!a.selectedDatas[s]&&a.objDatas[s]&&a.objDatas[s][nt]&&(a.selectedDatas[s]=a.objDatas[s]);a._triggerHandler(n,L,a)}},_loadDatas:function(t){var i,a,n,o=this,r=[],l={isContinue:!0,datas:[]};if(!t){if(!o.options.loader)return t={baseParams:{}},t.baseParams.timestemp=(new Date).getTime(),i=o._triggerHandler(t,z,o),!1===i||"false"===i?(l.isContinue=!1,l):(t.datas=o.data,o._triggerHandler(t,V,o),t.datas?e.isArray(t.datas)||(t.datas=[t.datas]):t.datas=[],l.datas=t.datas,l);t=e.objClone(o.options.loader)}return t.baseParams||(t.baseParams={}),t.baseParams.timestemp=(new Date).getTime(),i=o._triggerHandler(t,z,o),!1===i||"false"===i?(l.isContinue=!1,l):(n=t.contentType&&""!=t.contentType.trim()?t.contentType:o.contentType,a={contentType:n,url:t.url,data:t.baseParams,async:!1,dataType:"json",timeout:36e5,success:function(e){r=e||[]},error:function(){r=[]}},a.loadMask=!1===t.loadMask||"false"===t.loadMask?!1:!0,Sweet.Ajax.request(a),t.datas=r,o._triggerHandler(t,V,o),t.datas?e.isArray(t.datas)||(t.datas=[t.datas]):t.datas=[],l.datas=t.datas,l)},setLoader:function(e){var t=this;t.options.loader=e,t.isRenderAll=!1,t._setData()},load:function(e){var t,i=this;i.options.disabled||(i.searchField&&i.searchField.setValue({value:"",text:""}),t=i._loadDatas(e),t.isContinue&&(i.data=t.datas,i.setData(i.data)))},_doLoaderLoad:function(t,i,a){var n,o,r,l,s,d,c,h,u,p,f,g=this,m=g.options.valueKeys;t[pt]=!0,n={};for(var v=0;m.length>v;v++)n[m[v]]=t[m[v]];if(i.tParams||(i.tParams={}),i.tParams.node=n,g.searchField&&(p=g.searchField.getValue(),p&&""!=p.value&&(i.tParams.filter=p.value)),f=g._loadDatas(i),!f.isContinue)return!1;if(o=f.datas,o.length>0){r=[],l={},s=t[rt],g.parseDatas(o,r,l,t[lt],t[tt],++s,a),e.extend(g.optObjDatas,l),t[dt]||(t[dt]=[]),t[ct]||(t[ct]=[]);for(var v=0;r.length>v;v++)d=r[v][lt],g.optObjDatas[d]&&!g.optObjDatas[d][nt]&&(g.optObjDatas[d][pt]=!0),g.optObjDatas[d][st]==t[lt]&&t[dt].push(d),t[ct].push(d);g.bubble(t,function(e,t){t[dt]||(t[dt]=[]),t[ct]||(t[ct]=[]),t[ct]=t[ct].concat(e[ct])});for(var w=0;g.optListDatas.length>w;w++)if(g.optListDatas[w][lt]==t[lt]){c=w;break}h=g.optListDatas.slice(0,c+1),u=g.optListDatas.slice(c+1),g.optListDatas=h.concat(r,u)}return!0},filter:function(i){var a,n,o,r=this,l={},s={},d={};if(o={filter:i},n=r._triggerHandler(o,I,r),!1!==n&&"false"!==n){if(i=o.filter,r.searchField&&r.searchField.setDisabled(!0),r.options.loader)return r._doLoaderFilter(i,e.objClone(r.options.loader)),r.searchField&&r.searchField.setDisabled(!1),t;if(e.isNotNull(i)){r.optObjDatas=e.objClone(r.objDatas),a=RegExp(e.regExp.escape(i),"i");for(var c in r.optObjDatas)r.optObjDatas[c][nt]&&a.test(r.optObjDatas[c][Q])&&(l[c]=r.optObjDatas[c]);var h=h=r.options.valueKeys;r.parseTreeDatas(l,r.optObjDatas,h,d),d=d.data?d.data:[],r.optListDatas=[],r.optObjDatas={},r.parseDatas(d,r.optListDatas,r.optObjDatas,"",!1,null)}else r.optListDatas=e.objClone(r.listDatas),r.optObjDatas=e.objClone(r.objDatas),r.optShowDatas=r._getShowDatas(r.optListDatas,r.optObjDatas),r.treeUL.height(r.optShowDatas.length*r.liHeight),r._doTriggerScrollEvent();if(r.options.multi){for(var c in r.selectedDatas)r.optObjDatas[c]&&(r.optObjDatas[c][J]=Ct,s[c]=r.optObjDatas[c]);r._bubbleUpdateNodeChecked(s)}if(e.isNotNull(i))for(var c in r.optObjDatas)r.optObjDatas[c][tt]=!1,r.optObjDatas[c][nt]||(r.optObjDatas[c][et]=!0);r._triggerHandler(r.optObjDatas,N,r),r._setData(),l=null,s=null,d=null,r.searchField&&r.searchField.setDisabled(!1)}},_doLoaderFilter:function(e,t){var i,a,n=this;e?(t.tParams||(t.tParams={}),t.tParams.filter=e):t.tParams&&delete t.tParams.filter,a=n._loadDatas(t),a.isContinue&&(i=a.datas,n.data=i,n._reset(),n._initData(n.data),n._setData())},_setWidth:function(e){var t=this;!e||0>e||(t.width=e,t.treeEl.externalWidth(e))},_setHeight:function(e){var t=this;!e||0>e||(t.height=e,t.treeEl.externalHeight(e))},_setWH:function(e,t){var i=this;i.width=e,i.height=t,i.treeEl.externalWidth(e).externalHeight(t)},_getWidth:function(){var e=this;return e.treeEl.externalWidth()},_getHeight:function(){var e=this;return e.treeEl.externalHeight()},resizeLayout:function(e,t){var i=this,a=i.treeBodyDiv[0],n=a.scrollTop,o=a.scrollLeft;i.setWH(e,t),a.scrollTop=n,a.scrollLeft=o},cascade:function(e,t){var i=this;if(e&&e[ct]&&!(0>=e[ct].length)&&t&&"function"==typeof t)for(var a=0;e[ct].length>a;a++)t(i.optObjDatas[e[lt]],i.optObjDatas[e[ct][a]])},bubble:function(e,t){var i=this;t&&"function"==typeof t&&e[st]&&""!=e[st]&&(t(i.optObjDatas[e[lt]],i.optObjDatas[e[st]]),i.bubble(i.optObjDatas[e[st]],t))},_doLayout:function(){var e,t,i,a,n,o=this,r=0,l=0,s=o.liHeight;if(o._editMenu&&o._editMenu.destroy(),e=parseInt(o.options.width,10),t=parseInt(o.options.height,10),l=12,o.options.search&&(o.searchField.setWidth(e),r=o.searchFiedlDiv.outerHeight(!0)),isNaN(parseInt(o.options.height,10))||(t=parseInt(o.options.height,10)),isNaN(parseInt(o.options.width,10))||(e=parseInt(o.options.width,10)),t-=l,i=t-r,0>i&&(i=0),o.renderSize=Math.ceil(i/s),0>=o.renderSize&&(o.renderSize=1),o.treeBodyDiv.externalWidth(e).css("height",i),o.treeBodyDiv[0].scrollTop=0,o.isRenderAll){o.treeBodyDiv.unbind("scroll"),o.treeUL.height("auto"),a=[];for(var d=0;o.optListDatas.length>d;d++)a.push(o.optObjDatas[o.optListDatas[d][lt]]);o._doRenderAll(a)}else o.optShowDatas=o._getShowDatas(o.optListDatas,o.optObjDatas),o.treeUL.height(o.optShowDatas.length*s),a=o.optShowDatas.slice(0,o.renderSize),o._registScrollEvent(),o._createListNode(a,0,!1);o.__isTempFlag||(o.__isTempFlag=!0,n=o._getValue(null,!0),n&&n.length>0&&o._triggerHandler(n,L,o))},_render:function(e){var t=this;return t._super(e)?(t.treeEl.appendTo(t.renderEl),t.searchField&&t.searchField.render(t.searchFiedlDiv.attr("id")),t.setDisabled(t.options.disabled),t.rendered=!0,!0):!1},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},setDisabled:function(e){var t=this;t.options.disabled=e,t.searchField&&t.searchField.setDisabled(e),e?t.treeEl.addClass(n):t.treeEl.removeClass(n)},getValue:function(e,t){var i=this;return i._getValue(e,t)},_getValue:function(t,i){var a,n=this,o={},r=n.options.valueKeys,l=!1,s=n.optObjDatas;if(e.isEmptyObject(n.selectedDatas))return[];if(e.isArray(t)&&t.length>0&&(r=t),i&&(s=n.objDatas),n.parseTreeDatas(n.selectedDatas,s,r,o),!o.data)return[];if(a=e.objClone(o.data),!n.options.multi&&(!0===n.options.editable||"true"===n.options.editable||e.isArray(n.options.editable))){for(var d in n.selectedDatas){n.selectedDatas[d][nt]||(l=!0);break}l&&(a=n._doInitValue(a))}return a},_doInitValue:function(e){for(var t=this,i=0;e.length>i;i++)if(e[i][dt]&&e[i][dt].length>0){if("string"==typeof e[i][dt][0])return delete e[i][dt],e;t._doInitValue(e[i][dt])}return e},_doRenderAll:function(t){var i,a,n,o,r,d,c,p,f,m,_,C,b=this,E=0,k=!1,L="";if(b.options.multi||!0!==b.options.editable&&"true"!==b.options.editable&&!e.isArray(b.options.editable)||(k=!0,L=s,b.treeBodyDiv.unbind("contextmenu"),b.treeBodyDiv.bind("contextmenu",{me:b,isTreeBody:!0},b._onNodeMousedown)),b.treeUL.find("li").remove(),t&&!(0>=t.length)){for(var N=0;t.length>N;N++){a=null,n=null,d=e("<li>").addClass(l),m=t[N],p=b.options.useArrows?y:x,c=m[rt],_={},b._getPLastNode(m,b.optObjDatas,_);for(var I=0;c>I;I++)_[I]?e("<span>").addClass(x).appendTo(d):e("<span>").addClass(p).appendTo(d);m[nt]?(f=b.options.useArrows?m[ot]?D:T:S,e("<span>").addClass(f).appendTo(d),b.options.icon&&(C=bt[m[at]],C?e("<span>").addClass(C).appendTo(d):m[at]?e("<span>").addClass(w).appendTo(d).css({background:"url("+m[at]+")"}):e("<span>").addClass(w).appendTo(d))):(n=m[et]?e("<span>").attr(vt,ft).addClass(h).appendTo(d):e("<span>").attr(vt,ft).addClass(u).appendTo(d),b.options.icon&&e("<span>").addClass(v).appendTo(d)),b.options.multi&&(o=e("<span>").attr(vt,gt).addClass(g).appendTo(d)),i=e.nullToString(m[Q]),r=e("<span>").addClass(L).text(i).appendTo(d),b.options.showCCount&&!m[nt]?a=b._addCNodeCount(m,d,r):b.options.tip&&r.attr("title",m[it]),m[tt]&&d.hide(),m[ht]={},m[ht][ut]=d,n&&(m[ht][et]=n),o?(r.bind("dblclick",{me:b,node:m,checkedEl:o},b._onNodeDbClick),a&&a.bind("dblclick",{me:b,node:m,checkedEl:o,textEl:r},b._onNodeDbClick),m[ht][J]=o,b._checked(m,m[J])):(r.bind("dblclick",{me:b,node:m,expandedEl:n},b._onNodeDbClick),a&&a.bind("dblclick",{me:b,node:m,expandedEl:n,textEl:r},b._onNodeDbClick)),d.data(mt,m).bind("click",{me:b,node:m,liEl:d},b._onNodeClick),!b.options.multi&&e.isArray(b.options.editable)&&b.options.editable.length>0&&d.bind("contextmenu",{me:b,node:m,liEl:d,textEl:r},b._onNodeMousedown),!b.options.multi&&b.selectedDatas[m[lt]]&&b._doSelected(m),d.appendTo(b.treeUL)}E=b._getLiMaxWidth(b.treeUL,k),b._setElWidth(b.treeUL,E,k)}},_registScrollEvent:function(){var t=this,i=0,a=t.treeBodyDiv;a.unbind("scroll"),a.scroll(function(){i!=e(this)[0].scrollTop&&(i=e(this)[0].scrollTop,t._doTriggerScrollEvent())})},_doTriggerScrollEvent:function(){var e,t,i,a=this,n=0,o=a.treeBodyDiv,r=[],l=!1,s=0;l=!1,i=o[0].clientHeight,e=o[0].scrollHeight,t=o[0].scrollTop,n=Math.floor(t/a.liHeight),r=a.optShowDatas.slice(n,n+a.renderSize),t>0&&t+i>=e?(l=!0,s=a.optShowDatas.length-a.renderSize,0>s&&(s=0,t=0),r=a.optShowDatas.slice(s)):(l=!1,(0>=t||0>n)&&(n=0,t=0,r=a.optShowDatas.slice(n,n+a.renderSize))),a._doScrollLoad(r,t,l)},_createListNode:function(t,i,a){var n=this;e.isNull(t)||(n.treeUL.find("li").remove(),n._doScrollLoad(t,i,a))},_doScrollLoad:function(e,t,i){var a,n,o=this,r=o.treeUL,l=5,s=0;i&&(o.treeBodyDiv[0].scrollTop=r.height()-o.treeBodyDiv[0].clientHeight+l),t>0&&(n=o.treeBodyDiv[0].clientHeight+t,t=n-e.length*o.liHeight),a=r.find("li");for(var d=0;e.length>d;d++)o._addLiNode(e[d],t+d*o.liHeight);a.remove(),s=o._getLiMaxWidth(r),o._setElWidth(r,s)},_addLiNode:function(t,i){var a,n,o,r,s,d,c,p,f,m,_,C=this,b=C.options.disabled;f=e("<li>").addClass(l).css({top:i,position:"absolute"}),n=C.options.useArrows?y:x,a=t[rt],s={},C._getPLastNode(t,C.optObjDatas,s);for(var E=0;a>E;E++)s[E]?e("<span>").addClass(x).appendTo(f):e("<span>").addClass(n).appendTo(f);return t[nt]?(o=C.options.useArrows?t[ot]?D:T:S,e("<span>").addClass(o).appendTo(f),C.options.icon&&(r=bt[t[at]],r?e("<span>").addClass(r).appendTo(f):t[at]?e("<span>").addClass(w).appendTo(f).css({background:"url("+t[at]+")"}):e("<span>").addClass(w).appendTo(f))):(d=t[et]?e("<span>").attr(vt,ft).addClass(h).appendTo(f):e("<span>").attr(vt,ft).addClass(u).appendTo(f),C.options.icon&&e("<span>").addClass(v).appendTo(f)),C.options.multi&&(c=e("<span>").attr(vt,gt).addClass(g).appendTo(f)),m=e.nullToString(t[Q]),p=e("<span>").text(m).appendTo(f),C.options.showCCount&&!t[nt]?_=C._addCNodeCount(t,f,p):C.options.tip&&p.attr("title",t[it]),t[ht]={},c?(p.bind("dblclick",{me:C,node:t,checkedEl:c},C._onAsyncNodeDbClick),_&&_.bind("dblclick",{me:C,node:t,checkedEl:c},C._onAsyncNodeDbClick),t[ht][J]=c,C._checked(t,t[J]),delete t[ht][J]):(p.bind("dblclick",{me:C,node:t},C._onAsyncNodeDbClick),_&&_.bind("dblclick",{me:C,node:t},C._onAsyncNodeDbClick)),t[ht][ut]=f,f.data(mt,t).bind("click",{me:C,node:t,liEl:f},C._onAsyncNodeClick),!C.options.multi&&C.selectedDatas[t[lt]]&&C._doSelected(t),f.appendTo(C.treeUL),b&&C.setDisabled(b),f},_onAsyncNodeDbClick:function(t){var i,a,n=t.data.me,o=t.data.checkedEl,r=t.data.node,s=e(t.target);n.options.disabled||(a=n._triggerHandler(e.objClone(r),P,n),!1!==a&&"false"!==a&&(o?n._doAsyncChecked(o,r):(i=s.parent("."+l).find("span[name='expanded']"),!r[nt]&&i&&n._doAsyncExpanded(i,r)),n._triggerHandler(e.objClone(r),M,n)))},_doInputFocus:function(e){var t;e.data.me,e.data.self&&(t=e.data.self.get(0),t&&(t.selectionStart=t.value.length))},_doEdit:function(t){var i,a,n,o=t.data.me,r=t.data.node;i=t.data.oldText,a=t.data.self.val(),i!=a&&(n=o._triggerHandler({text:a,oldText:i},U,o),!1===n||"false"===n?(n=!1,a=i):n=!0),t.data.self.remove(),t.data.el.text(a),n&&(o.optObjDatas[r[lt]]&&(o.optObjDatas[r[lt]][Q]=a,o.optObjDatas[r[lt]][it]=a,o.options.tip&&(1==o.options.showCCount||"true"==o.options.showCCount||"leaf"==o.options.showCCount?o._upDateCNodeCount(o.optObjDatas[r[lt]]):t.data.el.attr("title",a))),o.objDatas=o.optObjDatas,o._triggerHandler({text:a,oldText:i},G,o)),o._triggerHandler(e.objClone(r),q,o)},_onNodeMousedown:function(t){var i,a=t.data.me,n=[];if(!a.options.disabled&&a.options.editable&&!0!==a.options.editable&&"true"!==a.options.editable&&!(e.isArray(a.options.editable)&&0>=a.options.editable.length)&&2==t.button){t.data.isTreeBody?a._doSelected(null):a._doSelected(t.data.node),a._editMenu&&a._editMenu.destroy(),a._editMenuId||(a._editMenuId=a.options.id+"-edit-menu",e('<div id="'+a._editMenuId+'">').appendTo(document.body));
for(var o=t.pageX,r=0;a.options.editable.length>r;r++)i=yt[a.options.editable[r]],i&&n.push(i);return a._editMenu=new Sweet.menu.Menu({renderTo:a._editMenuId,widgetClass:k,X:o,Y:t.pageY,itemClick:function(e,i){a._doMenuClick(t,a,i)},items:n}),t.preventDefault(),t.stopPropagation(),a._doScrollEvent(),!1}},_doScrollEvent:function(){var e=this;e.treeBodyDiv.unbind("scroll"),e.treeBodyDiv.scroll(function(){e._editMenu&&e._editMenu.destroy()})},_doMenuClick:function(e,t,i){var a;if(!t.options.disabled)switch(i.text){case Et.add:a={},a[Q]=Et.nodeName,a[X]=t.options.id+"-edit-"+ ++Dt,t._doAddNode(a,e.data.node);break;case Et.edit:t._doEditNode(e,!0);break;case Et["delete"]:t._doDeleteNode(e.data.node);break;default:return}},_doEditNode:function(t,i){var a,n,o,r,l,s=this;n=t.data.textEl,n&&(a=t.data.node,l=s._triggerHandler({newNode:null,node:e.objClone(a)},Y,s),!1!==l&&"false"!==l&&!1!==i&&"false"!==i&&(o=n.text(),n.text(""),r=e("<input type='text'>").attr({value:o}).css({width:"100%",height:"22px"}),r.appendTo(n).bind("blur",{me:s,el:n,node:a,self:r,oldText:o},s._doEdit).bind("focus",{me:s,el:n,node:a,self:r,oldText:o},s._doInputFocus),r.focus()))},_doAddRootNode:function(t,i,a){var n,o,r,d,c,h,u=this,p=0,f="",g=[];if(u.options.multi||!0!==u.options.editable&&"true"!==u.options.editable&&!e.isArray(u.options.editable)||(f=s),t[rt]=p,t[tt]=!1,t[nt]=!0,t[it]=t[Q],t[lt]=t[X],o=e("<li>").addClass(l),e("<span>").addClass(S).appendTo(o),u.options.icon&&e("<span>").addClass(w).appendTo(o),r=e.nullToString(t[Q]),d=e("<span>").addClass(f).text(r).appendTo(o),u.options.tip&&d.attr("title",t[it]),t[ht]={},t[ht][ut]=o,d.bind("dblclick",{me:u,node:t},u._onNodeDbClick),o.data(mt,t).bind("click",{me:u,node:t,liEl:o},u._onNodeClick),o.bind("contextmenu",{me:u,node:t,liEl:o,textEl:d},u._onNodeMousedown),u.optObjDatas[t[lt]]=t,u.objDatas=u.optObjDatas,e.isEmptyObject(i))n=u.treeUL.find("li"),a&&n&&n.length>0?(u.optListDatas=[{path:t[lt]}].concat(u.optListDatas),u.listDatas=u.optListDatas,o.insertBefore(e(n[0]))):(u.optListDatas.push({path:t[lt]}),u.listDatas=u.optListDatas,o.appendTo(u.treeUL));else if(a){h=i;for(var m=0;u.optListDatas.length>m;m++)h[lt]==u.optListDatas[m][lt]&&g.push({path:t[lt]}),g.push(u.optListDatas[m]);u.optListDatas=g,u.listDatas=u.optListDatas,o.insertBefore(h[ht][ut])}else{i[nt]?h=i:(i[ct]=i[ct]||[],h=0>=i[ct].length?i:u.optObjDatas[i[ct][i[ct].length-1]]);for(var m=0;u.optListDatas.length>m;m++)g.push(u.optListDatas[m]),h[lt]==u.optListDatas[m][lt]&&g.push({path:t[lt]});u.optListDatas=g,u.listDatas=u.optListDatas,o.insertAfter(h[ht][ut])}u._doSelected(t),c=u._getLiMaxWidth(u.treeUL,!0),u._setElWidth(u.treeUL,c,!0)},_doAddNode:function(i,a){var n,o,r,d,c,u,p,f,g,m,_,C=this,b=0,E=[],y=x,T="";if(i){if(e.isEmptyObject(a))return i[rt]=b,i[tt]=!1,i[nt]=!0,i[it]=i[Q],i[lt]=i[X],C._doAddRootNode(i),t;d=a[nt],C.options.multi||!0!==C.options.editable&&"true"!==C.options.editable&&!e.isArray(C.options.editable)||(T=s),n=a[ht][ut],n.children().remove(),a[nt]=!1,a[et]=!0,a[tt]=!1,b=a[rt],i[rt]=b+1,i[tt]=!1,i[nt]=!0,i[it]=i[Q],i[lt]=a[lt]+xt+i[X],i[st]=a[lt],c=e("<li>").addClass(l);for(var D=0;i[rt]>D;D++)e("<span>").addClass(y).appendTo(c);e("<span>").addClass(S).appendTo(c),C.options.icon&&e("<span>").addClass(w).appendTo(c),u=e.nullToString(i[Q]),f=e("<span>").addClass(T).text(u).appendTo(c),C.options.tip&&f.attr("title",i[it]),i[ht]={},i[ht][ut]=c,f.bind("dblclick",{me:C,node:i},C._onNodeDbClick),c.data(mt,i).bind("click",{me:C,node:i,liEl:c},C._onNodeClick),c.bind("contextmenu",{me:C,node:i,liEl:c,textEl:f},C._onNodeMousedown);for(var D=0;b>D;D++)e("<span>").addClass(y).appendTo(n);g=e("<span>").attr(vt,ft).addClass(h).appendTo(n),C.options.icon&&e("<span>").addClass(v).appendTo(n),u=e.nullToString(a[Q]),p=e("<span>").addClass(T).text(u).appendTo(n),p.bind("dblclick",{me:C,node:a,expandedEl:g},C._onNodeDbClick),n.removeData(mt),n.unbind("click"),n.unbind("contextmenu"),n.data(mt,a).bind("click",{me:C,node:a,liEl:n},C._onNodeClick),n.bind("contextmenu",{me:C,node:a,liEl:n,textEl:p},C._onNodeMousedown),a[ht]={},a[ht][ut]=n,a[ht][et]=g,d?(a[dt]=[i[lt]],a[ct]=[i[lt]],o=a):(a[dt]=a[dt]||[],a[ct]=a[ct]||[],o=0>=a[ct].length?a:C.optObjDatas[a[ct][a[ct].length-1]],a[dt].push(i[lt]),a[ct].push(i[lt])),C.optObjDatas[i[lt]]=i,C.objDatas=C.optObjDatas;for(var k=0;C.optListDatas.length>k;k++)E.push(C.optListDatas[k]),o[lt]==C.optListDatas[k][lt]&&E.push({path:i[lt]});C.optListDatas=E,C.listDatas=C.optListDatas,1==C.options.showCCount||"true"==C.options.showCCount||"leaf"==C.options.showCCount?(C.bubble(a,function(e,t){r=[];for(var a=0;t[ct].length>a;a++)r.push(t[ct][a]),o[lt]==t[ct][a]&&r.push(i[lt]);t[ct]=r,C._upDateCNodeCount(t)}),m=C._addCNodeCount(a,n,p),m&&m.bind("dblclick",{me:C,node:a,expandedEl:g,textEl:p},C._onNodeDbClick)):(C.bubble(a,function(e,t){r=[];for(var a=0;t[ct].length>a;a++)r.push(t[ct][a]),o[lt]==t[ct][a]&&r.push(i[lt]);t[ct]=r}),C.options.tip&&p.attr("title",a[it])),c.insertAfter(o[ht][ut]),C._doSelected(i),C._doExpanded(g,a,!1),_=C._getLiMaxWidth(C.treeUL,!0),C._setElWidth(C.treeUL,_,!0)}},_doDeleteNode:function(t){var i,a,n,o,r=this,l=[],s=[];if(t&&(n=r._triggerHandler(e.objClone(t),$,r),!1!==n&&"false"!==n)){if(t[ct]&&(s=t[ct]),s.push(t[lt]),i=r.optObjDatas[t[st]],i&&i[dt]){for(var d=0;i[dt].length>d;d++)i[dt][d]!=t[lt]&&l.push(i[dt][d]);i[dt]=l}1==r.options.showCCount||"true"==r.options.showCCount||"leaf"==r.options.showCCount?r.bubble(t,function(e,t){t[ct]=r._deleteFun(t[ct],s),r._upDateCNodeCount(t)}):r.bubble(t,function(e,t){t[ct]=r._deleteFun(t[ct],s)});for(var d=0;s.length>d;d++)a=r.optObjDatas[s[d]],a&&a[ht]&&a[ht][ut]&&a[ht][ut].remove(),delete r.optObjDatas[s[d]],delete r.selectedDatas[s[d]];r.objDatas=r.optObjDatas,r.optListDatas=r._deleteFun(r.optListDatas,s),r.listDatas=r.optListDatas,o=r._getLiMaxWidth(r.treeUL,!0),r._setElWidth(r.treeUL,o,!0),r._triggerHandler(e.objClone(t),K,r)}},_deleteFun:function(e,t){var i,a,n=[];if(!e)return n;if(!t||0>=t.length)return e;i={};for(var o=0;t.length>o;o++)i[t[o]]=t[o];for(var o=0;e.length>o;o++)a=e[o],a[lt]?i[a[lt]]||n.push(a):i[a]||n.push(a);return n},_onAsyncNodeClick:function(i){var a=i.data.me,n=e(i.target),o=i.data.node;if(!a.options.disabled)switch(n.attr(vt)){case ft:a._doAsyncExpanded(n,o);break;case gt:a._doAsyncChecked(n,o);break;default:return a._doSelected(o),a._triggerHandler(e.objClone(o),A,a),t}},_doAsyncChecked:function(t,i){var a,n,o=this,r=!t.hasClass(p),l=i[ct]||[];if(!o.options.disabled&&(a=o._triggerHandler({node:e.objClone(i),checked:r},R,o),!1!==a&&"false"!==a)){if(i[nt])o._doAsyncLeafChecked(i,r);else if(r){if(i[tt]=!1,i[et]=!0,o._asyncChecked(i,Ct),o.options.loader&&!i[pt]){if(i[pt]=!0,a=o._doLoaderLoad(i,e.objClone(o.options.loader)),!a)return;l=i[ct]||[]}for(var s=0;l.length>s;s++)n=o.optObjDatas[l[s]],n[tt]=!1,n[nt]||(n[et]=!0),o._asyncChecked(n,Ct)}else{i[tt]=!1,o._asyncChecked(i,wt);for(var s=0;l.length>s;s++)n=o.optObjDatas[l[s]],o._asyncChecked(n,wt)}o._doAsyncUpdatePNodeChecked(i),o.optShowDatas=o._getShowDatas(o.optListDatas,o.optObjDatas),o.treeUL.height(o.optShowDatas.length*o.liHeight),o._doTriggerScrollEvent(),o._triggerHandler({node:e.objClone(i),checked:r},H,o)}},_asyncChecked:function(e,t){var i=this;if(e)switch(e[J]=t,t){case wt:delete i.selectedDatas[e[lt]];break;case _t:delete i.selectedDatas[e[lt]];break;case Ct:e[nt]&&(i.selectedDatas[e[lt]]=e);break;default:return}},_doAsyncLeafChecked:function(e,t){var i=this;t?(i._asyncChecked(e,Ct),e[tt]=!1):i._asyncChecked(e,wt)},_doAsyncUpdatePNodeChecked:function(e){var t,i,a,n=this,o=!1,r=!0;if(t=n.optObjDatas[e[st]]){a=t[ct].length;for(var l=0;a>l;l++)i=n.optObjDatas[t[ct][l]],Ct==i[J]?o=!0:r=!1;r?n._asyncChecked(t,Ct):o?n._asyncChecked(t,_t):n._asyncChecked(t,wt),n._doAsyncUpdatePNodeChecked(t)}},_doAsyncExpanded:function(t,i){var a,n,o,r=this,l=t.hasClass(u),s=i[dt]||[],d=i[ct]||[],c={};if(!r.options.disabled){if(l){if(n=W,o=r._triggerHandler(e.objClone(i),F,r),!1===o||"false"===o)return;if(r.options.loader&&!i[pt]){if(i[pt]=!0,o=r._doLoaderLoad(i,e.objClone(r.options.loader),c),!o)return;if(s=i[dt]||[],d=i[ct]||[],!e.isEmptyObject(c))if(r.options.multi){for(var p in c)r.selectedDatas[p]=r.optObjDatas[p];r.selectedDatas=r._getLeafSelectedDatas(r.selectedDatas)}else if(e.isEmptyObject(r.selectedDatas))for(var p in c){r.selectedDatas[p]=r.optObjDatas[p];break}}if(t.removeClass(u),t.addClass(h),i[et]=!0,s)for(var f=0;s.length>f;f++)a=r.optObjDatas[s[f]],a[tt]=!1}else{if(n=O,o=r._triggerHandler(e.objClone(i),B,r),!1===o||"false"===o)return;if(t.removeClass(h),t.addClass(u),i[et]=!1,d)for(var f=0;d.length>f;f++)a=r.optObjDatas[d[f]],a[tt]=!0,a[et]=!1}r.optShowDatas=r._getShowDatas(r.optListDatas,r.optObjDatas),r.treeUL.height(r.optShowDatas.length*r.liHeight),r._doTriggerScrollEvent(),o=r._triggerHandler(e.objClone(i),n,r)}},_onNodeDbClick:function(i){var a,n,o,r=i.data.me,l=i.data.checkedEl,s=i.data.expandedEl,c=i.data.node;if(!r.options.disabled&&(o=r._triggerHandler(e.objClone(c),P,r),!1!==o&&"false"!==o)){if(!r.options.multi&&(!0===r.options.editable||"true"===r.options.editable||e.isArray(r.options.editable)))return e(i.target).hasClass(d)||(i.data.textEl=e(i.target)),r._doEditNode(i,r.options.isDbClickEdit),(!1===r.options.isDbClickEdit||"false"===r.options.isDbClickEdit)&&!c[nt]&&s&&(n=s.hasClass(h),r._doExpanded(s,c,n)),r._triggerHandler(e.objClone(c),M,r),t;l?(a=!l.hasClass(p),r._doChecked(c,a,!0)):!c[nt]&&s&&(n=s.hasClass(h),r._doExpanded(s,c,n)),r._triggerHandler(e.objClone(c),M,r)}},_onNodeClick:function(i){var a,n,o=i.data.me,r=e(i.target),l=i.data.node;if(!o.options.disabled)switch(r.attr(vt)){case ft:n=r.hasClass(h),o._doExpanded(r,l,n);break;case gt:a=!r.hasClass(p),o._doChecked(l,a,!0);break;default:return o._doSelected(l),o._triggerHandler(e.objClone(l),A,o),t}},_doChecked:function(i,a,n){var o,r,l,s,d=this,c=i[ct];if(!d.options.disabled&&(l=d._triggerHandler({node:e.objClone(i),checked:a},R,d),!1!==l&&"false"!==l)){if(i[nt]||!c||0>=c.length)return d._doLeafChecked(i,a),d._triggerHandler({node:e.objClone(i),checked:a},H,d),t;if(a)if(i[tt]=!1,d._checked(i,Ct),n){o=i[ht][et],o&&(i[et]=!0,o.removeClass(u),o.addClass(h));for(var p=0;c.length>p;p++)r=d.optObjDatas[c[p]],d._checked(r,Ct),o=r[ht][et],o&&(r[et]=!0,o.removeClass(u),o.addClass(h)),r[tt]=!1,r[ht]&&r[ht][ut]&&r[ht][ut].show()}else for(var p=0;c.length>p;p++)r=d.optObjDatas[c[p]],d._checked(r,Ct);else{d._checked(i,wt),i[tt]=!1;for(var p=0;c.length>p;p++)r=d.optObjDatas[c[p]],d._checked(r,wt)}d._doUpdatePNodeChecked(i),s=d._getLiMaxWidth(d.treeUL),d._setElWidth(d.treeUL,s),d._triggerHandler({node:e.objClone(i),checked:a},H,d)}},_doSelected:function(t){var i,a,n=this;if(!n.options.multi&&(!t||n.options.isParentNodeSelect||t[nt]||!0===n.options.editable||"true"===n.options.editable||e.isArray(n.options.editable))){if(!e.isEmptyObject(n.selectedDatas))for(var o in n.selectedDatas)n.selectedDatas[o][ht]&&n.selectedDatas[o][ht][ut]&&(i=n.selectedDatas[o][ht][ut],i.removeClass(c));n.selectedDatas={},e.isEmptyObject(t)||(n.selectedDatas[t[lt]]=t,t[ht]&&t[ht][ut]&&(a=t[ht][ut],a.addClass(c))),n._triggerHandler(e.objClone(t),j,n)}},_checked:function(e,t){var i=this,a=null;if(e)switch(a=e[ht][J],e[J]=t,t){case wt:delete i.selectedDatas[e[lt]],a.removeClass(p),a.removeClass(f),a.addClass(g);break;case _t:delete i.selectedDatas[e[lt]],a.removeClass(g),a.removeClass(p),a.addClass(f);break;case Ct:e[nt]&&(i.selectedDatas[e[lt]]=e),a.removeClass(g),a.removeClass(f),a.addClass(p);break;default:return}},_doLeafChecked:function(e,t){var i=this;t?(i._checked(e,Ct),e[tt]=!1):i._checked(e,wt),i._doUpdatePNodeChecked(e)},_doUpdatePNodeChecked:function(e){var t,i,a,n=this,o=!1,r=!0;if(t=n.optObjDatas[e[st]]){a=t[ct].length;for(var l=0;a>l;l++)i=n.optObjDatas[t[ct][l]],Ct==i[J]?o=!0:r=!1;r?n._checked(t,Ct):o?n._checked(t,_t):n._checked(t,wt),n._doUpdatePNodeChecked(t)}},_doBubbleExpanded:function(t){var i,a,n,o=this,r=0,l=!1;o.options.disabled||t&&(o.bubble(t,function(e,t){t[et]=!0,t[tt]=!1,t[ht]&&(a=t[ht][et],n=t[ht][ut],a&&(a.removeClass(u),a.addClass(h)),n&&n.show());for(var r=0;t[dt].length>r;r++)i=o.optObjDatas[t[dt][r]],i[tt]=!1,i[ht]&&i[ht][ut]&&i[ht][ut].show()}),o.isRenderAll||(o.optShowDatas=o._getShowDatas(o.optListDatas,o.optObjDatas),o.treeUL.height(o.optShowDatas.length*o.liHeight),o._doTriggerScrollEvent()),o.options.multi||!0!==o.options.editable&&"true"!==o.options.editable&&!e.isArray(o.options.editable)||(l=!0),r=o._getLiMaxWidth(o.treeUL,l),o._setElWidth(o.treeUL,r,l))},_doExpanded:function(t,i,a){var n,o,r,l,s=this,d=i[dt],c=i[ct],p=0,f=!1;if(!s.options.disabled){if(a){if(l=O,r=s._triggerHandler(e.objClone(i),B,s),!1===r||"false"===r)return;i[et]=!1,t.removeClass(h),t.addClass(u);for(var g=0;c.length>g;g++)n=s.optObjDatas[c[g]],n&&(o=n[ht][et],o&&(n[et]=!1,o.removeClass(h),o.addClass(u)),n[tt]=!0,n[ht]&&n[ht][ut]&&n[ht][ut].hide())}else{if(l=W,r=s._triggerHandler(e.objClone(i),F,s),!1===r||"false"===r)return;i[et]=!0,t.removeClass(u),t.addClass(h);for(var g=0;d.length>g;g++)n=s.optObjDatas[d[g]],n[tt]=!1,n[ht]&&n[ht][ut]&&n[ht][ut].show()}s.options.multi||!0!==s.options.editable&&"true"!==s.options.editable&&!e.isArray(s.options.editable)||(f=!0),p=s._getLiMaxWidth(s.treeUL,f),s._setElWidth(s.treeUL,p,f),s._triggerHandler(e.objClone(i),l,s)}},_removeAllNodeList:function(){var e=this;e.treeUL&&e.treeUL.children().remove()},_reset:function(){var e=this;e.selectedDatas={}},parseDatas:function(i,a,n,o,r,l,s){var d,c,h,u,p=this,f=!1,g=[],m=[],v=!1;if(i&&(e.isArray(i)||(i=[i]),!(0>=i.length))){i[i.length-1][ot]=!0;for(var w=0;i.length>w;w++){if(o&&""!=o&&(i[w][st]=o),c=o+xt+i[w][X],h=l){if(n[c]=i[w],!n[o]||!0!==n[o][et]&&"true"!==n[o][et]){if(!v){for(var _=0;i.length>_;_++)if(!0===i[_][et]||"true"===i[_][et]){f=!0;break}v=!0}}else f=!0;n[c][tt]=!r&&f?!1:!0}else r=!1,c=i[w][X],h=0,f=!0,n[c]=i[w],n[c][tt]=!1;if(n[c][rt]=h,d=i[w][dt],delete i[w][dt],i[w][lt]=c,(t===i[w][it]||null===i[w][it])&&(i[w][it]=i[w][Q]),u={},u[lt]=c,a&&a.push(u),Ct!=i[w][J]&&1!=i[w][J]&&"true"!=i[w][J]||!s?delete i[w][J]:(delete i[w][J],s[c]=""),d){i[w][nt]=!1,g=[],p._getChildrensPath(d,i[w][lt],g),i[w][ct]=g,m=[];for(var C=0;d.length>C;C++)m.push(c+xt+d[C][X]);i[w][dt]=m,p.parseDatas(d,a,n,i[w][lt],n[c][tt],++h,s)}else 0==i[w][nt]||"false"==i[w][nt]?(i[w][nt]=!1,i[w][pt]=!1):i[w][nt]=!0}}},_getChildrensPath:function(e,t,i){var a,n,o=this;if(e&&!(0>=e.length))for(var r=0;e.length>r;r++)a=t+xt+e[r][X],e[r][lt]=a,i.push(a),n=e[r][dt],n&&n.length>0&&o._getChildrensPath(n,e[r][lt],i)},_getShowDatas:function(e,t){var i,a=[],n=[];if(!e||0>=e.length)return a;for(var o=0;e.length>o;o++)i=t[e[o][lt]],i&&!i[tt]&&n.push(i);return n},parseTreeDatas:function(e,t,i,a){var n,o,r,l,s,d,c,h=this,u={},p=!1;for(var f in e)if(d={},c={},s=e[f],s&&t[s[lt]])if(r=s[st],n=t[r]){if(p=!0,o=u[s[lt]]){s[dt]&&o[dt]?o[dt]=o[dt].concat(s[dt]):s[dt]&&!o[dt]&&(o[dt]=s[dt]);continue}for(var g=0;i.length>g;g++)d[i[g]]=s[i[g]];if(s[dt]&&(d[dt]=s[dt]),!u[r]){for(var g=0;i.length>g;g++)c[i[g]]=n[i[g]];c[lt]=n[lt],c[st]=n[st],u[r]=c,u[r][dt]=[]}u[r][dt].push(d)}else u[s[lt]]?u[s[lt]][dt]=u[s[lt]][dt].concat(s[dt]):u[s[lt]]=s;if(!p){l=[];for(var f in u){d={};for(var g=0;i.length>g;g++)d[i[g]]=u[f][i[g]];u[f][dt]&&(d[dt]=u[f][dt]),l.push(d)}return a.data=l}h.parseTreeDatas(u,t,i,a)},_initData:function(t){var i=this,a={};if(i.selectedDatas={},i.objDatas={},i.listDatas=[],i.parseDatas(e.objClone(t),i.listDatas,i.objDatas,"",!1,null,a),i.optListDatas=e.objClone(i.listDatas),i.optObjDatas=e.objClone(i.objDatas),i.options.multi)for(var n in a)i.selectedDatas[n]=i.optObjDatas[n];else for(var n in a){i.selectedDatas[n]=i.optObjDatas[n];break}i.selectedDatas=i._getLeafSelectedDatas(i.selectedDatas),i.isRenderAll=Tt>=i.listDatas.length&&!i.options.loader?!0:!1},_getPLastNode:function(e,t,i){var a=this;e&&e[st]&&(t[e[st]][ot]&&(i[t[e[st]][rt]]=t[e[st]]),a._getPLastNode(t[e[st]],t,i))},_getLeafSelectedDatas:function(t){var i,a=this,n={};if(e.isEmptyObject(t))return n;for(var o in t)if(i=t[o],i[J]=Ct,i[nt])n[o]=i;else if(i[ct])for(var r=0;i[ct].length>r;r++)i[ct][r][nt]&&(n[i[ct][r][lt]]=i[ct][r]);return a._bubbleUpdateNodeChecked(n),n},_getUpdateNode:function(e,t){var i,a,n,o=this,r=!1,l=!0;if(t[e[lt]]=e,i=o.optObjDatas[e[st]]){n=i[ct].length;for(var s=0;n>s;s++)a=o.optObjDatas[i[ct][s]],Ct==a[J]?r=!0:l=!1;i[J]=l?Ct:r?_t:wt,o._getUpdateNode(i,t)}},_bubbleUpdateNodeChecked:function(t){var i=this,a={},n={},o=!1;if(!e.isEmptyObject(t)){for(var r in t)t[r][st]&&(o=!0,Ct==t[r][J]&&(n[t[r][st]]?n[t[r][st]].sCount++:(n[t[r][st]]={},n[t[r][st]].sCount=1),n[t[r][st]].checked=!0),_t==t[r][J]&&(n[t[r][st]]||(n[t[r][st]]={}),n[t[r][st]].checked=!0));for(var r in n)i.optObjDatas[r][J]=wt,n[r].checked&&(i.optObjDatas[r][J]=_t),n[r].sCount>=i.optObjDatas[r][dt].length&&(i.optObjDatas[r][J]=Ct,n[r][J]=Ct),a[r]=i.optObjDatas[r];o&&i._bubbleUpdateNodeChecked(a)}},_destroyWidget:function(){var t,i=this;i._editMenu&&i._editMenu.destroy(),t=e("#"+i._editMenuId),t&&t.remove(),i.treeEl&&i.treeEl.remove()},_setElWidth:function(t,i,a){var n,o,r,l=0;if(t)if(n=t.find("li"),a){for(var d=0;n.length>d;d++)if(e(n[d]).width(i),"none"!=e(n[d]).css("display")){o=e(n[d]).children(),l=0;for(var c=0;o.length>c;c++)e(o[c]).hasClass(s)?r=e(o[c]):"none"!=e(o[c]).css("display")&&(l+=e(o[c]).externalWidth());r&&r.width(i-l)}}else for(var d=0;n.length>d;d++)e(n[d]).width(i)},_getLiMaxWidth:function(t,i){var a,n,o=this,r=0,l=0,d=5;if(!t)return r;a=t.find("li"),i&&t.find("li ."+s).width("");for(var c=0;a.length>c;c++)if("none"!=e(a[c]).css("display")){n=e(a[c]).children(),l=0;for(var h=0;n.length>h;h++)"none"!=e(n[h]).css("display")&&(l+=e(n[h]).externalWidth());l>r&&(r=l)}return o.treeBodyDiv[0].clientWidth>=r&&(r=o.treeBodyDiv[0].clientWidth-d),r},getCurrentObjData:function(){var t=this;return e.objClone(t.objDatas)},getCurrentOptObjData:function(){var t=this;return e.objClone(t.optObjDatas)},getSelectedDatas:function(){var t=this;return e.isEmptyObject(t.selectedDatas)?null:e.objClone(t.selectedDatas)},getSelected:function(){var t=this;if(e.isEmptyObject(t.selectedDatas))return null;for(var i in t.selectedDatas)return e.objClone(t.selectedDatas[i])},appendChild:function(t,i){var a=this;a.options.multi||!0!==a.options.editable&&"true"!==a.options.editable&&!e.isArray(a.options.editable)||e.isEmptyObject(t)||e.isEmptyObject(i)||(i=a.optObjDatas[i[lt]],a._doAddNode(t,i))},insertAfter:function(i,a){var n,o,r,d,c,h,u,p,f,g=this,m=0,v=[],_=x,C="";if(!g.options.multi&&(!0===g.options.editable||"true"===g.options.editable||e.isArray(g.options.editable))&&!e.isEmptyObject(i)){if(a&&(a=g.optObjDatas[a[lt]],n=g.optObjDatas[a[st]]),!n||e.isEmptyObject(a))return i[rt]=m,i[tt]=!1,i[nt]=!0,i[it]=i[Q],i[lt]=i[X],g._doAddRootNode(i,a),t;a=g.optObjDatas[a[lt]],c=a[nt],g.options.multi||!0!==g.options.editable&&"true"!==g.options.editable&&!e.isArray(g.options.editable)||(C=s),m=a[rt],i[rt]=m,i[tt]=!1,i[nt]=!0,i[it]=i[Q],i[lt]=a[st]+xt+i[X],i[st]=a[st],h=e("<li>").addClass(l);for(var b=0;i[rt]>b;b++)e("<span>").addClass(_).appendTo(h);e("<span>").addClass(S).appendTo(h),g.options.icon&&e("<span>").addClass(w).appendTo(h),u=e.nullToString(i[Q]),p=e("<span>").addClass(C).text(u).appendTo(h),g.options.tip&&p.attr("title",i[it]),i[ht]={},i[ht][ut]=h,p.bind("dblclick",{me:g,node:i},g._onNodeDbClick),h.data(mt,i).bind("click",{me:g,node:i,liEl:h},g._onNodeClick),h.bind("contextmenu",{me:g,node:i,liEl:h,textEl:p},g._onNodeMousedown),c?o=a:(a[ct]=a[ct]||[],o=0>=a[ct].length?a:g.optObjDatas[a[ct][a[ct].length-1]]),r=[];for(var E=0;n[dt].length>E;E++)r.push(n[dt][E]),o[lt]==n[dt][E]&&r.push(i[lt]);n[dt]=r,r=[],g.optObjDatas[i[lt]]=i,g.objDatas=g.optObjDatas;for(var E=0;g.optListDatas.length>E;E++)v.push(g.optListDatas[E]),o[lt]==g.optListDatas[E][lt]&&v.push({path:i[lt]});g.optListDatas=v,g.listDatas=g.optListDatas,1==g.options.showCCount||"true"==g.options.showCCount||"leaf"==g.options.showCCount?g.bubble(a,function(e,t){d=[];for(var a=0;t[ct].length>a;a++)d.push(t[ct][a]),o[lt]==t[ct][a]&&d.push(i[lt]);t[ct]=d,g._upDateCNodeCount(t)}):g.bubble(a,function(e,t){d=[];for(var a=0;t[ct].length>a;a++)d.push(t[ct][a]),o[lt]==t[ct][a]&&d.push(i[lt]);t[ct]=d}),h.insertAfter(o[ht][ut]),g._doSelected(i),f=g._getLiMaxWidth(g.treeUL,!0),g._setElWidth(g.treeUL,f,!0)}},insertBefore:function(i,a){var n,o,r,d,c,h,u,p,f=this,g=0,m=[],v=x,_="";if(!f.options.multi&&(!0===f.options.editable||"true"===f.options.editable||e.isArray(f.options.editable))&&!e.isEmptyObject(i)){if(a&&(a=f.optObjDatas[a[lt]],n=f.optObjDatas[a[st]]),!n||e.isEmptyObject(a))return i[rt]=g,i[tt]=!1,i[nt]=!0,i[it]=i[Q],i[lt]=i[X],f._doAddRootNode(i,a,!0),t;a=f.optObjDatas[a[lt]],f.options.multi||!0!==f.options.editable&&"true"!==f.options.editable&&!e.isArray(f.options.editable)||(_=s),g=a[rt],i[rt]=g,i[tt]=!1,i[nt]=!0,i[it]=i[Q],i[lt]=a[st]+xt+i[X],i[st]=a[st],c=e("<li>").addClass(l);for(var C=0;i[rt]>C;C++)e("<span>").addClass(v).appendTo(c);e("<span>").addClass(S).appendTo(c),f.options.icon&&e("<span>").addClass(w).appendTo(c),h=e.nullToString(i[Q]),u=e("<span>").addClass(_).text(h).appendTo(c),f.options.tip&&u.attr("title",i[it]),i[ht]={},i[ht][ut]=c,u.bind("dblclick",{me:f,node:i},f._onNodeDbClick),c.data(mt,i).bind("click",{me:f,node:i,liEl:c},f._onNodeClick),c.bind("contextmenu",{me:f,node:i,liEl:c,textEl:u},f._onNodeMousedown),o=a,r=[];for(var b=0;n[dt].length>b;b++)o[lt]==n[dt][b]&&r.push(i[lt]),r.push(n[dt][b]);n[dt]=r,r=[],f.optObjDatas[i[lt]]=i,f.objDatas=f.optObjDatas;for(var b=0;f.optListDatas.length>b;b++)o[lt]==f.optListDatas[b][lt]&&m.push({path:i[lt]}),m.push(f.optListDatas[b]);f.optListDatas=m,f.listDatas=f.optListDatas,1==f.options.showCCount||"true"==f.options.showCCount||"leaf"==f.options.showCCount?f.bubble(a,function(e,t){d=[];for(var a=0;t[ct].length>a;a++)o[lt]==t[ct][a]&&d.push(i[lt]),d.push(t[ct][a]);t[ct]=d,f._upDateCNodeCount(t)}):f.bubble(a,function(e,t){d=[];for(var a=0;t[ct].length>a;a++)o[lt]==t[ct][a]&&d.push(i[lt]),d.push(t[ct][a]);t[ct]=d}),c.insertBefore(o[ht][ut]),f._doSelected(i),p=f._getLiMaxWidth(f.treeUL,!0),f._setElWidth(f.treeUL,p,!0)}},remove:function(t){var i=this;i.options.multi||!0!==i.options.editable&&"true"!==i.options.editable&&!e.isArray(i.options.editable)||e.isEmptyObject(t)||(t=i.optObjDatas[t[lt]],i._doDeleteNode(t))},edit:function(t,i){var a,n,o,r,l=this;l.options.multi||!0!==l.options.editable&&"true"!==l.options.editable&&!e.isArray(l.options.editable)||e.isEmptyObject(t)||e.isEmptyObject(i)||(i=l.optObjDatas[i[lt]],i[ht]&&i[ht][ut]&&(r=l._triggerHandler({newNode:e.objClone(t),node:e.objClone(i)},Y,l),!1!==r&&"false"!==r&&(a=i[Q],n=t[Q],i[X]=t[X],i[Q]=t[Q],i[Z]=t[Z],o=i[ht][ut].find("."+s),a!=n&&(r=l._triggerHandler({text:n,oldText:a},U,l),!1===r||"false"===r?(r=!1,n=a):r=!0),o.text(n),r&&(l.optObjDatas[i[lt]]&&(l.optObjDatas[i[lt]][Q]=n,l.optObjDatas[i[lt]][it]=n,l.options.tip&&(1==l.options.showCCount||"true"==l.options.showCCount||"leaf"==l.options.showCCount?l._upDateCNodeCount(l.optObjDatas[i[lt]]):o.attr("title",n))),l.objDatas=l.optObjDatas,l._triggerHandler({text:n,oldText:a},G,l)),l._triggerHandler(e.objClone(i),q,l))))},isRootNode:function(t){var i=this;return e.isEmptyObject(t)?!1:(t=i.optObjDatas[t[lt]],e.isEmptyObject(t)?!1:0>=t[rt]?!0:!1)},getNodeDepth:function(t){var i=this;return e.isEmptyObject(t)?-1:(t=i.optObjDatas[t[lt]],e.isEmptyObject(t)?-1:t[rt])},_objToArray:function(t){var i=[];return t?(e.isArray(t)?i=t:e.isUndefined(t.value)||e.isUndefined(t.text)||i.push(t),i):i},_addCNodeCount:function(t,i,a){var n,o,r,l=this;return t&&i&&a?(n="(0)",1==l.options.showCCount||"true"==l.options.showCCount?t[ct]&&(n="("+t[ct].length+")"):"leaf"==l.options.showCCount&&(n="("+l._getAllLeafChildrenCount(t[ct])+")"),r=e("<span>").addClass(d).text(n).appendTo(i),l.options.tip&&(o=t[it]+"&nbsp;&nbsp;"+n,a.attr("title",o),r.attr("title",o)),r):null},_upDateCNodeCount:function(e){var t,i,a,n=this;e&&e[ht]&&e[ht][ut]&&(a=e[ht][ut].find("span."+d),a&&a.length>0&&(1==n.options.showCCount||"true"==n.options.showCCount?t="("+e[ct].length+")":"leaf"==n.options.showCCount&&(t="("+n._getAllLeafChildrenCount(e[ct])+")"),a.text(t)),n.options.tip&&(i=e[it],t&&(i=e[it]+"&nbsp;&nbsp;"+t),a&&a.length>0&&a.attr("title",i),a=e[ht][ut].find("span."+s),a&&a.length>0&&a.attr("title",i)))},_getAllLeafChildrenCount:function(t){var i,a=this,n=0;if(!t||0>=t.length||e.isEmptyObject(a.optObjDatas))return n;for(var o=0;t.length>o;o++)i=a.optObjDatas[t[o]],i&&i[nt]&&n++;return n}}),Sweet.tree.Tree_v1=e.sweet.widgetTreeTree_v1}(jQuery),function(e){var t={defaultTreeClass:"sweet-optimizetree-panel",treenodeClass:"sweet-optimizetree-node",treeRootNodeClass:"sweet-optimizetree-root-node-empty",treenodeSelectClass:"sweet-optimizetree-node-selected",treeParentClass:"sweet-optimizetree-parent",treeBGClass:"select_win_bg",treeTextClass:"sweet-optimizetree-text-node",treeIcoBlockClass:"sweet-optimizetree-ico-empty-block",treeEmptyBlockClass:"sweet-optimizetree-empty-block",treeExpandClass:"sweet-optimizetree-expand",treeUnExpandClass:"sweet-optimizetree-coll",treeFullCheckedClass:"sweet-optimizetree-full-check",treeCheckedClass:"sweet-optimizetree-check",treeUnCheckedClass:"sweet-optimizetree-uncheck",treeSearchClass:"sweet-tree-search-div",treeToolAddClass:"sweet-optimizetree-tool-add",treeToolModifyClass:"sweet-optimizetree-tool-modify",treeToolDeleteClass:"sweet-optimizetree-tool-delete",treeParentNodeIco:"sweet-tree-node-ioc",treeLeafNodeIco:"sweet-tree-leaf-ioc",treeLeafIndexClass:"sweet-tree-leaf-index",treeLeafNodeDimension:"sweet-tree-leaf-dimension",treeLeafCompClass:"sweet-tree-leaf-comp",treeLeafUserDefine:"sweet-tree-leaf-userDefine",treeNodeLine:"sweet-tree-node-line",treeNodeEblow:"sweet-tree-node-eblow",treeNodeEblowEnd:"sweet-tree-node-eblow-end"},i="expand",a="checked",n="rootNode",o="leafNode",r="selected",l="sameLvlNodeCount",s="isLastNode",d="parentExpandIcoInfo",c="treeNodeId",h="children",u="parentKey",p="level",f="orgNodeIndex",g="pathKey",m="childrenIndexs",v="nodeRootKey",w="selectedMap",_="halfSelectedMap",C="selectedCount",b="halfSelectedCount",E="needUpdateCheckedState",y="needRemove",x="none",T="all",D="leaf",S="dir",k="root",L="add",N="modify",I="delete",A=2,P=1,M=0,F="sweet-optimizeTree-",W=function(e,t){return t=t.toLowerCase(),"finite"==t?!isnan[has](+e):"array"==t?e instanceof Array:"null"==t&&null===e||t==typeof e&&null!==e||"object"==t&&e===Object(e)||"array"==t&&Array.isArray&&Array.isArray(e)||Object.prototype.toString.call(e).slice(8,-1).toLowerCase()==t},B=function(){this.data=[],this.cellIndex=0},O=function(t,l){this.options=l,this.data={},this.ypos=0,this.el=t,this.cellIndex=0,this.nodeIndex=0;var c=this,f=0,g=l.style,m=e("<div class='"+g.treeIcoBlockClass+"'/>").attr("name","expandDom"),v=e("<div />").attr("name","iconDom"),w=e("<div />").attr("name","checkedDom"),_=e("<span class='"+g.treeTextClass+"'/>").attr("name","textDom"),C=e("<div class='"+g.treeNodeEblow+"' />").hide(),b=e("<div class='"+g.treeNodeEblowEnd+"'/>").hide(),E=[],y=[];for(this.el.addClass(g.treenodeClass),f=0;this.options.pc.maxNodeLevel>f;f++){var F=e("<div class='"+g.treeNodeLine+"' />").hide();E.push(F),this.el.append(F)}if(this.el.append(C).append(b).append(m).append(v).append(w).append(_),x!=this.options.toolsType)for(f=0;this.options.tools.length>f;f++){var W=this.options.tools[f],B=e("<div></div>").hide();switch(y.push(B),W){case L:B.addClass(g.treeToolAddClass).attr("name","toolAdd");break;case N:B.addClass(g.treeToolModifyClass).attr("name","toolModify");break;case I:B.addClass(g.treeToolDeleteClass).attr("name","toolDelete")}this.el.append(B)}this.preUpdateNode=function(e,t,i,a){c.data=e,c.ypos=t,void 0!=e&&(c.cellIndex=e.cellIndex=i,c.nodeIndex=e.nodeIndex=a)},this.updateNode=function(t){if(void 0==c.data)return c.el.hide().css("top",c.ypos+"px"),void 0;c.el.show();var l,f,L=20,N=20,I=c.data[p],F=g.treeLeafNodeIco,W=!1,B=!1,O=void 0==c.data[i]?!1:c.data[i],R=c.data[a]==M?!1:c.data[a];if(this.options.icon){if(this.options.icon&&!e.isNull(c.data[this.options.iconField]))switch(c.data[this.options.iconField]){case 0:F=g.treeLeafNodeDimension;break;case 1:F=g.treeLeafIndexClass;break;case 2:F=g.treeLeafUserDefine;break;case 3:F=g.treeLeafCompClass;break;case 4:F=g.treeParentNodeIco;break;default:F=g.treeLeafNodeIco}}else v.hide(),L-=N;if(c.data.hasOwnProperty(h)&&0!=c.data[h].length?(m.show().removeClass(),1==O?m.addClass(g.treeUnExpandClass):m.addClass(g.treeExpandClass),F=g.treeParentNodeIco,B=!0,L+=N):1==c.data[o]?m.removeClass().hide():(m.removeClass().addClass(g.treeIcoBlockClass),L+=N),this.options.icon&&v.removeClass().addClass(F),this.options.multi?(w.show().removeClass(),R==A?w.addClass(g.treeFullCheckedClass):R==P?w.addClass(g.treeCheckedClass):w.addClass(g.treeUnCheckedClass),L+=N):w.hide(),c.data.hasOwnProperty(u)){c.el.removeClass(g.treeRootNodeClass);var H=this.options.pc.isFilterMode?this.options.pc.filterItemsMap:this.options.pc.itemsMap;l=H[c.data[u]],W=!0}else c.el.addClass(g.treeRootNodeClass);C.hide(),b.hide(),!B&&W&&t.displayLine&&(c.data[s]?b.show():C.show(),L+=N);var j=I;l&&(j=l[p]);for(var z=0;E.length>z;z++)f=E[z],f.removeClass().addClass(g.treeIcoBlockClass),I>z?(f.show(),L+=N):f.hide(),0==c.data[d][z]&&t.displayLine&&f.removeClass().addClass(g.treeNodeLine);var V=!1;if(x!=c.options.toolsType)switch(c.options.toolsType){case T:V=!0;break;case D:1==c.data[o]&&(V=!0);break;case S:c.data[o]||(V=!0);break;case k:c.data[n]&&(V=!0)}for(z=0;y.length>z;z++)V?(y[z].show(),0==z&&y[z].css("marginLeft",10)):y[z].hide();c.el.css({top:c.ypos+"px"}).data({data:c.data}),c.data.hasOwnProperty(this.options.labelField)&&_.html(c.data[this.options.labelField]);var U=L+parseInt(_.css("width"));U>t.maxNodeWidth&&(t.maxNodeWidth=U),1==c.data[r]?c.el.addClass(g.treenodeSelectClass):c.el.removeClass(g.treenodeSelectClass)}};e.widget("sweet.optimizeTree",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-optimizeTree]",eventNames:{nodeClick:"树节点单击事件",nodeDClick:"树节点双击事件",nodeExpand:"树节点展开事件",nodeDrag:"树节点拖拽事件",nodeCheck:"树节点CheckBox选中事件",nodeUnCheck:"树节点CheckBox反选事件",search:"搜索节点事件",change:"切换树节点事件",afterSetData:"调用完setData方法后触发",afterSetValue:"调用完setValue后触发",nodeEdit:"树节点编辑事件",beforeCheckboxClick:"点击checkBox之前的事件",toolAddClick:"工具栏点击新增按钮",toolModifyClick:"工具栏点击修改按钮",toolDeleteClick:"工具栏点击删除按钮"},options:{idField:"id",parentField:"parent",data:[],orgData:[],disabled:!1,expand:!1,icon:!0,iconField:"type",displayLine:!0,multi:!1,nodeAccept:"",nodeDraggable:!1,search:!0,searchEmptyText:Sweet.core.i18n.tree.search,selectedItems:{},style:{},maxLevel:0,labelField:"text",valueField:"value",itemHeight:22,useTreeStruct:!0,tools:[],toolsType:"none",selectedNode:null,maxNodeWidth:0,alwaysDisplayExpandIcon:!1,pc:{},handleText:function(e){return e},handleTitle:function(e){return e}},setDisabled:function(){},setSelected:function(){},setUnSelected:function(){},setUnSelectedAll:function(){},updateOptions:function(e){for(var t in e)e[t]&&"pc"!=t&&("data"==t&&this.setData(e[t]),this.options[t]=e[t])},_updateOptionsData:function(e,t){void 0!=t&&1==t&&(e=this.concatData(this.options.orgData,e)),this._clearAll(),this.options.data=e,this.options.orgData=e,this.options.expand=void 0==this.options.expand?!1:this.options.expand,this._createIndex(this.options.pc.itemsMap,this.options.pc.leafItemsMap,e),this.options.pc.maxBgHeight=this.options.pc.totalNodeCount*this.options.itemHeight,this._draw()},concatData:function(e,t){if(!e||!t)throw Error("Function concatData Error: 传入的参数不合法");var i=this,a=i.options,n=[];if(1==a.useTreeStruct){var o={children:e},r={children:t};n=i._concatTreeData(o,r,""),n=n[h]}else n=i._concatRepeatData(e,t);return[].concat(n)},_concatTreeData:function(e,t,i){var a=this,n=a.options,o=i,r=e[h],l=t[h];if(!r||!l)return null;for(var s=0;l.length>s;s++){var d=l[s],u=d[n.labelField]+"_"+d[n.valueField],p=u;void 0!=o&&""!=o&&(p=o+"#"+u),d[c]=u,d[g]=p;var f=n.pc.itemsMap[p];f?f=a._concatTreeData(f,d,p):(d[E]=!0,e[h].push(d))}return e},_concatRepeatData:function(e,t){for(var i=this,a=i.options,n=t.length,o=0;n>o;o++){var r=t[o],l=r[a.labelField]+"_"+r[a.valueField],s=l,d=a.pc.itemsMap[s];
d||e.push(r)}return e},setData:function(t,i){t=e.objClone(t),0==this.options.useTreeStruct&&(t=this._repeatToTreeStruct(t).children),this._updateOptionsData(t,i),this._fireEvent("afterSetData",this,{})},getData:function(){return this.options.orgData},_repeatToTreeStruct:function(e){var t,i=this,a=i.options,n={},o={children:[]},r=e.length,l=0;for(l=0;r>l;l++)t=e[l],n[t[a.idField]]=t;for(l=0;r>l;l++){t=e[l];var s=t[a.parentField];void 0==s||""==s?o.children.push(t):n[s]&&(n[s].children||(n[s].children=[]),n[s].children.push(t))}return o},getSelectedItems:function(){return this.options.selectedItems},getTotalItemsCount:function(){return this.options.pc.totalNodeCount},removeSelectedItems:function(){this._removeNodes(this.options.selectedItems)},_removeNodes:function(e){var t,i=this,a=i.options;for(var n in e)t=e[n],i.options.pc.itemsMap[t[g]][y]=!0,delete e[t[g]];var o=i.getFilterString();i._updateData(a.orgData),""!=o&&i.filter(o)},getFilterString:function(){if(this.searchField){var e=this.searchField.getValue();return e&&e.text?e.text:""}},getSelectedNode:function(){return this.options.selectedNode?this.options.selectedNode:void 0},_setValue:function(e){this._modifyNodeData(e,""),this._updateItems(!0)},_modifyNodeData:function(e,t){for(var i=this,a=i.options,n=t,o=e.length,r=0;o>r;r++){var l=e[r],s=l[a.labelField]+"_"+l[a.valueField],d=s;void 0!=n&&""!=n&&(d=n+s),l[c]=s,l[g]=d;var u=a.pc.itemsMap[d];u&&(u[h]&&0!=u[h].length?i._modifyNodeData(l[h],d+"#"):(i._changeNodeProp(u,l),i._updateParentCheckedState(l)))}},_changeNodeProp:function(e,t){var i=this,n=i.options;for(var r in t)e[r]=t[r],r==a&&(t[r]==A&&e[o]?n.selectedItems[e[g]]=e:delete n.selectedItems[e[g]])},_getValue:function(){var e=this,t=e.options,i=t.selectedItems;return 1==t.useTreeStruct?e._rebuildValueTree(i):e._rebuildValueRepeat(i)},_rebuildValueTree:function(e){return this._rebuildTreeData(e,{})},_rebuildValueRepeat:function(e){var t=[],i={};for(var a in e){var n=e[a];if(void 0!=i[n[c]])throw Error("返回的平铺数据中，存在相同ID的节点，请设置树控件的useTreeStruct为true来返回正确的数据格式");i[n[c]]=!0,t.push(e[a])}return t},_updateDataChecked:function(e,t){e[a]=t,this.options.pc.isFilterMode&&e[o]&&(this.options.pc.itemsMap[e[g]][a]=t,this.options.pc.itemsMap[e[g]][E]=!0),t==A&&e[o]?this.options.selectedItems[e[g]]=e:delete this.options.selectedItems[e[g]]},_checkedNode:function(e,t){this._updateDataChecked(e,t),this._updateChildrenCheckedState(e),this._updateParentCheckedState(e)},_updateChildrenCheckedState:function(e){if(e[C]=0,e[w]={},void 0!=e[h]){var t,i=e[h],n=i.length,o=e[a];o==A&&(e[C]=n);for(var r=0;n>r;r++)t=i[r],this._updateDataChecked(t,o),o==A&&(e[w][t[g]]=t[g]),this._updateChildrenCheckedState(t)}},_updateParentCheckedState:function(e){var t=this.options.pc.isFilterMode?this.options.pc.filterItemsMap:this.options.pc.itemsMap,i=t[e[u]];void 0!=i&&(i[w]=i[w]||{},i[_]=i[_]||{},i[C]=i[C]||0,i[b]=i[b]||0,this._updateParentNodeCheckedCount(e,i),this._updateParentCheckedState(i))},_updateParentNodeCheckedCount:function(e,t){var i=e[g];e[a]==A?(void 0==t[w][i]&&(t[w][i]=i,t[C]++),void 0!=t[_][i]&&(delete t[_][i],t[b]--)):e[a]==P?(void 0==t[_][i]&&(t[_][i]=i,t[b]++),void 0!=t[w][i]&&(t[C]--,delete t[w][i])):e[a]==M&&(void 0!=t[w][i]?(t[C]--,delete t[w][i]):void 0!=t[_][i]&&(t[b]--,delete t[_][i])),this._calcCheckedState(t)},_calcCheckedState:function(e){var t=e[b]+e[C],i=e[h].length;if(0==t)e[a]=M;else if(e[C]==i)e[a]=A;else{if(!(e[b]>0||i>e[C]))throw Error("选中状态计算错误 : "+e[this.options.labelField]);e[a]=P}},_createSweetWidget:function(){this._initStyle(),this._initPrivateConfig();var t=this,i=this.options,a=i.style,n=(this.renderEl=e("#"+i.renderTo),this.rootDiv=e("<div/>").width(i.width).height(i.height).attr("id","rootDiv_"+this.uuid+"_"+i.id)),o=(this.treeRootDiv=e("<div>").width(i.width).addClass(a.treeParentClass+" "+a.treeBGClass),this.treeEl=e("<div/>").width(i.width).attr("id",i.id).addClass(a.defaultTreeClass),this.bgEl=e("<div></div>"));n.addClass(i.widgetClass),i.search&&(t.searchRendererDiv=e("<div/>").attr("id",i.id+F+i.id+"search").addClass(a.treeSearchClass),t.searchField=new Sweet.form.SearchField({width:i.width,emptyText:i.searchEmptyText})),o.addClass(a.treeEmptyBlockClass)},_initStyle:function(){var e={},i=this.options.style;for(var a in t)e[a]=i[a]?i[a]:t[a];this.options.style=e},_initPrivateConfig:function(){this.options.pc={cells:[],isFilterMode:!1,filterItemsMap:{},itemsMap:{},leafItemsMap:{},updateItemsMap:{},updateLeafItemsMap:{},items:[],bottomYPos:0,topYPos:0,topItem:{},bottomItem:{},searchMap:{},cellCount:100,totalNodeCount:0,maxNodeLevel:0,maxBgHeight:0}},_afterCreateSweetWidget:function(){var e=this,t=e.options;if(t.search){var i=0;e.searchField.addListener("keyup",function(t,a){0==i?i=setInterval(function(){clearInterval(i),e.filter(a.text),e._fireEvent("search",t.target,a)},500):(clearInterval(i),i=setInterval(function(){clearInterval(i),e.filter(a.text),e._fireEvent("search",t.target,a)},500))}),e.searchField.addListener("click",function(t,i){e.filter(i.text),e._fireEvent("search",t.target,i)})}e._handleAllEvent()},_handleAllEvent:function(){var t=this,n=t.options,o=n.style;t.options.disabled||t.treeEl.bind("click",function(n){var l,s,d,c=e(n.target);if(c.hasClass(o.treenodeClass)?l=c:c.parent()&&c.parent().hasClass(o.treenodeClass)&&(l=c.parent()),l){if(s=l.data("data"),d=c.attr("name"),"expandDom"==d){var h=s[i]=!s[i];t._expandNode(s,h),t._updateItems(!0),h&&t._fireEvent("nodeExpand",n,s)}else if("checkedDom"==d){var u=void 0==s[a]?M:s[a];if(u=u==M||u==P?A:M,!e.isNull(t.handlers)&&!e.isNull(t.handlers.beforeCheckboxClick)&&0==t.handlers.beforeCheckboxClick.call(t.treeEl,n,s))return;t._checkedNode(s,u),t._updateItems(!0),u==A?t._fireEvent("nodeCheck",n,s):t._fireEvent("nodeUnCheck",n,s)}else"toolAdd"==d?t._fireEvent("toolAddClick",n,s):"toolModify"==d?t._fireEvent("toolModifyClick",n,s):"toolDelete"==d?t._fireEvent("toolDeleteClick",n,s):(0==t._nodeClickTimer&&(t._nodeClickTimer=setInterval(function(){if(clearInterval(t._nodeClickTimer),t._nodeClickTimer=0,t._nodeClickCount>1)t._fireEvent("nodeDClick",n,s);else{if(!t.options.multi&&(!s.children||1>s.children.length)){for(var e in t.options.selectedItems)t._checkedNode(t.options.selectedItems[e],0);t.options.selectedItems={},t._checkedNode(s,2)}t._fireEvent("nodeClick",n,s)}t._nodeClickCount=0},300)),t._nodeClickCount++);s[r]=!0,t.options.selectedNode!=s&&(t.options.selectedNode&&(t.options.selectedNode[r]=!1),t.options.selectedNode=s,t._updateItems(!0),t._fireEvent("change",n,s))}})},_nodeClickTimer:0,_nodeClickCount:0,_fireEvent:function(t,i,a){this._trigger(t,i.target,a),e.isNull(this.handlers)||e.isNull(this.handlers[t])||this.handlers[t].call(this.treeEl,i,a)},_addNodeDragEvent:function(){var t=this,i=t.options,a=i.style,n=void 0==i.nodeAccept?"":i.nodeAccept,o=t.treeEl;o.children("."+a.treenodeClass).draggable({appendTo:"body",opacity:1,cursorAt:{left:0,top:0},start:function(i){var n=e(i.target),o={};n.hasClass(a.treenodeClass)||(n=n.parent()),o=n.data("data"),t._fireEvent("nodeDrag",i,o)},helper:function(t){var i,n,o=e("<div></div>").addClass(a.treenodeClass),r=t.target,l=e(r);l.hasClass(a.treenodeClass)||(l=l.parent()),i=l.children();for(var s=0;i.length>s;s++)n=e(i[s]),!n.is(":visible")||"iconDom"!=n.attr("name")&&"textDom"!=n.attr("name")||(n=n.clone().appendTo(o));return o}}),n&&n.droppable({drop:function(e,t){t.draggable.data("data")}})},_expandNode:function(e,t){if(e[i]=t,0!=e.hasChildren){var a,n,o,r=e[h],l=r.length,s=1;if(a=e.cellIndex,n=e.nodeIndex,o=this.options.pc.cells[a],t){var d=o.data.slice(0,n+1),c=o.data.slice(n+1,o.data.length);o.data=d.concat(r,c)}else{s=-1;for(var u,f=n+1,g=o.data.length,m=!1,v=n+1;g>v;v++){if(u=o.data[v],e[p]>=u[p]){l=v-f,o.data.splice(f,l),m=!0;break}u[i]=!1}m||(l=g-f,o.data.splice(f,g-f))}var w=parseInt(this.bgEl.css("height"))+l*this.options.itemHeight*s;this.bgEl.css("height",w+"px")}},_preUpdateCount:0,_updateItems:function(e){var t,i=this,a=0,n=i.treeEl[0].scrollTop,o=parseInt(i.treeEl.css("height")),r=i.options.pc.items.length,l=i.options.pc.cells.length,s=void 0==e?!1:e,d=0,c=n-this.options.itemHeight,h=n+o+this.options.itemHeight;if(c>i.options.pc.topYPos||i.options.pc.bottomYPos>h||1==s){var u,p,f,g,m=i.options.pc.topYPos,v=i.options.pc.topItem.cellIndex,w=i.options.pc.topItem.nodeIndex,_=i.options.pc.cells[v],C=!1;if(i.options.maxNodeWidth=parseInt(i.treeEl.externalWidth()),s){var b=0,E=0,y=parseInt(i.bgEl.css("height"));for(y/i.options.itemHeight>r&&(b=i._calcDataCellIndex(v,w,r-1),E=b.overflowCount,E>0&&(b=i._calcDataCellIndex(b.cellIndex,b.nodeIndex,-(r-1)),i.options.pc.topItem.cellIndex=v=b.cellIndex,i.options.pc.topItem.nodeIndex=w=b.nodeIndex,_=this.options.pc.cells[b.cellIndex],d=-E*this.options.itemHeight,i.options.pc.topYPos>Math.abs(d)?(i.options.pc.topYPos+=d,i.options.pc.bottomYPos+=d):d=0)),a=0;r>a;a++)t=i.options.pc.items[a],u=parseInt(t.ypos),p=void 0!=_?i.options.pc.cells[v].data[w]:void 0,i.options.pc.topItem.ypos==m?t.preUpdateNode(p,m,v,w):t.preUpdateNode(p,m+d,v,w),t.updateNode(i.options,i),w++,m+=i.options.itemHeight,_&&w>=_.data.length&&(w=0,v++,_=i.options.pc.cells[v]);return i._preUpdateCount=0,i._initNodesWidth(i),void 0}if(n>i._lastYpos)for(a=0;r>a&&(t=i.options.pc.items[a],u=parseInt(t.ypos),!(u>=c))&&(v=i.options.pc.bottomItem.cellIndex,w=i.options.pc.bottomItem.nodeIndex,_=i.options.pc.cells[v],w++,!(w>=_.data.length&&(w=0,v++,v>=l)));a++)p=i.options.pc.cells[v].data[w],f=i.options.pc.bottomYPos+i.options.itemHeight,t.preUpdateNode(p,f,v,w),i.options.pc.items.splice(a,1),i.options.pc.items.push(t),--a,i.options.pc.bottomItem=t,i.options.pc.bottomYPos=f,i.options.pc.topItem=i.options.pc.items[0],i.options.pc.topYPos=parseInt(i.options.pc.topItem.ypos),i._preUpdateCount++;else if(i._lastYpos>n)for(a=r-1;a>=0&&(t=i.options.pc.items[a],u=parseInt(t.ypos),!(h>=u));a--){if(v=i.options.pc.topItem.cellIndex,w=i.options.pc.topItem.nodeIndex,_=i.options.pc.cells[v],w--,0>w){if(v--,0>v)break;w=i.options.pc.cells[v].data.length-1}p=i.options.pc.cells[v].data[w],g=i.options.pc.topYPos-i.options.itemHeight,t.preUpdateNode(p,g,v,w),i.options.pc.items.splice(a,1),i.options.pc.items.unshift(t),++a,i.options.pc.topItem=t,i.options.pc.topYPos=g,i.options.pc.bottomItem=i.options.pc.items[r-1],i.options.pc.bottomYPos=parseInt(i.options.pc.bottomItem.ypos),i._preUpdateCount++}C=Math.abs(n-i._lastYpos)>200,i._lastYpos=n,i._preUpdateCount>0&&(1==C?(0==i._preUpdateCountFlag&&(i._preUpdateCountFlag=!0,i._preUpdateTimer=setInterval(function(){i._preUpdateTimerCount++,i._preUpdateTimerCount>=3&&(i._preUpdateTimerCount=0,i._preUpdateCount=0,clearInterval(i._preUpdateTimer),i._preUpdateCountFlag=!1,i._updateItems(!0))},100)),i._preUpdateCount>=2*i.itemCount&&(i._preUpdateTimerCount=0,i._preUpdateCount=0,clearInterval(i._preUpdateTimer),i._preUpdateCountFlag=!1,i._updateItems(!0))):(i._preUpdateCount=0,i._updateItems(!0)))}},_lastYpos:0,_preUpdateTimer:0,_preUpdateTimerCount:0,_preUpdateCountFlag:!1,_modifyChildrenProp:function(e,t){var i,a=0,n=this,o="",r=e.length;for(a=0;r>a;a++){i=e[a];for(o in t)i[o]=t[o];i.hasOwnProperty(h)&&n._modifyChildrenProp(i[h],t)}},_calcDataCellIndex:function(e,t,i){var a=this.options.pc.cells[e],n={},o=0,r=this.options.pc.cells.length,l=Math.abs(i),s=0;if(0>i)for(o=0;l>o;o++)--t,0>t&&(e--,a=this.options.pc.cells[e],a&&(t=a.data.length-1)),void 0==a&&++s;else for(o=0;l>o;o++)++t,a&&t>=a.data.length&&(t=0,e++,a=this.options.pc.cells[e]),a||++s;return 0>t&&(t=0),0>e?e=0:e>=r&&(e=r-1,a=this.options.pc.cells[r-1],t=a.data.length-1),n.cellIndex=e,n.nodeIndex=t,n.overflowCount=s,n},_draw:function(){var t=parseInt(this.treeEl.css("height"));if(isNaN(t)||0==t)return this.needRedraw=!0,void 0;var i=this,a=i.options.data.length,n=Math.ceil(t/this.options.itemHeight),o=2*n;i.treeEl.children().remove(),i.itemCount=o,i.options.pc.items=[],i.options.icon=void 0==i.options.icon?!0:i.options.icon,i.options.multi=void 0==i.options.multi?!0:i.options.multi,i.options.expand?i.bgEl.css("height",i.options.pc.maxBgHeight+"px"):i.bgEl.css("height",a*i.options.itemHeight+"px"),i.treeEl.append(i.bgEl);for(var r,l,s,d=0,c=0,h=0,u=0;o>u;u++){r=e("<div />"),h=u*this.options.itemHeight,s=this.options.pc.cells[d],s?l=s.data[c]:(l=void 0,d=c=-1),i.treeEl.append(r);var p=new O(r,this.options);p.preUpdateNode(l,h,d,c),p.updateNode(i.options,i),i.options.pc.items.push(p),c++,s&&c>=s.data.length&&(d++,c=0)}i.options.pc.topItem=i.options.pc.items[0],i.options.pc.topYPos=parseInt(i.options.pc.topItem.el.css("top")),i.options.pc.bottomItem=i.options.pc.items[i.options.pc.items.length-1],i.options.pc.bottomYPos=parseInt(i.options.pc.bottomItem.el.css("top")),i.options.nodeDraggable&&i._addNodeDragEvent(),i.treeEl.scroll(function(){i._updateItems()}),i._updateItems()},_render:function(t){t&&!this.rendered&&(this.renderEl=e("#"+t),this.renderEl||this._createRenderEl(),this.renderEl.append(this.rootDiv),this.searchField&&(this.rootDiv.append(this.searchRendererDiv),this.searchField.render(this.searchRendererDiv.attr("id"))),this.treeRootDiv.append(this.treeEl).appendTo(this.rootDiv),this.rendered=!0,this.updateOptions(this.options))},_doLayout:function(){void 0!=this.needRedraw&&1==this.needRedraw&&(this.needRedraw=!1,this._draw())},clear:function(){this.setData([])},_clearAll:function(){this.options.pc.cells.length=0,this.options.pc.itemsMap={},this.options.pc.leafItemsMap={},this.options.pc.filterItemsMap={},this.options.pc.bottomYPos=this.options.pc.topYPos=0,this.options.pc.topItem={},this.options.pc.bottomItem={},this.options.pc.totalNodeCount=0,this.options.pc.maxBgHeight=0,this.options.pc.items.length=0,this.options.data.length=0,this.options.orgData.length=0,this.options.selectedItems={},this.options.maxLevel=0,this.options.maxNodeWidth=0,this.options.selectedNode=null,this.treeEl.children().remove()},_clearUpdateData:function(){this.options.pc.cells.length=0,this.options.pc.bottomYPos=this.options.pc.topYPos=0,this.options.pc.topItem={},this.options.pc.bottomItem={},this.options.pc.totalNodeCount=0,this.options.pc.maxBgHeight=0,this.options.pc.items.length=0,this.options.data=[],this.options.maxLevel=0,this.options.maxNodeWidth=0,this.options.pc.updateItemsMap={},this.options.pc.updateLeafItemsMap={},this.treeEl.children().remove()},_createIndex:function(e,t,r,w,_,C,b,x,T,D){var S,k="",L=r.length,N=void 0==b?!0:b,I=_||0,P=T||"NA",F=M,W=0,O=x||0,R=0;for(I>this.options.maxLevel&&(this.options.pc.maxNodeLevel=this.options.maxLevel=I),R=0;L>R;R++)if(S=r[R],S.hasOwnProperty(y)&&1==S[y])S[a]=M,this._updateParentCheckedState(S),delete r[R],r.splice(R,1),delete this.options.pc.itemsMap[S[g]],delete this.options.pc.leafItemsMap[S[g]],--L,--R;else{N&&(0==O||O>=this.options.pc.cellCount-1)&&(C=new B,C.cellIndex=W,this.options.pc.cells[W]=C,++W,O=0),S[c]=S[this.options.labelField]+"_"+S[this.options.valueField],S[n]=N,S[f]=O,S[p]=I,S[i]=this.options.expand,F=S[a]=void 0==S[a]?M:S[a],S[l]=L,k=S[c],S[s]=R==L-1,S[d]=D?D.slice(0):[],S[d].push(S[s]),void 0!=w&&(S[u]=w[g],k=w[g]+"#"+k,w[m][S[c]]=S),S[g]=k,N&&(P=S[g]),S[v]=P,e[S[g]]=S;var H=0;if(C&&(C.data.push(S),H=C.data.length-1,++O),S.hasOwnProperty(h)){S[m]={},S[o]=!1;var j=this.options.pc.itemsMap[S[g]][h].length,z=S[h].length;O=this._createIndex(e,t,S[h],S,I+1,S[i]?C:void 0,!1,O,P,S[d]);var V=S[h].length;if(0==V&&0==j-z){S[y]=!0,C&&C.data.splice(H,1),--R;continue}}else t[S[g]]=S,S[o]=!0,S[a]==A&&(this.options.selectedItems[S[g]]=S),1==S[E]&&this._updateParentCheckedState(S);S[E]=!1,this.options.pc.totalNodeCount++}return O},_updateData:function(e){this._clearUpdateData(),this.options.data=e,this._createIndex(this.options.pc.updateItemsMap,this.options.pc.updateLeafItemsMap,this.options.data),this.options.pc.maxBgHeight=this.options.pc.totalNodeCount*this.options.itemHeight,this._draw(),this._updateItems(!0)},filter:function(e){var t=this._filterItemsByString(e),i=[];t&&(t.length>0?(this.options.pc.isFilterMode=!0,i=this._rebuildTreeData(t),this._updateData(i)):(this.options.pc.isFilterMode=!1,this._clearUpdateData()))},_filterItemsByString:function(e){var t,i="",a={},n=[];if(this.options.pc.filterItemsMap={},""==e)return this.options.pc.isFilterMode=!1,this._updateData(this.options.orgData),void 0;this.options.expand=!0,a=this.options.pc.leafItemsMap,e=e.toLowerCase();for(i in a)t=a[i][this.options.labelField].toLowerCase(),-1!=t.indexOf(e)&&n.push(a[i]);return n},_copyNode:function(t){var i=e.objCopy(t);return t.data&&(i.data=e.objClone(t.data)),i[w]={},i[_]={},i[C]=0,i[b]=0,i},_rebuildTreeData:function(t,i){function a(t){if(void 0!=t)if(t[n])c[t[g]]?t=c[t[g]]:(t=l._copyNode(t),c[t[g]]=t),s.push(t);else{if(t[o]){var i;t.data&&(i=e.objClone(t.data)),t=c[t[g]]=e.objCopy(t),i&&(t.data=i)}r=l.options.pc.itemsMap[t[u]],c[r[g]]?(r=c[r[g]],l._pushNodeToParent(t,r)):(r=l._copyNode(r),c[r[g]]=r,l._pushNodeToParent(t,r),a(r))}}var r,l=this,s=[],d=t.length,c=i||l.options.pc.filterItemsMap;if(W(t,"array"))for(var h=0;d>h;h++)a(t[h]);else if(W(t,"object"))for(var p in t)a(t[p]);return s},_pushNodeToParent:function(e,t){var i=e[g];t[h]||(t[h]=[]),t[h].push(e),A==e[a]?(t[w][i]=i,t[C]++):P==e[a]&&(t[_][i]=i,t[b]++),this._calcCheckedState(t)},_destoryWidget:function(){this.rootDiv&&this.rootDiv.remove()},_setHeightAndRedraw:function(e){this._setHeight(e),this._draw()},autoReDraw:function(){var e=this,t=e.options,i=t.pc,a=i.items,n=a.length,o=n*t.itemHeight,r=parseInt(this.treeEl.css("height"));2*r>o&&e._draw()},_getHeight:function(){return this.rootDiv.externalHeight()},_getWidth:function(){return this.rootDiv.externalWidth()},_setWidth:function(e){this.rootDiv.externalWidth(e),this.treeEl.externalWidth(e)},_setHeight:function(t){if("string"==typeof t&&/\d+%/.test(t)){var i=parseInt(t,10);t=this.rootDiv.parent().height()*i/100}this.rootDiv.externalHeight(t);var a=0;this.searchRendererDiv&&(a=parseInt(e(this.searchRendererDiv).css("height"))+20),a=t-a,this.treeRootDiv.css("height",a),this.treeEl.css("height",a)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t),void 0!=this.needRedraw&&1==this.needRedraw&&(this.needRedraw=!1,this._draw())},_addListener:function(e,t){this.eventNames[e]&&(this.handlers[e]=t)},_removeListener:function(e){delete this.handlers[e]},_removeAllListener:function(){for(var e in this.handlers)delete this.handlers[e]},_initNodesWidth:function(t){for(var i,a,n,o,r=22,l=5,s=0,d=0,c=0;t.options.pc.items.length>c;c++)i=t.options.pc.items[c].el,"block"==e(i).css("display")&&(s=0,e.each(e(i).children(),function(i,a){("block"===e(a).css("display")||e(a).hasClass(t.options.style.treeTextClass))&&(s+=e(a).externalWidth())}),s>d&&(d=s));a=t.treeEl.innerWidth(),n=t.treeEl.height(),o=t.bgEl.height(),o>n?a-r>d&&(d=a-r):a-l>d&&(d=a-l);for(var c=0;t.options.pc.items.length>c;c++)i=t.options.pc.items[c].el,e(i).width(d)}}),Sweet.tree.OptimizeTree=e.sweet.optimizeTree}(jQuery),function(e){var t="sweet-form-combobox-element",i="sweet-form-combobox-arrow",a="sweet-form-combobox-arrow-gray",n="sweet-form-combobox",o="sweet-form-combobox-gray",r="sweet-form-combobox-ulParent",l="sweet-form-combobox-selectWinText",s="sweet-form-combobox-selectWinRadio",d="sweet-form-checkbox-image",c="sweet-form-checkbox-imageSelect",h="sweet-form-combobox-dropDownSpan",u="sweet-form-combobox-bigDataImage-delete",p="sweet-form-combobox-partitionLine",f=0,g=10,m=22,v="afterSetData",w="afterSetValue",_=Sweet.core.i18n.combobox.checkAll;e.widget("sweet.widgetFormCombobox",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-combobox]",type:"text",eventNames:{change:"改变值事件",afterSetData:"调用完setData方法后事件",afterSetValue:"setValue执行后触发",beforeCheckboxClick:"点击checkBox之前的事件(checkBox未选中的时候触发)",afterCloseFloatWin:"关闭浮动窗口后的事件"},options:{data:[],value:null,multi:!1,all:!1,write:!1,tip:!1,tree:!1,lazyLoad:!1,limit:50,remote:!1,store:null,emptyText:Sweet.core.i18n.combobox.pleaseCheck,emptyAll:!1,minRemains:0,maxRemains:Number.MAX_VALUE,pleaseSelect:!1,pleaseSelectText:Sweet.core.i18n.combobox.pleaseSelect},isAll:function(){var e=this;return e.options.all&&e.options.multi&&e.formElement.val()===_?!0:!1},setData:function(e){var t=this;t._setData(e)},_setData:function(e,t){var i=this,a=i.options;return a.data=e||[],i.oldInputText2="",a.value=null,"block"===i.dropDownEl.css("display")&&i.dropDownEl.hide(),i.list||i.tree?(i.formElement&&!0!==t&&i.formElement.val(""),i.setDataFlag=null,i.options.tree?i.tree.setData(e):(i._deleteAllItem(),a.multi&&a.all&&e&&e.length>0&&i._creatAllItem(),a.emptyAll&&(i.inputShowAll=!0),i.list.setData(e)),i.formElement&&!0!==t&&(i.formElement.attr("title",""),a.tooltip=""),undefined):(i.setDataFlag=e,undefined)},setRemote:function(e){var t=this;t.options.remote=e,t.list&&t.list.setRemote(e)},setLazyLoad:function(e){var t=this;t.options.lazyLoad=e,t.list&&t.list.setLazyLoad(e)},_destroyWidget:function(){var e=this;e._super(),e.list?e.list.destroy():e.tree&&e.tree.destroy(),e.dropDownEl&&e.dropDownEl.remove()},_doLayoutFloat:function(){"use strict";var t,i=this,a=0,n=0,o=0;if(t=e.isNotNull(i.options.store)?i.options.store._dealData():i.options.data,i.dropDownEl.addClass(s).externalWidth(i.formDiv2El.outerWidth(!0)),i.tree)i.tree.setWidth(i.formDiv2El.width(!0)),i.tree.setHeight("auto");else{if(a=i.dropDownEl.find("li").length,a>9&&(o=m*(g-1),i.ulParentEl.css({"max-height":o})),!e.isPlainObject(t)&&i.options.lazyLoad&&e.isNotNull(i.options.store))a-=2;else if(e.isPlainObject(t)&&i.options.lazyLoad&&e.isNotNull(i.options.store)){for(var r=t.total,l=0,d=0,c=1;r>=10;)r/=10,c++;d=i.dropDownEl.width(),l=125+2*7*(c-1),l>d&&i.dropDownEl.css("width",l)}n=m*a,e.isPlainObject(t)&&i.options.lazyLoad&&e.isNotNull(i.options.store)&&(n-=15),i.ulParentEl.css("overflow","hidden"),i.list.setHeight(0===o?n:o),i.list.doLayout(!0)}i._orientDropDown()},_doLayout:function(){this._super(),this._closeFloatPanel()},_closeFloatPanel:function(){var t=this;if(!t.openDropDownFlag&&"block"===t.dropDownEl.css("display")){t.dropDownEl.hide();var a=!1;t._triggerHandler(null,"afterCloseFloatWin",{value:t.getValue(),changed:t.beforCloseFloatWinInput!==t.formElement.val()}),t.downArrow.hasClass(u)&&(a=!0,t.downArrow.removeClass(u).addClass(i));var n=t.getValue();if(t.options.write){var o=t.list.getValue(),r=t._getInputText(o),l=t.formElement.val();!o||e.isArray(o)&&1>o.length||e.isEmptyObject(o)||r===t.lastSelectedVal?(t.oldInputText2!==l&&t._triggerHandler(null,"change",l),t.formElement.val(l)):t.formElement.val(r),t._setTitle()}else if(t.options.tree)n&&t._getInputText(n)||(t.needSetDefaultVal=!1,t.tree.filter(""));else if(t.needSetDefaultVal=!0,!t.options.emptyAll||t.options.lazyLoad||t.options.remote||(t.inputShowAll=!0),t.options.lazyLoad||t.options.remote){var s=t._getInputText();t.options.emptyAll&&!s&&(s=_),e.isNull(s)?t.formElement.val(t.oldInputText2):t.formElement.val(s),t.formElement.attr("title",t.formElement.val())}else if(a){var d=t.list.getValue();t.list._triggerHandler(null,w,d),t.list.filter(""),t._afterFilter&&(e.isEmptyObject(d)||e.isNull(d))&&t._afterFilter()}else if(!t.options.multi){var d=t.list.getValue();t.list._triggerHandler(null,w,d),t.list.filter("")}t.rendered&&t.formElement.blur()}t.openDropDownFlag=!1,t.tabopen=!1},_addListener:function(){var t=this,i=t.options;e.each(t.handlers,function(a,n){"change"===a&&(i.tree?t.tree.addListener("change",n):t.list.addListener("change",function(t,a){(i.write||!e.isEmptyObject(a)||e.isArray(a))&&n(t,a)})),"beforeCheckboxClick"===a&&(i.tree?t.tree.addListener("beforeCheckboxClick",n):t.list.addListener("beforeCheckboxClick",n))})},_removeListener:function(t){var i=this,a=i.options;e.isNull(t)||("change"===t&&(a.tree?i.tree.removeListener("change"):i.list.removeListener("change")),"beforeCheckboxClick"===t&&(a.tree?i.tree.removeListener("beforeCheckboxClick"):i.list.removeListener("beforeCheckboxClick")))},_setValue:function(e){var t=this,i=t.options;return e?i.write&&e.write?(t.options.tree?(t.needSetDefaultVal=!0,t.tree.filter("")):(t.needSetDefaultVal=!0,t.list.filter(""),t.formElement.val("")),t.formElement.val(e.text),t._setTitle(),t._triggerHandler(null,"change",e),undefined):(t._showAllLine(),t.options.tree?t.tree.setValue(e):t.list.setValue(e),t.tree&&t.timerGetValue&&clearInterval(t.timerGetValue),t._setAllItem(),undefined):(t.formElement.val(""),t.formElement.attr("title",""),i.tooltip="",undefined)},_getValue:function(){var t=this,i=t.options,a=null;if(t.options.tree)a=t.tree.getValue();else if(a=t.list.getValue(),i.multi&&i.emptyAll&&t.formElement.val()===_&&(!a||e.isArray(a)&&1>a.length))return null;return i.write&&t.formElement.val()&&(!a||e.isArray(a)&&1>a.length||e.isEmptyObject(a))&&(a={value:t.formElement.val(),text:t.formElement.val(),write:!0}),a},_setDisabled:function(e){var t=this,r=t.formDiv2El,l=t.downArrow,s="";if(r.removeClass(n).removeClass(o),e){if(r.addClass(o),s=a,!t.formDiv2El.hasClass(t.defaultPaddingDivClass))return;r.removeClass(t.defaultPaddingDivClass).addClass(t.defaultPaddingDivDisabledClass)}else{if(r.addClass(n),s=i,t.rendered&&t.formElement.blur(),!r.hasClass(t.defaultPaddingDivDisabledClass))return;r.removeClass(t.defaultPaddingDivDisabledClass).addClass(t.defaultPaddingDivClass)}l.removeClass().addClass(s),t.__setDisabled(e)},_setEditable:function(e){var t=this;e&&t.rendered&&t.formElement.blur()},_optionsValidate:function(){var e=this,t=e.options;return t.all&&t.lazyLoad?(e._error("Lazy loading can not select all!"),!1):!0},_createInputField:function(){var a=this,o=a.formDiv1El,l=a.formDiv2El=e("<div>").appendTo(o).attr("tabindex",-1),s=a.formElement=e("<input>"),d=a.downArrow=e("<span>");if(a._optionsValidate()){d.addClass(i).bind("click",{me:a},a._showDropDownList).appendTo(l),s.attr("type",a.type).addClass(t).appendTo(l),a.options.editable||s.attr("disabled",!0),e.isNotNull(a.options.vID)&&s.attr("id",a.options.vID),l.addClass(a.defaultPaddingDivClass).addClass(n),s.click(function(e){"block"===a.dropDownEl.css("display")&&e.stopImmediatePropagation()}).bind("keyup",function(t){var i=t.charCode||t.keyCode;if(Sweet.constants.keyCode.TAB===i){if(a.disabled)return;if("none"===a.dropDownEl.css("display")){a.tabopen=!0,a._doLayoutFloat(),a._orientDropDown();var n=e.getMaxZIndex(a.dropDownEl.css("z-index"));return a.dropDownEl.css({"z-index":n}),a.dropDownEl.show(),a.beforCloseFloatWinInput=a.formElement.val(),a.openDropDownFlag=!1,a.formElement.select(),undefined}}a.inputShowAll=!1,a.options.tree||a.list.setFilter(a.formElement.val()),Sweet.Task.Delay.start({id:a.options.id+"-combobox-filter-delay",run:function(e){"none"!==a.dropDownEl.css("display")&&(a._afterFilter=a._filterItems(e[0],e[1]))},args:[t,a],delay:350})});var c=a.dropDownElId="comboboxDropdown"+f++,h=a.dropDownEl=e("<div>").addClass(a.floatBgClass).attr({tabindex:-1}).hide().appendTo("body");a.ulParentEl=e("<div>").attr({id:c}).addClass(r).appendTo(h),a._asynOperations(),a.options.emptyAll&&(a.inputShowAll=!0)}},_showDropDownList:function(t){var n=t.data.me;if(!n.downArrow.hasClass(a)){if(n.downArrow.hasClass(u))n.downArrow.removeClass(u).addClass(i),n.needSetDefaultVal=!0,n.options.tree?n.tree.filter(""):n.list.filter(""),"none"===n.dropDownEl.css("display")&&(n.dropDownEl.show(),n.beforCloseFloatWinInput=n.formElement.val()),t.stopImmediatePropagation();else{n._resizeDropDownHeight();var o=e.getMaxZIndex(n.dropDownEl.css("z-index"));n.dropDownEl.css("z-index",o),n.openDropDownFlag=!1,e.isVisiable(n.dropDownEl)||(n._orientDropDown(),n.dropDownEl.addClass(s),n.dropDownEl.show(),n.openDropDownFlag=!0,n.beforCloseFloatWinInput=n.formElement.val(),n.rendered),n._doLayoutFloat()}n._showAllLine()}},_asynOperations:function(){var e=this;e.options,e.finishedCreatingDropdown||(e._createDropDown(),e._doLayoutFloat(),e.setDataFlag&&e._setData(e.setDataFlag,!0),e._registInitEvent(),e.finishedCreatingDropdown=!0)},_createDropDown:function(){var e=this,t=e.options,i=e.dropDownEl;i.css({height:"auto"}),e.list||e.tree||(t.tree?e._creatDropDownTree():e._creatDropDownList(),i.click(function(e){e.stopImmediatePropagation()}))},_creatDropDownList:function(){var e=this,t=e.options,i=t.data;t.multi&&t.all&&e._creatAllItem(),e.list=new Sweet.list.List({multi:t.multi,data:i,store:t.store,lazyLoad:t.lazyLoad,limit:t.limit,remote:t.remote,tip:t.tip,renderTo:e.dropDownElId,minRemains:t.minRemains,maxRemains:t.maxRemains,_pleaseSelect:t.pleaseSelect,_pleaseSelectText:t.pleaseSelectText})},_creatDropDownTree:function(){var e=this,t=e.options,a=e.tree=new Sweet.tree.Tree({height:"auto",multi:t.multi,data:t.data,store:t.store,value:t.value,lazyLoad:t.lazyLoad,lazyLoadRows:t.limit,backSearch:t.remote,backEndLoad:!0,searchDir:t.searchDir,renderTo:e.dropDownElId,icon:t.icon,nodeClick:function(t,n){a.options.multi||n.children&&!(1>n.children.length)||(e.dropDownEl.hide(),e.tree.getValue(),e.formElement.val(n.text),e._setTitle(),e._triggerHandler(null,"afterCloseFloatWin",{value:e.getValue(),changed:e.beforCloseFloatWinInput!==e.formElement.val()}),e.rendered&&e.formElement.blur(),e.downArrow.hasClass(u)&&e.downArrow.removeClass(u).addClass(i))},nodeCheck:function(){if(a.options.multi){var t=e._getInputText();e.formElement.val(t),e._setTitle(),e.rendered&&e.formElement.blur()}},nodeUnCheck:function(){if(a.options.multi){var t=e._getInputText();e.formElement.val(t),e._setTitle(),e.rendered&&e.formElement.blur()}}});e.dropDownElRended=!1},_registInitEvent:function(){var e=this;if(e.list)e._registInitEventList();else{if(!e.tree)return;e._registInitEventTree()}},_registInitEventList:function(){var t=this,i=t.options,a=t.list;a.addListener("afterSetData",function(n,o){t._triggerHandler(null,v,o);var r=a.getValue(),l=!0;if(r&&(e.isArray(r)&&r.length>0&&(l=!1),e.isPlainObject(r)&&(r.value||r.text)&&(l=!1)),i.multi&&i.emptyAll){if(!l)return;return t.inputShowAll&&(t.formElement.val(_),t.formElement.attr("title",t.formElement.val()),t.inputShowAll=!1),t._setTitle(),undefined}if(t.needSetDefaultVal)return t.needSetDefaultVal=!1,undefined;var s=o&&o.length>0?o[0]:[];if(i.value)s=i.value||s;else if(i.multi)return;return e.isArray(s)&&(1>s.length||s.length>o.length)?(i.multi&&i.emptyAll?t.formElement.val(_):t.formElement.val(""),t._setTitle(),t.rendered&&t.formElement.blur(),undefined):(t._setTitle(),a.setValue(s),t.needSetDefaultVal=!1,i.value=s,undefined)}),a.addListener("afterSetValue",function(n,o){var r;if((!i.value||!i.value.value||e.isArray(i.value)&&1>i.value.length)&&(!o||e.isArray(o)&&1>o.length)){var l=i.multi&&i.emptyAll,s=l?_:"";return t.formElement.val(s),t._setTitle(),i.multi||a._setFirstValue(),undefined}if(t.notSetInpueVal)return t.notSetInpueVal=!1,undefined;var d=Boolean(!i.multi&&o&&i.pleaseSelectText===o.value&&i.pleaseSelect);d?r="":(r=t._objArrToObj(o).text,t._setAllItem(),t.allLiEl&&t._allIsClicked()&&(r=_)),t.formElement.val()!==r&&(e.isNull(r)&&!d?t.formElement.val(t.oldInputText2):t.formElement.val(r),t.rendered&&t.formElement.blur(),t._setTitle(),t._triggerHandler(null,w,o))}),a.addListener("nodeClick",function(){i.multi||(t._closeFloatPanel(),t.notSetInpueVal=!1)}),a.addListener("checkboxClick",function(){if(i.multi){var e=a.getValue(),n=t._objArrToObj(e).text;t.notSetInpueVal=!1,t.allLiEl&&(a.isAll()?(t.allLiEl.children("a").removeClass().addClass(c),n=_):t.allLiEl.children("a").removeClass().addClass(d)),!n&&i.emptyAll?t.formElement.val(_):t.formElement.val(n),t._setTitle(),t.rendered&&t.formElement.blur()}})},_registInitEventTree:function(){var e=this,t=(e.options,e.tree);t.addListener("nodeExpand",function(){e._orientDropDown()}),t.addListener("afterSetValue",function(t,i){var a=e._getInputText(i);e.formElement.val(a),e._setTitle(),e.rendered&&e.formElement.blur(),e._triggerHandler(null,w,i)}),t.addListener("afterSetData",function(t,i){e.needSetDefaultVal||(e.formElement.val(""),e._setTitle()),e.needSetDefaultVal=!1,e._triggerHandler(null,v,i)})},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},_afterCreateSweetWidget:function(){var e=this,t=e.options;
e._super(),e.tree&&!e.dropDownElRended&&(e.tree.render(e.dropDownElId),e.dropDownElRended=!0),e.formElement.bind("click",{me:e},e._showDropDownList),e.formElement.bind("focus",function(){var t;e.list&&(t=e.list.getValue()),e.oldInputText=e.formElement.val(),e.oldInputText2=e.formElement.val(),e.lastSelectedVal=e._getInputText(t)}),e.formElement.bind("focusout",function(){"block"===e.dropDownEl.css("display")&&e.tabopen&&e._closeFloatPanel()}),t.store&&t.emptyAll&&t.store.addListener({beforeLoad:function(){e.inputShowAll=!0,e.notSetInpueVal&&(e.inputShowAll=!1)}})},_creatAllItem:function(){var t=this,i=t.allLiEl=e("<li>"),a=e("<a>"),n=e("<span>").addClass(h),o=t.partitionLine=e("<div>").addClass(p);i.addClass(l).prependTo(t.dropDownEl),a.addClass(d).appendTo(i),i.bind("click",function(){t._clickAllImage(a.get(0))}),n.attr("value","All").text(_).appendTo(i),o.insertBefore(t.ulParentEl)},_deleteAllItem:function(){var e=this;e.allLiEl&&(e.dropDownEl.find("li").remove(),e.partitionLine.remove(),e.allLiEl=null)},_setAllItem:function(){var e=this;e.allLiEl&&(e._allIsClicked()?e.allLiEl.children("a").removeClass(d).addClass(c):e.allLiEl.children("a").removeClass(c).addClass(d))},_allIsClicked:function(){var e=this;e.options;var t=!1;return e.list&&e.list.isAll()&&(t=!0),t},_hideAllLine:function(){var e=this;e.allLiEl&&(e.allLiEl.hide(),e.partitionLine.hide())},_showAllLine:function(){var e=this;e.allLiEl&&(e.allLiEl.show(),e.partitionLine.show())},_clickAllImage:function(e){var t=this,i=t.options,a=e.className,n=a===d?c:d;t.allLiEl.children("a").removeClass(a).addClass(n),n===c?(t.list.all(!0),t.formElement.val(_),t._setTitle()):(t.list.all(!1),i.emptyAll?t.formElement.val(_):t.formElement.val(""),t._setTitle()),t.rendered&&t.formElement.blur()},_getInputText:function(e){var t=this;e=e||t.getValue();var i=t._oneObjToArray(e),a=t._getLeafNodeObj(i);return t._objArrToObj(a).text},_getLeafNodeObj:function(e,t){var i=this;if(t=t||[],e){for(var a=0;e.length>a;a++)e[a].children?i._getLeafNodeObj(e[a].children,t):t.push(e[a]);return t}},_objArrToObj:function(t){var i=this,a={},n="",o="",r="";if(!t)return a.text=n,a.value=o,a;for(var l=i._oneObjToArray(t),s=0;l.length>s;s++)r=e.isUndefined(l[s].text)?l[s].value:l[s].text,o=o+","+l[s].value,n=n+","+r;return a.text=n.substring(1,n.length),a.value=o.substring(1,o.length),a},_oneObjToArray:function(t){if(!t)return null;var i=[];return e.isArray(t)?i=t:e.isUndefined(t.value)||e.isUndefined(t.text)||i.push(t),i},_filterItems:function(e,t){var a=t,n=a.options,o=e.charCode||e.keyCode,r=a.formElement.val();if(!1!==a.editable&&Sweet.constants.keyCode.TAB!==o&&(a.downArrow.hasClass(i)&&a.downArrow.removeClass(i).addClass(u),a.oldInputText!==r)){if(a.oldInputText=r,a.needSetDefaultVal=!0,a.notSetInpueVal=!0,n.tree)return a.tree.filter(r),"none"===a.dropDownEl.css("display")&&a.downArrow.click(),undefined;var l=a.list.getValue();return a.list.filter(r),"none"===a.dropDownEl.css("display")&&a.downArrow.click(),n.write&&!n.multi&&a.list.setValue(""),function(){n.multi||n.write||a.list.setValue(l)}}},_resizeDropDownHeight:function(){var t=this;t.list&&(t.allLiEl&&("display"===t.dropDownEl.css("display")&&"display"===t.allLiEl.css("display")||"none"===t.dropDownEl.css("display"))?t.ulParentEl.css({"max-height":(g-1)*m+"px"}):t.list.lazyLoadEl&&t.options.lazyLoad&&!e.isVisiable(t.list.lazyLoadEl)&&t.ulParentEl.css({"max-height":(g-1)*m-18+"px"}))},_orientDropDown:function(){var t=this,i=e.getFloatOffset(t.formDiv2El,t.dropDownEl);t.dropDownEl.css({left:i.left,top:i.top})},_setTitle:function(){var e=this,t=e.options,i=e.formElement.val(),a=t.tip;a&&" "!==i&&(t.tooltip=i)},_afterFilter:e.noop}),Sweet.form.ComboBox=e.sweet.widgetFormCombobox}(jQuery),function(e){var t="sweet-form-comboboxv1-input",i="sweet-form-comboboxv1-arrow",a="sweet-form-comboboxv1-arrow-gray",n="sweet-form-comboboxv1",o="sweet-form-comboboxv1-gray",r="sweet-form-comboboxv1-win",l="sweet-form-comboboxv1-win-body",s="sweet-form-body-resizeEl",d="sweet-form-body-resizeXYEl",c="sweet-form-body-resizeXlEl",h="sweet-form-body-resizeXrEl",u="sweet-form-body-resizeYtEl",p="sweet-form-body-resizeYbEl",f="sweet-form-comboboxv1-bigDataImage-delete",g="sweet-form-comboboxv1-tree-win",m="afterSetData",v="afterSetValue",w="change",_="beforesearch",C="search",b="nodeClick",E="click",y="beforeCheckboxClick",x="beforecheckchange",T="collapse",D="expand",S="checkchange",k="checkboxClick",L="checkboxAllClick",N="resizeLayout",I="resizeElMove",A=0,P=10,M=22,F=Sweet.core.i18n.combobox.checkAll;e.widget("sweet.widgetFormCombobox_v1",e.sweet.widgetFormInput,{version:"1.0",sweetWidgetName:"[widget-form-combobox-v1]",type:"text",eventNames:{change:"改变值事件",beforesearch:"查询前事件",search:"过滤事件",afterSetData:"调用完setData方法后事件",afterSetValue:"setValue执行后触发",beforeCheckboxClick:"点击checkBox之前的事件(checkBox未选中的时候触发)",beforecheckchange:"树节状态改变前事件",collapse:"下拉列表关闭后的事件",expand:"下拉列表展开前的事件",checkchange:"勾选状态发生变化时的事件",click:"单选节点单击时触发的事件",resizeLayout:"缩放刷新后事件",resizeElMove:"虚线框缩放事件"},options:{data:[],value:null,multi:!1,all:!1,write:!1,tip:!1,tree:!1,emptyText:Sweet.core.i18n.combobox.pleaseCheck,emptyAll:!1,minRemains:0,maxRemains:Number.MAX_VALUE,tools:null,sViewBar:!1,icon:!1,useArrows:!0,isClearFilter:!1,isSelectFirst:!0,queryDelay:350,resizAble:!1},isAll:function(){var e=this;return e.options.multi&&1!=e.options.tree&&"true"!=e.options.tree&&e.list&&(e.list.isAll()||e.options.emptyAll&&0>=e.list.getValue().length)?!0:!1},setData:function(e,t,i,a){var n=this;n.disabled||(n._resizeInfo&&(n._resizeInfo=null),i?n._updateData(e,t,a):n._setData(e,t,a),n._doLayoutFloat(),n._isDoLayout=!0)},_updateData:function(e,t,i){var a=this,n=0;e=a._objToArray(e),n=a._dataLength,a._dataLength=e.length,1==a.options.tree||"true"==a.options.tree?a.tree.setData(e):(t&&(a._dataLength=n+a._dataLength),a.list.setData(e,t,i))},_setData:function(e,t,i){var a=this,n=0;e=a._objToArray(e),n=a._dataLength,a._dataLength=e.length,a.dropDownEl&&"block"===a.dropDownEl.css("display")&&a.dropDownEl.hide(),a._setTitle(""),a._initFilterImageState(),1==a.options.tree||"true"==a.options.tree?a.tree.setData(e):(t&&(a._dataLength=n+a._dataLength),a.list.setData(e,t,i),a.options.multi?a.options.emptyAll&&a._dataLength>0&&a._setTitle(F):a.options.isSelectFirst&&e.length>0&&a.setValue(e[0]))},_setValue:e.noop,setValue:function(e,t,a){var n=this,o="";if((n.tree||n.list)&&!n.disabled){if(n._isDoLayout=!0,e=n._objToArray(e),t)return 1==n.options.tree||"true"==n.options.tree?n.tree.setValue(e):n.list.setValue(e,a),n._triggerHandler(null,w,n.getValue()),undefined;if(n._initFilterImageState(),n._isFilterAfterReloadData&&(1==n.options.tree||"true"==n.options.tree?n.tree.filter(""):n.list.filter(""),n._isFilterAfterReloadData=!1),n.options.write&&e.write&&n.list&&!n.options.multi)return n.downArrow&&n.downArrow.removeClass(i).addClass(f),o=e.text||"",n._setTitle(o),n.list.setValue(e,a),n._triggerHandler(null,w,e),n.check(),undefined;1==n.options.tree||"true"==n.options.tree?(n.tree.setValue(e),n._doTreeSetText()):(n.list.setValue(e,a),n._doListSetText()),n._triggerHandler(null,w,n.getValue()),n.check()}},_getValue:function(){var e=this,t=null;return e.tree||e.list?(1==e.options.tree||"true"==e.options.tree?t=e.tree.getValue():e.isAll()?t=e.list.getData():(t=e.list.getValue(),t&&t.data&&(1==t.data.write||"true"==t.data.write)&&(delete t.data,t.write=!0)),t):[]},_setDisabled:function(e){var t=this,r=t.comboCDiv,l=t.downArrow,s="";if(r.removeClass(n).removeClass(o),e){if(t.formElement.attr("disabled",!0),r.addClass(o),s=a,!t.comboCDiv.hasClass(t.defaultPaddingDivClass))return;r.removeClass(t.defaultPaddingDivClass).addClass(t.defaultPaddingDivDisabledClass)}else{if(t.formElement.removeAttr("disabled"),r.addClass(n),s=i,!r.hasClass(t.defaultPaddingDivDisabledClass))return;r.removeClass(t.defaultPaddingDivDisabledClass).addClass(t.defaultPaddingDivClass)}l.removeClass().addClass(s),t.__setDisabled(e)},_setEditable:function(e){var t=this;e&&t.rendered&&t.formElement.blur()},_optionsValidate:function(){var e=this,t=e.options,i=!1;return i=1==t.tree||"true"==t.tree?!0:!1,(t.all||t.emptyAll||t.write)&&i?(e._error("tree config is error!"),!1):(t.multi||t.sViewBar)&&t.write&&!i?(e._error("list config is error!"),!1):!t.emptyAll||t.all&&t.multi&&!i?!0:(e._error("list config is error!"),!1)},_destroyWidget:function(){var e=this;e._super(),e.list?e.list.destroy():e.tree&&e.tree.destroy(),e.dropDownEl&&e.dropDownEl.remove()},_doLayout:function(){var e=this;e._super(),e._closeFloatPanel()},_createInputField:function(){var a=this,o=a.formDiv1El,s=a.comboCDiv=e("<div>").attr("tabindex",-1).appendTo(o),d=a.formElement=e("<input>"),c=a.downArrow=e("<span>"),h=a.dropDownEl=e("<div>").addClass(r),u=a.comBodyEl=e("<div>"),p=350;a._optionsValidate()&&(p=parseInt(a.options.queryDelay),isNaN(p)&&(p=350),0>p&&(p=0),c.addClass(i).bind("click",{me:a},a._showFloatPanel).appendTo(s),d.attr("type",a.type).addClass(t).appendTo(s),a.options.editable||d.attr("disabled",!0),s.addClass(a.defaultPaddingDivClass).addClass(n),d.bind("click",{me:a},function(e){return"block"===a.dropDownEl.css("display")?(e.stopImmediatePropagation(),undefined):(a._showFloatPanel(e),undefined)}).bind("keyup",function(e){Sweet.Task.Delay.start({id:a.options.id+"-combobox-filter-delay",run:function(e){a._doInputKeyUp(e)},args:e,delay:p})}).bind("focusout",function(){"block"===a.dropDownEl.css("display")&&a._isTabKeydown&&a._closeFloatPanel()}),a.dropDownElId=a.options.id+"-sweet-form-combobox-body-"+A++,h.addClass(a.floatBgClass).attr({tabindex:-1}).hide().appendTo("body"),u.attr({id:a.dropDownElId}).addClass(l).appendTo(h),a.options.resizAble&&a.__doCreateResizeEl())},_afterCreateSweetWidget:function(){var t,i=this;if(i._super(),t=i.options.listeners,!e.isEmptyObject(t))for(var a in t)i.addListener(""+a,t[a]);i._createFloatPanel(),i._registInitEvent()},_createFloatPanel:function(){var e=this,t=e.dropDownEl;t.css({height:"auto"}),e.options.data=e._objToArray(e.options.data),e._dataLength=e.options.data.length,1!=e.options.tree&&"true"!=e.options.tree?e._creatListFloatPanel(e.options.data):e._creatTreeFloatPanel(e.options.data),e.options.data=[],t.click(function(e){e.stopImmediatePropagation()})},_creatListFloatPanel:function(e){var t=this;t.options.all=1==t.options.all||"true"==t.options.all?!0:!1,t.options.multi=1==t.options.multi||"true"==t.options.multi?!0:!1,t.options.sViewBar=1==t.options.sViewBar||"true"==t.options.sViewBar?!0:!1,t.options.tip=1==t.options.tip||"true"==t.options.tip?!0:!1,t.options.tools=t.options.tools?t.options.tools:null,t.options.value=t._objToArray(t.options.value),0>=t.options.value.length&&t._dataLength>0&&(t.options.multi?t.options.all&&t.options.emptyAll&&(t.options.value=e):t.options.isSelectFirst&&(t.options.value=e[0])),t.list=new Sweet.list.OptimizeList({height:t._getListFloatBodyHeight(),data:e,value:t.options.value,all:t.options.all,multi:t.options.multi,tools:t.options.tools,sViewBar:t.options.sViewBar,tip:t.options.tip,renderTo:t.dropDownElId,minRemains:t.options.minRemains,maxRemains:t.options.maxRemains}),t._doListSetText(),t._triggerHandler(null,w,t.getValue())},_creatTreeFloatPanel:function(e){var t=this;t.options.multi=1==t.options.multi||"true"==t.options.multi?!0:!1,t.options.useArrows=0==t.options.useArrows||"false"==t.options.useArrows?!1:!0,t.options.icon=1==t.options.icon||"true"==t.options.icon?!0:!1,t.tree=new Sweet.tree.Tree_v1({height:t._getTreeFloatBodyHeight(),widgetClass:g,multi:t.options.multi,search:!1,tip:t.options.tip,icon:t.options.icon,useArrows:t.options.useArrows,renderTo:t.dropDownElId}),t.tree.setData(e),t.options.value=t._objToArray(t.options.value),t.options.value.length>0&&t.setValue(t.options.value)},_registInitEvent:function(){var e=this;if(e.list)e._registEventList();else{if(!e.tree)return;e._registEventTree()}},_registEventList:function(){var t,i,a=this,n=a.options,o=a.list;o.addListener(m,function(e,t){a._triggerHandler(null,m,t)}),o.addListener(v,function(e,t){a._triggerHandler(null,v,t)}),o.addListener(b,function(t,i){n.multi||(a._triggerHandler(e.objClone(i),E),a._closeFloatPanel())}),o.addListener(k,function(n,o){t=e.objClone(o),i=t.checked,delete t.checked,a._triggerHandler(t,S,i)}),o.addListener(L,function(n,o){t=e.objClone(o),i=t.checked,delete t.checked,delete t.data,a._triggerHandler(t,S,i)})},_registEventTree:function(){var t,i=this,a=i.tree;a.addListener(S,function(a){return e.isEmptyObject(a)?(i._triggerHandler(null,S,!1),undefined):(t=e.objClone(a.node),i._triggerHandler(t,S,a.checked),undefined)}),a.addListener(E,function(t){i.options.multi||(t.leaf&&i._closeFloatPanel(),i._triggerHandler(e.objClone(t),E))})},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){e===y&&(1==t.options.tree||"true"==t.options.tree?t.tree.addListener(x,function(e){"function"==typeof i&&i(e,t)}):t.list.addListener(y,function(e){"function"==typeof i&&i(e,t)})),e===x&&(1==t.options.tree||"true"==t.options.tree?t.tree.addListener(x,function(e){"function"==typeof i&&i(e,t)}):t.list.addListener(x,function(e){"function"==typeof i&&i(e,t)})),e===C&&(1==t.options.tree||"true"==t.options.tree?t.tree.addListener(C,function(e){"function"==typeof i&&i(e,t)}):t.list.addListener(C,function(e){"function"==typeof i&&i(e,t)}))})},_removeListener:function(t){var i=this;e.isNull(t)||(t===y&&(1==i.options.tree||"true"==i.options.tree?i.tree.removeListener(x):i.list.removeListener(y)),t===x&&(1==i.options.tree||"true"==i.options.tree?i.tree.removeListener(x):i.list.removeListener(x)),t===C&&(1==i.options.tree||"true"==i.options.tree?i.tree.removeListener(C):i.list.removeListener(C)))},_doLayoutFloat:function(){"use strict";var e=this,t=0,i=0,a=15,i=0,n=10,o=6;t=e.comboCDiv.outerWidth(!0),e._resizeInfo||(e.dropDownEl.externalWidth(t),e.tree?(i=e._getTreeFloatBodyHeight(),e.tree.setWH(e.comboCDiv.width()+a,i),e.comBodyEl.css({"max-height":i,overflow:"hidden"})):(i=e._getListFloatBodyHeight(),"auto"==i?(e.comBodyEl.css({"max-height":"none",overflow:"hidden",padding:"3px 0"}),e.list.setWH(e.comboCDiv.innerWidth()-o,i)):(e.comBodyEl.css({"max-height":i,overflow:"hidden",padding:"0 0 3px 0"}),e.list.setWH(e.comboCDiv.innerWidth()-o,i-n)))),e._isDoLayout&&(e.tree?e.tree.doLayout(!0):e.list.doLayout(!0),e._isDoLayout=!1),e.dropDownEl.unbind("resize"),e._orientDropDown()},_showFloatPanel:function(t){var n,o,r=t.data.me;if(!r.downArrow.hasClass(a)){if(r.options.isClearFilter)return r.formElement.removeAttr("placeholder"),r.downArrow.hasClass(f)?(r._isFilterAfterReloadData=!0,r._isReSetShowTxt=!0,r.formElement.val(""),r._initFilterImageState()):(o=r.formElement.val(),o&&""!=o.trim()&&r.downArrow.removeClass(i).addClass(f),n=e.getMaxZIndex(r.dropDownEl.css("z-index")),r.dropDownEl.css("z-index",n),e.isVisiable(r.dropDownEl)||(r._triggerHandler(r,D),r._saveShowFloatPanelValue(),r.dropDownEl.show()),r._doLayoutFloat()),r._isShowFloatPanel=!0,r._initResizeInfo(),undefined;r.downArrow.hasClass(f)?(r._isFilterAfterReloadData=!1,r._isReSetShowTxt=!0,r._initFilterImageState(),r._setTitle(""),1==r.options.tree||"true"==r.options.tree?r.tree.filter(""):r.list.filter(""),"none"===r.dropDownEl.css("display")&&(r._triggerHandler(r,D),r._saveShowFloatPanelValue(),r.dropDownEl.show()),t.stopImmediatePropagation()):(n=e.getMaxZIndex(r.dropDownEl.css("z-index")),r.dropDownEl.css("z-index",n),r._isShowFloatPanel=!1,e.isVisiable(r.dropDownEl)||(r._triggerHandler(r,D),r._saveShowFloatPanelValue(),r.dropDownEl.show(),r._isShowFloatPanel=!0),r._doLayoutFloat()),r._initResizeInfo()}},_closeFloatPanel:function(){var e,t=this,i=!1,a=null,n="",o="value";t._isShowFloatPanel||"block"!==t.dropDownEl.css("display")||(t.dropDownEl.hide(),t.options.isClearFilter&&t.options.emptyText&&t.formElement.attr("placeholder",t.options.emptyText),a=t.getValue(),t.list?(!t.options.write||t.options.multi||t.options.sViewBar?e={data:t._objToArray(a),isAll:t.isAll()}:(t._isFilterAfterReloadData&&(n=t.formElement.val(),""==n?(a={},t.list.setValue(null)):n!=a.text&&(a={value:n,text:n,data:{write:!0}},t.list.setValue(a))),e={data:t._objToArray(a),isAll:!1}),o="value"):(e={data:t._getArrayOfLeafNodesInfo(t._objToArray(a)),isAll:!1},o="treeId"),i=t._closeFloatPanelIsChange(t._beforeShowValue,e,o,t.formElement.val()),t._initFilterImageState(),t._isFilterAfterReloadData?(t.list?(t.list.filter(""),t._doListSetText()):(t.tree.filter(""),t._doTreeSetText()),t._isFilterAfterReloadData=!1,t._isDoLayout=!0):t.list?t._isReSetShowTxt?(t._isReSetShowTxt=!1,t._doListSetText()):i&&t._doListSetText():t._isReSetShowTxt?(t._isReSetShowTxt=!1,t._doTreeSetText()):i&&t._doTreeSetText(),i&&t._triggerHandler(null,w,a),t._triggerHandler(null,T,{value:a,changed:i}),t.rendered&&t.formElement.blur()),t._isShowFloatPanel=!1,t._isTabKeydown=!1,t._resizeInfo&&t._resizeInfo._$moveEl&&(t._resizeInfo._$moveEl.remove(),t._resizeInfo._$moveEl=null,t._resizeInfo.isMouseDown=!1)},_closeFloatPanelIsChange:function(e,t,i,a){var n={},o={};if(e=e||{data:[],isAll:!1},t=t||{data:[],isAll:!1},0>=e.data.length&&0>=t.data.length)return!1;if(e.data.length!=t.data.length)return!0;if(!0===e.isAll&&!0===t.isAll)return""!=a?!1:!0;for(var r=0;e.data.length>r;r++)n[e.data[r][i]]="";for(var r=0;t.data.length>r;r++)o[t.data[r][i]]="";for(var l in o)if(""!=n[l])return n=null,o=null,!0;return n=null,o=null,!1},_doInputKeyUp:function(t){var i,a,n=this;if(!n.disabled&&!1!==n.editable)return i=t.charCode||t.keyCode,Sweet.constants.keyCode.TAB===i&&"none"===n.dropDownEl.css("display")?(n._isTabKeydown=!0,a=e.getMaxZIndex(n.dropDownEl.css("z-index")),n.dropDownEl.css({"z-index":a}),n._triggerHandler(n,D),n._saveShowFloatPanelValue(),n.dropDownEl.show(),n._isShowFloatPanel=!1,n.formElement.select(),n._doLayoutFloat(),n._initResizeInfo(),undefined):(n._doFilter(n.formElement.val()),undefined)},_doFilter:function(e){var t,a,n=this;if(n._isFilterAfterReloadData=!0,e&&""!=e?n.downArrow.hasClass(i)&&n.downArrow.removeClass(i).addClass(f):n.downArrow.hasClass(f)&&n.downArrow.removeClass(f).addClass(i),a={filter:e},t=n._triggerHandler(a,_,n),!1!==t&&"false"!==t){if(e=a.filter,1==n.options.tree||"true"==n.options.tree)return n.tree.filter(e),"none"===n.dropDownEl.css("display")&&n.downArrow.click(),undefined;n.list.filter(e),"none"===n.dropDownEl.css("display")&&n.downArrow.click(),"none"===n.dropDownEl.css("display")&&(n._triggerHandler(n,D),n._saveShowFloatPanelValue(),n.dropDownEl.show()),n._orientDropDown(),n._initResizeInfo()}},_saveShowFloatPanelValue:function(){var e=this;e.list?(e.list.totalAEl&&(e.list.totalAEl.click(),e._isDoLayout=!0),e._beforeShowValue={data:e._objToArray(e.getValue()),isAll:e.isAll()}):e._beforeShowValue={data:e._getArrayOfLeafNodesInfo(e._objToArray(e.getValue())),isAll:!1}},_doListSetText:function(){var e,t=this,i=t.options,a="";e=t.list.getValue(),a=t._arrayToObj(e).text,(!a||""==a.trim())&&i.emptyAll&&i.multi&&t._dataLength>0?a=F:t.list.isAll()&&t.options.all&&(a=F),t._setTitle(a),t.rendered&&t.formElement.blur()},_doTreeSetText:function(){var e,t=this;e=t._getShowText(),t._setTitle(e),t.rendered&&t.formElement.blur()},_getShowText:function(e){var t,i,a=this;return e=e||a.getValue(),t=a._objToArray(e),i=a._getArrayOfLeafNodesInfo(t),a._arrayToObj(i).text},_getArrayOfLeafNodesInfo:function(e,t,i){var a=this;if(t=t||[],!e)return t;for(var n=0;e.length>n;n++)i||(i=""),i+=e[n].value,e[n].treeId=i,e[n].children?a._getArrayOfLeafNodesInfo(e[n].children,t,i):t.push(e[n]);return t},_arrayToObj:function(t){var i,a=this,n="",o="",r="",l={value:"",text:""};if(!t)return l;i=a._objToArray(t);for(var s=0;i.length>s;s++)s>0&&(o+=",",n+=","),r=e.isUndefined(i[s].text)?i[s].value:i[s].text,o+=i[s].value,n+=r;return l={value:o,text:n}},_objToArray:function(t){var i=[];return t?(e.isArray(t)?i=t:e.isUndefined(t.value)||i.push(t),i):i},_getListFloatBodyHeight:function(){var e=this,t=P,i=10,a=38,n=10,o=28,r=e._dataLength;return r>0&&t>=r?"auto":(e.options.all&&e.options.multi&&(i=a),1!=e.options.all&&"true"!=e.options.all&&0>=r&&(i=n),r>t&&(i=t*M+i),(1==e.options.sViewBar||"true"==e.options.sViewBar)&&(i+=o),i)},_getTreeFloatBodyHeight:function(){var e=this,t=P,i=10,a=5,n=3,o=e._dataLength;return i=0>=o?a:t*M+n},_setTitle:function(e){var t=this,i=t.options.tip;e=e||"",t.formElement?(""==e&&t.options.emptyAll&&t.options.multi&&t._dataLength>0&&(e=F),t.formElement.val(e),i&&t.formElement.attr("title",e),t.options.tooltip=e):t.options.tooltip=""},_initFilterImageState:function(){var e=this;e.downArrow&&e.downArrow.hasClass(f)&&e.downArrow.removeClass(f).addClass(i)},__doCreateResizeEl:function(){var t,i,a,n,o,r=this,l=r.dropDownEl;if(1==r.options.resizAble||"true"==r.options.resizAble||"xy"==r.options.resizAble)t=e("<div>").addClass(d).appendTo(l),n=e("<div>").addClass(u).appendTo(l),a=e("<div>").addClass(h).css({height:"calc(100% - 10px)"}).appendTo(l),o=e("<div>").addClass(p).css({width:"calc(100% - 10px)"}).appendTo(l),i=e("<div>").addClass(c).appendTo(l),r.__registResizeEvent(t,"xy"),r.__registResizeEvent(n,"yt"),r.__registResizeEvent(a,"xr"),r.__registResizeEvent(o,"yb"),r.__registResizeEvent(i,"xl");else if("x"==r.options.resizAble)a=e("<div>").addClass(h).appendTo(l),i=e("<div>").addClass(c).appendTo(l),r.__registResizeEvent(a,"xr"),r.__registResizeEvent(i,"xl");else{if("y"!=r.options.resizAble)return;n=e("<div>").addClass(u).appendTo(l),o=e("<div>").addClass(p).appendTo(l),r.__registResizeEvent(n,"yt"),r.__registResizeEvent(o,"yb")}},__registResizeEvent:function(e,t){var i=this;e&&(e.bind("mousedown",{me:i,rEl:e,type:t},i._doResizeElMousedown),e.bind("mousemove",{me:i,rEl:e,type:t},i._doResizeElMousemove),e.bind("mouseup",{me:i,rEl:e,type:t},i._doResizeElMouseup),e.bind("mouseover",{me:i,rEl:e,type:t},i._doResizeElMouseover))},_doResizeElMousedown:function(t){var i,a,n,o,r=t.data.me,l=e(t.target),d=l.get(0),c=t.data.type,h=0;if(!r._resizeInfo){var u=r.comboCDiv.outerWidth();e.isVisiable(r.dropDownEl)&&(u=r.dropDownEl.externalWidth()),r._resizeInfo={initWidth:u,width:u,initHeight:r.dropDownEl.outerHeight(),height:r.dropDownEl.externalHeight()}}return r._resizeInfo.isMouseDown=!0,r._resizeInfo.leftWidth=t.pageX,r._resizeInfo.topHeight=t.pageY,d.setCapture?d.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP|Event.MOUSEDOWN),r.dropDownEl.find("*").css({"-moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","-khtml-user-select":"none","user-select":"none"}),r._resizeInfo&&r._resizeInfo._$moveEl&&(r._resizeInfo._$moveEl.remove(),r._resizeInfo._$moveEl=null),i=r.dropDownEl.offset(),a=r.dropDownEl.width()+h,n=r.dropDownEl.height()+h,o="xl"==c?{width:a,height:n,right:r.dropDownEl.css("right"),top:i.top,"z-index":r.dropDownEl.css("z-index")}:"yt"==c?{width:a,height:n,left:i.left,bottom:r.dropDownEl.css("bottom"),"z-index":r.dropDownEl.css("z-index")}:{width:a,height:n,left:i.left,top:i.top,"z-index":r.dropDownEl.css("z-index")},r._resizeInfo._$moveEl=e("<div>").addClass(s).css(o).appendTo("body"),!1},_doResizeElMousemove:function(t){var i,a,n,o,r,l,s,d,c,h,u,p,f,g,m=t.data.me,v=(e(t.target),t.data.type),w=2,_=5,C=0;if(m._resizeInfo&&m._resizeInfo.isMouseDown){if(a=m.dropDownEl.offset(),g=m._triggerHandler({offset:a,resizeInfo:m._resizeInfo,resizeType:v,event:t},I,m),0==g||"false"==g)return;p=e(document).innerHeight(),f=e(document).innerWidth(),C=a.left,i=a.top,h=m.comboCDiv.offset().top,u=p-m.comboCDiv.outerHeight()-h,c=h,u>c&&(c=u),c-=_,r=t.pageX,l=t.pageY,s=f-_,d=p-_,r>s&&(r=s),l>d&&(l=d),_>=l&&(l=_),_>=r&&(r=_),("xy"==v||"xr"==v||"xl"==v)&&(n="xl"==v?m._resizeInfo.width+C-r:r-C,m._resizeInfo.initWidth>n?m._resizeInfo._$moveEl.width(m._resizeInfo.initWidth-w):m._resizeInfo._$moveEl.width(n)),("xy"==v||"yt"==v||"yb"==v)&&(o="yt"==v?m._resizeInfo.height+i-l:l-i,c>0&&o>c&&(o=c),m._resizeInfo.initHeight>o?m._resizeInfo._$moveEl.height(m._resizeInfo.initHeight-w):m._resizeInfo._$moveEl.height(o))}return!1},_doResizeElMouseup:function(t){var i,a,n,o,r=t.data.me,l=e(t.target),s=t.data.type,d=l.get(0),c=8,h=5,u=2,p=-1,f=-1,g=0,m=0;return r._resizeInfo.isMouseDown=!1,d.releaseCapture?d.releaseCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP),r._resizeInfo&&r._resizeInfo._$moveEl&&(p=r._resizeInfo._$moveEl.outerWidth(),f=r._resizeInfo._$moveEl.outerHeight(),r._resizeInfo._$moveEl.remove(),r._resizeInfo._$moveEl=null),r.dropDownEl.find("*").css({"-moz-user-select":"","-webkit-user-select":"","-ms-user-select":"","-khtml-user-select":"","user-select":""}),0>p||0>f||(r._resizeInfo.initWidth>p&&(p=r._resizeInfo.initWidth),r._resizeInfo.initHeight>f&&(f=r._resizeInfo.initHeight,a="auto"),n=r._resizeInfo.width-p,o=r._resizeInfo.height-f,n>=-1&&1>=n&&o>=-1&&1>=o)?undefined:(r._resizeInfo.width=p,r._resizeInfo.height=f,"xl"==s?r.dropDownEl.css({left:"0px"}):"yt"==s&&r.dropDownEl.css({top:"0px"}),r.dropDownEl.externalWidth(r._resizeInfo.width),r.tree?(r.tree.resizeLayout(r._resizeInfo.width-c,r._resizeInfo.height-u),r.comBodyEl.css({"max-height":r._resizeInfo.height-u,width:r._resizeInfo.width-c,overflow:"hidden"})):(i=r._getListFloatBodyHeight(),"auto"==i?(g=3,r.comBodyEl.css({padding:"3px 0"})):(g=0,r.comBodyEl.css({padding:"0 0 3px 0"})),"auto"==a&&"auto"==i?(r.comBodyEl.css({"max-height":"none",width:r._resizeInfo.width-c,overflow:"hidden"}),r.list.setWH(r._resizeInfo.width-c,a)):(r.comBodyEl.css({"max-height":r._resizeInfo.height-u,width:r._resizeInfo.width-c,overflow:"hidden"}),r.options.all?(m=2,a=r._resizeInfo.height-h):(m=-1,a=r._resizeInfo.height-c),r.options.sViewBar&&(a-=m),a-=g,r.list.resizeLayout(r._resizeInfo.width-c,a))),r.dropDownEl.unbind("resize"),r._orientDropDown(),r._triggerHandler(r.renderEl,N,r),!1)},_doResizeElMouseover:function(t){t.data.me,e(t.target)},_orientDropDown:function(){var t,i,a,n=this;if(1==n.options.resizAble||"true"==n.options.resizAble||"xy"==n.options.resizAble||"x"==n.options.resizAble||"y"==n.options.resizAble){var o,r=e(document).innerHeight(),l=e(document).innerWidth(),s=n.comboCDiv.offset(),d=n.comboCDiv.outerHeight(!0),c=n.dropDownEl.outerWidth(!0),h=n.dropDownEl.outerHeight(!0);i=s.top+d,t=s.left,o=l-(c+s.left),0>=o&&(t+=o),h>=r-s.top-d&&s.top>=h&&(i=s.top-h),n.dropDownEl.css({left:t,top:i})}else a=e.getFloatOffset(n.comboCDiv,n.dropDownEl),n.dropDownEl.css({left:a.left,top:a.top})},_initResizeInfo:function(){var e,t=this;(1==t.options.resizAble||"true"==t.options.resizAble||"xy"==t.options.resizAble||"x"==t.options.resizAble||"y"==t.options.resizAble)&&(e=t.comboCDiv.outerWidth(!0),t._resizeInfo?(t._resizeInfo.initWidth=e,t._resizeInfo.leftWidth=0,t._resizeInfo.topHeight=0,t._resizeInfo.isMouseDown=!1,t._resizeInfo&&t._resizeInfo._$moveEl&&(t._resizeInfo._$moveEl.remove(),t._resizeInfo._$moveEl=null)):t._resizeInfo={initWidth:e,width:e,initHeight:t.dropDownEl.outerHeight(),height:t.dropDownEl.externalHeight()})}}),Sweet.form.ComboBox_v1=e.sweet.widgetFormCombobox_v1}(jQuery),function(e){e.widget("sweet.widgetList",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-list]:",options:{data:[],maxHeight:null,minHeight:null},_createSweetWidget:function(){var t=this.options,i=this.listEl=e("<div>");i.addClass(t.widgetClass).width(t.width).attr("id",t.id),e.isNotNull(t.maxHeight)?(i.css("max-height",t.maxHeight),e.isNotNull(t.minHeight)&&i.css("min-height",t.minHeight)):i.height(t.height),this._createListWidget()},_createListWidget:function(){var t,i="",a=this.options.data;e.each(a,function(a,n){t=e.htmlEscape(n.text)||"",i+="<div>"+t+"</div>"}),this.listEl.html(i)},_render:function(e){var t=this;return t._super(e)?(t.listEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_destroyWidget:function(){this.listEl&&this.listEl.remove()}}),Sweet.list=e.sweet.widgetList}(jQuery),function(e){var t="sweet-list-list-con",i="sweet-list-list-ul",a="list-select",n="sweet-list-lazyload",o="sweet-list-list-select-item",r="sweet-list-list-action",l="sweet-form-checkbox-unchecked",s="sweet-form-checkbox-checked",d="sweet-form-checkbox-checked-disabled",c="sweet-form-checkbox-unchecked-disabled",h="sweet-list-list-BK",u="close",p="edit",f="delete",g="sweet-list-list-",m="sweet-list-content-timer",v="sweet-list-list-disabled ",w="sweet-list-search-div",_="change",C="afterSetData",b="afterSetValue",E="checkboxClick",y="checkboxAllClick",x="nodeClick",T="search",D="beforeCheckboxClick",S="dblclick",k="edit",L="delete",N=Sweet.constants.HREFSCRIPT,I=Sweet.core.i18n.list,A=A||1e3,P=200;e.widget("sweet.widgetListList",e.sweet.widgetList,{eventNames:{change:"切换树节点事件",afterSetData:"调用完setData方法后事件",afterSetValue:"setValue执行后触发",checkboxClick:"复选框点击事件",checkboxAllClick:"全选复选框点击事件",nodeClick:"点击树列表节点",search:"查询事件",beforeCheckboxClick:"点击checkBox之前的事件(checkBox未选中的时候触发)",dblclick:"列表行双击事件",edit:"行图片编辑事件","delete":"行图片删除事件"},version:"1.0",sweetWidgetName:"[widget-list-list]",type:"list",options:{data:null,multi:!1,remote:!1,search:!1,tip:!1,store:null,disabled:!1,lazyLoad:!1,all:!1,tools:null,minRemains:0,maxRemains:Number.MAX_VALUE,limit:50,_pleaseSelect:!1,_pleaseSelectText:Sweet.core.i18n.combobox.pleaseSelect,isBackGround:!1},getData:function(){return JSON.parse(JSON.stringify(this.data))},setData:function(t,i){if(!e.isNull(t)){var a,n=this,o=n.options,r=t;if(e.isPlainObject(t)?(r=t.data,n._setTotalElCount(t.total),n.filterControlEl.show()):n.filterControlEl&&(n.filterControlEl.hide(),n._doLayout()),n.afterSetData=!1,a=o.data=e.objClone(r),n.isAppend=i,i?(n.data=n.data.concat(r),n.appendData=a,n._setData(!0)):(n.liEls={},n.dataObjs={},n.dataObjLength=0,n.page=0,n._isFilterSetValue||(n._reset(),n._recoverOldValue(),o.value=[]),n._removeAllNodeList(),n.data=a,n._setData()),n.lazyLoadEl){var l,s=e.isVisiable(n.lazyLoadEl);o.lazyLoad?n.lazyLoadEl.show():n.lazyLoadEl.hide(),o.limit>r.length?(n.lazyLoadEl.hide(),n._lazyLoadElHideFlag=!0):n._lazyLoadElHideFlag=!1,l=e.isVisiable(n.lazyLoadEl),l&&l!==s&&n._doLayout()}o.store||n._isFilterSetData||n._filterCache(),n._isFilterSetData=!1}},setDisabled:function(t){var i,n=this,o=n.liEls;n.options.disabled=t,t?(n.allAEl&&(n.allAEl.hasClass(l)?n.allAEl.removeClass(l).addClass(c):n.allAEl.hasClass(s)&&n.allAEl.removeClass(s).addClass(d)),n.listDiv.addClass(v),e.each(o,function(e,t){t.removeClass(a),i=t.children("a"),i&&(i.hasClass(l)?i.removeClass(l).addClass(c):i.hasClass(s)&&i.removeClass(s).addClass(d))})):(n.allAEl&&(n.allAEl.hasClass(c)?n.allAEl.removeClass(c).addClass(l):n.allAEl.hasClass(d)&&n.allAEl.removeClass(d).addClass(s)),n.listDiv.removeClass(v),e.each(o,function(e,t){t.addClass(a),i=t.children("a"),i&&(i.hasClass(c)?i.removeClass(c).addClass(l):i.hasClass(d)&&i.removeClass(d).addClass(s))}))},setRemote:function(e){this.options.remote=e},setLazyLoad:function(e){this.options.lazyLoad=e},setFilter:function(e){this._filter=e},filter:function(t){var i=this,a=i.options,n=a.store,o=a.remote;if(i._isFilterSetValue=!0,i._isFilterSetData=!0,i.oldSelectedData=e.objClone(i.selectedData),i.options.value=i._getValue(),i._info("filter value: "+t),n)if(o)i.page=0,n.load(i._getAllConditions(t));else{var r=RegExp(e.regExp.escape(t),"i");n.filter(t,r)}else i.setData(e.fuzzyFilter(i.filterData,t))},all:function(t){var i=this,a=i.options,n=i.liEls;a.multi&&(clearInterval(i._setValueAllId),i._setValueAllId=setInterval(function(){if(i.afterSetData){var a,o,r;clearInterval(i._setValueAllId),i.oldSelectedData=e.objClone(i.selectedData),i._reset(),e.each(n,function(n,r){a=r.children("a"),t?(o=i.dataObjs[r.data("value")],e.isNull(o)||e.isNull(o.value)||(a.removeClass(l).addClass(s),i.selectedliEls[o.value]=r,i.selectedData[o.value]=o,i.selectedDataLength++)):a.removeClass(s).addClass(l)}),r=i._getValue(),e.equals(i.oldSelectedData,i.selectedData)||i._triggerHandler(null,_,r)}},100))},isAll:function(){var e,t=this,i=t.options;return 0===t.selectedDataLength?!1:i.store?(e=i.store.getData()||[],e.length===t.selectedDataLength):(e=t.filterData||[],t.selectedDataLength===e.length)
},_setData:function(e){var t=this,i=t.options;Sweet.Task.Timeout.stop(t.timerListContent),t.dataIndex=0,t.timerListContent=i.id+"-"+m,Sweet.Task.Timeout.start({id:t.timerListContent,run:t._buildListContent,scope:t,args:e,interval:10})},_removeData:function(t){var i=this;return i.options.store?(i.options.store.removeData(t),undefined):(e.isNull(t)?i.data=[]:e.each(i.data,function(e,a){a&&a.value===t.value&&i.data.splice(e,1)}),undefined)},_removeAllNodeList:function(){var e=this;e.listUI&&e.listUI.empty()},_removeAllNode:function(){var e=this;e._removeAllNodeList(),e._removeData()},_removeNode:function(t){var i,a,n=this,o=n.liEls,r=n.selectedData;e.each(t,function(e,t){a=t.value+"",i=o[a],i.data("value")===a&&(i.remove(),delete r[a],n.selectedDataLength--),n._removeData(t)})},_addNode:function(t){if(!e.isNull(t)){var i,a=this,n=a.options,o=a.listUI;e.each(t,function(t,n){n&&!e.isUndefined(n.value)&&(i=a._addLiNode(n),i.appendTo(o),a.liEls[n.value]=i,a.dataObjs[n.value]=n,a.dataObjLength++)}),a.setDisabled(n.disabled)}},_addLiNode:function(t){var i,n,r,s,d=this,c=d.options,h=c.tools;return s=e.nullToString(t.text),i=e("<li>").addClass(o+" "+a).data("value",t.value).bind("click",{me:d,data:t},d._onNodeClick),c.multi&&(n=e('<a class="'+l+'">').appendTo(i)),r=e("<span>").text(s).appendTo(i),c.tip&&r.attr("title",t.text),h&&h.length>0&&e.each(h,function(t,a){"edit"===a?e('<span class="'+p+'">').appendTo(i):"delete"===a&&e('<span class="'+f+'">').appendTo(i)}),i},_onNodeClick:function(t){var i,n,o=t.data.me,l=e.objClone(t.data.data),s=e(this),d=o.options;d.multi||(n=o._getValue(),i=l.value,delete o.selectedData[n.value],o.selectedData[i]=l,o.selectedDataLength=1,o.selectedliEls[i]=s,n.value!==i&&(e.each(o.selectedliEls,function(e,t){t.removeClass(r).addClass(a)}),o._triggerHandler(t,_,l)),s.removeClass(a).addClass(r)),o._triggerHandler(t,x,l)},_getAllNodeData:function(){var t=this,i=t.options.store;return i?i.getData():e.objClone(this.data)},_getAllShowNodeData:function(){var t=this,i=[];return e.each(t.liEls,function(a,n){e.isVisiable(n)&&i.push(t.dataObjs[n.data("value")])}),i},_showNode:function(t){var i=this,a=i.liEls;t=t||[],e.each(t,function(e,t){var i=a[t.value];i&&i.show()})},_hideNode:function(t){var i=this,a=i.liEls;t=t||[],e.each(t,function(e,t){var i=a[t.value];i&&i.hide()})},_setValue:function(t){var i,a=this,n=a.options,o=a.liEls;t=t||[],t=e.isArray(t)?e.objClone(t):[e.objClone(t)],a._saveOldValue(),clearInterval(a._setValueIntervalId),a._setValueIntervalId=setInterval(function(){var d;if(a.afterSetData){if(clearInterval(a._setValueIntervalId),a.searchField&&!a._isFilterSetValue&&(i=a.searchField.getValue(),e.isNotNull(i.value)))return a.searchField.setValue({text:"",value:""}),a.selectedData={},a.selectedDataLength=0,a.filter(""),undefined;e.each(a.selectedliEls,function(e,t){var i=t.children("a");i&&i.length>0?i.removeClass(s).addClass(l):t.removeClass(r)}),a.oldSelectedData=e.objClone(a.selectedData),n.multi&&a._isFilterSetValue||a._reset(),a._isFilterSetValue=!1,e.each(t,function(t,i){if(!e.isNull(i)){var n,d=a.dataObjs[i.value],c=o[i.value];c&&(n=c.children("a"),n&&n.length>0?n.removeClass(l).addClass(s):c.addClass(r),a.selectedliEls[i.value]=c,a.selectedData[i.value]=d)}}),a._reCaculateDataLength(),a._setSelectedSpanElCount(),d=a._getValue(),e.equals(a.oldSelectedData,a.selectedData)||a._triggerHandler(null,_,d),a._triggerHandler(null,b,d),n.all&&n.multi&&(a.selectedDataLength===a.dataObjLength?a.allAEl.removeClass(l).addClass(s):a.allAEl.removeClass(s).addClass(l))}},100)},_reCaculateDataLength:function(){var t=this;t.selectedDataLength=0,e.each(t.selectedData,function(){t.selectedDataLength++})},_setFirstValue:function(){var e,t=this;return t.data&&t.data.length>0?(e=t.data[0],t.setValue(e),e):undefined},_setWidth:function(e){var t=this;t.listEl.externalWidth(e)},_setHeight:function(e){var t=this;t.listEl.externalHeight(e)},_setWH:function(e,t){var i=this;i.listEl.externalWidth(e).externalHeight(t)},_getWidth:function(){var e=this;return e.listEl.externalWidth()},_getHeight:function(){var e=this;return e.listEl.externalHeight()},_getValue:function(){var e,t=this,i=t.options;return i.multi&&i.lazyLoad?t.realSelectedData:(e=t._getSelectedData(),i.multi?e:0===e.length?{}:e[0])},_doLayout:function(){var t,i=this,a=i.options,n=i.listEl.width(),o=i.listEl.height(),r=0,l=0,s=i.filterControlEl&&e.isVisiable(i.filterControlEl)?i.filterControlEl.externalHeight():0,d=i.lazyLoadEl&&e.isVisiable(i.lazyLoadEl)?18:0,c=i.lazyLoadEl&&e.isVisiable(i.lazyLoadEl)?21:0;a.search&&(i.searchField.setWidth(n),r=i.searchFiedlDiv.outerHeight(!0)),a.all&&a.multi&&(l=i.allEl.outerHeight()+i.separateEl.outerHeight()),i.listDiv.externalWidth(n),e.isNull(a.maxHeight)?t=o-r:(t=a.maxHeight-r,i.listDiv.css("max-height",t)),i.listUI.externalWidth(n).css("max-height",t-l-d-s),i.listUI.css("margin-bottom",c),i.selectedUlEl&&i.selectedUlEl.externalWidth(n).css("max-height",t-l-s)},_saveOldValue:function(){var t=this;t.options.multi&&!t.options.lazyLoad&&(t.oldValue=e.objClone(t.options.value))},_recoverOldValue:function(){var t=this;t.options.multi&&!t.options.lazyLoad&&(t.options.value=e.objClone(t.oldValue))},_optionsValidate:function(){var e=this,t=e.options;return t.all&&t.lazyLoad?(e._error("Lazy loading can not select all!"),!1):!0},_createListWidget:function(){var a=this,n=a.options,o=n.id,r=e.objClone(n.data),l=a.listDiv=e("<div>");a._optionsValidate()&&(a.liEls={},a.afterSetData=!1,a.page=0,a.data=r||[],a.dataObjs={},a.dataObjLength=0,a.selectedliEls={},a.selectedData={},a.selectedDataLength=0,a.oldSelectedData={},a._saveOldValue(),n.search&&(a.searchFiedlDiv=e("<div>").attr("id",o+g+A+"search").appendTo(a.listEl).addClass(w),a.searchField=new Sweet.form.SearchField({width:n.width,emptyText:Sweet.core.i18n.tree.search}),a.searchField.addListener("click",function(e,t){n.remote&&(a.filter(t.value),a._triggerHandler(e,T,t))}),a.searchField.addListener("keyup",function(e,t){n.remote||Sweet.Task.Delay.start({id:o+"-list-delay",run:function(t){a.filter(t.value),a._triggerHandler(e,T,t)},args:t,delay:350})}),l.addClass(t)),n.isBackGround&&a.listEl.addClass(h),l.appendTo(a.listEl),n.all&&n.multi&&(a.allEl=a._addLiNode({value:"sweet-all",text:Sweet.core.i18n.combobox.checkAll}).appendTo(l),a.allAEl=a.allEl.find("a"),a.allEl.bind("click",{me:a},a._onAllClick),a.separateEl=e("<div>").addClass("sweet-form-combobox-partitionLine").appendTo(l)),a.listUI=e("<ul>").bind("click",function(e){a._click(e)}).bind("dblclick",function(e){a._dbClick(e)}).addClass(i).appendTo(l),a._createLazyLoadEl(),a._setData(),n.store?n.store.addListener({setData:a.setData,scope:this}):a._filterCache())},_createLazyLoadEl:function(){var t,a=this,o=a.options;o.lazyLoad&&e.isNotNull(o.store)&&(t="<ul><li><span>"+I.total+"</span><a href="+N+">0</a></li>"+"<li><span>"+I.selected+"</span><a href="+N+">0</a></li></ul>",a.filterControlEl=e('<div class="sweet-list-filtercontrol">').insertBefore(a.listUI).html(t),a.totalAEl=a.filterControlEl.find("a:eq(0)"),a.filterControlEl.find("li:eq(0)").bind("click",function(){a._onTotalSpanClick()}),a.selectedAEl=a.filterControlEl.find("a:eq(1)"),a.filterControlEl.find("li:eq(1)").bind("click",function(){a._onSelectedSpanClick()}),a.selectedUlEl=e('<ul class="'+i+'">').bind("click",function(t){var i,n,o=e(t.target);o.hasClass(u)&&(i=o.attr("value"),a._delFromOptionsValue(i),a.selectedData[i]&&(delete a.selectedData[i],a.selectedDataLength--),n=a.listUI.find("li[value="+i+"]"),n&&n.children("a").removeClass(s).addClass(l),o.parent().remove(),a._setSelectedSpanElCount())}).appendTo(a.listDiv).hide(),a.lazyLoadEl=e("<div>").text("...").bind("click",function(e){a._onLazyLoad(e)}).addClass(n).appendTo(a.listDiv))},_delFromOptionsValue:function(t){var i=this,a=i.options;if(t+="",a.value)if(e.isArray(a.value))e.each(a.value,function(i,n){if(!e.isUndefined(n)){var o=e.isNumber(n.value)?n.value+"":n.value;o===t&&a.value.splice(i,1)}});else{var n=e.isNumber(a.value.value)?a.value.value+"":a.value.value;n===t&&(a.value=null)}},_onTotalSpanClick:function(){var e=this;e.listUI.show(),e._lazyLoadElHideFlag||e.lazyLoadEl.show(),e.selectedUlEl.hide()},_onSelectedSpanClick:function(){var t,i=this,n="";i.realSelectedData&&0!==i.realSelectedData.length&&(i.listUI.hide(),i.lazyLoadEl.hide(),i.selectedUlEl.empty().show(),e.each(i.realSelectedData||[],function(i,r){t=e.htmlEscape(e.isUndefined(r.text)?r.value:r.text)||"",n+='<li class="'+o+" "+a+'"><span>'+t+'</span><span class="'+u+'" value="'+r.value+'"></span></li>'}),i.selectedUlEl.html(n))},_setTotalElCount:function(e){var t=this;t.totalAEl&&t.totalAEl.text(e)},_setSelectedSpanElCount:function(){var e=this,t=e._mergeData();e.selectedAEl&&e.selectedAEl.text(t.length)},_mergeData:function(){var t=this,i=t.options,a=i.value,n=t.selectedData,o=[];return a&&(e.isArray(a)||(a=[a]),e.each(a,function(t,i){e.isUndefined(n[i.value])&&o.push(i)})),o=o.concat(t._getSelectedData()),t.realSelectedData=i.value=o,o},_reset:function(){var e=this;e.selectedliEls={},e.selectedData={},e.selectedDataLength=0},_filterCache:function(){var t=this;t.filterData=e.objClone(t.data)},_onLazyLoad:function(){var e=this,t=e.options,i=t.store;t.disabled||(e.page++,e._isLazyLoadSetValue=!0,i.loadRecords(e._getAllConditions(e._filter),!0,null,!0))},_getAllConditions:function(t){var i,a=this,n=a.options,o=n.limit,r={start:a.page*o,limit:o};return n.search?(i=a.searchField.getValue(),i&&(r.filter=i.value)):e.isUndefined(t)||(r.filter=t),r},_onAllClick:function(t){var i,a,n,r=t.data.me,d=r.options,c=e(t.target);if(!d.disabled){if(c.parent("li").hasClass(o)&&(c=c.parent("li")),i=c.children("a"),i.hasClass(l))n=!0,i.removeClass(l).addClass(s);else{if(!i.hasClass(s))return;if(0!==d.minRemains)return;n=!1,i.removeClass(s).addClass(l)}r.all(n),r.oldValue=a=r._getSelectedData(),r._triggerHandler(t,y,{checked:n,data:a})}},_getLiValue:function(t){var i=this;return e.objClone(i.dataObjs[t.data("value")])||{}},_click:function(t){var i,a,n,r,d,c,i,h=this,u=h.options,g=e(t.target),m=g.parent();if(!u.disabled)return g.hasClass(p)?h._triggerHandler(t,k,h._getLiValue(m)):g.hasClass(f)?(i=h._triggerHandler(t,L,h._getLiValue(m)),(i||e.isUndefined(i))&&m.remove()):(u.tools&&u.tools.length>0?g.parent("li").hasClass(o)&&(g=g.parent("li"),g=g.children("a")):(g.parent("li").hasClass(o)&&(g=g.parent("li")),g=g.children("a")),m=g.parent()),g.hasClass(s)&&u.multi&&h.selectedDataLength===u.minRemains?(c=I.minRemains,Sweet.Msg.warn(c.replace("{0}",u.minRemains)),undefined):g.hasClass(l)&&u.multi&&h.selectedDataLength===u.maxRemains?(c=I.maxRemains,Sweet.Msg.warn(c.replace("{0}",u.maxRemains)),undefined):((g.hasClass(l)||g.hasClass(s))&&(a=g.hasClass(l)?!0:!1,d=h._getLiValue(m),n=d.value,d.checked=a,g.hasClass(l)&&(i=h._triggerHandler(t,D,d)),(i||e.isUndefined(i))&&(a?(g.removeClass(l).addClass(s),h.selectedData[n]=e.objClone(d),h.selectedDataLength++,h.selectedliEls[n]=m):(g.addClass(l).removeClass(s),h._delFromOptionsValue(n),delete h.selectedData[n],h.selectedDataLength--,delete h.selectedliEls[n]),h.oldValue=r=h._getSelectedData(),h._setSelectedSpanElCount(),h._triggerHandler(t,E,e.objClone(d)),h._triggerHandler(t,_,r)),u.all&&u.multi&&(h.selectedDataLength===h.dataObjLength?h.allAEl.removeClass(l).addClass(s):h.allAEl.removeClass(s).addClass(l))),undefined)},_dbClick:function(t){var i=this,a=e(t.target);i.options.disabled||a.hasClass(p)||a.hasClass(f)||(a.parent("li").hasClass(o)?(a=a.parent("li"),i._triggerHandler(t,S,i._getLiValue(a))):a.hasClass(o)&&i._triggerHandler(t,S,i._getLiValue(a)))},_getSelectedData:function(){var t=this,i=t.selectedData,a=[];return e.isNull(i)?a:(e.each(i,function(e,t){t&&(delete t.checked,a.push(t))}),a)},_buildListContent:function(t){var i,a,n,o,r,l=this,s=l.options;return o=e.date.getMilliseconds(),0===l.data.length||l.dataIndex>=l.data.length?(Sweet.Task.Timeout.stop(l.timerListContent,function(){var t=l.options.value;e.isArray(t)&&0===t.length&&(t=null),l.afterSetData=!0,e.isNotNull(t)?l._setValue(t):(l.isAppend||e.equals(l.oldSelectedData,l.selectedData)||l._triggerHandler(null,_,l._getValue()),l._isFilterSetValue=!1),l._isLazyLoadSetValue||l._triggerHandler(null,C,e.objClone(l.data)),l._isLazyLoadSetValue=!1}),undefined):(i=l.dataIndex,a=l.dataIndex+P,!s.multi&&s._pleaseSelect&&(l.data=[{value:s._pleaseSelectText,text:s._pleaseSelectText}].concat(l.data)),n=t?l.appendData.slice(i,a):l.data.slice(i,a),l._addNode(n),l.dataIndex=a,r=e.date.getMilliseconds(),l._info("_buildListContent() Time-consuming = "+(r-o)+"ms"),undefined)},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},_render:function(e){var t=this;return t._super(e)?(t.searchField&&t.searchField.render(t.searchFiedlDiv.attr("id")),!0):!1},_destroyWidget:function(){var e=this;e._removeAllNode(),Sweet.Task.Timeout.stop(e.timerListContent),clearInterval(e._setValueIntervalId),e._super()}}),Sweet.list.List=e.sweet.widgetListList}(jQuery),function(e,t){var i="sweet-list-optimizelist-body",a="sweet-form-body-resizeEl",n="sweet-form-body-resizeXYEl",o="sweet-form-body-resizeXlEl",r="sweet-form-body-resizeXrEl",l="sweet-form-body-resizeYtEl",s="sweet-form-body-resizeYbEl",d="sweet-list-optimizelist-body-border",c="sweet-list-optimizelist-viewbar-body",h="sweet-list-optimizelist-ul",u="sweet-list-optimizelist-scorll",p="list-select",f="sweet-list-optimizelist-select-all",g="sweet-list-optimizelist-select-item",m="sweet-list-optimizelist-action",v="sweet-form-checkbox-unchecked",w="sweet-form-checkbox-checked",_="sweet-list-optimizelist-",C="sweet-list-optimizelist-disabled",b="sweet-list-optimizelist-search",E="sweet-form-checkbox-checked-disabled",y="sweet-form-checkbox-unchecked-disabled",x="close",T="edit",D="delete",S="change",k="afterSetData",L="afterSetValue",N="checkboxClick",I="checkboxAllClick",A="checkchange",P="beforecheckchange",M="nodeClick",F="beforeCheckboxClick",W="dblclick",B="edit",O="delete",R="beforesearch",H="search",j="resizeLayout",z="resizeElMove",V=Sweet.core.i18n.list,U=Sweet.constants.HREFSCRIPT,G=G||1e3;e.widget("sweet.widgetListList",e.sweet.widgetList,{version:"1.0",sweetWidgetName:"[widget-list-OptimizeList]",type:"list",eventNames:{change:"值改变时事件",afterSetData:"调用完setData方法后事件",afterSetValue:"setValue执行后触发",checkboxClick:"复选框状态改变时事件",checkboxAllClick:"全选复选框点击事件",checkchange:"节点状态改变时事件",beforecheckchange:"节点状态改变前事件",nodeClick:"点击树列表节点",beforesearch:"查询前事件",search:"查询事件",beforeCheckboxClick:"点击checkBox之前的事件(checkBox状态改变前的时候触发)",dblclick:"列表行双击事件",edit:"行图片编辑事件","delete":"行图片删除事件",resizeLayout:"缩放刷新后事件",resizeElMove:"虚线框缩放事件"},options:{data:null,multi:!1,search:!1,tip:!1,disabled:!1,all:!1,minRemains:0,maxRemains:Number.MAX_VALUE,tools:null,sViewBar:!1,isBorder:!1,resizAble:!1,queryDelay:350},_createListWidget:function(){var t=this,a=350,n=t.options.id,o=t.listDiv=e("<div>"),r=t.listBodyDiv=e("<div>");t.data=t.options.data||[],t.opDatas=t.options.data||[],t.options.data=null,t.dataLength=t.data.length,t.valueObjs={},t.liHeight=22,t.editItemWidth=30,t.searchFieldHeight=25,t.renderSize=10,t.selectedData={},t.selectedDataLength=0,t.limitCount=300,t.isFirstDelLimitCount=!1,t.isFirstSLimitCount=!1,t.tempRenderTop=-100,t.options.search&&(a=parseInt(t.options.queryDelay),isNaN(a)&&(a=350),0>a&&(a=0),t.searchFiedlDiv=e("<div>").attr("id",n+_+G+"search").appendTo(t.listEl).addClass(b),t.searchField=new Sweet.form.SearchField({width:t.options.width,emptyText:Sweet.core.i18n.tree.search}),t.searchField.addListener("keyup",function(e,i){Sweet.Task.Delay.start({id:t.options.id+"-optmizeList-filter-delay1",run:function(e){t.filter(e)},args:i.value,delay:a})}),t.searchField.addListener("click",function(e,i){Sweet.Task.Delay.start({id:t.options.id+"-optmizeList-filter-delay2",run:function(e){t.filter(e)},args:i.value,delay:a})}),o.addClass(i)),t.options.isBorder&&o.addClass(d),o.appendTo(t.listEl),t.options.sViewBar&&t._createSViewBar(),t.options.all&&t.options.multi&&(t.allEl=t._addAllLiNode({value:"sweet-all",text:Sweet.core.i18n.combobox.checkAll}).appendTo(o),t.allEl.bind("click",{me:t,data:{value:"sweet-all",text:Sweet.core.i18n.combobox.checkAll}},t._onAllClick),t.allAEl=t.allEl.find("a"),t.separateEl=e("<div>").addClass("sweet-form-combobox-partitionLine").appendTo(o)),r.addClass(u),t.listUI=e("<ul>").addClass(h).appendTo(r),r.appendTo(o),t.options.resizAble&&t.__doCreateResizeEl(),t.opDatas.length>t.limitCount&&t._doScrollEvent()},setData:function(t,i,a){var n=this,o=n.options.value;if(!n.options.disabled){e.isNull(t)&&(t=[]),n.isAppend=i,a=parseInt(a),isNaN(a)&&(a=null),n._total=a,n._reset(),o=o||[],e.isArray(o)||(o=[o]),n.selectedDataLength=o.length;for(var r=0;n.selectedDataLength>r;r++)n.selectedData[o[r].value]=o[r];n._removeAllNodeList(),i?(n.data=n.data.concat(t),n.opDatas=e.objClone(n.data),n.dataLength=n.data.length):(n.data=t,n.opDatas=t,n.dataLength=t.length),n.searchField&&n.searchField.setValue({value:"",text:""}),n._setData(n.opDatas),n.selectedDataLength>0?n.setValue(o):n.options.all&&n.options.multi&&n.allAEl.removeClass(w).addClass(v),n.options.sViewBar&&(n._total&&n._total>0?n._setTotalElCount(n._total):n._setTotalElCount(n.dataLength),n._setSelectedSpanElCount(n.selectedDataLength)),n._triggerHandler(null,k,e.objClone(n.data))}},getData:function(){return e.objClone(this.data)},setValue:function(i,a){var n,o,r,l,s,d,c=this;if(!c.options.disabled){if(i=i||[],e.isArray(i)||(i=[e.objClone(i)]),n=i.length,!c.options.multi&&n>1&&(i=[i[0]],n=1),a)for(var h=0;i.length>h;h++)for(var u=0;c.data.length>u;u++)c.data[u].value==i[h].value&&e.extend(i[h],c.data[u]);if(c.options.multi&&c.options.minRemains>n)return s=Sweet.core.i18n.list.minRemains,Sweet.Msg.warn(s.replace("{0}",c.options.minRemains)),t;if(c.options.multi&&n>c.options.maxRemains)return s=Sweet.core.i18n.list.maxRemains,Sweet.Msg.warn(s.replace("{0}",c.options.maxRemains)),t;c._reset(),c.selectedDataLength=n;for(var h=0;c.selectedDataLength>h;h++)c.selectedData[i[h].value]=i[h];c.options.all&&c.options.multi&&(d=c.dataLength,c._total&&c._total>0&&(d=c._total),c.dataLength>0&&c.selectedDataLength>=d?c.allAEl.removeClass(v).addClass(w):c.allAEl.removeClass(w).addClass(v)),c.options.sViewBar&&c._setSelectedSpanElCount(c.selectedDataLength),o=c.listUI.find("li"),c.options.multi?e.each(o,function(t,i){l=c.selectedData[e(i).data("value")]?!0:!1,r=e(i).children("a"),r&&r.length>0&&(l?r.removeClass(v).addClass(w):r.removeClass(w).addClass(v))}):e.each(o,function(t,i){l=c.selectedData[e(i).data("value")]?!0:!1,e(i).removeClass(m),l&&e(i).addClass(m)}),c.listBodyDiv&&c.listBodyDiv.triggerHandler("scroll"),c._triggerHandler(null,S,c._getValue()),c._triggerHandler(null,L,c._getValue())}},filter:function(t){var i,a,n,o,r=this,l=[];if(r._info("filter value: "+t),n={filter:t},a=r._triggerHandler(n,R,r),!1!==a&&"false"!==a){if(r.searchField&&r.searchField.setDisabled(!0),t=n.filter,e.isNotNull(t)){i=RegExp(e.regExp.escape(t),"i");for(var s=0;r.data.length>s;s++)i.test(r.data[s].text)&&l.push(r.data[s]);r.opDatas=l}else r.opDatas=r.data;r.options.all&&r.options.multi&&(o=r.dataLength,r._total&&r._total>0&&(o=r._total),r.dataLength>0&&r.selectedDataLength>=o?r.allAEl.removeClass(v).addClass(w):r.allAEl.removeClass(w).addClass(v)),r._triggerHandler(r.opDatas,H,r),r._setData(r.opDatas),r.searchField&&r.searchField.setDisabled(!1)}},getCurrentData:function(){return e.objClone(this.opDatas)},getCurrentValue:function(){var e=this,t=[],i=e._getValue(),a=e.opDatas,n={};if(!i||0>=i.length)return t;if(!a||0>=a.length)return t;for(var o=0;a.length>o;o++)n[a[o].value]=a[o];for(var o=0;i.length>o;o++)n[i[o].value]&&t.push(i[o]);return n=null,t},_setWidth:function(e){var t=this;!e||0>e||(t.width=e,t.listEl.externalWidth(e))},_setHeight:function(e){var t=this;!e||0>e||(t.height=e,t.listEl.externalHeight(e))},_setWH:function(e,t){var i=this;i.width=e,i.height=t,i.listEl.externalWidth(e).externalHeight(t)},_getWidth:function(){var e=this;return e.listEl.externalWidth()},_getHeight:function(){var e=this;return e.listEl.externalHeight()},resizeLayout:function(e,t){var i=this,a=i.listBodyDiv[0],n=a.scrollTop,o=a.scrollLeft,r=0,l=0,s=!1;i.options.sViewBar&&i.sListBodyDiv&&i.sListBodyDiv.length>0&&(s=!0,r=i.sListBodyDiv[0].scrollTop,l=i.sListBodyDiv[0].scrollLeft),i.setWH(e,t),a.scrollTop=n,a.scrollLeft=o,s&&(i.sListBodyDiv[0].scrollTop=r,i.sListBodyDiv[0].scrollLeft=l),i._triggerHandler(i.renderEl,j,i)},_setData:function(){var e=this,t=e.listUI,i=e.listBodyDiv;i[0].scrollTop=0,t.find("li").remove(),e.isFirstDelLimitCount=!1,e._doLayout()},_addAllLiNode:function(i){var a,n,o,r,l,s=this,d=s.listUI;return r=e.nullToString(i.text),a=e("<li>").addClass(g+" "+p+" "+f),n=e("<a>").addClass(v).appendTo(a),o=e("<span>").text(r).appendTo(a),s.options.tip&&(l=i.qtip,(t===l||null===l)&&(l=i.text),o.attr("title",l)),a.appendTo(d),a},_doScrollEvent:function(){var t=this,i=0,a=0,n=0,o=0,r=t.listBodyDiv,l=[],s=!1,d=0;r.unbind("scroll"),r.scroll(function(r){return a==e(this)[0].scrollTop?!1:(s=!1,n=e(this)[0].clientHeight,i=e(this)[0].scrollHeight,a=e(this)[0].scrollTop,o=Math.floor(a/t.liHeight),l=t.opDatas.slice(o,o+t.renderSize),a>0&&a+n>=i?(s=!0,d=t.opDatas.length-t.renderSize,0>d&&(d=0,a=0),l=t.opDatas.slice(d)):(s=!1,(0>=a||0>o)&&(o=0,a=0,l=t.opDatas.slice(o,o+t.renderSize))),t._doScrollLoad(l,a,s),r.stopImmediatePropagation(),!1)})},_doScrollLoad:function(i,a,n,o){var r,l,s,d=this,c=d.listUI,h=20,u=0,p=d.tempRenderTop,f=0,g=0;if(o){d.listBodyDiv.unbind("scroll"),u=d.listBodyDiv.get(0).scrollLeft,c.find("li").remove();for(var m=0;i.length>m;m++)l=d._addLiNode(i[m],m*d.liHeight);return f=d._getLiMaxWidth(c),d.listBodyDiv[0].clientWidth>=f?(d.options.tools&&d.options.tools.length>0&&(g=d.options.tools.length*d.editItemWidth-Math.abs(d.listBodyDiv[0].clientWidth-f)),0>g&&(g=0),f=d.listBodyDiv[0].clientWidth-h):d.options.tools&&d.options.tools.length>0&&(g=d.options.tools.length*d.editItemWidth),f+=g,r=c.find("li"),e.each(r,function(t,i){e(i).width(f).css({top:"",position:"relative"})}),d.listBodyDiv.get(0).scrollLeft=u,t}for(var m=0;i.length>m;m++)l=d._addLiNode(i[m],p),l.get(0).scrollWidth>=f&&(f=l.get(0).scrollWidth-h),l.remove();n&&(d.listBodyDiv[0].scrollTop=c.height()-d.listBodyDiv[0].clientHeight),a>0&&(s=d.listBodyDiv[0].clientHeight+a,a=s-i.length*d.liHeight),r=c.find("li");for(var m=0;i.length>m;m++)d._renderLiNode(i[m],a+m*d.liHeight,r[m]);d.options.tools&&d.options.tools.length>0&&(g=d.options.tools.length*d.editItemWidth-Math.abs(d.listBodyDiv[0].clientWidth-f)),r=c.find("li"),d.listBodyDiv[0].clientWidth>=f?(d.options.tools&&d.options.tools.length>0&&(g=d.options.tools.length*d.editItemWidth-Math.abs(d.listBodyDiv[0].clientWidth-f)),0>g&&(g=0),f=d.listBodyDiv[0].clientWidth-h):d.options.tools&&d.options.tools.length>0&&(g=d.options.tools.length*d.editItemWidth),f+=g,e.each(r,function(t,i){e(i).width(f)})},_renderLiNode:function(i,a,n){var o,r,l,s,d,c,h=this,u=h.options.disabled;return n?(r=e(n),r.css("top",a).data("value",i.value),r.unbind("click"),r.unbind("dblclick"),r.bind("click",{me:h,data:i},h._onNodeClick).bind("dblclick",{me:h,data:i},h._dbClick),h.options.multi?(l=r.find("a"),l.addClass(v),l.removeClass(w),h.selectedData[i.value]&&l.removeClass(v).addClass(w)):(o=h._getValue(),r.removeClass(m),i.value==o.value&&r.addClass(m)),d=e.nullToString(i.text),s=r.find("span"),s=e(s[0]),s.text(d),h.options.tip&&(c=i.qtip,(t===c||null===c)&&(c=i.text),s.attr("title",c)),u&&h.setDisabled(u),r):(h._addLiNode(i,a,0),t)},_addLiNode:function(i,a,n){var o,r,l,s,d,c,h=this,u=h.options.tools,f=h.listUI,_=20,C=h.options.disabled;return r=e("<li>").addClass(g+" "+p).css("top",a).data("value",i.value).bind("click",{me:h,data:i},h._onNodeClick).bind("dblclick",{me:h,data:i},h._dbClick),n&&n>0&&(h.listBodyDiv[0].clientWidth>=n&&(n=h.listBodyDiv[0].clientWidth-_),u&&u.length>0&&(n+=h.editItemWidth*u.length),r.width(n)),h.options.multi?(l=e("<a>").addClass(v).appendTo(r),h.selectedData[i.value]&&l.removeClass(v).addClass(w)):(o=h._getValue(),i.value==o.value?r.addClass(m):r.addClass(p)),d=e.nullToString(i.text),s=e("<span>").text(d).appendTo(r),h.options.tip&&(c=i.qtip,(t===c||null===c)&&(c=i.text),s.attr("title",c)),u&&u.length>0&&e.each(u,function(t,i){"edit"===i?e('<span class="'+T+'">').appendTo(r):"delete"===i&&e('<span class="'+D+'">').appendTo(r)}),r.appendTo(f),C&&h.setDisabled(C),r},_doLayout:function(){var t,i,a,n,o,r,l=this,s=l.listEl.width(),d=l.listEl.height(),c=0,h=8,u=0,p=0,f=5,g=1,m=7,v=3,w=l.liHeight,_=0,C=0;l.options.search&&(l.searchField.setWidth(s),c=l.searchFiedlDiv.outerHeight(!0),c+=f),l.options.sViewBar&&(p=l.viewBarEl.outerHeight()+v),l.options.all&&l.options.multi&&(u=l.allEl.outerHeight()+l.separateEl.outerHeight()),l.listDiv.externalWidth(s),r=l.listDiv.innerWidth(),e.isNull(l.options.height)||(d=l.options.height),"100%"!=d&&"auto"!=d?(l.options.isBorder&&(d-=2*g),t=d-c-u-p,0>t&&(t=0),l.renderSize=Math.ceil(t/w)):(t="auto",(1==l.options.resizAble||"true"==l.options.resizAble||"xy"==l.options.resizAble||"x"==l.options.resizAble||"y"==l.options.resizAble)&&(l.options.height="auto",_=2*g,C=2*g),l.renderSize=l.opDatas.length),l.listUI.height(l.opDatas.length*w),0>=l.renderSize&&(l.renderSize=1),l.listBodyDiv.externalWidth(r).css({height:t,margin:"3px 0px"}),l.listBodyDiv[0].scrollTop=0,a=l.opDatas.slice(0,l.renderSize),l.opDatas.length<=l.limitCount?(l.isFirstDelLimitCount=!0,a=l.opDatas):(l.isFirstDelLimitCount=!1,l._doScrollEvent()),l._createListNode(a,0,!1,l.isFirstDelLimitCount),"auto"==t&&(d=l.listEl.outerHeight(),0>=d&&(d=l.listBodyDiv.outerHeight()),t=d-c-u-p,l.listBodyDiv.css({height:t}),l.listEl.externalHeight(d)),l.options.sViewBar&&(i=d-p-m,0>i&&(i=0),l.options.isBorder&&(h-=2*g),l.sListBodyDiv.externalWidth(r).css("height",i+h),l.sListUI.height(l.selectedDataLength*w),l.sRenderSize=Math.ceil(i/w),0>=l.sRenderSize&&(l.sRenderSize=1),"block"==l.sListBodyDiv.css("display")&&(l.sListBodyDiv[0].scrollTop=0,n=l._getSelectedData(),n.length>l.limitCount?(l._doSScrollEvent(),l.isFirstSLimitCount=!1,o=n.slice(0,0+l.sRenderSize)):(l.isFirstSLimitCount=!0,o=n),l.sListUI.find("li").remove(),l._doSScrollLoad(o,0,!1,l.isFirstSLimitCount))),(1==l.options.resizAble||"true"==l.options.resizAble||"xy"==l.options.resizAble||"x"==l.options.resizAble||"y"==l.options.resizAble)&&(_+=l.listDiv.outerHeight(),C+=l.listDiv.outerWidth(!0),l._resizeInfo&&l._resizeLayout?(l._resizeInfo.leftWidth=0,l._resizeInfo.topHeight=0,l._resizeInfo.isMouseDown=!1,l._resizeInfo&&l._resizeInfo._$moveEl&&(l._resizeInfo._$moveEl.remove(),l._resizeInfo._$moveEl=null)):l._resizeInfo={initWidth:C,width:C,initHeight:_,height:_},l._resizeLayout=!1)},_createListNode:function(t,i,a,n){var o=this;e.isNull(t)||(o.listUI.find("li").remove(),o._doScrollLoad(t,i,a,n))},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},all:function(t,i){var a,n,o=this,r=[],l=!1;o.options.multi&&(r=o.listUI.find("li"),e.each(r,function(i,n){a=e(n).children("a"),t?a.removeClass(v).addClass(w):a.removeClass(w).addClass(v)}),t?e.each(o.opDatas,function(e,t){o.selectedData[t.value]||(o.selectedData[t.value]=t,o.selectedDataLength++,l=!0)}):e.each(o.opDatas,function(e,t){o.selectedData[t.value]&&(delete o.selectedData[t.value],o.selectedDataLength--,l=!0)}),o.options.all&&o.options.multi&&(t?o.allAEl.removeClass(v).addClass(w):o.allAEl.removeClass(w).addClass(v)),o.options.sViewBar&&o._setSelectedSpanElCount(o.selectedDataLength),n=o._getValue(),l&&o._triggerHandler(i,S,n))},isAll:function(){var e=this;return 0>=e.dataLength?!1:e._total&&e._total>0?e.selectedDataLength>=e._total?!0:!1:e.selectedDataLength>0&&e.selectedDataLength>=e.dataLength?!0:!1},setDisabled:function(t){var i,a=this,n=a.listUI.find("li");a.options.disabled=t,t?a.listDiv.addClass(C):a.listDiv.removeClass(C),a.searchField&&a.searchField.setDisabled(t),t?(a.allAEl&&(a.allAEl.hasClass(v)?a.allAEl.removeClass(v).addClass(y):a.allAEl.hasClass(w)&&a.allAEl.removeClass(w).addClass(E)),a.listDiv.addClass(C),e.each(n,function(t,a){e(a).removeClass(p),i=e(a).children("a"),i&&(i.hasClass(v)?i.removeClass(v).addClass(y):i.hasClass(w)&&i.removeClass(w).addClass(E))})):(a.allAEl&&(a.allAEl.hasClass(y)?a.allAEl.removeClass(y).addClass(v):a.allAEl.hasClass(E)&&a.allAEl.removeClass(E).addClass(w)),a.listDiv.removeClass(C),e.each(n,function(t,a){e(a).addClass(p),i=e(a).children("a"),i&&(i.hasClass(y)?i.removeClass(y).addClass(v):i.hasClass(E)&&i.removeClass(E).addClass(w))}))},_getValue:function(){var e=this;return e.options.multi?e._getSelectedData():0>=e._getSelectedData().length?{}:e._getSelectedData()[0]},_getSelectedData:function(){var t,i=this,a=[];if(e.isNull(i.selectedData))return a;for(var n in i.selectedData)t=i.selectedData[n],t&&(delete t.checked,a.push(t));return a},_onAllClick:function(i){var a,n,o,r=i.data.me,l=e(i.target);if(!r.options.disabled){if(l.hasClass(f)?l=l.find("a"):(l=l.parent("li"),l=l.children("a")),l.hasClass(v)){if(n=r.selectedDataLength,e.each(r.opDatas,function(e,t){r.selectedData[t.value]||n++}),r.options.multi&&n>r.options.maxRemains)return o=Sweet.core.i18n.list.maxRemains,Sweet.Msg.warn(o.replace("{0}",r.options.maxRemains)),t;a=!0,l.removeClass(v).addClass(w)}else{if(!l.hasClass(w))return;if(r.options.multi&&r.options.minRemains>0)return o=Sweet.core.i18n.list.minRemains,Sweet.Msg.warn(o.replace("{0}",r.options.minRemains)),t;a=!1,l.removeClass(w).addClass(v)}r.all(a,i),r._triggerHandler(i,I,{value:"sweet-all",text:Sweet.core.i18n.combobox.checkAll,checked:a,data:r._getSelectedData()}),r._triggerHandler({node:{value:"sweet-all",text:Sweet.core.i18n.combobox.checkAll,checked:a},checked:a},A,r)}},_dbClick:function(t){var i=t.data.me,a=e(t.target),n=e.objClone(t.data.data);i.options.disabled||a.hasClass(T)||a.hasClass(D)||(a.parent("li").hasClass(g)?(a=a.parent("li"),i._triggerHandler(t,W,n)):a.hasClass(g)&&i._triggerHandler(t,W,n))},_onNodeClick:function(i){var a,n,o,r,l,s,d,c,h,u,p,f,_,C,b,E,y,x,k,L,I=i.data.me,W=e(i.target),R=e.objClone(i.data.data),H=I.listBodyDiv,j=!1,z=!1,V=!1,U=0,G=0,Y=0,q=0,$=0;if(!I.options.disabled){if(W.hasClass(T))return I._triggerHandler(i,B,R),t;if(W.hasClass(D)){if(n=I._triggerHandler(i,O,R),n||e.isUndefined(n)){if(c=R.value,I.selectedData[c]&&(V=!0,delete I.selectedData[c],I.selectedDataLength--),I.opDatas=I._deleteItemByValue(c,I.opDatas),I.data=I._deleteItemByValue(c,I.data),I.dataLength=I.data.length,I.listUI.height(I.listUI.height()-I.liHeight),I.opDatas.length>I.limitCount){a=I.listUI.find("li");for(var K=0;a.length>K;K++)e(a[K]).css({top:parseInt(e(a[K]).css("top"))-22+"px"});h=H.get(0).clientHeight,u=H.get(0).scrollHeight,p=H.get(0).scrollTop,f=Math.floor(p/I.liHeight),_=I.opDatas.slice(f,f+I.renderSize),p>0&&p+h>=u?(j=!0,b=I.opDatas.length-I.renderSize,0>b&&(b=0,p=0),_=I.opDatas.slice(b)):(j=!1,(0>=p||0>f)&&(f=0,p=0,_=I.opDatas.slice(f,f+I.renderSize))),I._doScrollLoad(_,p,j,z)}else if(I.isFirstDelLimitCount){C=W.parent("li"),C.is("li")||(C=e(this)),q=H[0].scrollLeft,$=H[0].scrollTop,C.remove(),Y=0,U=0,y=I.listUI.find("li").width("");for(var K=0;y.length>K;K++)x=y[K],x.scrollWidth>U&&(U=x.scrollWidth),E=e(x).find("span:eq(0)"),E.width()>Y&&(Y=E.width());Y>=U?(G=I.options.tools?I.options.tools.length*I.editItemWidth:0,U=Y):(G=I.options.tools?I.options.tools.length*I.editItemWidth-Math.abs(U-Y):0,0>G&&(G=0),U-=20),U+=G,I.listUI.height(I.listUI.height()-I.liHeight),y.width(U),H[0].scrollLeft=q,H[0].scrollTop=$}else _=I.opDatas,z=!0,p=0,I._doScrollLoad(_,p,j,z),I.isFirstDelLimitCount=!0;return I.options.all&&I.options.multi&&(I.dataLength>0&&I.selectedDataLength>=I.dataLength?I.allAEl.removeClass(v).addClass(w):I.allAEl.removeClass(w).addClass(v)),I.options.sViewBar&&(I._total&&I._total>0?(I._total--,I._setTotalElCount(I._total),I.options.all&&I.options.multi&&(I.dataLength>0&&I.selectedDataLength>=I._total?I.allAEl.removeClass(v).addClass(w):I.allAEl.removeClass(w).addClass(v))):I._setTotalElCount(I.dataLength),I._setSelectedSpanElCount(I.selectedDataLength)),V&&I._triggerHandler(i,S,I._getSelectedData()),t
}}else I.options.multi?W.hasClass(g)?W=W.children("a"):(W=W.parent("li"),W=W.children("a")):W.hasClass(g)||(W=W.parent("li"));if(I.options.multi){if(W.hasClass(w)){if(I.options.multi&&I.options.minRemains>0&&I.selectedDataLength<=I.options.minRemains)return d=Sweet.core.i18n.list.minRemains,Sweet.Msg.warn(d.replace("{0}",I.options.minRemains)),t}else if(I.options.multi&&I.selectedDataLength>=I.options.maxRemains)return d=Sweet.core.i18n.list.maxRemains,Sweet.Msg.warn(d.replace("{0}",I.options.maxRemains)),t;if(W.hasClass(v)||W.hasClass(w)){if(o=W.hasClass(v)?!0:!1,r=R.value,W.hasClass(v)&&(n=I._triggerHandler(i,F,R)),s=e.objClone(R),s.checked=!W.hasClass(v),k=I._triggerHandler({node:s,checked:o},P,I),!1===k||"false"===k)return;(n||e.isUndefined(n))&&(o?(W.removeClass(v).addClass(w),I.selectedData[r]||(I.selectedData[r]=e.objClone(R),I.selectedDataLength++)):(W.addClass(v).removeClass(w),I.selectedData[r]&&(delete I.selectedData[r],I.selectedDataLength--)),s=e.objClone(R),s.checked=o,I._triggerHandler(i,N,s),I._triggerHandler({node:s,checked:o},A,I),I._triggerHandler(i,S,I._getSelectedData())),I.options.all&&I.options.multi&&(L=I.dataLength,I._total&&I._total>0&&(L=I._total),I.selectedDataLength>=L?I.allAEl.removeClass(v).addClass(w):I.allAEl.removeClass(w).addClass(v))}}else l=I._getValue(),r=R.value,I.selectedData={},I.selectedData[r]=R,I.selectedDataLength=1,a=I.listUI.find("li"),l.value!==r&&(e.each(a,function(t,i){e(i).removeClass(m)}),I._triggerHandler(i,S,R)),W.addClass(m),I._triggerHandler(i,M,R);I.options.sViewBar&&I._setSelectedSpanElCount(I.selectedDataLength)}},_removeAllNodeList:function(){var e=this;e.listUI&&e.listUI.empty()},_reset:function(){var e=this;e.selectedData={},e.selectedDataLength=0,e.options.sViewBar&&e._setSelectedSpanElCount(e.selectedDataLength)},_render:function(e){var t=this;return t._super(e)?(t.searchField&&t.searchField.render(t.searchFiedlDiv.attr("id")),t.setValue(t.options.value),t._setData(t.opDatas),t.options.sViewBar&&(t._setTotalElCount(t.dataLength),t._setSelectedSpanElCount(t.selectedDataLength)),t.setDisabled(t.options.disabled),t.rendered=!0,!0):!1},_deleteItemByValue:function(t,i){var a,n,o,r,l=[];if(e.isNull(i))return[];n=a=i.length;for(var s=0;a>s;s++)if(t==i[s].value){n=s;break}return o=i.slice(0,n),r=i.slice(n+1),l=o.concat(r)},_createSViewBar:function(){var i,a,n,o,r,l,s=this,d=0,p=0,f=0,g=0,_=[],C=[],b=!1,E=0,y=s.listDiv,T=0,D=20,k=40,L=0,N=0,I=0,A=0;n="<ul><li><span>"+V.total+"</span><a href="+U+">0</a></li>"+"<li><span>"+V.selected+"</span><a href="+U+">0</a></li></ul>",s.viewBarEl=e("<div>").addClass(c).html(n).appendTo(y),s.totalAEl=s.viewBarEl.find("a:eq(0)"),s.totalAEl.bind("click",function(){s._onTotalSpanClick()}),s.selectedAEl=s.viewBarEl.find("a:eq(1)"),s.selectedAEl.bind("click",function(){s._onSelectedSpanClick()}),s.sListBodyDiv=e("<div>").addClass(u),s.sListUI=e("<ul>").addClass(h).bind("click",function(n){if(!s.options.disabled&&(T=0,i=e(n.target),i.hasClass(x))){if(a=i.data("value"),n.data={data:{value:a}},!s.selectedData[a])return;if(T=0,L=0,N=0,delete s.selectedData[a],s.selectedDataLength--,e.each(s.listUI.find("li"),function(t,i){e(i).data("value")==a&&(s.options.multi?e(i).children("a").removeClass(w).addClass(v):e(i).removeClass(m))}),s.allAEl&&s.allAEl.removeClass(w).addClass(v),s._setSelectedSpanElCount(s.selectedDataLength),s.isFirstSLimitCount){I=s.sListBodyDiv[0].scrollLeft,A=s.sListBodyDiv[0].scrollTop,i.parent("li").remove(),o=e(this).find("li").width("");for(var c=0;o.length>c;c++)r=o[c],r.scrollWidth>T&&(T=r.scrollWidth),l=e(r).find("span:eq(0)"),l.width()>N&&(N=l.width());return N>=T?(L=k,T=N):(L=k-Math.abs(T-N),0>L&&(L=0),T-=D),T+=L,e(this).height(e(this).height()-s.liHeight),o.width(T),s.sListBodyDiv[0].scrollLeft=I,s.sListBodyDiv[0].scrollTop=A,s._triggerHandler(n,S,s._getSelectedData()),t}_=s._getSelectedData(),_.length<=s.limitCount?(C=_,d=0,b=!1,s.isFirstSLimitCount=!0,s._doSScrollLoad(C,d,b,!0)):(f=s.sListBodyDiv[0].clientHeight,p=s.sListBodyDiv[0].scrollHeight,d=s.sListBodyDiv[0].scrollTop,g=Math.floor(d/s.liHeight),C=_.slice(g,g+s.sRenderSize),d>0&&d+f>=p?(b=!0,E=_.length-s.sRenderSize,0>E&&(E=0,d=0),C=_.slice(E)):(b=!1,(0>=d||0>g)&&(g=0,d=0,C=_.slice(g,g+s.sRenderSize))),s._doSScrollLoad(C,d,b)),s._triggerHandler(n,S,s._getSelectedData())}}).appendTo(s.sListBodyDiv),s.sListBodyDiv.appendTo(y),s.sListBodyDiv.hide()},_setTotalElCount:function(e){var t=this;t.totalAEl&&t.totalAEl.text(e)},_setSelectedSpanElCount:function(e){var t=this;t.selectedAEl&&t.selectedAEl.text(e),t.sListUI&&t.sListUI.height(e*t.liHeight)},_onTotalSpanClick:function(){var e=this,t=e.options.disabled;t||"block"!=e.listBodyDiv.css("display")&&(e.sListBodyDiv&&e.sListBodyDiv.hide(),e.searchField&&e.searchField.show(),e.separateEl&&e.separateEl.show(),e.allEl&&e.allEl.show(),e.listBodyDiv&&e.listBodyDiv.show(),e._doLayout())},_onSelectedSpanClick:function(){var e,t,i=this,a=i.options.disabled;a||"block"!=i.sListBodyDiv.css("display")&&(i.searchField&&i.searchField.hide(),i.separateEl&&i.separateEl.hide(),i.allEl&&i.allEl.hide(),i.listBodyDiv&&i.listBodyDiv.hide(),i.sListBodyDiv&&i.sListBodyDiv.show(),i.sListBodyDiv[0].scrollTop=0,e=i._getSelectedData(),e.length>i.limitCount?(i._doSScrollEvent(),i.isFirstSLimitCount=!1,t=e.slice(0,0+i.sRenderSize)):(i.isFirstSLimitCount=!0,t=e),i.sListUI.find("li").remove(),i._doSScrollLoad(t,0,!1,i.isFirstSLimitCount))},_doSScrollEvent:function(){var t=this,i=0,a=0,n=0,o=0,r=[],l=[],s=!1,d=0;t.sListBodyDiv.unbind("scroll"),t.sListBodyDiv.scroll(function(c){return i==e(this).get(0).scrollTop?!1:(s=!1,n=e(this)[0].clientHeight,a=e(this)[0].scrollHeight,i=e(this)[0].scrollTop,o=Math.floor(i/t.liHeight),r=t._getSelectedData(),l=r.slice(o,o+t.sRenderSize),i>0&&i+n>=a?(s=!0,d=r.length-t.sRenderSize,0>d&&(d=0,i=0),l=r.slice(d)):(s=!1,(0>=i||0>o)&&(o=0,i=0,l=r.slice(o,o+t.sRenderSize))),t._doSScrollLoad(l,i,s),c.stopImmediatePropagation(),!1)})},_doSScrollLoad:function(i,a,n,o){var r,l,s,d=this,c=d.sListUI,h=d.tempRenderTop,u=20,p=0,f=0;if(o){d.sListBodyDiv.unbind("scroll"),p=d.sListBodyDiv.get(0).scrollLeft,c.find("li").remove();for(var g=0;i.length>g;g++)l=d._addSLiNode(i[g],g*d.liHeight),l.get(0).scrollWidth>f&&(f=l.get(0).scrollWidth);return d.sListBodyDiv[0].clientWidth>=f&&(f=d.sListBodyDiv[0].clientWidth-u),r=c.find("li"),e.each(r,function(t,i){e(i).width(f).css({top:"",position:"relative"})}),d.sListBodyDiv.get(0).scrollLeft=p,t}for(var g=0;i.length>g;g++)l=d._addSLiNode(i[g],h),l.get(0).scrollWidth>f&&(f=l.get(0).scrollWidth),l.remove();n&&(d.sListBodyDiv[0].scrollTop=c.height()-d.sListBodyDiv[0].clientHeight),a>0&&(s=d.sListBodyDiv[0].clientHeight+a,a=s-i.length*d.liHeight),r=c.find("li");for(var g=0;i.length>g;g++)d._renderSLiNode(i[g],a+g*d.liHeight,r[g]);d.sListBodyDiv[0].clientWidth>=f&&(f=d.sListBodyDiv[0].clientWidth-u),r=c.find("li"),e.each(r,function(t,i){e(i).width(f)})},_renderSLiNode:function(i,a,n){var o,r,l,s,d,c,h=this,u=h.options.disabled;return n?(o=e(n),o.css("top",a),d=e.nullToString(i.text),r=o.find("span"),l=e(r[0]),l.text(d),h.options.tip&&(c=i.qtip,(t===c||null===c)&&(c=i.text),l.attr("title",c)),r[1]&&(s=e(r[1]),s.data("value",i.value)),u&&h.setDisabled(u),o):(h._addSLiNode(i,a,0),t)},_addSLiNode:function(i,a,n){var o,r,l,s,d=this,c=d.sListUI,h=20,u=d.options.disabled;return o=e("<li>").addClass(g+" "+p).css("top",a),n&&n>0&&(d.sListBodyDiv[0].clientWidth>=n&&(n=d.sListBodyDiv[0].clientWidth-h),o.width(n)),l=e.nullToString(i.text),r=e("<span>").text(l).appendTo(o),d.options.tip&&(s=i.qtip,(t===s||null===s)&&(s=i.text),r.attr("title",s)),e("<span>").addClass(x).data("value",i.value).appendTo(o),o.appendTo(c),u&&d.setDisabled(u),o},_getLiMaxWidth:function(t){var i,a,n=0,o=0;if(!t)return n;i=t.find("li");for(var r=0;i.length>r;r++)if("none"!=e(i[r]).css("display")){a=e(i[r]).children(),o=0;for(var l=0;a.length>l;l++)"none"!=e(a[l]).css("display")&&(o+=e(a[l]).externalWidth());o>n&&(n=o)}return n},_destroyWidget:function(){var e=this;e.listEl&&e.listEl.remove(),e._resizeInfo&&(e._resizeInfo._$moveEl&&e._resizeInfo._$moveEl.remove(),e._resizeInfo=null)},destroyMoveEl:function(){var e=this;e._resizeInfo&&e._resizeInfo._$moveEl&&(e._resizeInfo._$moveEl.remove(),e._resizeInfo._$moveEl=null,e._resizeInfo.isMouseDown=!1)},__doCreateResizeEl:function(){var t,i,a,d,c,h=this,u=h.listDiv;1==h.options.resizAble||"true"==h.options.resizAble||"xy"==h.options.resizAble?(u.css({position:"absolute"}),t=e("<div>").addClass(n).appendTo(u),d=e("<div>").addClass(l).appendTo(u),a=e("<div>").addClass(r).css({height:"calc(100% - 10px)"}).appendTo(u),c=e("<div>").addClass(s).css({width:"calc(100% - 10px)"}).appendTo(u),i=e("<div>").addClass(o).appendTo(u),h.__registResizeEvent(t,"xy"),h.__registResizeEvent(d,"yt"),h.__registResizeEvent(a,"xr"),h.__registResizeEvent(c,"yb"),h.__registResizeEvent(i,"xl")):"x"==h.options.resizAble?(u.css({position:"absolute"}),a=e("<div>").addClass(r).appendTo(u),i=e("<div>").addClass(o).appendTo(u),h.__registResizeEvent(a,"xr"),h.__registResizeEvent(i,"xl")):"y"==h.options.resizAble&&(u.css({position:"absolute"}),d=e("<div>").addClass(l).appendTo(u),c=e("<div>").addClass(s).appendTo(u),h.__registResizeEvent(d,"yt"),h.__registResizeEvent(c,"yb"))},__registResizeEvent:function(e,t){var i=this;e&&(e.bind("mousedown",{me:i,rEl:e,type:t},i._doResizeElMousedown),e.bind("mousemove",{me:i,rEl:e,type:t},i._doResizeElMousemove),e.bind("mouseup",{me:i,rEl:e,type:t},i._doResizeElMouseup),e.bind("mouseover",{me:i,rEl:e,type:t},i._doResizeElMouseover))},_doResizeElMousedown:function(t){var i,n,o,r,l,s,d,c,h,u=t.data.me,p=e(t.target),f=p.get(0),g=t.data.type,m=1,v=2,w=0;return u._resizeInfo.isMouseDown=!0,u._resizeInfo.leftWidth=t.pageX,u._resizeInfo.topHeight=t.pageY,f.setCapture?f.setCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP|Event.MOUSEDOWN),u.listDiv.find("*").css({"-moz-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","-khtml-user-select":"none","user-select":"none"}),u._resizeInfo&&u._resizeInfo._$moveEl&&(u._resizeInfo._$moveEl.remove(),u._resizeInfo._$moveEl=null),u.options.isBorder||(w=1),i=u.listDiv.offset(),s=u.listDiv.width(),d=u.listDiv.height(),h=e.getMaxZIndex(u.listDiv.css("z-index")),"xl"==g?(n=u.listDiv.css("right"),u.renderEl&&"absolute"==u.renderEl.css("position")&&(n=u.renderEl.css("right")),n=parseInt(n)-w,l=i.top-w,c={width:s,height:d,right:n,top:l,"z-index":h}):"yt"==g?(l=i.top,o=e("body").height()-l-d,o-=u.options.isBorder?v:m,r=i.left-w,c={width:s,height:d,left:r,bottom:o,"z-index":h}):(r=i.left-w,l=i.top-w,c={width:s,height:d,left:r,top:l,"z-index":h}),u._resizeInfo._$moveEl=e("<div>").addClass(a).css(c).appendTo("body"),!1},_doResizeElMousemove:function(t){var i,a,n,o,r,l,s,d,c,h=t.data.me,u=(e(t.target),t.data.type),p=0,f=0,g=5;if(h._resizeInfo.isMouseDown){if(a=h.listDiv.offset(),c=h._triggerHandler({offset:a,resizeInfo:h._resizeInfo,resizeType:u,event:t},z,h),0==c||"false"==c)return;f=a.left,i=a.top,r=t.pageX,l=t.pageY,s=e(document).innerWidth()-g,d=e(document).innerHeight()-g,r>s&&(r=s),l>d&&(l=d),g>=l&&(l=g),g>=r&&(r=g),h.options.isBorder&&(p=2),("xy"==u||"xr"==u||"xl"==u)&&(n="xl"==u?h._resizeInfo.width+f-r:r-f,h._resizeInfo.initWidth>n?h._resizeInfo._$moveEl.width(h._resizeInfo.initWidth-p):h._resizeInfo._$moveEl.width(n)),("xy"==u||"yt"==u||"yb"==u)&&(o="yt"==u?h._resizeInfo.height+i-l:l-i,h._resizeInfo.initHeight>o?h._resizeInfo._$moveEl.height(h._resizeInfo.initHeight-p):h._resizeInfo._$moveEl.height(o))}return!1},_doResizeElMouseup:function(i){var a,n,o,r,l=i.data.me,s=e(i.target),d=s.get(0),c=5,h=1,u=2,p=-1,f=-1;return l._resizeInfo.isMouseDown=!1,d.releaseCapture?d.releaseCapture():window.captureEvents&&window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP),l._resizeInfo&&l._resizeInfo._$moveEl&&(p=l._resizeInfo._$moveEl.width(),f=l._resizeInfo._$moveEl.height(),l._resizeInfo._$moveEl.remove(),l._resizeInfo._$moveEl=null),l.listDiv.find("*").css({"-moz-user-select":"","-webkit-user-select":"","-ms-user-select":"","-khtml-user-select":"","user-select":""}),0>p||0>f||(l._resizeInfo.initWidth>p&&(p=l._resizeInfo.initWidth),l._resizeInfo.initHeight>f&&(f=l._resizeInfo.initHeight),o=l._resizeInfo.width-p,r=l._resizeInfo.height-f,o>=-1&&1>=o&&r>=-1&&1>=r)?t:(l._resizeInfo.width=p,l._resizeInfo.height=f,n=l._resizeInfo.width+u,a=l._resizeInfo.height-c,a+=h,l.options.isBorder||(a-=u,n-=u),l.options.search&&(a+=l.searchFiedlDiv.outerHeight(!0)+c),l.options.sViewBar&&(a+=h,l.options.all&&l.options.multi&&(a-=u)),l._resizeLayout=!0,l.resizeLayout(n,a),l.listDiv.unbind("resize"),!1)},_doResizeElMouseover:function(t){t.data.me,e(t.target)}}),Sweet.list.OptimizeList=e.sweet.widgetListList}(jQuery),function(e){"use strict";var t="sweet-dialog-title",i="sweet-dialog-title-close",a="sweet-dialog-content",n="sweet-dialog-content-headless",o="sweet-dialog-bottom",r="sweet-form-button",l="sweet-window-visible-",s="sweet-window-invisible-",d={normal:0,rotateY:700};e.widget("sweet.widgetWindow",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-win]",defaultElement:"<div>",defaultWindowBg:"sweet-dialog-bg",options:{width:330,height:137,modal:!0,buttons:null,content:null,toggleMethod:"normal",listeners:[],header:!0,padding:null,maskId:""},setTitle:function(t){if(e.isString(t)){var i=this;i.titleTextEl.text(t)}},show:function(t,i){var a,n=this,o=0,r=this.options.toggleMethod,s=d[r]||0;n.options.modal&&(a={maskAll:!0,duration:s},n.options.maskId&&e("#"+n.options.maskId)?(a.maskAll=!1,e("#"+n.options.maskId).sweetMask(a)):n.winEl.sweetMask(a)),o=e.getMaxZIndex(),n.winEl.css("z-index",o),n.winEl.addClass(l+r),n._doLayout(t,i),n.visible=!0,e(window).unbind("keydown",n._onKeyDown).bind("keydown",{me:n},n._onKeyDown)},hide:function(){this._closeWindow()},close:function(e){var t=this;e&&(t=e.data.me||t),t._closeWindow()},_setWidth:function(e){this.winEl&&this.winEl.externalWidth(e)},_setHeight:function(e){this.winEl&&this.winEl.externalHeight(e)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_getWidth:function(){return this.winEl?this.winEl.externalWidth():undefined},_getHeight:function(){return this.winEl?this.winEl.externalHeight():undefined},_doLayout:function(t,i){var a,n,o,r,s=this,d=s.options,c=d.width,h=d.height,u=e("body");if(s.winEl.hasClass(l+d.toggleMethod)){try{a=u.width(),n=u.height()}catch(p){return}if(t===undefined||i===undefined?(o=Math.floor((n-h)/3)+u.scrollTop(),r=Math.floor((a-c)/2)+u.scrollLeft()):(o=i,r=t),s.winEl.css({top:0>o?0:o,left:r}).width(c).height(h),h=s.winEl.height()-s.titleEl.externalHeight(),null===d.buttons||d.buttons.length>0){var f=parseInt(s.bottomEl.css("bottom"),10);isNaN(f)&&(f=0),h=h-s.bottomEl.externalHeight()-f}if(s.contentEl.externalHeight(h),d.content)try{d.content.doLayout()}catch(p){}}},_render:function(){var t=this,i=t.options,a=t.bottomEl,n={width:"65px","margin-left":"5px"},o=i.id+"-content-div";if(t.winEl.appendTo("body"),null!==i.content&&(e.isNull(i.content.html)?i.content.render(o):t.contentEl.html(i.content.html)),e.isNull(i.buttons)){var o=i.vID?i.vID:i.id,l=t.okButtonEl=e("<button>").attr("id",o+"_ok").addClass(r),s=t.cancelButtonEl=e("<button>").attr("id",o+"_cancel").addClass(r);l.css(n).text(Sweet.core.i18n.dialog.ok).appendTo(a),s.css(n).text(Sweet.core.i18n.dialog.cancel).appendTo(a),t.okButtonEl.unbind().bind("click",{me:t},t._onOK),t.cancelButtonEl.unbind().bind("click",{me:t},t._onCancel)}else for(var d in i.buttons){var c=i.buttons[d];if(c&&e.isFunction(c.render)){var h=i.id+"-btn-"+d;e("<div></div>").attr("id",h).css("float","left").css("margin-left","5px").appendTo(a),c.render(h)}}t.options.header===!0&&t.winEl.draggable({handle:"#"+t.titleId,containment:"document",scroll:!1,start:function(){e("body").trigger("click")}}),t.winEl.css({top:-2e3,"z-index":-1})},_onKeyDown:function(e){var t=e.data.me,i=e.which,a=t.isVisible();27===i&&a&&t._onCancel(e)},_onOK:function(t){var i,a=t.data.me,n=a.options.listeners.ok||e.noop;i=n.call(null,t),!1!==i&&a.close(t)},_onCancel:function(t){var i,a=t.data.me,n=a.options.listeners.cancel||e.noop;i=n.call(null,t),!1!==i&&a.close(t)},_closeWindow:function(){var t=this,i=this.options.modal,a=this.options.toggleMethod,n=d[a]||0;this.winEl.removeClass(l+a),this.visible=!1,setTimeout(function(){t.winEl.css({top:-2e3,"z-index":-1})},n),Sweet._closeFloatPanel&&setTimeout(Sweet._closeFloatPanel,20),i&&(t.options.maskId&&e("#"+t.options.maskId)?e("#"+t.options.maskId).unSweetMask():t.winEl.unSweetMask())},_createSweetWidget:function(){var t=this,i=t.options,a=t.winEl=e("<div>");a.addClass(t.defaultWindowBg+" "+i.widgetClass).height(i.height).width(i.width).attr("id",t.options.id),a.addClass(s+this.options.toggleMethod),t._createTitle(),t._createContent(),t._createButtons()},_createTitle:function(){var a=this,n=a.options,o=a.titleEl=e("<div>"),r=a.closeSapn=e("<span>").addClass(i),l=a.titleTextEl=e("<em>"),s=a.titleId=n.id+"-win-title";r.unbind().bind("click",{me:a},a._onCancel).appendTo(o),l.text(n.title).appendTo(o),o.attr("id",s).addClass(t).appendTo(this.winEl),this.options.header!==!0&&o.height(0).hide()},_createContent:function(){var t=this,i=t.options,o=t.contentEl=e("<div>"),r=i.id+"-content-div";if(o.attr("id",r).addClass(a).appendTo(t.winEl),e.isArray(i.padding))for(var l=["padding-top","padding-right","padding-bottom","padding-left"],s=0;i.padding.length>s&&l.length>s;s++)o.css(l[s],0===i.padding[s]?"0":i.padding[s]+"px");t.options.header!==!0&&o.addClass(n)},_createButtons:function(){var t=this;t.bottomEl=e("<div>").addClass(o).appendTo(t.winEl)},_destroyWidget:function(){this.options.modal&&(this.options.maskId&&e("#"+this.options.maskId)?e("#"+this.options.maskId).unSweetMask():this.winEl.unSweetMask()),this.closeSapn.unbind(),e.isNull(this.options.buttons)?(this.okButtonEl.unbind(),this.cancelButtonEl.unbind()):e.each(this.options.buttons,function(t,i){e.isFunction(i.destroy)&&i.destroy()}),e(window).unbind("keydown",this._onKeyDown),this.options.content&&e.isFunction(this.options.content.destroy)&&this.options.content.destroy(),this.winEl.remove()}}),Sweet.Window=e.sweet.widgetWindow}(jQuery),function(e){var t="sweet-listbox-div2",i="sweet-listbox-li",a="sweet-listbox-clearPic",n="sweet-listbox-emptyDiv",o=0;e.widget("sweet.widgetListBox",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widgetListBox]",defaultElement:"<input>",widgetClass:"sweet.widgetListBox",options:{width:650,height:100,clearAll:!0,emptyText:"",items:[],label:!1,labelText:null,labelWidth:.3,tip:!1,draggable:!0,closeItem:function(){return!1}},addItems:function(e){var t=this;if("object"==typeof e){if(e.length)for(var i=0;e.length>i;i++)t._addOneItem(e[i]);else t._addOneItem(e);t._setEmptyText()}},removeItems:function(t){var i=this;if(t)i.btnObj[t]&&(i.btnObj[t].renderEl.remove(),delete i.btnObj[t]);else{for(var a in i.btnObj)i.btnObj[a].renderEl.remove(),delete i.btnObj[a];i.btnObj={}}e.isEmptyObject(i.btnObj)&&i._setEmptyText()},widget:function(){return this.boxElement},getContainerObj:function(){return this.boxElement},_setWidth:function(t){var i=this;"string"===e.type(t)&&this.listBoxEl.onResize(function(){i.doLayout()}),i.listBoxEl.externalWidth(t)},_setHeight:function(t){var i=this;"string"===e.type(t)&&this.listBoxEl.onResize(function(){i.doLayout()}),i.listBoxEl.externalHeight(t)},_getWidth:function(){var e=this;return e.listBoxEl.externalWidth()},_getHeight:function(){var e=this;return e.listBoxEl.externalHeight()},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)},_setValue:function(t){e.isNull(t)||this.boxElement.val(t.value)},_getValue:function(){var e=this,t=[];for(var i in e.btnObj)t.push(e.btnObj[i].getValue());return t},_doLayout:function(){var e=this,t=(e.options,e.listBoxEl.width()),i=e.listBoxEl.height(),a=e.labelWidth=e._doLabelLayout(t),n=t,o=0;e.listBoxDiv1El.css({"padding-left":a,position:"relative"}).externalWidth(n).externalHeight(i),e.options.clearAll&&(o=e.clearAllBtn.externalWidth()),e.listBoxDiv2El.externalWidth(e.listBoxDiv1El.width()-o).externalHeight(e.listBoxDiv1El.height()),e.boxElement.css("overflow","auto").externalWidth("100%").externalHeight("100%")},_createSweetWidget:function(){if(!this.renderEl){var t=this,i=t.listBoxEl=e("<div>"),a=t.options;i.width(a.width).height(a.height).attr("id",a.id),t._beforeCreateBoxWidget(),t._createListBoxWidget(),t._afterCreateBoxWidget()}},_createDraggable:function(e,t,i){var a=this,n=t;e&&(n.parent().sortable({start:function(){if(a.options.tip)for(var e in i)i[e].setTip(!1)},stop:function(){if(a.options.tip){for(var e in i)i[e].setTip(!0);for(var t,n=a.boxElement.children("li").children("div"),o={},r=0;n.length>r;r++)t=n[r].id,o[t]=a.btnObj[t];a.btnObj=o}}}),n.parent().disableSelection())},_createListBoxWidget:function(){var e=this;e.options,e._createLabel(),e._createBoxField()},_createLabel:function(){if(this.options.label){var t=this,i=t.options,a="sweet-form-label",n=t.label=e("<label>").addClass(a),o="";e.isNull(i.labelText)||(o+=i.labelText+Sweet.constants.symbol.COLON,n.html(e.nullToString(o)).appendTo(t.listBoxEl))}},_createBoxField:function(){var i=this,o=(i.options,i.listBoxDiv1El=e("<div>").appendTo(i.listBoxEl)),r=i.listBoxDiv2El=e("<div>").addClass(t);i.boxElement=e("<ul>").appendTo(r),i.options.clearAll&&(i.clearAllBtn=e("<a>").attr("title",Sweet.core.i18n.listbox.clearAll).addClass(a).appendTo(o)),r.appendTo(o),i.emptyDiv=e("<div>").html(i.options.emptyText).addClass(n).appendTo(i.listBoxDiv2El)},_addOneItem:function(t){if(t.data){var a=this,n="listBox-li-"+o,r="listBox-labelItem-"+o++,l=e("<li>").attr("id",n).addClass(i).appendTo(a.boxElement),s=t.data.closable===!1?!1:!0,d=a.labelItem=new Sweet.form.LabelItem({id:r,value:t,imageType:t.data.type,closable:s,width:150,tip:a.options.tip,renderTo:n,close:function(e,t){d.renderEl.remove(),delete a.btnObj[r],a.options.closeItem.call(this,t),a._setEmptyText()}});d.options.value=t,a.btnObj[r]=d,a._createDraggable(a.options.draggable,l,a.btnObj)}},_doLabelLayout:function(e){var t,i=this,a=i.options;return i.label?(t=1>a.labelWidth?Math.floor(e*a.labelWidth):a.labelWidth,i.label.width(t).height(a.height)):t=0,t},_render:function(e){var t=this;return t._super(e)?(t.listBoxEl.appendTo(t.renderEl),t.options.items&&t.addItems(t.options.items),t.rendered=!0,!0):!1},_destroyWidget:function(){this.renderEl&&this.renderEl.remove()},_beforeCreateBoxWidget:function(){var e=this;e.btnObj={}},_afterCreateBoxWidget:function(){var e=this;e.options.clearAll&&e.clearAllBtn.bind("click",function(){var t=e.getValue();e.removeItems(),e.options.closeItem.call(this,t,!0)})},_setEmptyText:function(){var e=this;e.boxElement.html()?e.emptyDiv.hide():e.emptyDiv.show()}}),Sweet.ListBox=e.sweet.widgetListBox}(jQuery),function(e){"use strict";var t="sweet-widgetpanel-container",i="sweet-widgetpanel-title",a="sweet-widgetpanel-tools",n="sweet-widgetpanel-content",o="sweet-widgetpanel-header",r="sweet-widgetpanel-state",l="sweet-widgetpanel-tools-always-show",s="sweet-widgetpanel-arrow",d="sweet-widgetpanel-ulParent",c="sweet-widgetpanel-selectWinRadio",h=0,u=21;e.widget("sweet.widgetpanel",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-widgetpanel]",eventNames:{tool:"工具按钮点击事件",switchTitle:"切换标题事件"},type:"WidgetPanel",options:{width:"100%",height:"100%",panelTitle:"",tools:["zoom","refresh","setting","close"],autoHideTools:!0,switchable:!1,items:null},updateTools:function(t,i){var a,n,o=this;if(o.toolsEl){if(null!==t){var r=0;o.toolsEl.children().each(function(i,o){n=e(o),a=n.attr("tool"),t.indexOf(a)>=0?(r++,n.show()):n.hide()}),r>0?(o.toolsEl.css("opacity",""),o.toolsEl.width(r*u)):o.toolsEl.css("opacity","0")}i===!0?(o.options.autoHideTools=i,o.toolsEl.removeClass(l)):i===!1&&(o.options.autoHideTools=i,o.toolsEl.addClass(l))}},setTitle:function(t){if(!e.isNull(t)){var i="";Array.isArray(t)?(t.forEach(function(e){e.isDefault&&(i=e.text)}),this.list.setData(t),this._listDoLayout()):i=t,this.titleEl.find(">em").attr("title",i).text(i),this.options.panelTitle=t,this.list.setValue({text:i,value:i})}},setSwitchable:function(e){var t=this;e===!0?(t.downArrow.show(),t._downArrowHide=!1):e===!1&&(t.downArrow.hide(),t._downArrowHide=!0),t._listDoLayout()},_getCanvasObject:function(){var t=this,i=null,a=t.options,n=a.items[0];return e.isNotNull(n)&&e.isFunction(n.getCanvasObject)&&(i=n.getCanvasObject()),i},_createSweetWidget:function(){var p=this,f=Sweet.core.i18n.widgetPanel,g=p.options.panelTitle,m="",v=null;null===p.options.items&&(p.options.items=[]),Array.isArray(g)?g.forEach(function(t){t.isDefault&&(m=t.text,v=e.objClone(t))}):m=g,p.container=e("<div>").attr("id",p.options.id).addClass(t);var w=p.titleEl=e("<div>");w.addClass(i).appendTo(p.container);var _=p.headerEl=e("<em>");_.text(m).addClass(o).appendTo(w).attr("title",m);var C=p.downArrow=e("<span>");C.addClass(s).bind("click",{me:p},p._showDropDownList).appendTo(w),p._downArrowHide=!1,Array.isArray(g)&&p.options.switchable||(C.hide(),p._downArrowHide=!0);var b=p.toolsEl=e("<div>");b.addClass(a).appendTo(w),e.isArray(p.options.tools)&&p.options.tools.length>0&&(e.each(p.options.tools,function(t,i){e("<span>").addClass(i).attr("title",f[i]||"").attr("tool",i).appendTo(b)}),b.width(u*p.options.tools.length),p.options.autoHideTools||b.addClass(l)),p.stateEl=e("<div><span></span></div>").addClass(r).appendTo(w).hide();var E=p.contentEl=e("<div>");E.addClass(n).attr("id",p.options.id+"-content").appendTo(p.container);var y="widgetPanelDropdown"+h++,x=p.dropDownEl=e("<div>").attr({tabindex:-1}).hide().appendTo("body");e("<div>").attr({id:y}).appendTo(x).addClass(d);var T=p.list=new Sweet.list.OptimizeList({multi:!1,data:Array.isArray(g)?g:[],tip:!0,width:103,renderTo:y});v&&T.setValue(v),T.addListener("change",function(e,t){p._switchTitle(t.text),x.hide()}),T.addListener("nodeClick",function(){x.hide()}),e("body").bind("click",function(t){e(t.target).hasClass(s)===!1&&x.hide()}),x.addClass(c)},_render:function(t){var i=this;if(!i._super(t))return!1;if(i.container.appendTo(i.renderEl),e.isArray(i.options.items)&&i.options.items.length>0){var a=i.options.items[0];e.isFunction(a.render)&&a.render(i.options.id+"-content")}return i.rendered=!0,!0},_addListener:function(t){var i="",a=this;return i="undefined"===e.type(t)?"tool":t,"tool"!==i?!1:e.isNull(this.toolsEl)?!1:(this.toolsEl.children().unbind().bind("click",function(e){a._trigger("tool",e,e.target.className)}),!0)},_trigger:function(t,i,a){if(!e.isNull(this.handlers)){var n=this.handlers[t];e.isFunction(n)&&n(i,a,this)}},addItems:function(t){var i,a=this;return"object"!=typeof t?!1:(e.isArray(a.options.items)||(a.options.items=[]),a.options.items.length>0?(a._error("widgetpanel can only hold 1 sub item. #"+a.options.id),!1):(i=e.isArray(t)&&t.length>=1?t[0]:t,this.rendered&&i.render(a.options.id+"-content"),a.options.items.push(i),!0))},removeItems:function(){var t;if(0!==this.options.items.length){if(t=this.options.items[0],e.isFunction(t.destroy))try{t.destroy()}catch(i){this._error(i)}this.options.items=[]}},_destroyWidget:function(){var t=this;this.stateTimer&&this.stateTimer>=0&&(window.clearInterval(this.stateTimer),this.stateTimer=-1),this.toolsEl.children(".close")&&this.toolsEl.children(".close").trigger("mouseout"),this.toolsEl.children().unbind(),e.each(t.options.items,function(t,i){if(e.isFunction(i.destroy))try{i.destroy()}catch(a){}}),t.options.items=[],t.container.remove()},_doLayout:function(){var t=this;t.rendered&&(e.each(this.options.items,function(i,a){e.isFunction(a.setWH)&&a.setWH(t.contentEl.width(),t.contentEl.height())}),t._listDoLayout())},_listDoLayout:function(){var e,t,i,a=this,n=22,o=a.titleEl.outerHeight(!0),r=a.container.height(),l=a.container.width(),s=a.toolsEl.outerWidth(),d=r-o-n,c=0,h=10,u=6,p=13;a.list&&(e=a.list.getData(),0>=d?d=n:(c=e.length,d>=c*n&&(d="auto")),t=a._getLiMaxWidth(e),i=t+4*h+p-(l-s-h),i=i>0?t-i:t,a.downArrow.css({left:i+4*h+u}),a.list.setWH(i+4*h+p+u,d),a._downArrowHide?a.headerEl.css({width:"calc(100% - 20px)"}):a.headerEl.width(i+3*h+u))},_getLiMaxWidth:function(t){var i,a=60,n=0;i=e("<span>").css({left:"-10000px",position:"absolute"}).appendTo("body");for(var o=0;t.length>o;o++)i.text(t[o].text),n=i.outerWidth(),n>a&&(a=n);return i.remove(),a},_getWidth:function(){return this.container.externalWidth()},_getHeight:function(){return this.container.externalHeight()},_setWidth:function(e){var t=this;t.container.externalWidth(e)},_setHeight:function(e){var t=this;t.container.externalHeight(e)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_showDropDownList:function(t){var i=t.data.me;if(e.isVisiable(i.dropDownEl))i.dropDownEl.hide();else{var a=e.getMaxZIndex(i.dropDownEl.css("z-index"));i.dropDownEl.css("z-index",a);var n=e.getFloatOffset(i.titleEl,i.dropDownEl);i.dropDownEl.css({left:n.left,top:n.top}),i.dropDownEl.show(),i.list&&i.list.doLayout(!0)}},_switchTitle:function(e){var t=this;e!==t.options.panelTitle&&(t.setTitle(e),t.options.panelTitle=e,t._trigger("switchTitle",null,e))},setState:function(e){if("loading"===e){this.toolsEl.hide(),this.stateEl.show(),this.stateTimer&&this.stateTimer>=0&&(window.clearInterval(this.stateTimer),this.stateTimer=-1);var t=0,i=this.stateEl.children().first();i.addClass(e),i.css("background-position","0px"),this.stateTimer=window.setInterval(function(){t+=22,t>=176&&(t=0),i.css("background-position",-t+"px")},100)}else this.toolsEl.show(),this.stateEl.hide(),this.stateTimer&&this.stateTimer>=0&&(window.clearInterval(this.stateTimer),this.stateTimer=-1)},tool:function(t,i,a){e.log(t+","+i+","+a)}}),Sweet.WidgetPanel=e.sweet.widgetpanel}(jQuery),function(e){e.widget("sweet.widgetslidepanel",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-slidepanel]",options:{columnperpage:3,pagewidth:"300",pageheight:"100",currentindex:0},_newGuid:function(){for(var e,t="",i=1;32>=i;i++)e=Math.floor(16*Math.random()).toString(16),t+=e,(8===i||12===i||16===i||20===i)&&(t+="-");return t},_createSweetWidget:function(){var t=this;t.container=e("<div style='width: 100%;height: 100%;'>"),t.sweetEl={},t.sweetEl.id=t._newGuid(),t.sweetEl.Dom=e("<div class='PageDom'>"),t.sweetEl.Pages=e("<div class='Pages'>"),t.container.attr("id",t.options.id).append(t.sweetEl.Dom),t.sweetEl.Dom.append(t.sweetEl.Pages)},_widgetSlideCSS:function(){var e=this;e.sweetEl.Dom.css({position:"relative",overflow:"hidden",width:e.options.pagewidth,height:e.options.pageheight}),e.sweetEl.page[0].css({width:e.options.pagewidth,height:e.options.pageheight}),e.sweetEl.page[1].css({width:e.options.pagewidth,height:e.options.pageheight}),e.sweetEl.page[2].css({width:e.options.pagewidth,height:e.options.pageheight})},addItems:function(){var t=this;t.sweetEl.page=[],t.sweetEl.page[0]=e("<div class='Page'>").html("a1"),t.sweetEl.page[1]=e("<div class='Page'>").html("a2"),t.sweetEl.page[2]=e("<div class='Page'>").html("a3"),t.sweetEl.Pages.append(t.sweetEl.page[0]).append(t.sweetEl.page[1]).append(t.sweetEl.page[2])},_addEvent:function(){var e=this;e.sweetEl.Dom.mousedown(function(t){t.clientX,t.clientX,e.options.currentindex*e.sweetEl.Dom.innerWidth()})},_destroyWidget:function(){var e=this;e.container.remove()},reSize:function(e){var t=this;e.width,e.height,t.renderEl.width(e.width),t.renderEl.height(e.height)},_doLayout:function(){var e=this;if(e.rendered){var t=e.container.width(),i=e.container.height();e.sweetEl.Dom.externalWidth(t),e.sweetEl.Dom.externalHeight(i)}},_getWidth:function(){return this.container.externalWidth()},_getHeight:function(){return this.container.externalHeight()},_setWidth:function(t){var i=this;"string"===e.type(t)&&this.container.onResize(function(){i.doLayout()}),i.container.externalWidth(t)},_setHeight:function(t){var i=this;"string"===e.type(t)&&this.container.onResize(function(){i.doLayout()}),i.container.externalHeight(t)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_render:function(t){var i=this;if(!i._super(t))return!1;i.renderEl.append(i.container);var a=e.isNull(i.options.width)||"100%"===i.options.width?"100%":i.options.width+"px",n=e.isNull(i.options.height)||"100%"===i.options.width?"100%":i.options.height+"px";
return i.renderEl.width(a),i.renderEl.height(n),i.preWH={width:i.renderEl.width(),height:i.renderEl.height()},i.sweetEl.Dom.externalWidth(i.preWH.width),i.sweetEl.Dom.externalHeight(i.preWH.height),i._widgetSlideCSS(),i.rendered=!0,!0}}),Sweet.WidgetslidePanel=e.sweet.widgetslidepanel}(jQuery),function(e){"use strict";var t="sweet-arrayindicator-widget",i="sweet-arrayindicator-content",a="sweet-arrayindicator-image",n="sweet-arrayindicator-serverGreen",o="sweet-arrayindicator-serverRed",r="sweet-arrayindicator-serverGray",l="sweet-arrayindicator-raidGreen",s="sweet-arrayindicator-raidRed",d="sweet-arrayindicator-raidGray",c="sweet-arrayindicator-infoDiv",h="sweet-arrayindicator-infoUl",u="sweet-arrayindicator-infoTr",p="sweet-arrayindicator-infoTrName",f="sweet-arrayindicator-infoTrValue",g="sweet-arrayindicator-infoTrValue-green",m="sweet-arrayindicator-infoTrValue-red",v="sweet-arrayindicator-label-server",w="sweet-arrayindicator-label-raid";e.widget("sweet.widgetArrayIndicator",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-bxCarousel]",type:"bxCarousel",eventNames:{click:"点击图片事件"},options:{height:"auto",data:null,label:!0,labelText:null,labelWidth:.2,type:1,symbol:!0},setData:function(e){var t=this,i=t.options;i.data=e||i.data,t._removeTips(),t._initData(),t.arrayIndicatorUl.text(""),t._createArrayIndicatorLi(),t._doLayout()},setLabelText:function(e){var t=this;t.options.symbol&&(e+=Sweet.constants.symbol.COLON),t.label.text(e)},getLabelText:function(){var e=this;return e.label.text()},_createSweetWidget:function(){var i=this,a=this.options;i.arrayIndicatorEl=e("<div>").addClass(t).attr("id",a.id),i._initData(),i._createLabel(),i._createArrayIndicator()},_initData:function(){var t=this,i=t.options,a=i.data,n=t.dataMap={};t.liObjMap={},!e.isArray(a)||1>a.length||e.each(a,function(e,t){n[t.value]=t})},_createLabel:function(){if(this.options.label){var t=this,i=t.options,a=t.label=e("<label>"),n="";e.isNull(i.labelText)||(n+=e.htmlEscape(i.labelText),i.symbol&&(n+=Sweet.constants.symbol.COLON),a.html(n).appendTo(t.arrayIndicatorEl))}},_createArrayIndicator:function(){var t=this,a=t.options,n=(a.data,t.arrayIndicatorDiv=e("<div>").addClass(i).appendTo(t.arrayIndicatorEl));t.arrayIndicatorUl=e("<ul>").appendTo(n),t._createArrayIndicatorLi()},_createArrayIndicatorLi:function(){var t=this,i=t.options,a=i.data;if(e.isArray(a)&&!(1>a.length)){var n="";e.each(a,function(i,a){n=t._getImageClass(a);var o=e("<li>").data("info",a.text).data("value",a.value).addClass(n).bind("click",{me:t},t._clickImage).bind("mouseover",{me:t},t._showInfo).bind("mouseout",{me:t},t._closeInfo).appendTo(t.arrayIndicatorUl);t.liObjMap[a.value]=o})}},_getImageClass:function(e){var t=this,i=t.options,c=a+" ",h=parseInt(e.status,10);return 1===i.type?(c+=1===h?n:2===h?o:r,t.label&&t.label.addClass(v)):(c+=1===h?l:2===h?s:d,t.label&&t.label.addClass(w)),c},_clickImage:function(t){var i=t.data.me,a=(i.options,e(t.currentTarget)),n=i.dataMap[a.data("value")];i._triggerHandler(t,"click",n)},_showInfo:function(t){var i=t.data.me,a=(i.options,e(t.currentTarget)),n=a.data("info");if(e.isArray(n)&&!(1>n.length)){var o=e("<div>").addClass(c).appendTo("body"),r=e("<table>").addClass(h).appendTo(o),l=0;e.each(n,function(t,i){var a=e("<tr>").addClass(u).appendTo(r);e("<td>").html(i.label).addClass(p).appendTo(a);var n=e("<td>").html(i.desc).addClass(f).appendTo(a);l=parseInt(i.status,10),1===l?n.addClass(g):2===l&&n.addClass(m)}),o.position({my:"left-20 top",at:"right bottom",of:a,collision:"flipfit flipfit"}),a.data("infoDiv",o)}},_closeInfo:function(t){var i=(t.data.me,e(t.currentTarget));i.data("infoDiv")&&i.data("infoDiv").remove()},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},_afterCreateSweetWidget:function(){},_render:function(e){var t=this;return t._super(e)?(t.arrayIndicatorEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_setValue:function(t){var i=this,a=[];e.isArray(a)?a=t:a.push(t);var n="";e.each(a,function(e,t){if(i.liObjMap[t.value]){n=i._getImageClass(t);var a=i.liObjMap[t.value].data("info",t.text).removeClass().addClass(n);i.dataMap[t.value]=t,i.liObjMap[t.value]=a}})},_getValue:function(){},_doLayout:function(){var t=this,i=t.options;if(t.rendered){var a=t.arrayIndicatorEl.width()-e.getPaddingRight(t.arrayIndicatorEl)-e.getPaddingLeft(t.arrayIndicatorEl),n=t.labelWidth=t._doLabelLayout(a);t.label&&t.label.width(n),t.arrayIndicatorDiv.width(a-n),"auto"===i.height?t.arrayIndicatorEl.height(t.arrayIndicatorDiv.height()):t.arrayIndicatorDiv.height(i.height)}},_doLabelLayout:function(e){var t,i=this,a=i.options;return t=i.label?1>a.labelWidth?Math.floor(e*a.labelWidth):a.labelWidth:0},_setWidth:function(e){var t=this;t.arrayIndicatorEl.externalWidth(e)},_getWidth:function(){var e=this;return e.arrayIndicatorEl.externalWidth()},_getHeight:function(){var e=this;return e.arrayIndicatorEl.externalHeight()},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)},_setHeight:function(e){var t=this;t.arrayIndicatorEl.externalHeight(e)},_removeTips:function(){var t=this;e.isNull(t.liObjMap)||e.each(t.liObjMap,function(e,t){t.trigger("mouseout")})},_destroyWidget:function(){var e=this;e._removeTips(),e.arrayIndicatorEl.remove(),delete e.liObjMap,delete e.dataMap}}),Sweet.ArrayIndicator=e.sweet.widgetArrayIndicator}(jQuery),function(e){var t="sweet-ratioIndicator-color-common",i="sweet-ratioIndicator-color-green-left",a="sweet-ratioIndicator-color-yellow-left",n="sweet-ratioIndicator-color-shadow",o="sweet-ratioIndicator-color-gray-right",r="sweet-ratioIndicator-loading",l="sweet-ratioIndicator-color-green-all",s="sweet-ratioIndicator-color-gray-all",d="sweet-ratioIndicator-color-red-all",c="sweet-ratioIndicator-color-red-left",h="yellowtext",u="sweet-ratioIndicator-loading-text";e.widget("sweet.widgetRatioIndicator",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-ratioindicator]:",type:"ratioindicator",eventNames:{change:"比率指示灯数据改变事件"},options:{value:null,maxValue:100,threshhold:null,secondThreshhold:null,valueLabel:"",maxValueLabel:"",width:287,from:"green"},setData:function(t){if(!e.isNull(t)&&!e.isArray(t)){var i=this,a=e.objClone(t);for(var n in t)i.options[n]=a[n];e.isNull(t.width)||(i.width=t.width),i._setValue(i.options.value)}},_setValue:function(t){if(!e.isNull(t)){var i=this;e.equals(i.currentValue,t)||e.isNull(i.eventMap.change)||i.eventMap.change.call(null,null,t),i.currentValue=t,i.ratioIndicatorLeftDivEl.remove(),i.ratioIndicatorRightDivEl.remove(),i.ratioIndicatorContentEl.remove(),i._createRatioIndicator()}},_getValue:function(){var e=this;return e.options.value},_doLayout:function(){var e=this,t=(e.options,e.width),i=e.ratioIndicatorEl;i.width(t)},_createSweetWidget:function(){if(!this.renderEl){var t=this,i=t.options,a=t.ratioIndicatorEl=e("<div>");t.eventMap=[],t.width=i.width,a.addClass(i.widgetClass+" "+r).width(i.width).attr("id",i.id),t._createRatioIndicatorWidget()}},_createRatioIndicatorWidget:function(){var t,i=this,a=i.options;t=i.contentEl=e("<div>").appendTo(i.ratioIndicatorEl).addClass(a.widgetClass).width(i.width),i._createRatioIndicator()},_createRatioIndicator:function(){var i,a,r,l,d,c=this,h=c.options,p=h.value,f=h.threshhold,g=!1,m=e.htmlEscape(h.valueLabel),v=e.htmlEscape(h.maxValueLabel),w=e.htmlEscape(h.maxValue),_=e.htmlEscape(p.value),C=h.secondThreshhold;return(e.isNull(p)||e.isNull(p.value)||!e.isNumeric(p.value))&&(g=!0,p={value:0,text:null}),(p.value>w||f>w||0>p.value)&&(g=!0),e.isNull(f)&&(f=h.maxValue),e.isNull(C)||(f>C||C>w)&&(g=!0),c.currentValue=e.objClone(p),0===p.value||0===h.maxValue||0===f?(r=0,l=c.width):(r=c.width*(p.value/h.maxValue),l=c.width*((h.maxValue-p.value)/h.maxValue)),c.ratioIndicatorLeftDivEl=i=e("<div>").appendTo(c.contentEl).width(r).addClass(t).addClass(n),c.ratioIndicatorRightDivEl=d=e("<div>").appendTo(c.contentEl).width(l).addClass(t).addClass(o),c.ratioIndicatorContentEl=a=e("<div>").appendTo(c.contentEl).width(c.width).html(m+"/ "+v+"<em>"+_+"</em>/"+w).addClass(u),g?(d.addClass(s),a.html(m+"/ "+v+"："+"--"+"/"+"--"),undefined):0===p.value?(d.addClass(s),a.html(m+"/ "+v+"："+_+"/"+w),undefined):(c._createRatioIndicatorContent(),undefined)},_createRatioIndicatorContent:function(){var t=this,n=t.options,o=t.ratioIndicatorLeftDivEl,r=t.ratioIndicatorContentEl,s=n.value,u=n.from,p=n.threshhold,f=e.htmlEscape(n.valueLabel),g=e.htmlEscape(n.maxValueLabel),m=e.htmlEscape(n.maxValue),v=e.htmlEscape(s.value),w=n.secondThreshhold;if("green"===u){if(s.value===m)return o.addClass(l),r.html(g+"："+"<em>"+v+"</em>"),undefined;if(p>=s.value&&(o.addClass(i),r.html(f+"/ "+g+"："+"<em>"+v+"</em>/"+m)),!e.isNull(w)&&s.value>p&&w>s.value)return o.addClass(a),r.html(f+"/ "+g+"："+"<span class = "+h+">"+v+"</span>/"+m),undefined;s.value>p&&(o.addClass(c),r.html(f+"/ "+g+"："+"<i>"+v+"</i>/"+m))}else{if(s.value===m)return o.addClass(d),r.html(g+"："+"<i>"+v+"</i>"),undefined;if(p>s.value&&(o.addClass(c),r.html(f+"/ "+g+"："+"<i>"+v+"</i>/"+m)),!e.isNull(w)&&s.value>p&&w>s.value)return o.addClass(a),r.html(f+"/ "+g+"："+"<span class = "+h+">"+v+"</span>/"+m),undefined;s.value>p&&(o.addClass(i),r.html(f+"/ "+g+"："+"<em>"+v+"</em>/"+m))}},_render:function(e){var t=this;return t._super(e)?(t.ratioIndicatorEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_destroyWidget:function(){this.ratioIndicatorEl&&this.ratioIndicatorEl.remove()},_removeListener:function(){var t=this;t.handlers=t.handlers||{},e.each(t.handlers,function(e){"change"===e&&(t.eventMap.change=null,delete t.handlers.change,t.eventMap.length--)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"change"===e&&(t.eventMap.change=i,t.eventMap.length++)})}}),Sweet.RatioIndicator=e.sweet.widgetRatioIndicator}(jQuery),function(e){e.widget("sweet.widgetMap",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-map]",eventNames:{click:"单击事件",MapIsOk:"地图已加载完事件",mapZoomEnd:"地图层级放大缩小事件",kqiChange:"指标切换事件"},options:{width:600,height:600,cellData:[],layerId:null,layerData:[],layerDefaultColor:"",layerLengedInfo:[],kqiList:[],isFilter:!1,isCircle:!1,dashboardMapLayer:{}},clearLayer:function(){var e=this;e.mapObj&&e.mapObj.clearLayer()},setKqiList:function(e){var t=this;t.mapObj&&t.mapObj.setKqiList(e)},setLenged:function(e){var t=this;t.mapObj&&t.mapObj.setLenged(e)},setData:function(t){var i=this;if(e.isArray(t))i.options.layerData=e.objClone(t);else for(var a in t)i.options[a]=JSON.parse(JSON.stringify(t[a]));i.mapObj&&(i.mapObj.setLayerId(i.options.layerId),i.options.layerDefaultColor&&i.mapObj.setLayerDefaultCorlor(i.options.layerDefaultColor),i.mapObj.setLayerData(i.options.layerData))},_setWidth:function(e){this.mapContainerEl.externalWidth(e),this.mapObj&&this.mapObj.setWidth(e)},_setHeight:function(e){this.mapContainerEl.externalHeight(e),this.mapObj&&this.mapObj.setHeight(e)},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},getCellData:function(){return e.objClone(this.options.cellData)},creatPointLayer:function(t){var i=this;i.options.cellData=e.objClone(t),i.mapObj&&i.mapObj.addCell(t,"noTest")},addLine:function(e){var t=this;t.mapObj&&t.mapObj.addLine(e)},reFreshLine:function(e){var t=this;t.mapObj&&t.mapObj.reFreshLine(e)},reFreshCell:function(e){var t=this;t.mapObj&&t.mapObj.reFreshCell(e)},clearLine:function(){var e=this;e.mapObj&&e.mapObj.clearLine()},removePointLayer:function(){var e=this;e.mapObj&&e.mapObj.removePointLayer()},setPosition:function(t){var i=this;e.isNull(t)||i.mapObj&&i.mapObj.setPosition(t)},setPositionLayer:function(t){var i=this;e.isNull(t)||i.mapObj&&i.mapObj.setPositionLayer(t)},_render:function(e){var t=this;return t._super(e)?(t.mapContainerEl.appendTo(t.renderEl),t.rendered=!0,t.options.renderTo=e,t._createMapWidget(),!0):!1},_createSweetWidget:function(){if(!this.renderEl){var t=this,i=t.options;t.mapContainerEl=e("<div>").attr("id",i.id).width(i.width).height(i.height).addClass(i.widgetClass),t.mapId=i.id+"-map",t.mapEl=e("<div>").attr("id",t.mapId).width(i.width).height(i.height).appendTo(t.mapContainerEl)}},_createMapWidget:function(){var e=this,t=e.options,i=t.width,a=t.height;e.mapObj=new Supermapflex(e,e.mapId,e.mapId,i,a,t.cellData,t.layerLengedInfo,t.kqiList,t.isCircle,t.isFilter,t.dashboardMapLayer),e.mapObj&&e.options.layerId&&(e.mapObj.setLayerId(e.options.layerId),e.options.layerDefaultColor&&e.mapObj.setLayerDefaultCorlor(e.options.layerDefaultColor),e.mapObj.setLayerData(e.options.layerData))},_destroyWidget:function(){},_doLayout:function(){var e=this,t=e.mapContainerEl.width(),i=e.mapContainerEl.height();e._setWH(t,i)},_getWidth:function(){return this.mapContainerEl.externalWidth()},_getHeight:function(){return this.mapContainerEl.externalHeight()}}),Sweet.Map=e.sweet.widgetMap}(jQuery),$(function(e,t){"use strict";var i="sweet-arrayindicator-infoDiv";e.widget("sweet.widgetStatuBar",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-StatuBar]:",eventNames:{click:"小方块点击事件"},type:"StatuBar",options:{height:10,width:"100%",barWidth:10,barHeight:10,direction:"right",data:[],tip:!1,label:"",labelSpaceWidth:30,lableStyle:{labelWidth:100,color:"#3c3c3c",font:"12px Tahoma"},isShadow:!1,shadowPosInfo:null,userData:null},setData:function(t,i){var a=this,n=a.options;e.isNull(a.tipDiv)||a.tipDiv.remove(),!e.isNull(t)&&e.isArray(t)&&(n.data.length=0,n.data=e.objClone(t),n.label=i,a.nodeInfo.length=0,a.preInfo=null,a._drawStatuBar())},setUserData:function(t){this.options.userData=t?e.objClone(t):t},setPosition:function(t){var i=this;e.isNull(t)||(e.isNull(t.left)||i.canvasEl.css("left",t.left+"px"),e.isNull(t.top)||i.canvasEl.css("top",t.top+"px"))},_createSweetWidget:function(){var t=this,i=10,a=t.options,n=a.id+"-canvas";a.width=a.width-i,t.nodeInfo=[],t.eventMap={},i>a.height-a.barHeight&&(a.height=a.barHeight+i),t.sbarEl=e("<div>").attr({id:a.id}).height(a.height).width(a.width).css("overflow","hidden").css("position","relative"),t.canvasEl=e("<Canvas>").attr({id:n,height:a.height,width:a.width}).appendTo(t.sbarEl),t.c=t.canvasEl.get(0).getContext("2d"),t._bindEvent(),t._drawStatuBar()},_isScope:function(t,i){var a,n=this,o=0,r=0,l=0;for(e.isFirefox()?(o=t.pageX-n.canvasEl.offset().left,r=t.pageY-n.canvasEl.offset().top):(e.isChrome()||e.isIE())&&(o=t.offsetX,r=t.offsetY),l=0;i.length>l;l++)if(a=i[l],o>=a.left&&a.left+a.width>=o&&r>=a.top&&a.top+a.height>=r)return{isScope:!0,node:a};return!1},_onClick:function(t){var i=t.data.me;if(e.isFunction(i.eventMap.click)){var a=i._isScope(t,i.nodeInfo);if(a&&a.isScope&&a.node.clickable){var n=a.node.node;i.options.isShadow&&(n={userData:i.options.userData,data:i.options.data,curNode:a.node.node}),i.eventMap.click(t,n)}}},_onMousemove:function(a){var n=a.data.me,o=n.options.tip,r=n._isScope(a,n.nodeInfo);if(n._removeTipDiv(),r&&r.isScope){if(e.isFunction(n.eventMap.click)&&r.node.clickable&&n.canvasEl.css("cursor","pointer"),o&&r.node&&r.node.node&&!e.isNull(r.node.node.text)){var l=e.getMaxZIndex(t,i);n.tipDiv=e("<div>").addClass(i).css("z-index",l).appendTo("body"),e("<span>").html(r.node.node.text).appendTo(n.tipDiv),n.tipDiv.position({my:"left+5 bottom-10",of:a,collision:"flipfit"})}}else n._removeTipDiv(),n.canvasEl.css("cursor","default")},_onMouseout:function(e){var t=e.data.me;t._removeTipDiv()},_bindEvent:function(){var e=this;e.canvasEl.bind("click",{me:e},e._onClick).bind("mousemove",{me:e},e._onMousemove).bind("mouseout",{me:e},e._onMouseout)},_removeTipDiv:function(){var t=this;e.isNull(t.tipDiv)||(t.tipDiv.remove(),t.tipDiv=null)},_closeFloatPanel:function(){this._removeTipDiv()},_calcLabelWidth:function(t,i){var a,n=this,o=n.c;return o.save(),o.textAlign="start",o.fillStyle=n.options.lableStyle.color,o.font=n.options.lableStyle.font,a=o.measureText(t).width,o.restore(),e.isNotNull(i)&&a>i&&(a=i),a},_drawStatuBar:function(){var t,i=this,a=i.options,n=a.direction,o=i.c,r=a.data.length,l=i.sbarEl,s=l.width(),d=l.height(),c=a.barWidth,h=a.barHeight,u=c+1,p=0,f=0,g=(d-h)/2,m=0,v=5,w=h/2,_=0;for(e.isNotNull(a.label)&&(_=v+a.lableStyle.labelWidth,m=_+a.labelSpaceWidth),i.cw=s=r*u+m,i.canvasEl.attr({height:d,width:s}),e.isNotNull(a.label)&&(i._createText(a.label,f+v,g+w,{maxTextWidth:a.lableStyle.labelWidth}),i.nodeInfo.push({node:{value:a.label,text:a.label},left:f+v,top:g,width:_,height:h,clickable:!1}),f+=m),"right"===n&&(i.canvasEl.css("position","relative"),i.canvasEl.css("left",-i.canvasEl.attr("width")+i.sbarEl.width()+"px"),u=-u,f=s+u),p=0;r>p;p++)t=a.data[p],o.fillStyle=t.color,o.fillRect(f,g,c,h),i.nodeInfo.push({node:t,left:f,top:g,width:c,height:h,clickable:!0}),f+=u;a.isShadow&&i.drawShadow({width:a.shadowPosInfo?a.shadowPosInfo.width:8*u,left:a.shadowPosInfo?a.shadowPosInfo.left:0})},drawShadow:function(e){var t=this,i=e.width?e.width:88,a=t.sbarEl.height(),n=t.cw-Math.abs(e.left?e.left:0)-i,o=t.c;t.options.shadowPosInfo=e,t.preInfo&&t.preInfo.imgData&&(o.putImageData(t.preInfo.imgData,t.preInfo.x,t.preInfo.y),delete t.preInfo),t.preInfo={imgData:o.getImageData(n,0,i,a),x:n,y:0,width:i,height:a},o.fillStyle="black",o.globalAlpha=.2,o.fillRect(n,0,i,a)},_createText:function(t,i,a,n){var o=this,r=0,l=t,s=0,d=o.c;return n=n||{},d.save(),d.textAlign=n.textAlign?n.textAlign:"start",d.fillStyle=o.options.lableStyle.color,d.font=o.options.lableStyle.font,d.textBaseline=n.textBaseline?n.textBaseline:"middle",d.translate(i,a),e.isNull(n.maxTextWidth)?d.fillText(l,0,0):(r=d.measureText(t).width,r>n.maxTextWidth&&(s=Math.ceil(t.length*n.maxTextWidth/r),l=(t+"").substr(0,s-4)+"..."),d.fillText(l,0,0,n.maxTextWidth)),d.restore(),r},_doLayout:function(){var e=this;e._drawStatuBar()},_getWidgetEl:function(e){return this.renderEl=this.sbarEl,e?this.sbarEl[0]:this.sbarEl},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"click"===e&&(t.eventMap.click=i)})},_removeListener:function(){var t=this;e.each(t.handlers,function(e){"click"===e&&delete t.eventMap.click})},_destroyWidget:function(){var e=this;e.canvasEl&&e.canvasEl.unbind(),e._removeTipDiv()},_render:function(t){var i=this;e.isNull(t)||i.rendered||(i.renderEl||i._createRenderEl(t),i.sbarEl.appendTo(i.renderEl),i.options.renderTo=t,i.rendered=!0)}}),Sweet.StatuBar=e.sweet.widgetStatuBar}(jQuery)),function(e,t){var i="sweet-scoreCard-unit",a="sweet-scoreCard-offset",n="sweet-scoreCard-diff",o="sweet-scoreCard-textOR",r="sweet-scoreCard-textTR",l="sweet-scoreCard-card",s="sweet-scoreCard-num",d="sweet-scoreCard-value",c="sweet-scoreCard-icon",h="sweet-scoreCard-icon2",u="sweet-scoreCard-noValue",p="sweet-scoreCard-noValue2",f={},g={};f[Sweet.constants.numColor.YELLOW]="sweet-scoreCard-yellow",f[Sweet.constants.numColor.GREEN]="sweet-scoreCard-green",f[Sweet.constants.numColor.RED]="sweet-scoreCard-red",g[Sweet.constants.differType.EQUAL]="sweet-scoreCard-equal",g[Sweet.constants.differType.INCREASE]="sweet-scoreCard-increase",g[Sweet.constants.differType.DECREASE]="sweet-scoreCard-decrease",e.widget("sweet.widgetScoreCard",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-ScoreCard]",eventNames:{click:"点击事件"},options:{textPosition:"down",value:{value:t,text:"",data:{unit:""},options:{color:"",trend:"",offset:t}}},_setValue:function(t){if(!e.isNull(t)){var i=this;i.options.value=JSON.parse(JSON.stringify(t)),i._clearWidget(),i._createScoreCard(),i._doLayout()}},_getValue:function(){var e=this,t=e.options;return t.value},_render:function(e){e&&!this.rendered&&(this.renderEl||this._createRenderEl(e),this.cardEl.appendTo(this.renderEl),this.rendered=!0)},_createSweetWidget:function(){var t=this,i=t.options,a=i.width;t.cardEl=e("<div>").addClass(l).addClass(i.widgetClass).attr("id",t.options.id).css("width",a),t._createScoreCard()},_createScoreCard:function(){var n=this,r=n.options.value,l=r.options,d=r.value,m=n.options.textPosition,v=r.data;"up"===m&&e.isNotNull(r.text)&&(n.titleEl=e("<div>").appendTo(n.cardEl).text(r.text).attr("title",r.text).addClass(o)),e.isUndefined(d)||(n._addValueEl(),n.numEl=e("<span>").appendTo(n.valueEl),""!==d?(n.numEl.text(d).addClass(s),e.isNotNull(l)&&e.isNotNull(l.color)?n.numEl.addClass(f[l.color]):n.numEl.addClass(f[Sweet.constants.numColor.GREEN])):n.numEl.text(Sweet.constants.scoreCard.NO_VALUE).addClass(u)),e.isNotNull(v)&&e.isNotNull(v.unit)&&(n._addValueEl(),n.unitEl=e("<span>").appendTo(n.valueEl).text(v.unit).addClass(i)),e.isNotNull(l)&&(l.offset!==t&&(n._addOffsetEl(),n.diffNumEl=e("<span>").appendTo(n.offsetEl),""!==l.offset?n.diffNumEl.text(l.offset).addClass(a):n.diffNumEl.text(Sweet.constants.scoreCard.NO_VALUE).addClass(p)),e.isNotNull(l.trend)&&(n._addOffsetEl(),n.iconEl=e("<span>").appendTo(n.offsetEl).addClass(g[l.trend]),l.offset!==t?n.iconEl.addClass(c):n.iconEl.addClass(h))),"down"===m&&e.isNotNull(r.text)&&(n.titleEl=e("<div>").appendTo(n.cardEl).text(r.text).attr("title",r.text).addClass(o))},_doLayout:function(){var t=this,i=t.options,a=0,n=0,o=0,l=0,s=0,d=0,c=0,h=0,u=0,p=0,f=0,g=0,m=0,v=0,w=0,_=0,C=0,b="",E=0;t.valueEl&&(a=t.valueEl.width()),e.isNotNull(i.value.value)&&(d=t.numEl.width()),e.isNotNull(i.value.data)&&e.isNotNull(i.value.data.unit)&&(c=t.unitEl.width()),d+c>a&&(v=a-c,w=t.numEl.text(),_=w.length,C=Math.floor(_*v/d-Sweet.constants.scoreCard.CHAR_NUM),b=w.substr(0,C)+"...",t.numEl.attr("title",w).text(b)),e.isNotNull(i.value.text)&&(h=t.titleEl.height(),u=t.titleEl.text(),p=t.titleEl.width()),f=u.length,g=Sweet.constants.scoreCard.ROW*t.cardEl.width()*f/p,e.isNotNull(i.value.text)&&(t.titleEl.addClass(r),m=t.titleEl.height()),m>Sweet.constants.scoreCard.ROW*h&&(E=u.substr(0,g-10)+"...",e.isNotNull(i.value.text)&&(t.titleEl.text(E).attr("title",u),m=t.titleEl.height())),e.isNotNull(i.value.text)&&(s=t.titleEl.outerHeight()),t.offsetEl&&(l=t.offsetEl.outerHeight()),t.valueEl&&(o=t.valueEl.outerHeight()),n=s+l+o,t.cardEl.css("height",n)},_addValueEl:function(){var t=this;t.valueEl||(t.valueEl=e("<div>").appendTo(t.cardEl).addClass(d))},_addOffsetEl:function(){var t=this;t.offsetEl||(t.offsetEl=e("<div>").appendTo(t.cardEl).addClass(n))},_clearWidget:function(){var e=this;e.cardEl.empty(),e.valueEl=null,e.offsetEl=null},_getWidth:function(){var e=this;return e.cardEl.externalWidth()},_getHeight:function(){var e=this;return e.cardEl.externalHeight()},_setWidth:function(e){var t=this;t.cardEl.externalWidth(e)},_setHeight:function(e){var t=this;t.cardEl.externalHeight(e)},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,r){i===e&&(o._info(i+" event occured!"),n=r.call(null,t,a))}),n},_afterCreateSweetWidget:function(){var e=this;e.options,e.cardEl.bind("click",function(){e._triggerHandler(null,"click",e.getValue())})}}),Sweet.ScoreCard=e.sweet.widgetScoreCard}(jQuery),function(e){var t="sweet-numcard-panel",i="sweet-numcard-body",a="sweet-numcard-label-panel",n="sweet-numcard-label-text",o="sweet-numcard-body-active",r="sweet-numcard-num-body",l="sweet-numcard-num-panel",s="sweet-numcard-num-item",d="sweet-numcard-title",c="sweet-numcard-titledata",h="click",u="value",p="text",f="titleData",g="color",m="tip",v="textAlign",w="label",_="isLabelTip",C="isLabelSymbol",b="labelWidth",E=":",y={0:["#f17268","#ec3b2d"],1:["#51bd51","#0ca20c"],2:["#F5F32B","#F6DC04"]},x={value:[[{value:"",color:"0"},{value:"",color:"1"}],[{value:"",color:"0"},{value:"",color:"1"}]],text:"",textAlign:"top",label:"",isLabelTip:!1,isLabelSymbol:!1,labelWidth:0},T={labelWidth:80,itemMargin:5,paddingLeft:10};e.widget("sweet.widgetNumCard",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-NumCard]",eventNames:{click:"单击事件"},options:{width:262,height:105,data:{value:[{value:"",color:"0"},{value:"",color:"1"}],text:"",tip:null,textAlign:"top",label:[],labelWidth:T.labelWidth,isLabelTip:!1,isLabelSymbol:!1},color:y},setData:function(e){var t=this;t.options.data=e,t._createNumCard(e),t._doLayout()},setValue:function(e){var t=this;t.setData(e)},getValue:function(){var t=this;return e.objClone(t.options.data)},getData:function(){var t=this;return e.objClone(t.options.data)},active:function(e){var t=this;e=1==e||"true"==e?!0:!1,t.numCardEl&&(e?(t.numCardEl.addClass(o),t._triggerHandler(null,h,{me:t,data:t.getValue()})):t.numCardEl.removeClass(o))},isActive:function(){var e=this;return e.numCardEl?e.numCardEl.hasClass(o):!1},setColor:function(e){var t=this;e||(e={}),t.options.color=e,t.setData(t.options.data)},_getWidth:function(){var e=this;return e.options.width},_getHeight:function(){var e=this;return e.options.height},_setWidth:function(e){var t=this;t.options.width=e},_setHeight:function(e){var t=this;t.options.height=e},_setWH:function(e,t){var i=this;i.options.width=e,i.options.height=t},_render:function(e){var t=this;return t._super(e)?(t.numCardPanelEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_createSweetWidget:function(){var e=this;e._createNumCard(e.options.data)},_initData:function(t){var i;return(i=e.objClone(t))?(i[p]||(i[p]=""),(!i[u]||0>=i[u].length)&&(i[u]=x[u]),i[w]||(i[w]=[]),i[v]=i[v]&&"BOTTOM"==i[v].toUpperCase()?"bottom":"top",i[_]=!i[_]||1!=i[_]&&"true"!=i[_]?!1:!0,i[C]=!i[C]||1!=i[C]&&"true"!=i[C]?!1:!0,i[b]=parseInt(i[b]),isNaN(i[b])&&(i[b]=T.labelWidth),i):i=x},_createNumCard:function(o){var l,s,g=this;if(g.labelTextEls=[],g.itemEls=[],g.numCardPanelEl&&g.numCardPanelEl.remove(),g.data=l=g._initData(o),g.numCardPanelEl=e("<div>").attr("id",g.options.id).addClass(t),g.options.widgetClass&&""!=g.options.widgetClass&&g.numCardPanelEl.addClass(g.options.widgetClass),g.numLabelEl=e("<div>").addClass(a).appendTo(g.numCardPanelEl),l[w]&&l[w].length>0)for(var b=0;l[w].length>b;b++)s=e("<span>").addClass(n).addClass(n+"-00"+(b+1)).appendTo(g.numLabelEl),l[C]?s.text(l[w][b]+E):s.text(l[w][b]),l[_]&&s.attr("title",l[w][b]?l[w][b]:""),g.labelTextEls.push(s);g.numCardEl=e("<div>").addClass(i).bind(h,{me:g,data:g.getValue()},g._onClick).appendTo(g.numCardPanelEl),l[m]&&g.numCardEl.attr("title",l[m]),g.numTitlelEl=e("<div>").text(l[p]).addClass(d),g.numBodyEl=e("<div>").addClass(r),"bottom"==l[v]?(g.numBodyEl.appendTo(g.numCardEl),l[f]!==undefined&&(g.numTitleDataEl=e("<div>").text(l[f]).addClass(c),g.numTitleDataEl.appendTo(g.numCardEl)),g.numTitlelEl.appendTo(g.numCardEl)):(g.numTitlelEl.appendTo(g.numCardEl),l[f]!==undefined&&(g.numTitleDataEl=e("<div>").text(l[f]).addClass(c),g.numTitleDataEl.appendTo(g.numCardEl)),g.numBodyEl.appendTo(g.numCardEl));for(var b=0;l[u].length>b;b++)g.itemEls.push(g._createItemEls(l[u][b]));g.rendered&&g.numCardPanelEl.appendTo(g.renderEl)},_onClick:function(e){var t=e.data.me;t.active(!0)},_createItemEls:function(t){var i,a,n,o,r,d,c,h,p=this,f=p.options.color,v=[];f||(f=y),h=e("<div>").addClass(l).appendTo(p.numBodyEl);for(var w=0;t.length>w;w++)i=""+t[w][u]||"",a=t[w][g]||""+w,d=t[w][m]||i,c=e("<div>").addClass(s).text(i).attr("title",d),r=f[a],r&&r.length>0&&(n=r[0],o=r[1]?r[1]:n,c.css({background:"-moz-linear-gradient(center top , "+n+", "+o+") repeat scroll 0 0 transparent"}),c.css({background:"-webkit-linear-gradient(top , "+n+", "+o+") repeat scroll 0 0 transparent"})),c.addClass(s).appendTo(h),v.push(c);return v},_doLayout:function(){var e,t,i,a,n=this,o=n.data,r=n.itemEls,l=parseInt(n.options.width),s=parseInt(n.options.height),d=n.numTitlelEl.externalHeight(),c=0,h=0,u=0,p=2,f=!0;if(o&&(h=o[b]?o[b]:0,"bottom"==o[v]&&(f=!1)),n.numTitleDataEl&&(c=n.numTitleDataEl.externalHeight()),u=i=s-d-c,n.labelTextEls&&n.labelTextEls.length>0?(n.numLabelEl.width(h).height(u),f?(n.numLabelEl.css({"padding-top":d+c}),n.numBodyEl.css({"padding-bottom":T.itemMargin})):(n.numLabelEl.css({"padding-top":2*T.itemMargin}),n.numBodyEl.css({"padding-top":T.itemMargin}))):n.numLabelEl.width(0).height(0),h=n.numLabelEl.externalWidth(),n.numCardPanelEl.width(l).height(s),a=l-h-p,n.numCardEl.width(a-1).height(s),r&&r.length>0){r[0]&&r[0].length>0&&(e=Math.floor((a-2*T.paddingLeft)/r[0].length)),t=Math.floor((i-r.length*T.itemMargin-T.itemMargin)/r.length);for(var g=0;r.length>g;g++)if(r[g]&&r[g].length>0)for(var m=0;r[g].length>m;m++)f?r[g][m].width(e).height(t).css({"line-height":t+"px","margin-bottom":T.itemMargin+"px"}):r[g][m].width(e).height(t).css({"line-height":t+"px","margin-top":T.itemMargin+"px"})}if(n.labelTextEls&&n.labelTextEls.length>0)for(var g=0;n.labelTextEls.length>g;g++)n.labelTextEls[g].height(t).css({"line-height":t+"px"})}}),Sweet.NumCard=e.sweet.widgetNumCard}(jQuery),$(function(e,t){"use strict";var i=10,a="sweet-slider-stick",n="sweet-slider-container",o="sweet-slider",r="sweet-tick-div",l="sweet-slider-tick",s="sweet-text-div",d="sweet-text-content",c="sweet-slider-block",h="sweet-all-move-slider",u="sweet-all-move-real-slider";e.widget("sweet.widgetSlider",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-slider]:",eventNames:{clickSlider:"点击Slider的事件",move:"滑块拖动事件"},type:"slider",options:{height:60,width:"100%",data:[],shadowHeight:300,offsetTop:0,step:1,interval:900,dayCount:1},getData:function(){return JSON.parse(JSON.stringify(this.options.data||[]))},setData:function(i){var a=this;!e.isNull(i)&&e.isArray(i)&&(a.options.data=JSON.parse(JSON.stringify(i)),a.textEl.empty(),a.tickEl.empty(),a._createTicks(),a.containerEl.css("left",a.sliderEl.width()-a.blockWidth*a.intervalCount+"px"),a.moveAllEl.scrollLeft(a.moveAllEl.get(0).scrollWidth),a.blockEl.css("left","0px"),a._triggerHandler(null,"clickSlider",{left:0,width:a.blockWidth,times:a.options.data,startTime:a.options.data[1],endTime:a.options.data[0]}),a.preStart=t)},getPosition:function(){var e=this;return{left:parseFloat(e.containerEl.css("left"))}},getTimeRangPos:function(){return{left:this.preStart,width:this.blockWidth}},_createSweetWidget:function(){var t=this,i=t.options,a=i.id;t.ticks=[],t.tickHeight=4,t.stickHeight=15,t.textHeight=i.height-25-t.stickHeight-t.tickHeight,t.sliderHeight=i.height,i.width=i.width-10,t.sliderId=a,t.sliderEl=e("<div>").attr({id:a}).height(t.sliderHeight).width(i.width).addClass(o),t._createStick(),t._createBlock(),t._createTicks()},_createStick:function(){var t=this,o=0,l=t.options;t.blockWidth=20,t.intervalCount=12*l.dayCount,t.count=8,1===l.step&&900===l.interval&&(t.blockWidth=(i+1)*t.count),t.realWidth=o=t.blockWidth*t.intervalCount,t.containerEl=e("<div>").attr({id:l.id+"-container"}).width(o).addClass(n).appendTo(t.sliderEl).css("left",t.sliderEl.width()-o+"px"),t.textEl=e("<div>").height(t.textHeight).width(o).addClass(s).appendTo(t.containerEl),t.tickEl=e("<div>").height(t.tickHeight).width(o).addClass(r).appendTo(t.containerEl),t.stickEl=e("<div>").attr({id:t.sliderId+"-stick"}).height(t.stickHeight).width(o).addClass(a).appendTo(t.containerEl).css("cursor","pointer").bind("click",function(e){var i=e.pageX,a=o-Math.abs(t.stickEl.offset().left),n=a-i,r=Math.ceil(n/t.blockWidth),s=(r-1)*t.blockWidth,d=-s;s!==t.preStart&&(t.blockEl.css("left",d+"px"),t._triggerHandler(e,"clickSlider",{left:d,width:t.blockWidth,times:l.data,startTime:l.data[r],endTime:l.data[r-1]})),t.preStart=s})},getMoveBarPos:function(){return this.moveBarPos},_createBlock:function(){var t=this,i=t.options;t.blockEl=e("<div>").addClass(c).attr({id:t.sliderId+"-block"}).height(t.stickHeight).width(t.blockWidth).appendTo(t.stickEl),t.moveAllEl=e("<div>").width(i.width).addClass(h).scroll(function(i){var a=e(i.target).scrollLeft(),n={left:-a};t._triggerHandler(i,"move",n),t.moveBarPos=n,t.containerEl.css("left",-a)}).appendTo(t.sliderEl),t.moveRealEl=e("<div>").width(t.realWidth).addClass(u).appendTo(t.moveAllEl)},_createTicks:function(){var t,i,a=this,n=a.options,o=n.data,r=0;for(a.textDivs=[],a.curText=[],r=0;a.intervalCount>r;r++)i=e("<div>").attr({id:r+"-text"}).addClass(d).text(o[r]).height(a.textHeight).width(a.blockWidth).appendTo(a.textEl),t=e("<div>").attr({id:r+"-tick"}).addClass(l).height(a.tickHeight).width(a.blockWidth-1).appendTo(a.tickEl)},_render:function(t){var i=this;e.isNull(t)||i.rendered||(i.renderEl||i._createRenderEl(t),i.sliderEl.appendTo(i.renderEl),i.options.renderTo=t,i.rendered=!0,i.moveAllEl.scrollLeft(i.moveAllEl.get(0).scrollWidth))}}),Sweet.Slider=e.sweet.widgetSlider
}(jQuery)),function(e){var t="sweet-stateitem-body",i="sweet-stateitem-header",a="sweet-stateitem-header-text",n="sweet-stateitem-header-add",o="sweet-stateitem-list-body",r="sweet-stateitem-list-ul",l="sweet-stateitem-list-item",s="sweet-stateitem-list-item-text",d="sweet-stateitem-list-error",c="sweet-stateitem-list-delete",h="sweet-stateitem-list-check",u="sweet-stateitem-list-item-selected",p="sweet-stateitem-list-item-checked",f="select",g="beforeadd",m="beforedelete",v="delete",w="beforetextchange",_="textchange",C=Sweet.core.i18n.stateItem,b=1;e.widget("sweet.widgetStateItem",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-StateItem]",eventNames:{select:"选中事件",beforedelete:"删除前事件","delete":"删除事件",beforetextchange:"选项文本发生变化前事件",textchange:"选项文本发生变化事件"},options:{data:[],maxCount:-1,headerText:C.headerText,tipInfo:{add:C.plus,"delete":C["delete"],check:C.check}},setData:function(e){var t=this;e=e||[],t.stateItemsUL&&t.stateItemsUL.find("li").remove(),t.options.data=e,t._setData(e)},setValue:function(e){var t=this;t.setData(e)},getValue:function(){var t,i=this,a=[];if(i.stateItemsUL){t=i.stateItemsUL.find("li");for(var n=0;t.length>n;n++)a.push(e(t[n]).data("data"));return e.objClone(a)}},getData:function(){var e=this;return e.getValue()},_getWidth:function(){return this.stateItemEl.externalWidth()},_getHeight:function(){return this.stateItemEl.externalHeight()},_setWidth:function(e){this.stateItemEl.externalWidth(e)},_setHeight:function(e){this.stateItemEl.externalHeight(e)},_setWH:function(e,t){var i=this;i.stateItemEl.externalWidth(e),i.stateItemEl.externalHeight(t)},_render:function(e){var t=this;return t._super(e)?(t.stateItemEl.appendTo(t.renderEl),t.rendered=!0,!0):!1},_createSweetWidget:function(){var l,s=this;s.options.data=s.options.data||[],s.selected=null,s.checked=null,s.maxCount=-1,s.options.maxCount&&s.options.maxCount>0&&(s.maxCount=parseInt(s.options.maxCount)),s.stateItemEl=e("<div>").addClass(t).attr("id",s.options.id),s.options.widgetClass&&""!=s.options.widgetClass&&s.stateItemEl.addClass(s.options.widgetClass),s.headerEl=e("<div>").addClass(i).appendTo(s.stateItemEl),e("<span>").text(s.options.headerText).attr("title",s.options.headerText).addClass(a).appendTo(s.headerEl),s.addEl=e("<span>").attr("title",s.options.tipInfo.add).addClass(n).bind("click",{me:s},s._addStateItem).appendTo(s.headerEl),l=e("<div>").addClass(o).appendTo(s.stateItemEl),s.stateItemsUL=e("<ul>").addClass(r).appendTo(l),s._setData(s.options.data)},_setData:function(t){var i,a=this;t=t||[],a.selected=null,a.checked=null,i=e.objClone(t);for(var n=0;i.length>n;n++)a._createStateItem(i[n]);a.addEl&&a.maxCount>-1&&i.length>=a.maxCount&&a.addEl.hide(),a.addEl&&a.maxCount>-1&&i.length<a.maxCount&&a.addEl.show(),a.selected&&a._doSelected(a.selected)},_createStateItem:function(t){var i,a,n,o,r,u=this;if(!e.isEmptyObject(t))return i=e("<li>").addClass(l).data("data",t).bind("click",{me:u},u._onClick).bind("dblclick",{me:u},u._onDbClick).appendTo(u.stateItemsUL),a=e("<span>").text(t.text).attr("title",t.text).addClass(s).appendTo(i),r=e("<span>").attr({name:"error"}).addClass(d).appendTo(i),n=e("<span>").attr({name:"deleted",title:u.options.tipInfo["delete"]}).addClass(c).appendTo(i),o=e("<span>").attr({name:"checked",title:u.options.tipInfo.check}).addClass(h).appendTo(i),t.selected&&(u.selected=i),t.checked&&(i.addClass(p),u.checked=i),i},_addStateItem:function(e){var t,i,a=e.data.me,n=b++;t=a._triggerHandler(a,g),"false"!==t&&!1!==t&&(i=a._createStateItem({value:a.options.id+"-stateitem-"+n,text:C.stateText+n}),a._doSelected(i),a.addEl&&a.maxCount>-1&&a.stateItemsUL&&a.stateItemsUL.find("li").length>=a.maxCount&&a.addEl.hide())},_onDbClick:function(t){var i,a,n,o=t.data.me,r=e(t.target);"deleted"!=r.attr("name")&&"checked"!=r.attr("name")&&(r.hasClass(l)||!r.hasClass(s)?(a=r,r=r.find("."+s)):a=r.parent("li"),i=r.text(),r.text(""),n=e("<input type='text'>").attr({value:i}).css({width:"100%",height:"22px"}),n.appendTo(r).bind("blur",{me:o,liEl:a,el:r,self:n,oldText:i},o._doEdit).bind("focus",{me:o,liEl:a,el:r,self:n,oldText:i},o._doInputFocus),n.focus())},_doInputFocus:function(e){var t;e.data.me,e.data.self&&(t=e.data.self.get(0),t&&(t.selectionStart=t.value.length))},_doEdit:function(t){var i,a,n,o,r=t.data.me,l=!1;a=t.data.oldText,n=t.data.self.val(),o=t.data.liEl,i=o.data("data")||{},a!=n&&(l=r._triggerHandler({data:e.objClone(i),text:n,oldText:a},w,r),!1===l||"false"===l?(l=!1,n=a):(l=!0,i.text=n,t.data.el.attr("title",n))),t.data.self.remove(),t.data.el.text(n),l&&r._triggerHandler({data:e.objClone(i),text:n,oldText:a},_,r)},_onClick:function(t){var i=t.data.me,a=e(t.target);switch(a.attr("name")){case"deleted":i._doDeleted(a);break;case"checked":i._doChecked(a);break;default:return i._doSelected(a),undefined}},_doDeleted:function(t){var i,a,n,o,r,l,s=this;t&&(o=t.parent("li"),i=o.data("data"),r=i.select?!0:!1,l=s._triggerHandler({data:e.objClone(i),selected:r},m,s),"false"!==l&&!1!==l&&(s.selected&&(a=s.selected.data("data"),i&&a&&(a.value==i.value||a.text==i.text)&&(s.selected=null)),s.checked&&(n=s.checked.data("data"),i&&n&&(n.value==i.value||n.text==i.text)&&(s.checked=null)),o&&o.remove(),s.addEl&&s.maxCount>-1&&s.stateItemsUL&&s.maxCount>s.stateItemsUL.find("li").length&&s.addEl.show(),s._triggerHandler({data:e.objClone(i),selected:r},v,s)))},isValidate:function(e){var t,i,a=this;return t=a._doFindLi(e),t&&(i=t.find("span[name='error']")),i?"block"==i.css("display")&&"error"==i.attr("tiptype")?!1:!0:!1},doValidate:function(e){var t,i,a=this;t=a._doFindLi(e),t&&(i=t.find("span[name='error']")),i&&(!1===e.checked||"false"===e.checked?(i.attr({tiptype:"error"}),e.tip&&i.attr({title:e.tip}),i.css({display:"block"})):(i.removeAttr("tiptype"),i.removeAttr("title"),i.css({display:"none"})))},doChecked:function(e){var t,i=this;t=i._doFindLi(e),t&&i._doChecked(t.find("span[name='checked']"))},_doChecked:function(t){var i,a,n=this;t&&(a=t.parent("li"),n.checked&&(i=n.checked.data("data"),e.isEmptyObject(i)||delete i.checked,n.checked.removeClass(p)),i=a.data("data"),i&&(i.checked=!0),n.checked=a,a.addClass(p))},doSelected:function(e){var t,i=this;t=i._doFindLi(e),t&&i._doSelected(t)},_doSelected:function(t){var i,a=this;t&&((!t.hasClass(l)||t.hasClass(s))&&(t=t.parent("li")),a.selected&&(i=a.selected.data("data"),e.isEmptyObject(i)||delete i.selected,a.selected.removeClass(u)),i=t.data("data"),i&&(i.selected=!0),a.selected=t,t.addClass(u),a._triggerHandler(e.objClone(t.data("data")),f,a))},_doFindLi:function(t){var t,i,a,n=this;if(!n.stateItemsUL)return null;if(e.isEmptyObject(t)||!t.value)return null;i=n.stateItemsUL.find("li");for(var o=0;i.length>o;o++)if(a=e(i[o]).data("data"),a&&t.value==a.value)return e(i[o]);return null},_doLayout:function(){var e,t,i=this,n=i.stateItemEl.width(),o=i.stateItemEl.height(),r=i.headerEl.externalHeight(),l=75;i.headerEl&&(e=i.headerEl.find("."+a),e&&e.length>0&&e.width(n-l)),i.stateItemsUL&&(i.stateItemsUL.height(o-r),t=i.stateItemsUL.find("li ."+s),t&&t.length>0&&t.width(n-l))}}),Sweet.StateItem=e.sweet.widgetStateItem}(jQuery),$(function(e){"use strict";var t="sweet-progress-bg",i="sweet-progress",a="sweet-progress-span";e.widget("sweet.widgetProgressBar",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-ProgressBar]:",eventNames:{change:"进度条改变事件"},type:"ProgressBar",options:{width:"100%",value:0,progressText:""},setValue:function(e,t){var i=this,a=i.options,n=a.value;i._check(e)&&n!==e&&(a.value=e,i._updateProgressData(t),i._triggerHandler(null,"change",{preData:n,curData:e}))},_check:function(t){return e.isNull(t)||!e.isNumeric(t)?!1:0>t||t>100?!1:!0},_updateProgressData:function(t){var i=this,a=i.options,n=a.value+"%",o=e.isNotNull(t)?t:n;i.progressEl.css("width",n),i.spanEl.text(o)},_createSweetWidget:function(){var n=this,o=n.options,r=o.value,l=r+"%",s=e.isNotNull(o.progressText)?o.progressText:l;n._check(r)&&(n.pbarEl=e("<div>").attr("id",o.id).width(o.width).height(20).addClass(t),n.spanEl=e("<span>").text(s).addClass(a).appendTo(n.pbarEl),n.progressEl=e("<div>").attr("id",o.id+"-progress").css("width",l).addClass(i).appendTo(n.pbarEl))},_doLayout:function(){},_getWidgetEl:function(e){return e?this.pbarEl[0]:this.pbarEl},_render:function(t){var i=this;e.isNull(t)||i.rendered||(i.renderEl||i._createRenderEl(t),i.pbarEl.appendTo(i.renderEl),i.options.renderTo=t,i.rendered=!0)}}),Sweet.ProgressBar=e.sweet.widgetProgressBar}(jQuery)),function(e){Sweet.Base=Class.extend({sweetWidgetName:"[Sweet-Base]",addListener:function(t){this.handlers=e.extend({},this.handlers||{},t)},removeListener:function(t){e.isNull(t)?this.handlers=null:delete this.handlers[t]},destroy:function(){this.removeListener(),this._destroyWidget();for(var e in this)this.hasOwnProperty(e)&&(this[e]=null)},_destroyWidget:e.noop,_error:function(t){sweetDebug&&e.error("[ERROR]"+this.sweetWidgetName+t)},_info:function(t){sweetDebug&&Sweet.constants.logLevel.INFO===Sweet.logLevel&&e.log("[INFO]"+this.sweetWidgetName+t)}})}(jQuery),function(e){var t="beforeRead",i="afterRead";Sweet.Reader=Sweet.Base.extend({sweetWidgetName:"[Sweet-Reader]",init:function(){},read:function(t){var i=this._beforeRead(t),a=e.objClone(i);return a=this._parse(a),this._afterRead(e.objClone(a)),a},_beforeRead:function(i){var a=i;if(this.handlers){var n=this.handlers[t];n&&e.isFunction(n)&&(a=n.call(this,i))}return a},_afterRead:function(t){if(this.handlers){var a=this.handlers[i];a&&e.isFunction(a)&&a.call(null,t)}},_parse:function(e){return e}})}(jQuery),function(e){Sweet.Reader.JsonReader=Sweet.Reader.extend({sweetWidgetName:"[Sweet-Reader-JsonReader]",init:function(t){e.isNotNull(t)?this.format=t:(this.format={root:"root",data:[{name:"text",mapping:"text"},{name:"value",mapping:"value"},{name:"data",mapping:"data"},{name:"children",mapping:"children",children:!0}]},this.defaultFormat=!0)},_parse:function(t){var i=this;if(e.isNull(t))return this._error("Input data is null."),undefined;if(this.defaultFormat)return t;var a=t[this.format.root],n=[];return i._parseData(a,n),n},_parseData:function(t,i){var a=this;a.format.data&&e.each(t,function(t,n){var o={};e.each(a.format.data,function(t,i){if(i.children&&n[i.mapping]){var r=[];a._parseData(n[i.mapping],r),o[i.name]=r}else e.isNotNull(n[i.mapping])&&(o[i.name]=n[i.mapping])}),i.push(o)})}})}(jQuery),function(e,t){var i="beforeLoad",a="afterLoad",n="application/json;charset=UTF-8";Sweet.Store=Sweet.Base.extend({sweetWidgetName:"[Sweet-Store]",eventNames:{setData:"填充组件值"},init:function(i){e.isNull(i)||(this.baseParams=i.baseParams,this.params=null,this.reader=i.reader,this.url=i.url,this.failCallBack=i.failCallBack,this.loadMask=t!==i.loadMask?i.loadMask:!0,this.contentType=i.contentType||n,this.async=e.isUndefined(i.async)?!0:i.async,this.cache=t!==i.cache?i.cache:!1,this.isRequest=t!==i.isRequest?i.isRequest:!0,this.beforeSend=e.isNull(i.beforeSend)?"":i.beforeSend,this.timeout=e.isNull(i.timeout)?"":i.timeout,this.data=[],this.allData=[],this.handlers={})},clearFilters:e.noop,clearOrders:e.noop,setBaseParams:function(e){this.baseParams=e},_loadRemoteData:function(t,i,a,o){var r,l=this,s={};t&&(l.params=t),r=e.extend({},l.baseParams,l.params),!e.isNull(l.beforeSend)&&e.isFunction(l.beforeSend)&&(r=l.beforeSend(r)),s={url:l.url,async:l.async,loadMask:l.loadMask,data:n===l.contentType?JSON.stringify(r):r,contentType:l.contentType,success:function(e){l._pretreatmentData(e,i,a),l._callBack(a,o)},error:function(t,i,a){l.failCallBack&&e.isFunction(l.failCallBack)&&l.failCallBack(t,i,a)}},e.isNull(l.timeout)||(s.timeout=l.timeout),Sweet.Ajax.request(s)},_pretreatmentData:function(t,i){var a=this,n=a.reader.read(t),o=a._dealForList(n);a.allData=i?e.isPlainObject(a.allData)?a.allData.data.concat(o):a.allData.concat(o):o,a.data=n},_dealForList:function(t){return e.isNull(t)?[]:e.isPlainObject(t)?t.data:t},_returnForList:function(t){var i=this;return e.isPlainObject(i.data)?{total:i.data.total,data:t}:t},_callBack:function(e,i,a){var n=this,o=n._dealData();i&&i[0]&&i[0].filter&&(o=i[0].data),n.handlers[e]?(n.handlers.scope.options.expand=i&&i[0].filter?!0:!1,i=t,n.handlers[e].call(n.handlers.scope,o,i)):n.handlers.setData&&n.handlers.setData.call(n.handlers.scope,o,i,a),n._afterLoad()},_dealData:function(){var t,i=this;if(i.cache){var a,n,o={},r=i._dealForList(i.data);i.params&&!e.isUndefined(i.params.start)?o=i.params:i.baseParams&&!e.isUndefined(i.baseParams.start)&&(o=i.baseParams),a=o.start||0,n=o.limit||r.length,t=r.slice(a,a+n)}else t=i._dealForList(i.data);return i._returnForList(t)},loadRecords:function(e,t,i,a){var n=this;n.params=e,n.cache?n._callBack(i,a,t):n.load(e,t,i,a)},loadData:function(e,t,i,a,n){var o=this;n||o._resetParamStart(),o._pretreatmentData(e,t),o._callBack(i,a,t)},load:function(e,t,i,a){var n=this;n._beforeLoad(),n._loadRemoteData(e,t,i,a)},reload:function(){this._resetParamStart(),this._beforeLoad(),this._loadRemoteData(this.params)},getData:function(){return this.allData?e.objClone(this.allData):null},removeData:function(t){var i=this;e.isNull(t)?i.allData=[]:e.each(i.allData,function(e,a){a&&a.value===t.value&&i.allData.splice(e,1)})},filter:function(t,i,a,n){var o,r,l,s=this,d=!0;a=a||!1,s._beforeLoad(),e.isNull(n)&&(n=e.objClone(s.allData)),e.each(n,function(d,c){if(!e.isNull(c))if(c.children&&c.children.length>0){if(a){if(o=!1,r=c.text,o=i.test(r))return;s.filter(t,i,a,c.children)}else s.filter(t,i,a,c.children);l=!1,e.each(c.children,function(t,i){e.isNull(i)||(l=!0)}),l||delete n[d]}else o=!1,r=c.text,o=i.test(r),o||delete n[d]}),s.data=n,s._callBack("setData",[{data:e.deleteUndefinedData(n),filter:d}])},sort:function(t,i){this._beforeLoad();var a=this,n=[],o=i||Sweet.constants.sortType.ASC;if("string"===e.type(t))n.push({key:t,order:o});else{if("array"!==e.type(t))throw Error("Store.sort() Unsupported type!");n=t}a._resetParamStart(),a.cache&&a.data.sort(e.objSort(t,o)),a.loadRecords({orders:n})},_beforeLoad:function(){if(this.handlers){var t=this.handlers[i];t&&e.isFunction(t)&&t.call(this)}},_afterLoad:function(){if(this.handlers){var t=this.handlers[a];t&&e.isFunction(t)&&t.call(this)}},_resetParams:function(e){var t=this;t.params&&t.params.start&&t.params.limit&&(t.params.start=e.start,t.params.limit=e.limit)},_resetParamStart:function(){var e=this;e.params?e.params.start&&(e.params.start=0):e.baseParams&&e.baseParams.start&&(e.baseParams.start=0)}})}(jQuery),function(e){var t=Sweet.constants.symbol;Sweet.Store.GridStore=Sweet.Store.extend({sweetWidgetName:"[Sweet-Store-GridStore]",setCurrentPage:function(e){this._currentPage=e},getCurrentData:function(){var t=this;return t.data&&t.data.data?e.objClone(t.data.data):null},load:function(t,i,a,n){var o,r,l=this;l._beforeLoad(),l.cache&&!l.isRequest?(l._resetParams(t),e.isNotNull(t)&&(o=t.filter,r=t.order),e.isNotNull(o)&&o.length>0?(l.filter(t),l.curFilters=o):(l.data.data=e.objClone(l.allData.data),l.curFilters=[]),e.isNotNull(r)&&r.length>0?(l.sort(t),l.curOrders=r):l.curOrders=[],l.loadRecords(t)):(l.cache&&(l.isRequest=!1),l._loadRemoteData(t,i,a,n))},clearFilters:function(){var e=this;e.curFilters=[]},clearOrders:function(){var e=this;e.curOrders=[]},_setPage:function(t){var i=this;e.extend(i.baseParams,{start:t.start,limit:t.limit})},_setDataPage:function(t){var i=this;e.extend(i.data.page,t),i._setPage(t)},setDataPage:function(e){var t=this;t._setDataPage(e)},_dealData:function(){var t=this;if(t.cache){var i,a,n,o,r={},l=t.data.data||[];return t.data.page&&(t.data.page.total=l.length),delete t.data.data,o=e.objClone(t.data),t.params?r=t.params:t.baseParams&&(r=t.baseParams),i=r.start||0,a=r.limit||l.length,t._currentPage&&1===t._currentPage?(i=0,t._currentPage=null,o.page||(o.page={}),o.page.currentPage=1):o.page&&1===o.page.currentPage&&(i=0),n=l.slice(i,i+a),o.data=n,t.data.data=l,o}return t.data},_pretreatmentData:function(t,i,a){var n=this,o=n.reader.read(t)||[];if(n._saveAllData(o,i),n._saveCurrentData(o,i,a),i){var r=n.curFilters,l=n.curOrders;e.isNotNull(r)&&r.length>0&&n.filter({filter:r}),e.isNotNull(l)&&l.length>0&&n.sort({order:l})}},_saveAllData:function(t,i){var a=this,n=JSON.parse(JSON.stringify(t));i?e.isPlainObject(a.allData)?a.allData.data=e.isPlainObject(n)?a.allData.data.concat(n.data):a.allData.data.concat(n):a.allData=e.isPlainObject(n)?a.allData.concat(n.data):a.allData.concat(n):a.allData=n},_saveCurrentData:function(t,i,a){var n=this,o=t;i&&"setTreeData"!==a?e.isPlainObject(n.data)?n.data.data=e.isPlainObject(o)?n.data.data.concat(o.data):n.data.data.concat(o):n.data=e.isPlainObject(o)?n.data.concat(o.data):n.data.concat(o):n.data=o},filter:function(t){this._beforeLoad();var i,a,n,o,r,l=this,s=0,d=0,c=t.filter,h=Sweet.constants.dataType,u=l.allData.data||[];if(l.cache){for(0===u.length&&(u=l.data.data||[]),s=0;c.length>s;s++)switch(o=c[s],n=o.name,i=o.type,a=o.value,r=o.text,i){case h.LIST:if(e.isNotNull(r)){var p=[];for(d=0;u.length>d;d++){var f=u[d][n];e.isPlainObject(f)&&(f=f.text),l._filterList(f,r.value)&&p.push(u[d])}u=p}break;case h.STRING:if(e.isNotNull(a)){var p=[];for(d=0;u.length>d;d++){var f=u[d][n];e.isPlainObject(f)&&(f=f.text),l._filterString(f,a.symbol,a.value)&&p.push(u[d])}u=p}break;case h.NUMBER:if(e.isNotNull(a)){var p=[];for(d=0;u.length>d;d++){var f=u[d][n];e.isPlainObject(f)&&(f=f.text),l._filterNumber(f,a)&&p.push(u[d])}u=p}break;case h.DATE:if(e.isNotNull(a)){var p=[];for(d=0;u.length>d;d++){var f=u[d][n];e.isPlainObject(f)&&(f=f.text),l._filterDate(f,a)&&p.push(u[d])}u=p}break;default:l._error("Unsupported filter type ["+i+"].")}l.data.data=u,l.data.page&&(l.setCurrentPage(1),l.data.page.total=u.length,l.data.page.currentPage=1)}},sort:function(t){this._beforeLoad();var i,a=this,n=t.order,o=e.isNotNull(n)?n.length:0,r=a.data.data||[];a.cache&&o>0&&(1===o?(i=n[0],"number"===i.dataType?r.sort(e.objNumberSort(i.name,i.order)):r.sort(e.objSort(i.name,i.order))):r.sort(e.objMultiSort(n)),a.data.data=r||[])},_filterList:function(t,i){function a(e,t){for(var i=0;t.length>i;i++)if(e===t[i])return!0;return!1}var n;return e.isPlainObject(t)&&(n=t.value),a(t,i)},_filterString:function(i,a,n){var o,r=!1;switch(a){case t.EQUAL:i===n&&(r=!0);break;case t.LIKE:o=RegExp(e.regExp.escape(n),"i"),e.isNotNull(i)&&o.test(i)&&(r=!0);break;case t.NOTEQUAL:i!==n&&(r=!0);break;case t.EQNULL:e.isNull(i)&&(r=!0);break;case t.NOTNULL:e.isNotNull(i)&&(r=!0);break;default:}return r},_filterNumber:function(e,i){var a=this,n=!1,o=i.length;return"number"!=typeof e&&(e=parseFloat(e),isNaN(e))?!1:(1===o?i[0].symbol===t.EQUAL&&e===Number(i[0].value)?n=!0:i[0].symbol===t.GT&&e>Number(i[0].value)?n=!0:i[0].symbol===t.LT&&Number(i[0].value)>e&&(n=!0):n=a._numberBetween(e,i[0],i[1]),n)},_numberBetween:function(e,i,a){var n,o=this,r=i.symbol,l=(a.symbol,Number(i.value)),s=Number(a.value),d=!1;return t.GT===r&&l>s||t.LT===r&&s>l?(n=o._minMax(l,s),(Number(n[0])>e||e>Number(n[1]))&&(d=!0)):(t.LT===r&&l>s||t.GT===r&&s>l)&&(n=o._minMax(l,s),Number(n[1])>e&&e>Number(n[0])&&(d=!0)),d},_filterDate:function(t,i){var a=this,n=!1,o=a.__getMaxMin(i,"text");return t&&(t=e.date.format(new Date((t+"").replace(/-/g,"/")),"yyyy-MM-dd hh:mm:ss")),o[0]>t&&t>=o[1]&&(n=!0),n},_minMax:function(e,t){return e=Number(e),t=Number(t),e>t?[t,e]:[e,t]},__getMaxMin:function(e,i){var a,n;return i=i||"value",t.GT===e[0].symbol?(n=e[0][i],a=e[1][i]):(a=e[0][i],n=e[1][i]),[a,n]}})}(jQuery),function(e){Sweet.Store.ChartStore=Sweet.Store.extend({sweetWidgetName:"[Sweet-Store-ChartStore]",_pretreatmentData:function(t,i){var a=this,n=a.reader.read(t)||[];a.allData=i?a.data.concat(n):n,a.data=e.objClone(n)},_dealData:function(){var t,i=this;if(i.cache){var a,n,o={},r=i.data||[];i.params&&!e.isUndefined(i.params.start)?o=i.params:i.baseParams&&!e.isUndefined(i.baseParams.start)&&(o=i.baseParams),a=o.start||0,n=o.limit||i.data.length,t=r.slice(a,a+n)}else t=i.data||[];return t}})}(jQuery),function(e){var t=0,i=1,a=2,n=3,o=-1,r=0;Sweet.Socket=Sweet.Base.extend({sweetWidgetName:"[Sweet-Socket]",eventNames:{open:"连接建立成功",message:"接收到消息",close:"连接关闭",error:"发生异常"},init:function(i){e.isNull(i)||(this.options={url:"",autoRetry:!0,retryTimes:-1,retryInterval:5},this.options=e.extend({},this.options,i),this.socket=null,this.status=t,this.handlers={},this.retryTimer="Sweet.Socket-"+r++,this.retried=0)},connect:function(){var e=this,t="";if(e.socket)return!0;if(e.status=i,t="http:"===window.location.protocol?"ws://"+window.location.host+e.options.url:"wss://"+window.location.host+e.options.url,"WebSocket"in window)e.socket=new WebSocket(t);else{if(!("MozWebSocket"in window))return e._error("WebSocket is not supported by this browser."),e.status=o,!1;e.socket=new MozWebSocket(t)}return e.socket.onopen=function(t){e._onOpen(t)},e.socket.onclose=function(t){e._onClose(t)},e.socket.onmessage=function(t){e._onMessage(t)},e.socket.onerror=function(t){e._onError(t)},!0},close:function(){var e=this;e._stopRetry(),e.status=t,null!==e.socket&&(e.socket.close(),e.socket=null)},send:function(e){var t=this,i=t.socket;if(!i||t.status!==a)return t._error("Web Socket is not connected yet."),-1;try{return i.send(e),e.length}catch(n){return t._error("Send message failed, detail:"+n),0}},addListener:function(t,i){var a=this;e.isPlainObject(t)&&!i?a.handlers=e.extend({},a.handlers||{},i):a.handlers[t]=i},removeListener:function(e){delete this.handlers[e]},_trigger:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(o,r){return t===o&&e.isFunction(r)?(n=r(i,a),!1):undefined}),n},_onOpen:function(e){this.status=a,this.retried=0,this._stopRetry(),this._trigger("open",e,null)},_onMessage:function(e){this.status!==a&&(this.status=a,this._stopRetry()),this._trigger("message",e,e.data)},_onClose:function(e){var i=this;i.socket&&i.status!==t&&(i.socket=null,i.status=n,i._trigger("close",e,null),i.options.autoRetry&&i._startRetry())},_onError:function(e){this._trigger("error",e,null)},_startRetry:function(){var e=this;return e.options.retryTimes>=0&&e.retried>=e.options.retryTimes?(e._stopRetry(),undefined):(Sweet.Task.Timeout.start({id:e.retryTimer,run:function(){e.retried++,e.connect()},scope:e,interval:1e3*e.options.retryInterval}),undefined)},_stopRetry:function(){Sweet.Task.Timeout.stop(this.retryTimer)}})}(jQuery),function(e){e.widget("sweet.widgetCmp",e.sweet.widget,{version:"1.0",sweetWidgetName:"[widget-cmp]",defaultElement:"<div>",type:"cmp",options:{visiable:!0,value:""},_createSweetWidget:function(){if(!this.renderEl){var t=this,i=t.cmpEl=e("<div>"),a=t.options;i.attr("id",a.id).addClass(a.widgetClass).width(a.width).height(a.height),t._createCmpWidget()}},_destroyWidget:function(){this.renderEl&&this.renderEl.remove()},_createCmpWidget:e.noop})}(jQuery),function(e){var t="sweet-cmp-listwin-select_btn",i="sweet-cmp-listwin-title",a="sweet-cmp-listwin-seletMore",n="sweet-cmp-listwin-content",o="sweet-cmp-listwin-select",r="sweet-cmp-listwin-select-tree",l="sweet-cmp-listwin-select-left",s="sweet-cmp-listwin-",d="sweet-cmp-listWin-float-bg",c=c||1e3;e.widget("sweet.widgetCmpListwindow",e.sweet.widgetCmp,{version:"1.0",eventNames:{fromSearch:"源搜索事件",toSearch:"目标搜索事件",nodeEdit:"双向列表节点编辑事件"},sweetWidgetName:"[widget-cmp-listwindow]",type:"listwindow",options:{type:"list",fromTitle:"",toTitle:"",hidden:!1,icon:!0,search:!1,store:null,lazyLoad:!1,limit:50},_doLayout:function(){if(this.rendered){var e=this,t=e.fTitleEl,i=e.fromDiv,a=e.fromPanel,n=a.searchFiedlDiv,o=e.toDiv,r=0,l=e.selectPanel,s=e.toPanel,d=0,c=e.cmpEl,h=c.width(),u=c.height(),p=0,f=0,g=0,m=0,v=parseInt(l.css("width"))+parseInt(l.css("margin-left"))+parseInt(l.css("margin-right")),w=0;t&&(f=parseInt(t.css("margin-bottom")),p=t.height()+f),g=parseInt(h,10)-v,w=parseInt(u,10),i.externalWidth(g/2),i.externalHeight(w-p),a.setWidth(g/2),a.setHeight(w-p),a.doLayout(),o.externalWidth(g/2),o.externalHeight(w-p),s.setWidth(g/2),s.setHeight(w-p),s.doLayout(),"list"===e.options.type&&(n&&(r=parseInt(n.css("margin-bottom")),m=n.height()+r),d=p+m,l.css("padding-top",d))}},_render:function(t){var i=this,n=i.cmpEl,o=i.fromPanel,r=i.toPanel;return i.options,i.selectPanel,i._super(t)?(n.addClass(a),n.appendTo(i.renderEl),e.isNull(o)||e.isNull(r)?i._error("create muti list Panelfrom fail,from panel or to panel is empty!"):(o.render(i.fromDiv[0].id),r.render(i.toDiv[0].id)),i.rendered=!0,!0):!1},_createCmpWidget:function(){var e=this;e.eventMap=[],this._createFloatPanel(),this._initData(),this._render()},_initData:function(){var t=this,i=t.options,a=i.data||[],n=i.value||[];e.isNull(t.options.store)&&t.setData(a),t.setValue(n)},setData:function(e,t){var i=this,a=i.options,n=a.type;t=t||!1,"list"===n?(this.fromPanel.setData(e,t),this.toPanel.setData(e,t,!0)):this.fromPanel.setData(e)},setValue:function(t,i){var a,n,o=this,r=o.options,l=r.type,s=[];i?(n=this.toPanel.getAllNode(),e.each(t,function(t,i){a=!0,e.each(n,function(e,t){i.value===t.value&&(a=!1)}),a&&s.push(i)})):s=t,"list"===l?(i=i||!1,this.toPanel._showNode(t),this.fromPanel._hideNode(t)):(this.toPanel.setData(s,i),this.toPanel.addListener("afterSetData",function(){o.toPanel.getUnSelectedData()}))},_createFloatPanel:function(){var t=this,a=t.cmpEl,o=t.options,r=(a.position(),e("<table>").attr({cellspacing:0,border:0}).appendTo(a)),l=e("<tbody>").appendTo(r),d=e("<tr>").appendTo(l),h=e("<td>").appendTo(d),u=e("<td>").appendTo(d),p=e("<td>").appendTo(d);t.selectPanel=t._createSeletPanel().appendTo(u),e.isNotNull(t.options.fromTitle)&&(t.fTitleEl=e("<span>").addClass(i).text(t.options.fromTitle).appendTo(h)),e.isNotNull(t.options.toTitle)&&(t.tTitleEl=e("<span>").addClass(i).text(t.options.toTitle).appendTo(p));var f=e("<div>").appendTo(p).addClass(n),g=e("<div>").appendTo(h).addClass(n),m=t.fromDiv=e("<div>").appendTo(g);m.attr("id",s+o.id+"-"+ ++c);var v=t.toDiv=e("<div>").appendTo(f);v.attr("id",s+o.id+"-"+ ++c),t._createListPanel()},_createListPanel:function(){var t=this,i=this.options,a=i.type;"list"===a?(this.fromPanel=new Sweet.list.List({search:i.search,widgetClass:"sweet-list-list-con",multi:!0}),this.toPanel=new Sweet.list.List({search:i.search,widgetClass:"sweet-list-list-con",multi:!0})):"tree"===a&&(this.fromPanel=new Sweet.tree.Tree({multi:!0,data:i.data,search:i.search,store:i.store,lazyLoad:i.lazyLoad,limit:i.limit,icon:i.icon,widgetClass:d}),this.toPanel=new Sweet.tree.Tree({multi:!0,expand:!0,data:i.data,search:i.search,icon:i.icon,widgetClass:d}),this.toPanel.addListener("nodeEdit",function(i,a){e.isNull(t.eventMap.nodeEdit)||t.eventMap.nodeEdit.call(this,i,a)}),this.fromPanel.addListener("nodeEdit",function(i,a){e.isNull(t.eventMap.nodeEdit)||t.eventMap.nodeEdit.call(this,i,a)}))},_createSeletPanel:function(){var i=this,a=i.options.type,n=!1;"tree"===a&&(n=!0);var s=e("<div>").addClass(n?r:o);return e("<button>").addClass(t).text(Sweet.constants.listWindowButton.RIGHT).bind("click",{me:i},i._selectToRight).appendTo(s),e("<button>").addClass(t).addClass(l).text(Sweet.constants.listWindowButton.LEFT).bind("click",{me:i},i._selectToLeft).appendTo(s),e("<button>").addClass(t).text(Sweet.constants.listWindowButton.ALL_RIGHT).bind("click",{me:i},i._selectAllToRight).appendTo(s),e("<button>").addClass(t).text(Sweet.constants.listWindowButton.ALL_LEFT).bind("click",{me:i},i._selectAllToLeft).appendTo(s),s},_getValue:function(){var e=this,t=e.options.type;return"list"===t?this.toPanel._getAllShowNodeData():this.toPanel.getAllNode()},_setSelectData:function(t,i){var a=this;e.each(i,function(i,n){e.each(t,function(t,i){e.isNull(i)||n.value===i.value&&(i.isSelect=1,n.children&&n.children.length>0&&i.children&&i.children.length>0&&a._setSelectData(i.children,n.children))})})},_setSourceData:function(t,i){var a=this;e.each(i,function(i,n){e.each(t,function(e,t){n.value===t.value&&(t.isSelect=1,n.children&&n.children.length>0&&t.children&&t.children.length>0&&a._setSelectData(t.children,n.children))})})},_deleteData:function(t){var i=this;e.each(t,function(a,n){e.isNull(n.isSelect)?delete t[a]:n.children&&n.children.length>0&&i._deleteData(n.children)})},_getAppendData:function(t){var i=[];return e.each(t,function(e,t){t.data&&t.data.isSelect&&i.push(t)}),i},_toRigth:function(t){var i,a,n,o,r=this,l=r.fromPanel,s=r.toPanel;t=t||!1,o=t?l.getAllNode():l.getValue(),i=e.objClone(l.filterData),r._setSourceData(i,o),r._setSourceData(i,s.getAllNode(!0)),a=r._getAppendData(s.getAllNode(!0)),r._deleteData(i),i=e.deleteUndefinedData(i),i=i.concat(a),n=s.filterData,s.setData(i),s.filterData=s.mergeTree(n,i),s.addListener("afterSetData",function(){s.getUnSelectedData()})},_selectToRight:function(e){var t,i=e.data.me,a=i.fromPanel,n=i.toPanel;"list"===i.options.type?(t=a.getValue(),a._hideNode(t),n._showNode(t)):i._toRigth(),i._trigger("selectToRight",i)},_selectToLeft:function(e){var t,i=e.data.me,a=i.fromPanel,n=i.toPanel,o=n.getValue();"list"===i.options.type?(a._showNode(o),n._hideNode(o)):(n.removeNode(o),n.deleteData(o,n.filterData),n.deleteFilterData(n.filterData),n.getUnSelectedData(),t=n.getValue(),n.removeAllNode(),n.createNodes(t,!0)),i._trigger("selectToLeft",i)},_selectAllToRight:function(e){var t,i=e.data.me,a=i.fromPanel,n=i.toPanel;"list"===i.options.type?(t=a._getAllNodeData(),a._hideNode(t),n._showNode(t)):i._toRigth(!0),i._trigger("selectAllToRight",i)},_selectAllToLeft:function(e){var t,i,a,n=e.data.me,o=n.fromPanel,r=n.toPanel;"list"===n.options.type?(a=r._getAllNodeData(),o._showNode(a),r._hideNode(a)):(a=r.getAllNode(),r.removeNode(a),r.deleteData(a,r.filterData),r.deleteFilterData(r.filterData),r.getUnSelectedData(),i=r.filterData,t=r.getValue(),r.setData(t),r.filterData=r.mergeTree(i,[])),n._trigger("selectAllToLeft",n)},_removeListener:function(){var t=this;t.handlers=t.handlers||{},e.each(t.handlers,function(e){"nodeEdit"===e&&(t.eventMap.nodeEdit=null,delete t.handlers.nodeEdit,t.eventMap.length--)})},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){"nodeEdit"===e&&(t.eventMap.nodeEdit=i,t.eventMap.length++)})},_getWidth:function(){var e=this;return e.cmpEl.externalWidth()},_getHeight:function(){var e=this;return e.cmpEl.externalHeight()},_setWidth:function(e){var t=this;t.cmpEl.externalWidth(e)},_setHeight:function(e){var t=this;t.cmpEl.externalHeight(e)},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)}}),Sweet.cmp.ListWindow=e.sweet.widgetCmpListwindow}(jQuery),function(e){var t=[{value:"toRight",text:" > "},{value:"toLeft",text:" < "},{value:"allToRight",text:" >> "},{value:"allToLeft",text:" << "}];e.widget("sweet.widgetCmpListwindow_v1",e.sweet.widgetCmp,{version:"1.0",eventNames:{},sweetWidgetName:"[widget-cmp-listWindow_v1]",type:"listwindow_v1",options:{data:[],value:[],fromTitle:"",toTitle:"",btnWidth:80,beforeMoveFun:function(){return!0}},getValue:function(){return this.rightList?this.rightList.getCurrentData()||[]:[]},setData:function(t){var i=this;return e.isNull(t)?(i.options.data=[],i.leftList&&i.leftList.setData(null),i.rightList&&i.rightList.setData(null),undefined):(i.leftList&&i.rightList&&(i.options.data.length=0,i.options.data=JSON.parse(JSON.stringify(t)),i.leftList.setData(i.options.data),i.rightList.setData([])),undefined)},setValue:function(t){var i=this;return e.isNull(t)?(i.options.value=[],i.rightList&&i.rightList.setData(null),i.leftList&&i.leftList.setValue(null),undefined):(i.rightList&&(i.options.value.length=0,i.options.value=JSON.parse(JSON.stringify(t)),i.rightList.setData(i.options.value)),i.leftList&&i.leftList.setValue(i.options.value),undefined)},_destroyWidget:function(){var e=this;e.listWindHPanel&&e.listWindHPanel.destroy(),e._super()},_render:function(e){var t=this;return t._super(e)?(t.cmpEl.appendTo(t.renderEl),t.isCreate||t._createListWindow(),t.listWindHPanel.render(t.options.id),t.rendered=!0,!0):!1},_createCmpWidget:function(){var e=this,t=e.options;e.isCreate=!1,-1===(t.width+"").indexOf("%")&&-1===(t.height+"").indexOf("%")&&(this._createListWindow(),e.isCreate=!0)},_dealMoveBtns:function(e){var t=this,i=t.options,a=t.rightList;a&&i.beforeMoveFun()!==!1&&a.setData(e)},_deleteArraysSimilar:function(e,t){for(var i=[],a=e.concat(t),n={},o=0;a.length>o;o++)n[a[o].value]=a[o];
for(var r in n)i.push(n[r]);return i},_minusArrays:function(e,t){for(var i={},a=[],n=0;e.length>n;n++)i[e[n].value]=e[n];for(var o=0;t.length>o;o++)delete i[t[o].value];for(var r in i)a.push(i[r]);return a},_moveButtonClick:function(e,i){var a=this;if(!a.hasFinishedMove){a.hasFinishedMove=!0;var n=[];switch(i.value){case t[0].value:if(n=a.leftList.getCurrentValue(),0>=n.length)return a.hasFinishedMove=!1,undefined;var o=a.rightList.getCurrentData(),r=o.length>0?a._deleteArraysSimilar(n,o):n;a._dealMoveBtns(r,t[0].value);break;case t[1].value:var l=a.rightList.getCurrentValue();if(0>=l.length)return a.hasFinishedMove=!1,undefined;var s=a.rightList.getData();if(!s||!l)return a.hasFinishedMove=!1,undefined;n=a._minusArrays(s,l),a._dealMoveBtns(n,t[1].value);var d=a.leftList.getValue();d=a._minusArrays(d,l),a.leftList&&a.leftList.setValue(d);break;case t[2].value:if(n=a.leftList.getCurrentData(),0>=n.length)return a.hasFinishedMove=!1,undefined;var c=a.rightList.getData()||[];c.length>0&&(n=a._deleteArraysSimilar(c,n)),a._dealMoveBtns(n,t[2].value);break;case t[3].value:if(a.leftList&&a.leftList.setValue(null),n=a.rightList.getCurrentData()||[],0>=n.length)return a.hasFinishedMove=!1,undefined;var s=a.rightList.getData();n=n.length!==s.length?a._minusArrays(s,n):[],a._dealMoveBtns(n,t[3].value)}a.hasFinishedMove=!1}},_setWidth:function(e){this.cmpEl.externalWidth(e),this.listWindHPanel&&this.listWindHPanel.setWidth(e)},_setHeight:function(e){this.cmpEl.externalHeight(e),this.listWindHPanel&&this.listWindHPanel.setHeight(e)},_doLayout:function(){var e=this;e.listWindHPanel&&e.listWindHPanel.doLayout(),e.leftList&&e.leftList.doLayout(!0),e.rightList&&e.rightList.doLayout(!0)},_createListWindow:function(){var e=this,i=e.options,a=i.btnWidth,n=30,o=22,r=10,l=e.cmpEl.width(),s=e.cmpEl.height(),d=Math.floor((l-a-2*r)/2),c=s-o,h=60,u=2*h+n,p=(c-u)/2+o,f=c,g=d-2,m='<span class="sweet-cmp-stat-title">'+i.fromTitle+"</span>",v='<span class="sweet-cmp-stat-title">'+i.toTitle+"</span>";e.leftList=new Sweet.list.OptimizeList({width:g,search:!0,height:c,multi:!0,isBorder:!0,data:i.data});var w=new Sweet.panel.VPanel({width:d,height:s,padding:2,items:[{html:m},e.leftList]});e.toRightBtn=new Sweet.form.Button({value:t[0],width:a}),e.toRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)}),e.toLeftBtn=new Sweet.form.Button({value:t[1],width:a}),e.toLeftBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)}),e.toAllRightBtn=new Sweet.form.Button({value:t[2],width:a}),e.toAllRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)}),e.toAllLefttBtn=new Sweet.form.Button({value:t[3],width:a}),e.toAllLefttBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)});var _=new Sweet.panel.VPanel({height:h,width:a,items:[e.toRightBtn,e.toLeftBtn]}),C=new Sweet.panel.VPanel({height:h,width:a,items:[e.toAllRightBtn,e.toAllLefttBtn]});e.vpBtns=new Sweet.panel.VPanel({height:u+p,width:a,padding:n,margin:[p,0,0,0],items:[_,C]}),e.rightList=new Sweet.list.OptimizeList({width:g,height:c,search:!0,multi:!0,isBorder:!0,data:i.value,value:i.value});var b=new Sweet.panel.VPanel({width:d,height:s,padding:2,items:[{html:v},e.rightList]});e.listWindHPanel=new Sweet.panel.HPanel({width:"100%",height:f,itemExtend:!1,items:[w,e.vpBtns,b]})},_getWidth:function(){var e=this;return e.cmpEl.externalWidth()},_getHeight:function(){var e=this;return e.cmpEl.externalHeight()},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)}}),Sweet.cmp.ListWindow_v1=e.sweet.widgetCmpListwindow_v1}(jQuery),function(e){var t="sweet-cmp-treewindow-lpanel",i="sweet-cmp-treewindow-mpanel",a="sweet-cmp-treewindow-rpanel",n="sweet-cmp-treewindow-btnpanel",o="sweet-cmp-treewindow-title",r="beforemoveright",l="beforeload",s="load",d="search",c="vcountchange",h=[{value:"_moveRight",text:" > "},{value:"_moveLeft",text:" < "},{value:"_allMoveRight",text:" >> "},{value:"_allMoveLeft",text:" << "}],u="sweet-treewindow",p=p||1e3;e.widget("sweet.widgetCmpTreeWindow",e.sweet.widgetCmp,{version:"1.0",sweetWidgetName:"[widget-cmp-treeWindow]",type:"treewindow",eventNames:{beforemoveright:"右移前事件",beforeload:"延迟加载数据时,左列表加载前事件",load:"延迟加载数据时,左列表数据加载回时事件",vcountchange:"右列表节点数量变化事件"},options:{data:[],value:[],fromTitle:Sweet.cmp.i18n.listWindow.fromTitle,toTitle:Sweet.cmp.i18n.listWindow.toTitle,btnWidth:60,tip:!1,icon:!0,useArrows:!0,valueKeys:["value","text","data","icon"],lShowCCount:!1,rShowCCount:!1,loader:null},getValue:function(){var e,t,i=this;return i.rightTree?(e=i.rightTree.getCurrentOptObjData(),t=i._parseTreeDatas(e)):[]},setData:function(e){var t,i=this;i.leftTree&&i.rightTree&&(i.leftTree.setData(e),t=i.leftTree.getValue(),i._initExpanded(t),i.rightTree.setData(t),i._triggerHandler(i._getLeafCount(t),c,i))},setValue:function(e){var t=this;t.leftTree&&t.rightTree&&(t._initExpanded(e),t.rightTree.setData(e),t.leftTree.setValue(e),t._triggerHandler(t._getLeafCount(e),c,t))},setLoader:function(e){var t=this;t.leftTree&&(t.options.loader&&!e?(t._createMoveRightBtn(),t._createMoveLeftBtn(),t._createMoveAllRightBtn(),t._createMoveAllLeftBtn(),t.vpUp.removeItems(),t.vpDown.removeItems(),t.vpUp.addItems([t.moveRightBtn,t.moveLeftBtn]),t.vpDown.addItems([t.moveAllRightBtn,t.moveAllLeftBtn])):!t.options.loader&&e&&(t._createMoveRightBtn(),t._createMoveLeftBtn(),t.vpUp.removeItems(),t.vpDown.removeItems(),t.vpUp.addItems(t.moveRightBtn),t.vpDown.addItems(t.moveLeftBtn)),t.options.loader=e,t.leftTree.setLoader(e))},load:function(e){var t,i=this;i.leftTree&&i.rightTree&&(i.leftTree.load(e),t=i.leftTree.getValue(),i._initExpanded(t),i.rightTree.setData(t),i._triggerHandler(i._getLeafCount(t),c,i))},_destroyWidget:function(){var e=this;e._super(),e.treeWindowEl&&e.treeWindowEl.remove(),e.leftTree&&e.leftTree.destroy(),e.vpBtns&&e.vpBtns.destroy(),e.rightTree&&e.rightTree.destroy()},_render:function(e){var t=this;return t._super(e)?(t.treeWindowEl.appendTo(t.renderEl),t.leftTree.render(t.__leftTreeRenderID),t.rightTree.render(t.__rightTreeRenderID),t.vpBtns.render(t.__mOptBtnPanelRenderID),t.lTitleEl.html(t.options.fromTitle),t.rTitleEl.html(t.options.toTitle),t.rendered=!0,!0):!1},_createTreeWindow:function(){var t,i,a,n,o,r,d,c,h=this,u=h.options.btnWidth,p=30,f=23,g=60,m=10,v=5,w=30;if(t=h.options.listeners,i={},!e.isEmptyObject(t))for(var _ in t)(s==_||l==_)&&(i[_]=t[_]),h.addListener(""+_,t[_]);a=h.treeWindowEl.width(),n=h.treeWindowEl.height(),o=Math.floor((a-u-2*m)/2),r=h.lTitleDiv.outerHeight(),d=n-r,c=2*g+p,h.options.loader&&(v=10),h.__tempHeight>n?h.mTopDiv.width(u+2*m).height((n+r-c+v+w)/2):h.mTopDiv.width(u+2*m).height((n+r-c+v)/2),h.leftTree=new Sweet.tree.Tree_v1({width:o,height:d,search:!0,multi:!0,tip:h.options.tip,valueKeys:h.options.valueKeys,icon:h.options.icon,useArrows:h.options.useArrows,listeners:i,showCCount:h.options.lShowCCount,loader:h.options.loader}),h.rightTree=new Sweet.tree.Tree_v1({width:o,height:d,search:!0,multi:!0,valueKeys:h.options.valueKeys,tip:h.options.tip,icon:h.options.icon,useArrows:h.options.useArrows,showCCount:h.options.rShowCCount,data:h.options.value}),h._createMoveRightBtn(),h._createMoveLeftBtn(),h.options.loader?(h.vpUp=new Sweet.panel.VPanel({height:g+f,width:u,items:[h.moveRightBtn]}),h.vpDown=new Sweet.panel.VPanel({height:g-f,width:u,items:[h.moveLeftBtn]})):(h._createMoveAllRightBtn(),h._createMoveAllLeftBtn(),h.vpUp=new Sweet.panel.VPanel({height:g,width:u,items:[h.moveRightBtn,h.moveLeftBtn]}),h.vpDown=new Sweet.panel.VPanel({height:g,width:u,items:[h.moveAllRightBtn,h.moveAllLeftBtn]})),h.vpBtns=new Sweet.panel.VPanel({height:c,padding:p,items:[h.vpUp,h.vpDown]})},_createMoveRightBtn:function(){var e=this,t=e.options.btnWidth;e.moveRightBtn=new Sweet.form.Button({value:h[0],width:t}),e.moveRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createMoveLeftBtn:function(){var e=this,t=e.options.btnWidth;e.moveLeftBtn=new Sweet.form.Button({value:h[1],width:t}),e.moveLeftBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createMoveAllRightBtn:function(){var e=this,t=e.options.btnWidth;e.moveAllRightBtn=new Sweet.form.Button({value:h[2],width:t}),e.moveAllRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createMoveAllLeftBtn:function(){var e=this,t=e.options.btnWidth;e.moveAllLeftBtn=new Sweet.form.Button({value:h[3],width:t}),e.moveAllLeftBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createSweetWidget:function(){var r,l,s,d=this,h=d.options.id,f=d.options.widgetClass,g={isChange:!1};d.__tempHeight=300,d.treeWindowEl=e("<div>").attr("id",d.options.id),f&&""!=f&&d.treeWindowEl.addClass(f),r=e("<div>").addClass(t).appendTo(d.treeWindowEl),d.mPanelDiv=e("<div>").addClass(i).height(d.options.height).appendTo(d.treeWindowEl),l=e("<div>").addClass(a).appendTo(d.treeWindowEl),d.lTitleDiv=e("<div>").appendTo(r),d.lTitleEl=e("<span>").addClass(o).appendTo(d.lTitleDiv),d.__leftTreeRenderID=h+u+"-lefttree-"+p,e("<div>").attr("id",d.__leftTreeRenderID).appendTo(r),d.__rightTreeRenderID=h+u+"-righttree-"+p,d.rTitleDiv=e("<div>").appendTo(l),d.rTitleEl=e("<span>").addClass(o).appendTo(d.rTitleDiv),e("<div>").attr("id",d.__rightTreeRenderID).appendTo(l),d.mTopDiv=e("<div>").appendTo(d.mPanelDiv),d.__mOptBtnPanelRenderID=h+u+"-optbtnpanel-"+p,e("<div>").attr("id",d.__mOptBtnPanelRenderID).addClass(n).appendTo(d.mPanelDiv),d._createTreeWindow(),d._registInitEvent(),d.options.data&&d.options.data.length>0&&d.leftTree.setData(d.options.data),s=d.leftTree.getValue(),d.options.value&&d.options.value.length>0&&(s&&s.length>0?d._doCompoundTree(s,d.options.value,"value",g):s=d.options.value),s&&s.length>0&&(d._initExpanded(s),d.rightTree.setData(s),d._triggerHandler(d._getLeafCount(s),c,d))},_doLayout:function(){var e,t,i,a,n=this,o=n.options.btnWidth,r=30,l=60,s=10,d=5,c=n.treeWindowEl.width(),h=n.treeWindowEl.height(),u=30;c=n.treeWindowEl.width(),h=n.treeWindowEl.height(),i=Math.floor((c-o-2*s)/2),t=n.lTitleDiv.outerHeight(),a=h-t,e=2*l+r,n.options.loader&&(d=10),n.__tempHeight>h?n.mTopDiv.width(o+2*s).height((h+t-e+d+u)/2):n.mTopDiv.width(o+2*s).height((h+t-e+d)/2),n.mPanelDiv.height(h),n.leftTree&&(n.leftTree.setWH(i,a),n.leftTree.doLayout(!0)),n.rightTree&&(n.rightTree.setWH(i,a),n.rightTree.doLayout(!0))},_moveButtonClick:function(e,t){var i=this;switch(t.value){case h[0].value:i.moveRight();break;case h[1].value:i.moveLeft();break;case h[2].value:i.moveAllRight();break;case h[3].value:i.moveAllLeft()}},moveRight:function(){var t,i,a=this,n=[],o={isChange:!1};if(a.leftTree&&a.rightTree&&!a.__isDoMoving){if(a.__isDoMoving=!0,n=a.leftTree.getValue(),!n||0>=n.length)return a.__isDoMoving=!1,undefined;if(t=a.rightTree.getCurrentOptObjData(),e.isEmptyObject(t)?(o.isChange=!0,t=n):(t=a._parseTreeDatas(t),a._doCompoundTree(t,n,"value",o)),a.rightTree.searchField&&a.rightTree.searchField.getValue()&&a.rightTree.searchField.getValue().value&&(o={isChange:!0}),o&&o.isChange){if(i=a._triggerHandler(t,r,a),!1===i||"false"===i)return a.__isDoMoving=!1,undefined;a._initExpanded(t),a.rightTree.setData(t)}a.__isDoMoving=!1,a._triggerHandler(a._getLeafCount(t),c,a)}},moveLeft:function(){var e,t,i,a,n=this,o=[],r={};if(n.leftTree&&n.rightTree&&!n.__isDoMoving){if(n.__isDoMoving=!0,t=n.rightTree.getValue(),!t||0>=t.length)return n.__isDoMoving=!1,undefined;n.rightTree.parseDatas(t,o,r,"",!1,null),e=n.rightTree.getCurrentObjData(),o=null,i=n.leftTree.getSelectedDatas()||{};for(var l in r)r[l].leaf&&(delete e[l],delete i[l]);r=null,e=n._parseTreeDatas(e),n._initExpanded(e),n.rightTree.setData(e),a=n._parseTreeValues(i),n.leftTree.setValue(a),n.__isDoMoving=!1,n._triggerHandler(n._getLeafCount(e),c,n)}},moveAllRight:function(){var t,i,a,n,o=this,l={isChange:!1};if(o.leftTree&&o.rightTree&&!o.__isDoMoving){if(o.__isDoMoving=!0,i=o.leftTree.getCurrentOptObjData(),e.isEmptyObject(i))return o.__isDoMoving=!1,undefined;if(a=o.rightTree.getCurrentOptObjData(),t=o._parseTreeDatas(i),e.isEmptyObject(a)?(l.isChange=!0,a=t):(a=o._parseTreeDatas(a),o._doCompoundTree(a,t,"value",l)),o.rightTree.searchField&&o.rightTree.searchField.getValue()&&o.rightTree.searchField.getValue().value&&(l={isChange:!0}),l&&l.isChange){if(n=o._triggerHandler(a,r,o),!1===n||"false"===n)return o.__isDoMoving=!1,undefined;o._initExpanded(a),o.rightTree.setData(a)}else o.rightTree.searchField.setValue({value:"",text:""});o.__isDoMoving=!1,o._triggerHandler(o._getLeafCount(a),c,o)}},moveAllLeft:function(){var t,i,a=this;if(a.leftTree&&a.rightTree&&!a.__isDoMoving){if(a.__isDoMoving=!0,a.leftTree.setValue(null),i=a.rightTree.getCurrentOptObjData(),e.isEmptyObject(i))return a.__isDoMoving=!1,undefined;t=a.rightTree.getCurrentObjData();for(var n in i)i[n].leaf&&delete t[n];t=a._parseTreeDatas(t),a._initExpanded(t),a.rightTree.setData(t),a.__isDoMoving=!1,a._triggerHandler(a._getLeafCount(t),c,a)}},_parseTreeValues:function(t){var i,a,n,o=this,r={},l=o.options.valueKeys;return!o.leftTree||e.isEmptyObject(t)?[]:(i=o.leftTree,n=o.options.loader?o.leftTree.getCurrentOptObjData():o.leftTree.getCurrentObjData(),i.parseTreeDatas(t,n,l,r),r.data?a=e.objClone(r.data):[])},_parseTreeDatas:function(e){var t,i,a,n=this,o=n.options.valueKeys;if(!n.leftTree&&!n.rightTree)return[];a=n.leftTree||n.rightTree,t={},i={};for(var r in e)e[r].leaf&&(i[r]=e[r]);return a.parseTreeDatas(i,e,o,t),t=t.data?t.data:[]},_doCompoundTree:function(e,t,i,a){for(var n,o=this,r=0;t.length>r;r++){n=!0,t[r].checked=!1;for(var l=0;e.length>l;l++)if(t[r][i]==e[l][i]){t[r].children&&t[r].children.length>0&&e[l].children&&e[l].children.length>0&&o._doCompoundTree(e[l].children,t[r].children,i,a),t[r].children&&t[r].children.length>0&&(!e[l].children||0>=e[l].children.length)&&(e[l].children=[],o._doCompoundTree(e[l].children,t[r].children,i,a)),n=!1;break}n&&(a.isChange=!0,e.push(t[r]))}},_getLeafCount:function(t,i){var a=this,n=[],o=0;if(i){if(e.isEmptyObject(t))return o;for(var r in t)!t[r]||1!=t[r].leaf&&"true"!=t[r].leaf||o++;return o}return e.isNull(t)&&(t=[]),e.isArray(t)||(t=[t]),0>=t.length?o:(a._getLeafDatas(t,n),o=n.length)},_getLeafDatas:function(e,t){for(var i=this,a=0;e.length>a;a++)e[a]&&(e[a].children&&e[a].children.length>0?i._getLeafDatas(e[a].children,t):t.push(e[a]));return t},_initExpanded:function(e){var t,i=this;if(!e)return[];for(var a=0;e.length>a;a++)t=e[a].children,t&&t.length>0&&(e[a].expanded=!0,i._initExpanded(t))},_getWidth:function(){return this.treeWindowEl.externalWidth()},_getHeight:function(){return this.treeWindowEl.externalHeight()},_setWidth:function(e){this.treeWindowEl.externalWidth(e)},_setHeight:function(e){this.treeWindowEl.externalHeight(e)},_setWH:function(e,t){var i=this;i.treeWindowEl.externalWidth(e),i.treeWindowEl.externalHeight(t)},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,o){i===e&&(n=o.call(null,t,a))}),n},_addListener:function(){var t=this;e.each(t.handlers,function(e,i){!t.leftTree||e!==l&&e!==s||t.leftTree.addListener(e,i)})},_removeListener:function(t){var i=this;e.isNull(t)||!i.leftTree||t!==l&&t!==s||i.leftTree.removeListener(t)},_registInitEvent:function(){var e=this;e.leftTree.addListener(l,function(t,i){e._triggerHandler(t,l,i)}),e.leftTree.addListener(s,function(t,i){e._triggerHandler(t,s,i)}),e.rightTree.addListener(d,function(t){e._triggerHandler(e._getLeafCount(t,!0),c,e)})}}),Sweet.cmp.TreeWindow=e.sweet.widgetCmpTreeWindow}(jQuery),function(e){var t="sweet-cmp-timeschedule-panel-li-pic",i="sweet-cmp-timeschedule-span",a="sweet-cmp-timeschedule-textButtonDiv",n="sweet-cmp-timeschedule-inputParent",o="sweet-cmp-timeschedule-normal",r="sweet-cmp-timeschedule-gray",l="sweet-cmp-timeschedule-input",s="sweet-cmp-timeschedule-imageButton",d="sweet-cmp-timeschedule-clearEl",c="sweet-form-timeschedule-textGray",h="sweet-form-timeschedule-emptyDiv";e.widget("sweet.widgetCmpTimeschedule",e.sweet.widgetCmp,{version:"1.0",sweetWidgetName:"[widget-cmp-timeschedule]",defaultElement:"<div>",type:"timeschedule",options:{width:50,height:25,type:1,tip:!1,editable:!1,disabled:!1,emptyText:Sweet.core.i18n.combobox.pleaseCheck},setEditable:function(e){var t=this;t.inputEl&&!t.disabled&&(t.inputEl.removeAttr("readonly").attr("readOnly",!e),t.editable=e)},setDisabled:function(e){var t=this;return"boolean"!=typeof e?(t._error("setDisabled() Input parameter is not a Boolean type!"),undefined):(t.inputEl&&t.inputEl.removeAttr("readonly").attr("readonly",e),t._setDisabled(e),t.options.disabled=e,t.disabled=e,e||!1===t.editable&&t.setEditable(!1),undefined)},getDisabled:function(){return this.options.disabled},clear:function(){var e=this;for(var t in e.aElObjs)e.aElObjs[t].hasClass(i)&&e.aElObjs[t].removeClass(i);e.inputEl&&(e.inputEl.val(""),e._setTitle(""),e._setEmptyText()),e.selectedTimeNum=[]},_setDisabled:function(e){var t=this;t.button&&(t.button.setDisabled(e),t.checkbox.setDisabled(e)),e?t.inputEl&&(t.inputEl.addClass(c),t.inputParentDivEl.removeClass(o).addClass(r),t.imageButton.removeClass(o).addClass(r).addClass(c),t._setEmptyText(!0)):t.inputEl&&(t.inputEl.removeClass(c),t.inputParentDivEl.removeClass(r).addClass(o),t.imageButton.removeClass(c).removeClass(r).addClass(o),t._setEmptyText())},_setValue:function(e){var t=this,a=(t.options,e.text.split(" ")),n=a.length;if(t.selectedTimeNum=[],!(2>n)){for(var o,r,l=0;n-1>l;l++)if(o=parseInt(a[l].substr(0,2),10),r=parseInt(a[l].substr(6,2),10),r-1===o)t.selectedTimeNum.push(o);else for(var s=o;r>s;s++)t.selectedTimeNum.push(s);for(var d in t.aElObjs)t.aElObjs[d].hasClass(i)&&t.aElObjs[d].removeClass(i);for(var c=t.selectedTimeNum.length,h=0;c>h;h++)t.aElObjs[t.selectedTimeNum[h]].addClass(i);t._setInputText()}},_getValue:function(){var e=this,t=e._getTimeText();return{text:t,value:t}},_closeFloatPanel:function(){var e=this;e.openPanelElFlag||"block"!==e.divPanelEl.css("display")||e.divPanelEl.fadeOut(150),e.openPanelElFlag=!1},_render:function(e){var t=this,i=t.options;return t._super(e)?(t.cmpEl.appendTo(t.renderEl),1===i.type?(t.checkbox.render(i.id),t.button.render(i.id)):t.textButtonDiv.appendTo(t.cmpEl),t.rendered=!0,undefined):!1},_createCmpWidget:function(){var e=this,t=e.options,i="sweet-cmp-timeschedule";e.cmpEl.addClass(i),1===t.type?(e._createCheckBox(),e._createButton()):e._createTextField(),e._createBusyHourPanel(),e._setEmptyText(),e.selectedTimeNum=[]},_createCheckBox:function(){var e,t=this,i="checkbox";e=new Sweet.form.CheckBox({widgetClass:i,height:25}),t.checkbox=e},_createButton:function(){var t,i=this,a="button";t=new Sweet.form.Button({widgetClass:a,value:{text:Sweet.cmp.i18n.timeSchedule.buttonText}}),t.addListener("click",function(){if(i.openPanelElFlag=!1,"block"!==i.divPanelEl.css("display")){var t=e.getMaxZIndex(i.divPanelEl.css("z-index")),a=i.__getPanelElOffset(i.button.formEl,i.divPanelEl);i.divPanelEl.css({"z-index":t,left:a.left,top:a.top}).show(),i.openPanelElFlag=!0}}),i.button=t},_createTextField:function(){var t=this,i=t.options,o=t.textButtonDiv=e("<div>").addClass(a),r=t.inputParentDivEl=e("<div>").addClass(n).appendTo(o),d=t.inputEl=e("<input>").attr("type","text").addClass(l).appendTo(r);t.imageButton=e("<span>").text("···").addClass(s).appendTo(o),e.isNotNull(i.vID)&&d.attr("id",i.vID)},_createBusyHourPanel:function(){var t=this,i="sweet-cmp-timeschedule-panel",a="sweet-cmp-timeschedule-panel-ul",n=t.divPanelEl=e("<div>").addClass(i+" "+t.floatBgClass).hide(),o=e("<ul>").addClass(a).appendTo(n),r=(t.aElObjs={},t.liPic1=t._createBusyHourPicItem(0)),l=t._createBusyHourNumItem(0,13),s=t.liPic2=t._createBusyHourPicItem(1),c=t._createBusyHourNumItem(12,25),h=t.clearEl=e("<a>").addClass(d).text(Sweet.core.i18n.listbox.clearAll);r.appendTo(o),l.appendTo(o),s.appendTo(o),c.appendTo(o),h.appendTo(n),n.bind("click",function(e){e.stopPropagation()}).select(function(){return!1}).appendTo("body")},_createBusyHourPicItem:function(i){for(var a,n=this,o=e("<li>").addClass(t),r=e("<ul>").appendTo(o),l=e("<li>").appendTo(r),s=n.aElObjs,d=0,c=0;12>c;c++)d=c+12*i,a=e("<span>").data("num",parseInt(d,10)).attr("value",c+"~"+(c+1)).appendTo(l),s[d]=a;return o},_createBusyHourNumItem:function(t,i){for(var a,n=this,o="sweet-cmp-timeschedule-panel-li-num",r=e("<li>").addClass(o),l=t;i>l;l++)a=e("<em>").val(l).text(l).on("selectstart",n._unselectable).appendTo(r);return r},_getSelectedTime:function(){var e=this;e.selectedTimeNum=[];for(var t in e.aElObjs)e.aElObjs[t].hasClass(i)&&e.selectedTimeNum.push(e.aElObjs[t].data("num"));e._setInputText()},_setInputText:function(){var e=this;if(e.inputEl){var t=e._getTimeText();e.inputEl.val(t),e._setTitle(t),e._setEmptyText()}},_getTimeText:function(){var e=this,t=(e.options,e.selectedTimeNum),i=t.length,a=e.selectedTimeFlag=[];if(0===i)return"";if(1===i&&(a[0]="O"),2===i&&(t[0]+1===t[1]?(a[0]="S",a[1]="E"):a[0]=a[1]="O"),i>=3){a[0]=t[0]+1===t[1]?"S":"O",a[i-1]=t[i-1]-1===t[i-2]?"E":"O";for(var n,o,r,l,s,d,c,h=1;i-1>h;h++)n=t[h],o=t[h-1],r=t[h+1],l=n-1!==o&&n+1===r,s=n-1===o&&n+1!==r,d=n-1===o&&n+1===r,c=n-1!==o&&n+1!==r,a[h]=l?"S":s?"E":d?"M":"O"}for(var u="",p=null,f="",g=0;i>g;g++)if("S"===a[g])p=t[g];else if("E"===a[g])f=e._numberToTimer(p,t[g]),u+=f;else{if("O"!==a[g])continue;f=e._numberToTimer(t[g]),u+=f}return u},_numberToTimer:function(e,t){var i=this;i.options;var a="";return t?(10>e&&(e="0"+e),t+=1,10>t&&(t="0"+t),a=e+":00-"+t+":00; "):(t=e+1,10>e&&(e="0"+e),10>t&&(t="0"+t),a=e+":00-"+t+":00; "),a},_setTitle:function(e){var t=this,i=t.options;t.inputEl&&i.tip&&t.inputEl.attr("title",e)},_afterCreateSweetWidget:function(){var t=this,i=t.options;t.setEditable(i.editable),t.setDisabled(i.disabled),t.imageButton&&t.imageButton.bind("click",function(){if(!t.imageButton.hasClass(r)&&(t.openPanelElFlag=!1,"block"!==t.divPanelEl.css("display"))){var i=e.getMaxZIndex(t.divPanelEl.css("z-index")),a=t.__getPanelElOffset(t.inputParentDivEl,t.divPanelEl);t.divPanelEl.css({"z-index":i,left:a.left,top:a.top}).fadeIn(300),t.openPanelElFlag=!0}}),t.inputEl&&t.inputEl.bind("click",function(e){"block"===t.divPanelEl.css("display")&&e.stopImmediatePropagation()}).focus(function(){t._setEmptyText(!0)}).blur(function(){t.disabled||t._setEmptyText()}),t.clearEl.bind("click",function(){t.clear()}),t.liPic1.children().children().selectable({stop:function(){t._selectedStop()}}),t.liPic2.children().children().selectable({stop:function(){t._selectedStop()}})},_selectedStop:function(){var e=this;for(var t in e.aElObjs)e.aElObjs[t].hasClass("ui-selected")&&(e.aElObjs[t].hasClass(i)?e.aElObjs[t].removeClass("ui-selected").removeClass(i):e.aElObjs[t].removeClass("ui-selected").addClass(i));e._getSelectedTime()},_destroyWidget:function(){var e=this;e._super(),e.inputEl&&e.inputEl.trigger("mouseout"),delete e.aElObjs,delete e.selectedTimeNum,delete e.selectedTimeFlag},_setEmptyText:function(t){var i=this;if(i.inputEl&&i.options.emptyText){t=t||!1;var a=i.inputEl.val();if(!i.emptyDiv){var n=i.emptyDiv=e("<div>").addClass(h).appendTo(i.inputParentDivEl);n.html(i.options.emptyText),n.bind("click",function(t){e(this).hide(),i.inputEl.click(),i.inputEl.focus(),t.stopImmediatePropagation()}).bind("mouseover",function(){i.inputEl.trigger("mouseover")}).bind("mouseout",function(){i.inputEl.trigger("mouseout")})}t?"block"===i.emptyDiv.css("display")&&i.emptyDiv.hide():a?i.emptyDiv.hide():i.emptyDiv.show()}},__getPanelElOffset:function(t,i){var a,n=t.offset(),o=0,r=0,l=2,s=e(window),d=e(document),c=s.height()+d.scrollTop(),h=s.width()+d.scrollLeft(),u=t.outerHeight(!0),p=i.outerWidth(!0),f=i.outerHeight(!0);return o=n.top+u+l,r=n.left,a=h-(p+n.left),0>=a&&(r=r+a-l),f>=c-n.top-u&&n.top>=f&&(o=n.top-f-l),{left:r,top:o}}}),Sweet.cmp.TimeSchedule=e.sweet.widgetCmpTimeschedule}(jQuery),function(e){e.widget("sweet.cmpHoliday",e.sweet.widget,{version:"1.0",sweetWidgetName:"[cmp-holiday]",defaultElement:"<div>",type:"holiday",eventNames:{click:"日期点击事件",change:"日期变化时触发"},options:{year:2012},widget:function(){return this.holidayPanel},setValue:function(t){if(e.isNull(t))return e.error("setValue(): Input parameter must not be empty! "),undefined;var i=this;e.each(t,function(t,a){i.holidayItems[e.string.toNumber(t)-1].setValue(a)})},getValue:function(){for(var e={},t=0;this.holidayItems.length>t;t++)e[t+1]=this.holidayItems[t].getValue();return e},_createSweetWidget:function(){this._createHolidayCmp()},_createHolidayCmp:function(){for(var e,t,i=this.holidayItems=[],a=this.options,n=0;12>n;n++)t=new Sweet.panel.Date({year:a.year,month:n+1,height:250}),i[n]=t;e=this.holidayPanel=new Sweet.panel.GridPanel({id:a.id,name:a.name,title:Sweet.cmp.i18n.holiday,width:"100%",height:"100%",widgetClass:"sweet-cmp-holiday",layoutOptions:{rows:3,columns:4},items:i}),e.render(a.renderTo)},_addListener:function(){var t=this;t.handlers=t.handlers||{},e.each(t.handlers,function(i,a){e.each(t.holidayItems,function(e,t){t.addListener(i,a)})})},_destroyWidget:function(){this.holidayPanel&&this.holidayPanel.destroy()},_render:function(e){var t=this;return!e||t.rendered?!1:(t.holidayPanel.render(e),!0)}}),Sweet.cmp.Holiday=e.sweet.cmpHoliday}(jQuery),function(e){e.widget("sweet.widgetCmpFileUpload",e.sweet.widgetCmp,{version:"1.0",sweetWidgetName:"[widget-cmp-fileupload]",defaultElement:"<div>",type:"fileupload",eventNames:{afterUpload:"上传后触发"},options:{width:360,height:124,title:Sweet.core.i18n.fileUploadWin.title,label:!0,labelWidth:"30%",labelText:"",required:!0,editable:!0,errorModel:"none",validateFun:function(){return{success:!0}},url:"","import":!1,afterUpload:null,beforeUpload:null},show:function(){var e=this;e.fileuploaddiv.clear(),e.wnd.show()},hide:function(){this.wnd.hide()},isValidate:function(){var e=this;return e.fileuploaddiv.validate()},OK:function(){var t=this,i=t.options;return t.fileuploaddiv.validate()?(t.fileuploaddiv.submit(),i.afterUpload&&e.isFunction(i.afterUpload)&&i.afterUpload(),undefined):!1},_setValue:function(){},_getValue:function(){},_createCmpWidget:function(){var t,i,a=this,n=a.options,o=a.fileuploaddiv=new Sweet.form.FileUpLoadField({label:n.label,labelText:n.labelText,errorModel:n.errorModel,labelWidth:n.labelWidth,required:n.required,editable:n.editable,validateFun:n.validateFun,vID:n.vID,url:n.url});n.import?(160>n.height&&(n.height=n.height+35),i=a._creatImportType(),t=new Sweet.panel.VPanel({width:"100%",height:"100%",items:[i,o],itemExtend:!1})):t=o,a.wnd=new Sweet.Window({width:n.width,height:n.height,title:n.title,content:t,listeners:{ok:function(){if(a.options.import&&a.importTypeGroup){var t=a.importTypeGroup.getValue();if(e.isNotNull(t)&&e.isNotNull(t.value)){var i="";if(-1!==(a.options.url+"").indexOf("importType=1"))i=(a.options.url+"").replace("importType=1","importType="+t.value);else if(-1!==(a.options.url+"").indexOf("importType=2"))i=(a.options.url+"").replace("importType=2","importType="+t.value);else{var o="?importType=";-1!==(a.options.url+"").indexOf("?")&&(o="&importType="),i=a.options.url+o+t.value}a.fileuploaddiv.setUrl(i)}}if(!n.beforeUpload||!e.isFunction(n.beforeUpload))return a.OK();var r=n.beforeUpload();return"false"===r||!1===r?r:undefined},cancel:function(){}}})},_creatImportType:function(){var t,i,a,n,o,r=this,l=r.options.url,s=/\?+/;return r.options.import&&(n=new Sweet.form.Label({width:85,height:25,symbol:!0,blank:!1,value:{text:Sweet.core.i18n.fileUpload.importType,value:"importTypeLabel"}}),a=[{text:Sweet.core.i18n.fileUpload.appendImport,value:1,checked:!0},{text:Sweet.core.i18n.fileUpload.overWriteImport,value:2,checked:!1}],i=r.importTypeGroup=new Sweet.form.RadioGroup({width:300,height:25,columns:"auto",data:a,tip:!0}),i.addListener("change",function(i,a){e.isNotNull(a)&&e.isNotNull(a.value)&&(t=s.test(l)?r.options.url+"&importType="+a.value:r.options.url+"?importType="+a.value,r.fileuploaddiv.setUrl(t))}),o=new Sweet.panel.HPanel({width:400,height:30,items:[n,i],itemExtend:!1})),o},_addListener:function(e,t){var i=this;i.fileuploaddiv.addListener(e,t)},_removeListener:function(e){var t=this;t.fileuploaddiv.removeListener(e)},setEditable:function(e){var t=this;t.fileuploaddiv&&t.fileuploaddiv.setEditable(e)},getFileSize:function(){var e=this,t=0;return e.fileuploaddiv?t=e.fileuploaddiv.getFileSize():t}}),Sweet.cmp.FileUpload=e.sweet.widgetCmpFileUpload}(jQuery),function(e){var t="sweet-cmp-listwin-select_btn",i="sweet-cmp-listwin-select",a="sweet-cmp-listwin-select-tree",n="sweet-cmp-listwin-select-left",o="sweet-cmp-listwin-title",r="sweet-cmp-optimizelist-div-left",l="sweet-cmp-optimizelist-div-right",s="tree",d="id",c="srcContainer_",h="destContainer_";e.widget("sweet.cmpOptimizeListWindow",e.sweet.widgetCmp,{version:"1.0",eventNames:{fromSearch:"源搜索事件",toSearch:"目标搜索事件",nodeEdit:"双向列表节点编辑事件",beforeLeftToRight:"右移前事件",beforeRightToLeft:"左移前事件",afterLeftToRight:"右移后事件",afterRightToLeft:"左移后事件"},sweetWidgetName:"[widget-cmp-optimizeListWindow]",type:"listwindow",options:{type:"tree",fromTitle:"",toTitle:"",hidden:!1,icon:!0,search:!0,expand:!1,useTreeStruct:!0,btnWidth:60},_createCmpWidget:function(){this._createChildren()},_createChildren:function(){var t=this,i=(t.options,c+t.uuid),a=h+t.uuid,n=this.table=e("<table>").attr({cellspacing:0,border:0}).appendTo(t.cmpEl),s=e("<tr>").appendTo(n),d=e("<td>").appendTo(s),u=e("<td>").appendTo(s),p=e("<td>").appendTo(s),f=(this.divMiddle=t._createSeletPanel().appendTo(u),this.srcTitle=e("<span>").addClass(o).text(t.options.fromTitle).appendTo(d)),g=this.destTitle=e("<span>").addClass(o).text(t.options.toTitle).appendTo(p);this.divSrc=e("<div />").addClass(r).attr("id",i).appendTo(d),this.divDest=e("<div />").addClass(l).attr("id",a).appendTo(p),""==t.options.toTitle&&""==t.options.fromTitle&&(f.css("display","none"),g.css("display","none"))},setData:function(e){var t=this,i=t.options;i.type,i.data=e,this.srcList&&this.srcList.setData(e)},setRightData:function(e){var t=this,i=t.options;i.rightData=e,t.destList&&t.destList.setData(e)},_getValue:function(){return this.destList.getData()},_createSeletPanel:function(){var o=this,r=o.options,l=o.options.type,d=l==s,c=e("<div>").addClass(d?a:i).css("width",r.btnWidth);return e("<button>").addClass(t).text(Sweet.constants.listWindowButton.RIGHT).appendTo(c).bind("click",o.moveToRight.bind(o)).css("width",r.btnWidth),e("<button>").addClass(t).addClass(n).text(Sweet.constants.listWindowButton.LEFT).appendTo(c).bind("click",o.moveToLeft.bind(o)).css("width",r.btnWidth),e("<button>").addClass(t).text(Sweet.constants.listWindowButton.ALL_RIGHT).appendTo(c).bind("click",o.moveAllToRight.bind(o)).css("width",r.btnWidth),e("<button>").addClass(t).text(Sweet.constants.listWindowButton.ALL_LEFT).appendTo(c).bind("click",o.moveAllToLeft.bind(o)).css("width",r.btnWidth),c},moveToRight:function(t){var i=this,a=i.options;a.type;var n=this.srcList.getValue();(e.isNull(i.handlers)||e.isNull(i.handlers.beforeLeftToRight)||!1!==i.handlers.beforeLeftToRight.call(i.renderEl,t,n))&&(i.destList.setData(n,!0),i._triggerHandler(t,"afterLeftToRight",i.getValue()))},moveToLeft:function(t){var i=this,a=i.options,n=(a.type,i.destList.options.selectedItems);(e.isNull(i.handlers)||e.isNull(i.handlers.beforeRightToLeft)||!1!==i.handlers.beforeRightToLeft.call(i.renderEl,t,n))&&(i.destList.removeSelectedItems(),i._triggerHandler(t,"afterRightToLeft",i.getValue()))},moveAllToLeft:function(t){var i=this,a=i.options;a.type,(e.isNull(i.handlers)||e.isNull(i.handlers.beforeRightToLeft)||!1!==i.handlers.beforeRightToLeft.call(i.renderEl,t,i.getValue()))&&(i.destList._clearAll(),i._triggerHandler(t,"afterRightToLeft",i.getValue()))},moveAllToRight:function(t){var i,a=this,n=a.options;n.type,i=e.objClone(a.srcList.options.data),(e.isNull(a.handlers)||e.isNull(a.handlers.beforeLeftToRight)||!1!==a.handlers.beforeLeftToRight.call(a.renderEl,t,i))&&(a.destList.setData(i),a._triggerHandler(t,"afterLeftToRight",a.getValue()))},_setWH:function(e,t){this._setWidth(e),this._setHeight(t)},_setWidth:function(e){this.cmpEl.externalWidth(e)},_getWidth:function(){return this.cmpEl.externalWidth()},_setHeight:function(e){this.cmpEl.externalHeight(e)},_getHeight:function(){return this.cmpEl.externalHeight()
},_doLayout:function(){var e=this,t=20,i=parseInt(e.divMiddle.css("width")),a=Math.floor((e.cmpEl.externalWidth()-i-t)/2)-5,n=e.cmpEl.externalHeight();"none"!=e.srcTitle.css("display")&&(n-=parseInt(e.srcTitle.css("height"))+10),e.divSrc.css({width:a,height:n}),e.divDest.css({width:a,height:n}),e.srcList&&(e.srcList.setWH(a,n),e.srcList.autoReDraw()),e.destList&&(e.destList.setWH(a,n),e.destList.autoReDraw())},_render:function(e){if(!this._super(e))return!1;var t=this,i=t.options,a=i.type==s,n=t.divSrc.attr(d),o=t.divDest.attr(d);t.cmpEl.appendTo(t.renderEl);var r=this.srcList=new Sweet.tree.OptimizeTree({renderTo:n,search:i.search,icon:i.icon,expand:a?i.expand:!1,useTreeStruct:a?i.useTreeStruct:!1,multi:!0}),l=this.destList=new Sweet.tree.OptimizeTree({renderTo:o,search:i.search,icon:i.icon,expand:a,useTreeStruct:a?i.useTreeStruct:!1,multi:!0});return i.data&&i.data.length>0&&r.setData(i.data),i.rightData&&i.rightData.length>0&&l.setData(i.rightData),this.rendered=!0,!0}}),Sweet.cmp.OptimizeListWindow=e.sweet.cmpOptimizeListWindow}(jQuery),function(e){var t=Sweet.cmp.i18n.stat,i=[{value:"toRight",text:" > "},{value:"toLeft",text:" < "},{value:"allToRight",text:" >> "},{value:"allToLeft",text:" << "}],a=[{value:"max",text:t.max_msg,data:"MAX"},{value:"min",text:t.min_msg,data:"MIN"},{value:"sum",text:t.sum_msg,data:"SUM"},{value:"average",text:t.average_msg,data:"AVG"},{value:"counter",text:t.total_msg,data:"COUNT"},{value:"remove",text:t.delete_msg}];e.widget("sweet.widgetCmpSecondaryStat",e.sweet.widgetCmp,{version:"1.0",eventNames:{},sweetWidgetName:"[widget-cmp-secondaryStat]",type:"secondaryStat",options:{dims:[],indicators:[],statFun:null},_destroyWidget:function(){var e=this;e.wnd&&e.wnd.destroy()},_render:function(){var e=this;return e.wnd.show(),!0},_createCmpWidget:function(){var e=this;e.options.width,e.options.height,e.selectPanels=[],e._createTargetSelect(),e._createDimSelect(),e._createWindow()},_dealMoveBtns:function(e){var t=this,i=t.dimsRight;i&&i.setData(e)},_moveButtonClick:function(t,a){var n=this,o=n.dimLeft.getValue();switch(a.value){case i[0].value:if(e.isEmptyObject(o)||e.isNull(o)||e.isArray(o)&&0===o.length)return;n._dealMoveBtns(o);break;case i[1].value:var r=n.dimsRight.getData(),l=n.dimsRight.getValue();if(!r||!l)return;o=[];for(var s=!1,d=0;r.length>d;d++){s=!1;for(var c=0;l.length>c;c++)if(r[d].value===l[c].value){s=!0;break}s||o.push(JSON.parse(JSON.stringify(r[d])))}n._dealMoveBtns(o);break;case i[2].value:o=n.dimLeft.getData(),n._dealMoveBtns(o);break;case i[3].value:o=[],n._dealMoveBtns(o)}},_createDimSelect:function(){var e=this,a=210,n=190,o=n+30,r=a+32,l=80,s='<span class="sweet-cmp-stat-title">'+t.analysis_dimensions_msg+"</span>",d='<span class="sweet-cmp-stat-title">'+t.selected_analysis_dimensions_msg+"</span>";e.dimLeft=new Sweet.list.OptimizeList({width:r,height:n,multi:!0,isBorder:!0,data:e.options.dims});var c=new Sweet.panel.VPanel({width:r,height:o,padding:2,items:[{html:s},e.dimLeft]});e.toRightBtn=new Sweet.form.Button({value:i[0],width:l}),e.toRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)}),e.toLeftBtn=new Sweet.form.Button({value:i[1],width:l}),e.toLeftBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)}),e.toAllRightBtn=new Sweet.form.Button({value:i[2],width:l}),e.toAllRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)}),e.toAllLefttBtn=new Sweet.form.Button({value:i[3],width:l}),e.toAllLefttBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)});var h=[e.toRightBtn,e.toLeftBtn,e.toAllRightBtn,e.toAllLefttBtn];e.vpDimsBtns=new Sweet.panel.VPanel({height:"100%",width:l,margin:[60,0,5,0],items:h}),e.dimsRight=new Sweet.list.OptimizeList({width:r,height:n,multi:!0,isBorder:!0,data:[]});var u=new Sweet.panel.VPanel({width:r,height:o,padding:2,items:[{html:d},e.dimsRight]});e.hDimspanel=new Sweet.panel.HPanel({width:"100%",height:o,padding:10,itemExtend:!1,items:[c,e.vpDimsBtns,u]}),e.selectPanels.push(e.hDimspanel)},_createTargetSelect:function(){var e=this,i=210,n=190,o=n+30,r=i+32,l=80,s='<span class="sweet-cmp-stat-title">'+t.indicators_msg+"</span>",d='<span class="sweet-cmp-stat-title">'+t.statistics_item_msg+"</span>";e.targetLeft=new Sweet.list.OptimizeList({width:r,height:n,multi:!0,isBorder:!0,data:e.options.indicators});var c=new Sweet.panel.VPanel({width:r,height:o,padding:2,items:[{html:s},e.targetLeft]});e.maxBtn=new Sweet.form.Button({value:a[0],width:l}),e.maxBtn.addListener("click",function(t,i){e._DimButtonClick(t,i)}),e.minBtn=new Sweet.form.Button({value:a[1],width:l}),e.minBtn.addListener("click",function(t,i){e._DimButtonClick(t,i)}),e.sumBtn=new Sweet.form.Button({value:a[2],width:l}),e.sumBtn.addListener("click",function(t,i){e._DimButtonClick(t,i)}),e.averageBtn=new Sweet.form.Button({value:a[3],width:l}),e.averageBtn.addListener("click",function(t,i){e._DimButtonClick(t,i)}),e.countBtn=new Sweet.form.Button({value:a[4],width:l}),e.countBtn.addListener("click",function(t,i){e._DimButtonClick(t,i)}),e.removeBtn=new Sweet.form.Button({value:a[5],highLight:!0,imageType:"delete",width:l}),e.removeBtn.addListener("click",function(t,i){e._DimButtonClick(t,i)});var h=[e.maxBtn,e.minBtn,e.sumBtn,e.averageBtn,e.countBtn,e.removeBtn];e.vpBtns=new Sweet.panel.VPanel({height:"100%",width:l,margin:[30,0,5,0],items:h});var u=[];e.options.indicators&&0===e.options.indicators.length&&u.push(a[4]),e.targetRight=new Sweet.list.OptimizeList({width:r,height:n,multi:!0,isBorder:!0,data:u});var p=new Sweet.panel.VPanel({width:r,height:o,padding:2,items:[{html:d},e.targetRight]});e.hpanel=new Sweet.panel.HPanel({width:"100%",height:o,padding:10,itemExtend:!1,items:[c,e.vpBtns,p]}),e.selectPanels.push(e.hpanel)},_dealBtns:function(t,i,a){var n=this,o=n.targetRight;if(e.isArray(t)&&t.length>0){for(var r=[],l=o.getData(),s=0;t.length>s;s++)r.push({value:t[s].value+"_&#&_"+a,text:t[s].text+"("+i+")",data:a});for(var d=0;r.length>d;d++){for(var c=!1,h=0;l.length>h;h++)if(r[d].value===l[h].value&&r[d].text===l[h].text){c=!0;break}c&&(r.splice(d,1),d--)}r.length>0&&(r=l.concat(r),o.setData(r))}},_DimButtonClick:function(t,i){var n=this,o=n.targetLeft,r=n.targetRight,l=r.getValue(),s=o.getValue();switch(i.value){case a[0].value:n._dealBtns(s,a[0].text,a[0].data);break;case a[1].value:n._dealBtns(s,a[1].text,a[1].data);break;case a[2].value:n._dealBtns(s,a[2].text,a[2].data);break;case a[3].value:n._dealBtns(s,a[3].text,a[3].data);break;case a[4].value:for(var d=r.getData(),c=!1,h=0;d.length>h;h++)d[h].value===a[4].value&&(c=!0);c||(d.push(a[4]),r.setData(d));break;case a[5].value:if(e.isArray(l)&&l.length>0){for(var d=r.getData(),u=[],h=0;d.length>h;h++){for(var c=!1,p=0;l.length>p;p++)if(d[h].value===l[p].value){c=!0;break}c||u.push(d[h])}r.setData(u)}}},_createWindow:function(){var e,i=this;e=new Sweet.panel.VPanel({height:"100%",width:"100%",items:i.selectPanels});var a=new Sweet.form.Button({width:80,highLight:!0,value:{value:"calculatBtn",text:t.calculation_msg}});a.addListener("click",function(e){i._counterStat(e,i)});var n=new Sweet.form.Button({width:80,value:{value:"cancelBtn",text:t.cancel_msg}});n.addListener("click",function(){i.wnd.close()}),i.wnd=new Sweet.Window({widgetClass:"sweet-cmp-stat-window",width:605,height:550,title:t.secondary_statistics_msg,content:e,buttons:[a,n]})},_counterStat:function(i,n){var o,r,l={DIM:[],COUNTER:[]},s=!1,d="";if(r=n.targetRight.getData(),o=n.dimsRight.getData(),(!r||0>=r.length)&&(s=!0,d=t.select_indicators_msg),(!o||0>=o.length)&&(s=!0,d=t.analysis_dimension_msg),s)return Sweet.Dialog.alert({width:330,height:130,prompt:t.prompt_msg,message:d}),undefined;for(var c=0;r.length>c;c++){var h=r[c].value===a[4].value?"*":r[c].value;h=h.split("_&#&_")[0],l.COUNTER.push({value:h,text:r[c].text,func:r[c].data})}for(var u=0;o.length>u;u++)l.DIM.push({value:o[u].value,text:o[u].text});n.options.statFun&&e.isFunction(n.options.statFun)&&n.options.statFun(l),n.wnd.close()},_getWidth:function(){var e=this;return e.cmpEl.externalWidth()},_getHeight:function(){var e=this;return e.cmpEl.externalHeight()},_setWidth:function(e){var t=this;t.cmpEl.externalWidth(e)},_setHeight:function(e){var t=this;t.cmpEl.externalHeight(e)},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)}}),Sweet.cmp.SecondaryStat=e.sweet.widgetCmpSecondaryStat}(jQuery),function(e){var t=Sweet.cmp.i18n.officeDirection,i=20,a=25,n=52,o=50,r=[{value:"toRight",text:">"},{value:"toLeft",text:"<"},{value:"allToRight",text:">>"},{value:"allToLeft",text:"<<"}];e.widget("sweet.widgetCmpOfficeDirection",e.sweet.widgetCmp,{version:"1.0",eventNames:{},sweetWidgetName:"[widget-cmp-officeDirection]",type:"secondaryStat",options:{width:500,height:400,source:[],destination:[],data:{},search:!0,all:!1,tip:!0,splitMark:"#"},clearData:function(){var e=this,t=[];if(e.oldSelectedOptVal=[],e.optionsList&&e.optionsList.setData(t),e.selectedList&&e.selectedList.setData(t),e.sourceList){var i=e.sourceList.getData();i&&i.length>0&&e.sourceList.setValue(t)}if(e.destinationList){var a=e.destinationList.getData();a&&a.length>0&&e.destinationList.setValue(t)}},setData:function(t){var i=this,a="";if(e.isNotNull(t)){i.clearData(),i.options.data=t;var n=i.sourceCombo.getValue(),o=n.value,r=i.destinaCombo.getValue().value;if(e.isNotNull(o)&&i.sourceList)for(a in t)if(a===o){i.sourceList.setData(t[a]);break}if(e.isNull(r)&&e.isArray(n.data)&&(r=n.data[0].value),e.isNotNull(r)&&i.destinationList)for(a in t)if(a===r){i.destinationList.setData(t[a]);break}}},getOData:function(){var e=this,t=[];return e.sourceList&&(t=e.sourceList.getData()),t},getDData:function(){var e=this,t=[];return e.destinationList&&(t=e.destinationList.getData()),t},getValue:function(){var t=this,i=t.selectedList.getData();return e.isNull(i)&&(i=[]),i},getAllSelValue:function(){var e,t,i,a,n,o=this,r={};return e=o.sourceCombo.getValue(),t=o.destinaCombo.getValue(),i=o.sourceList.getValue(),a=o.destinationList.getValue(),n=o.selectedList.getData(),r={source:e,destination:t,sourceList:i,destinationList:a,selectedList:n}},setValue:function(t){var i=this;if(e.isNotNull(t)){var a,n,o,r=[],l=[];a=t.source?t.source:"",n=t.destination?t.destination:"",o=t.selectedList?t.selectedList:[],r=t.sourceList?t.sourceList:[],l=t.destinationList?t.destinationList:[],i.clearData(),e.isNotNull(a)?i.sourceCombo.setValue(a):"",e.isNotNull(n)?i.destinaCombo.setValue(n):"",i.selectedList.setData(o),i.sourceList.setValue(r),i.destinationList.setValue(l),i._setOptionsListData()}},_doLayout:function(){var e=this;e.vPanel.doLayout(),e.sourceList.doLayout(!0),e.destinationList.doLayout(!0),e.optionsList.doLayout(!0),e.selectedList.doLayout(!0)},_destroyWidget:function(){var e=this;e.vPanel&&e.vPanel.destroy()},_createCmpWidget:function(){var e=this;e.selListData=[],e.optListData=[],e._createUpList(),e._createCombobox(),e._createMidLabel(),e._createDownList();var t=e.options.height+40,i=e.options.width+10;e.vPanel=new Sweet.panel.VPanel({id:e.options.id,height:t,width:i,items:[e.comboHpanel,e.upListHpanel,e.LabelPanel,e.downPanel]}),e.options.renderTo&&e.vPanel.render(e.options.renderTo)},_createCombobox:function(){var i,o=this,r=o.options.source,l=(o.options.width-n)/2,s=70,d=s-10;o.sourceCombo=new Sweet.form.ComboBox_v1({label:!0,labelWidth:d,width:l,labelText:t.sourceCombLabel,data:r,blank:!1,tip:!0}),o.sourceCombo.addListener("change",function(t,i){e.isNotNull(i)&&o._sourceCombChange(i)}),i=new Sweet.panel.HPanel({width:n,height:"100%",items:[]}),o.destinaCombo=new Sweet.form.ComboBox_v1({label:!0,labelWidth:s,width:l,blank:!1,labelText:t.destinationCombLabel,tip:!0}),o.destinaCombo.addListener("change",function(t,i){e.isNotNull(i)&&o._destinationCombChange(i)}),o.comboHpanel=new Sweet.panel.HPanel({width:"100%",height:a,itemExtend:!1,items:[o.sourceCombo,i,o.destinaCombo]}),o.sourceCombo.setValue(r[0])},_sourceCombChange:function(t){var i=this,a=t,n=[],o=[];if(i.optionsList?i.optionsList.setData(o):"",i.selectedList?i.selectedList.setData(o):"",a.data&&a.data.length>0&&(n=a.data),i.destinaCombo&&i.destinaCombo.setData(n),e.isNotNull(i.options.data)&&e.isNotNull(a)){var r,o=i.options.data;if(i.sourceList)for(r in o)if(r===a.value){i.sourceList.setData(o[r]);break}}},_destinationCombChange:function(t){var i=this,a=t,n=[];if(i.optionsList?i.optionsList.setData(n):"",i.selectedList?i.selectedList.setData(n):"",e.isNotNull(i.options.data)&&e.isNotNull(a)){var o,n=i.options.data;if(i.destinationList)for(o in n)if(o===a.value){i.destinationList.setData(n[o]);break}}},_createUpList:function(){var t,i=this,o=i.options,r=(o.height-a)/2,l=(o.width-n)/2;i.sourceList=new Sweet.list.OptimizeList({width:l,height:r,multi:!0,search:o.search,all:o.all,tip:o.tip,isBorder:!0}),i.sourceList.addListener("checkboxClick",function(t,a){e.isNotNull(a)&&i._setOptionsListData(a)}),i.sourceList.addListener("checkboxAllClick",function(t,a){e.isNotNull(a)&&i._setOptionsListData(a)}),t=new Sweet.panel.HPanel({width:n,height:"100%",items:[]}),i.destinationList=new Sweet.list.OptimizeList({width:l,height:r,multi:!0,search:o.search,all:o.all,tip:o.tip,isBorder:!0}),i.destinationList.addListener("checkboxClick",function(t,a){e.isNotNull(a)&&i._setOptionsListData(a)}),i.destinationList.addListener("checkboxAllClick",function(t,a){e.isNotNull(a)&&i._setOptionsListData(a)}),i.upListHpanel=new Sweet.panel.HPanel({width:"100%",height:r,itemExtend:!1,items:[i.sourceList,t,i.destinationList]})},_createMidLabel:function(){var e=this,a=e.options,o=(a.width-n)/2,r=new Sweet.form.LabelField({width:o,label:!1,height:i,type:2,value:{text:t.optionsMsg}}),l=new Sweet.panel.HPanel({width:n,height:"100%",items:[]}),s=new Sweet.form.LabelField({width:o,label:!1,height:i,type:2,value:{text:t.selectedMsg}});e.LabelPanel=new Sweet.panel.HPanel({width:"100%",height:i,itemExtend:!1,items:[r,l,s]})},_createDownList:function(){var t=this,i=t.options,l=(i.width-n)/2,s=(i.height-a)/2,d=s-10,c=o,h=n,u=2,p=25,f=(d-6*p)/2;t.optionsList=new Sweet.list.OptimizeList({width:l,height:d,multi:!0,type:2,tip:i.tip,isBorder:!0}),t.optionsList.addListener("dblclick",function(i,a){e.isNotNull(a)&&t._optionsListDbClick(i,a)}),t.toRightBtn=new Sweet.form.Button({value:r[0],width:c}),t.toRightBtn.addListener("click",function(e,i){t._moveButtonClick(e,i)}),t.toLeftBtn=new Sweet.form.Button({value:r[1],width:c}),t.toLeftBtn.addListener("click",function(e,i){t._moveButtonClick(e,i)}),t.toAllRightBtn=new Sweet.form.Button({value:r[2],width:c}),t.toAllRightBtn.addListener("click",function(e,i){t._moveButtonClick(e,i)}),t.toAllLefttBtn=new Sweet.form.Button({value:r[3],width:c}),t.toAllLefttBtn.addListener("click",function(e,i){t._moveButtonClick(e,i)});var g,m,v,w;g=new Sweet.panel.HPanel({width:"100%",height:f,items:[]}),m=new Sweet.panel.HPanel({width:"100%",height:u,items:[]}),v=new Sweet.panel.HPanel({width:"100%",height:u,items:[]}),w=new Sweet.panel.HPanel({width:"100%",height:u,items:[]});var _=[g,t.toRightBtn,m,t.toLeftBtn,v,t.toAllRightBtn,w,t.toAllLefttBtn];t.toWherePanel=new Sweet.panel.VPanel({height:"100%",width:h,items:_}),t.selectedList=new Sweet.list.OptimizeList({width:l,height:d,isBorder:!0,multi:!0,tip:i.tip,data:[]}),t.selectedList.addListener("dblclick",function(i,a){e.isNotNull(a)&&t._selectedListDbClick(i,a)}),t.downPanel=new Sweet.panel.HPanel({width:"100%",height:s,itemExtend:!1,items:[t.optionsList,t.toWherePanel,t.selectedList]})},_setOptionsListData:function(t){var i,a,n=this,o=[],r=[],l={value:"",text:""},s=[],d=0,c=0,h="",u="";n.oldSelectedOptVal=n.optionsList.getValue(),n.optionsList.setData([]),o=n.sourceList.getValue(),r=n.destinationList.getValue(),d=o.length,c=r.length;for(var p=0;d>p;p++){i=o[p];for(var f=0;c>f;f++)a=r[f],i.value!==a.value&&(h=i.value+n.options.splitMark+a.value,u=i.text+"-"+a.text,l={value:h,text:u},s.push(l))}n.optionsList.setData(s),n.oldSelectedOptVal&&n.oldSelectedOptVal.length>0&&n.optionsList.setValue(n.oldSelectedOptVal),e.isNotNull(t)&&n._updateSelectedListData(t)},_updateSelectedListData:function(e){var t,i=this,a=i.selectedList.getData(),n=[];if(a&&a.length>0&&e&&!e.checked){var o=e.value+"";({value:o,text:e.text});for(var r=0;a.length>r;r++)t=a[r].value.split(i.options.splitMark),(t[0]===o||t[1]===o)&&n.push(a[r]);for(var l=[],s=!1,d=0;a.length>d;d++){s=!1;for(var c=0;n.length>c;c++)if(a[d].value===n[c].value){s=!0;break}s||l.push(JSON.parse(JSON.stringify(a[d])))}i._dealMoveBtns(l)}},_dealMoveBtns:function(e){var t=this,i=t.selectedList;i&&i.setData(e)},_moveButtonClick:function(t,i){var a=this;switch(i.value){case r[0].value:var n=a.optionsList.getValue();if(e.isEmptyObject(n)||e.isNull(n)||e.isArray(n)&&0===n.length)return;a._dealMoveBtns(n);break;case r[1].value:var o=[],l=a.selectedList.getData(),s=a.selectedList.getValue();if(!l||!s)return;for(var d=!1,c=0;l.length>c;c++){d=!1;for(var h=0;s.length>h;h++)if(l[c].value===s[h].value){d=!0;break}d||o.push(JSON.parse(JSON.stringify(l[c])))}a._dealMoveBtns(o);break;case r[2].value:var o=[];o=a.optionsList.getData(),a._dealMoveBtns(o);break;case r[3].value:var o=[];a._dealMoveBtns(o)}},_optionsListDbClick:function(e,t){var i=this,a=i.selectedList.getData(),n=!1;if(t){for(var o=0;a.length>o;o++)if(a[o].value===t.value){n=!0;break}n||a.push(t),i._dealMoveBtns(a)}},_selectedListDbClick:function(e,t){var i=this,a=[],n=i.selectedList.getData(),o=t;if(n&&o){for(var r=!1,l=0;n.length>l;l++){if(r=!1,n[l].value===o.value){r=!0;break}r||a.push(JSON.parse(JSON.stringify(n[l])))}i._dealMoveBtns(a)}},_render:function(e){var t=this;return!e||t.rendered?!1:t.renderEl||t._createRenderEl(e)?(t.vPanel.render(e),t.rendered=!0,!0):!1},_getWidth:function(){var e=this;return e.cmpEl.externalWidth()},_getHeight:function(){var e=this;return e.cmpEl.externalHeight()},_setWidth:function(e){var t=this;t.cmpEl.externalWidth(e)},_setHeight:function(e){var t=this;t.cmpEl.externalHeight(e)},_setWH:function(e,t){var i=this;i._setWidth(e),i._setHeight(t)}}),Sweet.cmp.OfficeDirection=e.sweet.widgetCmpOfficeDirection}(jQuery),function(e){var t="sweet-cmp-officedirectionv1-lpanel",i="sweet-cmp-officedirectionv1-rpanel",a="sweet-cmp-officedirectionv1-mpanel",n="sweet-cmp-officedirectionv1-btnpanel",o="sweet-cmp-officedirectionv1-combobox",r="sweet-cmp-officedirectionv1-tree",l="sweet-cmp-officedirectionv1-title",s="sweet-cmp-officedirectionv1-listbody",d="change",c="checkchange",h="beforemoveright",u="load",p="beforeload",f="sourcecomboboxchange",g=Sweet.cmp.i18n.officeDirection.optionsMsg,m=Sweet.cmp.i18n.officeDirection.selectedMsg,v=[{value:"_moveRight",text:" > "},{value:"_moveLeft",text:" < "},{value:"_allMoveRight",text:" >> "},{value:"_allMoveLeft",text:" << "}],w="sweet-cmp-officeDirectionv1",_=_||1e3;e.widget("sweet.widgetCmpOfficeDirection_v1",e.sweet.widgetCmp,{version:"1.0",sweetWidgetName:"[widget-cmp-officeDirectionv1]",type:"officeDirectionv1",eventNames:{beforemoveright:"右移前事件",sourcecomboboxchange:"源下拉列表change事件"},options:{data:{},value:null,sLabel:Sweet.cmp.i18n.officeDirection.sourceCombLabel,dLabel:Sweet.cmp.i18n.officeDirection.destinationCombLabel,tip:!0,icon:!0,useArrows:!0,valueSplit:"#&#*#&#",textSplit:"-"},setData:function(e){var t=this;t.options.data=e,t._initData(),t.sTree&&t.sTree.setData(null),t.dTree&&t.dTree.setData(null),t.optionsList&&t.optionsList.setData(null),t.selectedList&&t.selectedList.setData(null),t.sCombobox&&t.sCombobox.setData(t.sComDatas),t.dCombobox&&t.dCombobox.setData(t.dComDatas)},setValue:function(t){var i=this,a={},n={},o=[],r=[],l=[],s=[];e.isEmptyObject(t)||(a=t.sComValue,n=t.dComValue,o=t.sSelected,r=t.dSelected,l=t.optionsDatas,s=t.selectedDatas),i.sCombobox&&i.sCombobox.setValue(a),i.dCombobox&&i.dCombobox.setValue(n),i.sTree&&i.sTree.setValue(o),i.dTree&&i.dTree.setValue(r),i.optionsList&&i.optionsList.setData(l),i.selectedList&&i.selectedList.setData(s)},getValue:function(){var e=this,t={},i={},a={},n=[],o=[],r=[],l=[];return e.sCombobox&&(i=e.sCombobox.getValue()),e.dCombobox&&(a=e.dCombobox.getValue()),e.sTree&&(n=e.sTree.getValue()),e.dTree&&(o=e.dTree.getValue()),e.optionsList&&(r=e.optionsList.getCurrentData()),e.selectedList&&(l=e.selectedList.getCurrentData()),t.sComValue=i,t.dComValue=a,t.sSelected=n,t.dSelected=o,t.optionsDatas=r,t.selectedDatas=l,t},_destroyWidget:function(){var e=this;e._super(),e.officeDirectionEl&&e.officeDirectionEl.remove(),e.sCombobox&&e.sCombobox.destroy(),e.dCombobox&&e.dCombobox.destroy(),e.sTree&&e.sTree.destroy(),e.dTree&&e.dTree.destroy(),e.optionsList&&e.optionsList.destroy(),e.vpBtns&&e.vpBtns.destroy(),e.selectedList&&e.selectedList.destroy()},_createSweetWidget:function(){var s,d,c=this,h=c.options.id,u=c.options.widgetClass;c.btnWidth=60,c.btnMargin=5,c._initData(),c.officeDirectionEl=e("<div>").attr("id",c.options.id),u&&""!=u&&c.officeDirectionEl.addClass(u),s=e("<div>").addClass(t).appendTo(c.officeDirectionEl),c.__sComRenderID=h+"-"+w+"-scombobox-"+_,e("<div>").attr("id",c.__sComRenderID).addClass(o).appendTo(s),c.__sTreeRenderID=h+"-"+w+"-stree-"+_,e("<div>").attr("id",c.__sTreeRenderID).addClass(r).appendTo(s),c.optionsTitleDiv=e("<div>").addClass(l).appendTo(s),c.optionsTitleEl=e("<span>").appendTo(c.optionsTitleDiv),c.__optionsListRenderID=h+"-"+w+"-optionslist-"+_,e("<div>").attr("id",c.__optionsListRenderID).appendTo(s),c.mPanelDiv=e("<div>").addClass(a).height(c.options.height).appendTo(c.officeDirectionEl),c.mTopDiv=e("<div>").appendTo(c.mPanelDiv),c.__mOptBtnPanelRenderID=h+"-"+w+"-optbtnpanel-"+_,e("<div>").attr("id",c.__mOptBtnPanelRenderID).addClass(n).appendTo(c.mPanelDiv),d=e("<div>").addClass(i).appendTo(c.officeDirectionEl),c.__dComRenderID=h+"-"+w+"-dcombobox-"+_,e("<div>").attr("id",c.__dComRenderID).addClass(o).appendTo(d),c.__dTreeRenderID=h+"-"+w+"-dtree-"+_,e("<div>").attr("id",c.__dTreeRenderID).addClass(r).appendTo(d),c.selectedTitleDiv=e("<div>").addClass(l).appendTo(d),c.selectedTitleEl=e("<span>").appendTo(c.selectedTitleDiv),c.__selectedListRenderID=h+"-"+w+"-selectedlist-"+_,e("<div>").attr("id",c.__selectedListRenderID).appendTo(d),c._createOfficeDirectionPanel(),c._registInitEvent()},_initData:function(){var e=this;e.options.data?(e.options.data.sData||(e.options.data.sData=[]),e.options.data.dData||(e.options.data.dData=[])):e.options.data={sData:[],dData:[]},e.sComDatas=[],e.dComDatas=[];for(var t=0;e.options.data.sData.length>t;t++)e.sComDatas.push({value:e.options.data.sData[t].value,text:e.options.data.sData[t].text,data:e.options.data.sData[t].data});for(var t=0;e.options.data.dData.length>t;t++)e.dComDatas.push({value:e.options.data.dData[t].value,text:e.options.data.dData[t].text,data:e.options.data.dData[t].data})},_render:function(t){var i=this;return i._super(t)?(i.officeDirectionEl.appendTo(i.renderEl),i.sCombobox.render(i.__sComRenderID),i.dCombobox.render(i.__dComRenderID),i.sTree.render(i.__sTreeRenderID),i.dTree.render(i.__dTreeRenderID),i.optionsList.render(i.__optionsListRenderID),i.vpBtns.render(i.__mOptBtnPanelRenderID),i.selectedList.render(i.__selectedListRenderID),i.optionsTitleEl.text(g),i.selectedTitleEl.text(m),i.rendered=!0,i.sCombobox.setData(i.sComDatas),i.dCombobox.setData(i.dComDatas),e.isEmptyObject(i.options.value)||i.setValue(i.options.value),!0):!1},_createOfficeDirectionPanel:function(){var t,i,a,n,o,r,l,d=this,c=d.btnWidth,h=30,u=60,p=18,f=22,g=d.btnMargin,m=20,v=10;if(t=d.options.listeners,!e.isEmptyObject(t))for(var w in t)d.addListener(""+w,t[w]);i=d.officeDirectionEl.width(),a=d.officeDirectionEl.height(),d.treeWidth=n=Math.floor((i-c-2*g)/2),d.treeHeight=o=Math.floor((a-f-p-m)/2),r=2*u+h,d.mTopDiv.width(c+2*g).height(a-o+(o-r)/2),d.comboboxLabelWidth=52,l=e("<span>").css({display:"block",position:"absolute",top:"-500px"}).html(d.options.sLabel).appendTo("body"),d.comboboxLabelWidth=l.width(),l.html(d.options.dLabel),d.comboboxLabelWidth<l.width()&&(d.comboboxLabelWidth=l.width()),l.remove(),d.comboboxLabelWidth=d.comboboxLabelWidth+v,d.sCombobox=new Sweet.form.ComboBox_v1({label:!0,width:n,labelText:d.options.sLabel,blank:!1,labelWidth:d.comboboxLabelWidth,tip:d.options.tip}),d.dCombobox=new Sweet.form.ComboBox_v1({label:!0,width:n,labelText:d.options.dLabel,blank:!1,labelWidth:d.comboboxLabelWidth,tip:d.options.tip}),d.sTree=new Sweet.tree.Tree_v1({width:n,height:o,search:!0,multi:!0,tip:d.options.tip,icon:d.options.icon,useArrows:d.options.useArrows}),d.dTree=new Sweet.tree.Tree_v1({width:n,height:o,search:!0,multi:!0,tip:d.options.tip,icon:d.options.icon,useArrows:d.options.useArrows}),d.optionsList=new Sweet.list.OptimizeList({width:n,height:o,widgetClass:s,multi:!0,isBorder:!0,tip:!0,search:!1}),d.selectedList=new Sweet.list.OptimizeList({width:n,height:o,widgetClass:s,multi:!0,isBorder:!0,tip:!0,search:!1}),d._createMoveRightBtn(),d._createMoveLeftBtn(),d._createMoveAllRightBtn(),d._createMoveAllLeftBtn(),d.vpUp=new Sweet.panel.VPanel({height:u,width:c,items:[d.moveRightBtn,d.moveLeftBtn]}),d.vpDown=new Sweet.panel.VPanel({height:u,width:c,items:[d.moveAllRightBtn,d.moveAllLeftBtn]}),d.vpBtns=new Sweet.panel.VPanel({height:r,padding:h,items:[d.vpUp,d.vpDown]})},_doLayout:function(){var e,t,i,a,n,o=this,r=o.btnWidth,l=30,s=60,d=18,c=22,h=o.btnMargin,u=20;e=o.officeDirectionEl.width(),t=o.officeDirectionEl.height(),o.treeWidth=i=Math.floor((e-r-2*h)/2),d=o.optionsTitleDiv.outerHeight(),c=o.sCombobox.getHeight(),o.treeHeight=a=Math.floor((t-c-d-u)/2),n=2*s+l,o.mTopDiv.width(r+2*h).height(t-a+(a-n)/2),o.mPanelDiv.height(t),o.sCombobox&&o.sCombobox.setWidth(i),o.dCombobox&&o.dCombobox.setWidth(i),o.sTree&&(o.sTree.setWH(i,a),o.sTree.doLayout(!0)),o.dTree&&(o.dTree.setWH(i,a),o.dTree.doLayout(!0)),o.optionsList&&(o.optionsList.setWH(i,a),o.optionsList.doLayout(!0)),o.selectedList&&(o.selectedList.setWH(i,a),o.selectedList.doLayout(!0))},_createMoveRightBtn:function(){var e=this,t=e.btnWidth;e.moveRightBtn=new Sweet.form.Button({value:v[0],width:t}),e.moveRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createMoveLeftBtn:function(){var e=this,t=e.btnWidth;e.moveLeftBtn=new Sweet.form.Button({value:v[1],width:t}),e.moveLeftBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createMoveAllRightBtn:function(){var e=this,t=e.btnWidth;e.moveAllRightBtn=new Sweet.form.Button({value:v[2],width:t}),e.moveAllRightBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_createMoveAllLeftBtn:function(){var e=this,t=e.btnWidth;e.moveAllLeftBtn=new Sweet.form.Button({value:v[3],width:t}),e.moveAllLeftBtn.addListener("click",function(t,i){e._moveButtonClick(t,i)})},_moveButtonClick:function(e,t){var i=this;switch(t.value){case v[0].value:i.moveRight();break;case v[1].value:i.moveLeft();break;case v[2].value:i.moveAllRight();break;case v[3].value:i.moveAllLeft()}},moveRight:function(){var e,t,i=this,a=[];if(i.optionsList&&i.selectedList&&!i.__isDoMoving){if(i.__isDoMoving=!0,a=i.optionsList.getValue(),!a||0>=a.length)return i.__isDoMoving=!1,undefined;if(e=i.selectedList.getCurrentData(),e=e&&e.length>0?i._deleteArraysSimilar(a,e):a,t=i._triggerHandler(e,h,i),!1===t||"false"===t)return i.__isDoMoving=!1,undefined;i.selectedList.setData(e),i.__isDoMoving=!1}},moveLeft:function(){var e,t,i=this;if(i.optionsList&&i.selectedList&&!i.__isDoMoving){if(i.__isDoMoving=!0,e=i.selectedList.getValue(),!e||0>=e.length)return i.__isDoMoving=!1,undefined;t=i.selectedList.getCurrentData(),t=i._minusArrays(t,e),i.selectedList.setData(t),i.__isDoMoving=!1}},moveAllRight:function(){var e,t,i,a=this;if(a.optionsList&&a.selectedList&&!a.__isDoMoving){if(a.__isDoMoving=!0,e=a.optionsList.getCurrentData(),!e||0>=e.length)return a.__isDoMoving=!1,undefined;if(t=a.selectedList.getCurrentData(),t=t&&t.length>0?a._deleteArraysSimilar(e,t):e,i=a._triggerHandler(t,h,a),!1===i||"false"===i)return a.__isDoMoving=!1,undefined;a.selectedList.setData(t),a.__isDoMoving=!1}},moveAllLeft:function(){var e=this;e.selectedList&&(e.__isDoMoving||(e.__isDoMoving=!0,e.selectedList.setData([]),e.__isDoMoving=!1))},_getWidth:function(){return this.officeDirectionEl.externalWidth()},_getHeight:function(){return this.officeDirectionEl.externalHeight()},_setWidth:function(e){this.officeDirectionEl.externalWidth(e)},_setHeight:function(e){this.officeDirectionEl.externalHeight(e)},_setWH:function(e,t){var i=this;i.officeDirectionEl.externalWidth(e),i.officeDirectionEl.externalHeight(t)},_triggerHandler:function(t,i,a){var n,o=this;if(!e.isNull(o.handlers))return e.each(o.handlers,function(e,o){i===e&&(n=o.call(null,t,a))}),n},_registInitEvent:function(){var t,i,a=this;if(t=a.options.listeners,!e.isEmptyObject(t))for(var n in t)a.addListener(""+n,t[n]);a.sCombobox.addListener(d,function(e,t){a.optionsList&&a.optionsList.setData([]),a.selectedList&&a.selectedList.setData([]),a._doComboboxChange(t,!0),a._registCheckChangeEvent(),i=a._triggerHandler(t,f,a),(1==i||"true"==i)&&a.dCombobox&&a.dCombobox.setData(a.dComDatas)}),a.dCombobox.addListener(d,function(e,t){a.optionsList&&a.optionsList.setData([]),a.selectedList&&a.selectedList.setData([]),a._doComboboxChange(t,!1),a._registCheckChangeEvent()}),a._registCheckChangeEvent()},setDestinaComboData:function(e){var t=this;if(t.optionsList&&t.optionsList.setData([]),t.selectedList&&t.selectedList.setData([]),t.dCombobox){e||(e=[]),t.dComDatas=[],t.options.data.dData=e;for(var i=0;t.options.data.dData.length>i;i++)t.dComDatas.push({value:t.options.data.dData[i].value,text:t.options.data.dData[i].text,data:t.options.data.dData[i].data})}},getValueSplit:function(){return this.options.valueSplit},getTextSplit:function(){return this.options.textSplit},_parseListDatas:function(e,t){for(var i=this,a=0;e.length>a;a++)e[a].children&&e[a].children.length>0?i._parseListDatas(e[a].children,t):t.push(e[a])},_getListDatas:function(e,t){var i=this,a=[];return e&&t?"widgetListList"==t.widgetName?e:("widgetTreeTree_v1"==t.widgetName?i._parseListDatas(e,a):i._parseListDatas(e,a),a):a},_registCheckChangeEvent:function(){var e,t,i=this;i.sTree&&i.sTree.addListener(c,function(a,n){e=n.getValue(),t=i.dTree?i.dTree.getValue():[],e=i._getListDatas(e,n),t=i._getListDatas(t,i.dTree),i._setOptionsDatas(e,t)}),i.dTree&&i.dTree.addListener(c,function(a,n){t=n.getValue(),e=i.sTree?i.sTree.getValue():[],t=i._getListDatas(t,n),e=i._getListDatas(e,i.sTree),i._setOptionsDatas(e,t)})},_setOptionsDatas:function(e,t){var i,a,n,o,r=this,l=[],s={};if(r.optionsList)if(i=r.optionsList.getValue(),i&&i.length>0){for(var d=0;i.length>d;d++)s[i[d].value]="";i=[];for(var d=0;e.length>d;d++)for(var c=0;t.length>c;c++)a=e[d].value+r.options.valueSplit+t[c].value,n=e[d].text+r.options.textSplit+t[c].text,o={value:a,text:n,data:{sNode:e[d],dNode:t[c]}},l.push(o),""===s[a]&&i.push(o);r.optionsList.setData(l),r.optionsList.setValue(i)}else{for(var d=0;e.length>d;d++)for(var c=0;t.length>c;c++)a=e[d].value+r.options.valueSplit+t[c].value,n=e[d].text+r.options.textSplit+t[c].text,o={value:a,text:n,data:{sNode:e[d],dNode:t[c]}},l.push(o);r.optionsList.setData(l)}},_doComboboxChange:function(t,i){var a,n,o,r,l,s,d,c,h,f=this;if(i?(n="sData",l=f.__sTreeRenderID,o=f.sTree):(n="dData",l=f.__dTreeRenderID,o=f.dTree),r="tree",a=null,s=[],f.options.data[n])for(var g=0;f.options.data[n].length>g;g++)if(t.value==f.options.data[n][g].value&&(h=f.options.data[n][g].isAll,f.options.data[n][g].datasource))if(r=f.options.data[n][g].datasource.type,"list"==r)f.options.data[n][g].datasource&&f.options.data[n][g].datasource.data&&(s=f.options.data[n][g].datasource.data);else if(r="tree",a=e.objClone(f.options.data[n][g].datasource.loader),e.isEmptyObject(a))s=f.options.data[n][g].datasource.data||[];else if(d=a.listeners,delete a.listeners,!e.isEmptyObject(d))for(var m in d)m!=p&&m!=u&&delete d[m];o&&o.destroy(),"tree"==r?(c={width:f.treeWidth,height:f.treeHeight,search:!0,multi:!0,tip:f.options.tip,icon:f.options.icon,useArrows:f.options.useArrows,renderTo:l},e.isEmptyObject(d)||(c.listeners=d),o=new Sweet.tree.Tree_v1(c)):(c={width:f.treeWidth,height:f.treeHeight,multi:!0,search:!0,all:h,tip:f.options.tip,isBorder:!0,renderTo:l},o=new Sweet.list.OptimizeList(c)),"tree"==r&&a?(o.setLoader(a),o.load()):o.setData(s),i?f.sTree=o:f.dTree=o
},_deleteArraysSimilar:function(e,t){var i,a,n=[];a=e.concat(t),i={};for(var o=0;a.length>o;o++)i[a[o].value]=a[o];for(var r in i)n.push(i[r]);return n},_minusArrays:function(e,t){for(var i={},a=[],n=0;e.length>n;n++)i[e[n].value]=e[n];for(var o=0;t.length>o;o++)delete i[t[o].value];for(var r in i)a.push(i[r]);return a}}),Sweet.cmp.OfficeDirection_v1=e.sweet.widgetCmpOfficeDirection_v1}(jQuery),function(e){var t="sweet-cmp-app-item",i="sweet-cmp-app-item-over",a="sweet-cmp-app-container",n="sweet-cmp-app-content",o="sweet-cmp-app-img-container",r="sweet-cmp-app-img",l="sweet-cmp-app-text",s="sweet-cmp-app-opertor",d="sweet-cmp-app-action",c="sweet-cmp-app-state-text";e.widget("sweet.cmpAppManager",e.sweet.widgetCmp,{version:"1.0",sweetWidgetName:"[widget-appManager]",eventNames:{opertorClick:"操作面板上的操作事件"},options:{data:[],lpWidth:200,lpHeight:250,defaultIcon:"",errorIcon:"",actions:[{value:"detail",text:"Details"},{value:"edit",text:"Edit"},{value:"delete",text:"Delete"}]},deleteItem:function(t){if(!e.isNull(t)){var i=this,a=e("#"+t);if(a&&a.length>0){for(var n=0;a.length>n;n++){var o=e(a[n]),r=o.data("item");if(r&&e.isNotNull(r.value))for(var l=0;i.options.data.length>l;l++)if(r.value===i.options.data[l].value){i.options.data.splice(l,1);break}o.unbind(),o.find("."+d).unbind(),o.remove()}i._doLayout()}}},getData:function(){return e.objClone(this.options.data)},setData:function(i){if(!e.isNull(i)){var a=this,n=0;a.options.data=e.objClone(i),a.contentEl&&(a.contentEl.find("."+t).unbind(),a.contentEl.find("."+d).unbind(),a.contentEl.empty()),n=a.options.data?a.options.data.length:0,n>0&&a._createLookPanel()}},_render:function(e){return e&&!this.rendered?(this.renderEl||this._createRenderEl(e),this.cmpEl.appendTo(this.renderEl),this.rendered=!0,!0):undefined},_onMouseOver:function(e){var a=e.data.obj,n=a.data("operEl"),o=a.data("stateEl");a.removeClass(t).addClass(i),n&&o&&(o.hide(),n.show())},_onMouseOut:function(e){var a=e.data.obj,n=a.data("operEl"),o=a.data("stateEl");a.removeClass(i).addClass(t),o&&n&&(o.show(),n.hide())},_onActionClick:function(e){var t=e.data.me,i=e.data.obj,a=i.data("action"),n=i.data("id"),o=i.data("item");t._triggerHandler(e,"opertorClick",{action:a,id:n,item:o})},_createLookPanel:function(){var i=this,a=0,n=0,h=i.options,u=h.data,p=h.lpWidth,f=h.lpHeight,g=u?u.length:0;for(a=0;g>a;a++){var m=e("<div>").addClass(t).attr("id",h.id+"-item-"+a).height(f).width(p).appendTo(i.contentEl);m.bind("mouseover",{me:i,obj:m},i._onMouseOver).bind("mouseout",{me:i,obj:m},i._onMouseOut);var v=u[a],w=v.icon?v.icon:h.defaultIcon;m.data("item",v);var _=e("<div>").addClass(o).appendTo(m);e("<img>").attr({src:w}).bind("error",function(){e(this).attr("src",h.errorIcon)}).addClass(r).appendTo(_),e("<div>").addClass(l).attr("title",v.text).width(p).text(v.text).appendTo(m);var C=e("<div>").addClass(c).text(v.state).appendTo(m);if(m.data("stateEl",C),h.actions&&h.actions.length>0){var b=e("<div>").addClass(s).appendTo(m).hide();for(m.data("operEl",b),n=0;h.actions.length>n;n++){var E=e("<div>").addClass(d).text(h.actions[n].text).appendTo(b);E.data("action",h.actions[n]),E.data("id",h.id+"-item-"+a),E.data("item",v),E.bind("click",{me:i,obj:E},i._onActionClick)}}}},_doLayout:function(){var e=this,t=e.options,i=30,a=20,n=t.data.length,o=t.lpWidth,r=t.lpHeight,l=(e.cmpEl.width(),e.cmpEl.height()),s=Math.floor(l/(r+i));if(1===s){var d=Math.ceil(n/s);e.contentEl.width(d*(o+a+2)).height("100%")}else e.cmpEl.css("overflow","hidden"),e.contentEl.css("overflow","auto")},_createCmpWidget:function(){var t=this,i=t.options.data?t.options.data.length:0;t.cmpEl.addClass(a),t.contentEl=e("<div>").attr("id",t.options.id+"-content").addClass(n).appendTo(t.cmpEl),i>0&&t._createLookPanel()},_getWidth:function(){var e=this;return e.cmpEl.externalWidth()},_getHeight:function(){var e=this;return e.cmpEl.externalHeight()},_setWidth:function(e){var t=this;t.cmpEl.externalWidth(e)},_setHeight:function(e){var t=this;t.cmpEl.externalHeight(e)}}),Sweet.cmp.AppManager=e.sweet.cmpAppManager}(jQuery);